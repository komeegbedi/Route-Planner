/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/@mapbox";
exports.ids = ["vendor-chunks/@mapbox"];
exports.modules = {

/***/ "(ssr)/./node_modules/@mapbox/search-js-core/dist/index-esm.js":
/*!***************************************************************!*\
  !*** ./node_modules/@mapbox/search-js-core/dist/index-esm.js ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AddressAutofillCore: () => (/* binding */ AddressAutofillCore),\n/* harmony export */   Evented: () => (/* binding */ Evented),\n/* harmony export */   GeocodingCore: () => (/* binding */ GeocodingCore),\n/* harmony export */   LngLat: () => (/* binding */ LngLat),\n/* harmony export */   LngLatBounds: () => (/* binding */ LngLatBounds),\n/* harmony export */   MapboxAutofill: () => (/* binding */ AddressAutofillCore),\n/* harmony export */   MapboxError: () => (/* binding */ MapboxError),\n/* harmony export */   MapboxGeocode: () => (/* binding */ GeocodingCore),\n/* harmony export */   MapboxValidate: () => (/* binding */ ValidationCore),\n/* harmony export */   MatchCodeConfidence: () => (/* binding */ MatchCodeConfidence),\n/* harmony export */   MatchCodeType: () => (/* binding */ MatchCodeType),\n/* harmony export */   SearchBoxCore: () => (/* binding */ SearchBoxCore),\n/* harmony export */   SearchSession: () => (/* binding */ SearchSession),\n/* harmony export */   SessionToken: () => (/* binding */ SessionToken),\n/* harmony export */   ValidationCore: () => (/* binding */ ValidationCore),\n/* harmony export */   debounce: () => (/* binding */ debounce),\n/* harmony export */   featureToSuggestion: () => (/* binding */ featureToSuggestion),\n/* harmony export */   polyfillFetch: () => (/* binding */ polyfillFetch)\n/* harmony export */ });\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nvar __objRest = (source, exclude) => {\n  var target = {};\n  for (var prop in source)\n    if (__hasOwnProp.call(source, prop) && exclude.indexOf(prop) < 0)\n      target[prop] = source[prop];\n  if (source != null && __getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(source)) {\n      if (exclude.indexOf(prop) < 0 && __propIsEnum.call(source, prop))\n        target[prop] = source[prop];\n    }\n  return target;\n};\nvar __accessCheck = (obj, member, msg) => {\n  if (!member.has(obj))\n    throw TypeError(\"Cannot \" + msg);\n};\nvar __privateGet = (obj, member, getter) => {\n  __accessCheck(obj, member, \"read from private field\");\n  return getter ? getter.call(obj) : member.get(obj);\n};\nvar __privateAdd = (obj, member, value) => {\n  if (member.has(obj))\n    throw TypeError(\"Cannot add the same private member more than once\");\n  member instanceof WeakSet ? member.add(obj) : member.set(obj, value);\n};\nvar __privateSet = (obj, member, value, setter) => {\n  __accessCheck(obj, member, \"write to private field\");\n  setter ? setter.call(obj, value) : member.set(obj, value);\n  return value;\n};\nvar __privateMethod = (obj, member, method) => {\n  __accessCheck(obj, member, \"access private method\");\n  return method;\n};\nvar __async = (__this, __arguments, generator) => {\n  return new Promise((resolve, reject) => {\n    var fulfilled = (value) => {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    };\n    var rejected = (value) => {\n      try {\n        step(generator.throw(value));\n      } catch (e) {\n        reject(e);\n      }\n    };\n    var step = (x) => x.done ? resolve(x.value) : Promise.resolve(x.value).then(fulfilled, rejected);\n    step((generator = generator.apply(__this, __arguments)).next());\n  });\n};\n\n// src/autofill/constants.ts\nvar SEARCH_URL = `https://api.mapbox.com/autofill/v1`;\nvar ENDPOINT_SUGGEST = \"suggest\";\nvar ENDPOINT_RETRIEVE = \"retrieve\";\nvar SUGGEST_URL = `${SEARCH_URL}/${ENDPOINT_SUGGEST}`;\nvar RETRIEVE_URL = `${SEARCH_URL}/${ENDPOINT_RETRIEVE}`;\n\n// src/LngLat.ts\nvar LngLat = class {\n  constructor(lng, lat) {\n    if (isNaN(lng) || isNaN(lat)) {\n      throw new Error(`Invalid LngLat object: (${lng}, ${lat})`);\n    }\n    this.lng = +lng;\n    this.lat = +lat;\n    if (this.lat > 90 || this.lat < -90) {\n      throw new Error(\"Invalid LngLat latitude value: must be between -90 and 90\");\n    }\n    if (this.lng > 180 || this.lng < -180) {\n      throw new Error(\"Invalid LngLat longitude value: must be between -180 and 180\");\n    }\n  }\n  toArray() {\n    return [this.lng, this.lat];\n  }\n  toString() {\n    return `LngLat(${this.lng}, ${this.lat})`;\n  }\n  static convert(input) {\n    if (input instanceof LngLat) {\n      return new LngLat(input.lng, input.lat);\n    }\n    if (Array.isArray(input) && input.length === 2) {\n      return new LngLat(Number(input[0]), Number(input[1]));\n    }\n    if (!Array.isArray(input) && typeof input == \"object\" && input !== null && (\"lng\" in input || \"lon\" in input) && \"lat\" in input) {\n      return new LngLat(Number(\"lng\" in input ? input.lng : input.lon), Number(input.lat));\n    }\n    throw new Error(\"`LngLatLike` argument must be specified as an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]\");\n  }\n};\n\n// src/LngLatBounds.ts\nvar LngLatBounds = class {\n  constructor(sw, ne) {\n    this._sw = LngLat.convert(sw);\n    this._ne = LngLat.convert(ne);\n  }\n  getSouthWest() {\n    return this._sw;\n  }\n  getNorthEast() {\n    return this._ne;\n  }\n  getNorthWest() {\n    return new LngLat(this.getWest(), this.getNorth());\n  }\n  getSouthEast() {\n    return new LngLat(this.getEast(), this.getSouth());\n  }\n  getWest() {\n    return this._sw.lng;\n  }\n  getSouth() {\n    return this._sw.lat;\n  }\n  getEast() {\n    return this._ne.lng;\n  }\n  getNorth() {\n    return this._ne.lat;\n  }\n  toArray() {\n    return [this._sw.toArray(), this._ne.toArray()];\n  }\n  toFlatArray() {\n    return [this._sw.lng, this._sw.lat, this._ne.lng, this._ne.lat];\n  }\n  toString() {\n    return `LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`;\n  }\n  static convert(input) {\n    if (!input) {\n      throw new Error(\"Invalid LngLatBounds convert value: falsy\");\n    }\n    if (input instanceof LngLatBounds) {\n      return new LngLatBounds(input.getSouthWest(), input.getNorthEast());\n    }\n    if (Array.isArray(input) && input.length === 2) {\n      return new LngLatBounds(LngLat.convert(input[0]), LngLat.convert(input[1]));\n    }\n    if (Array.isArray(input) && input.length === 4) {\n      return new LngLatBounds(LngLat.convert([input[0], input[1]]), LngLat.convert([input[2], input[3]]));\n    }\n    throw new Error(\"`LngLatBoundsLike` argument must be specified as an array [<LngLatLike>, <LngLatLike>] or an array [<west>, <south>, <east>, <north>]\");\n  }\n};\n\n// src/utils/uuid.ts\nfunction generateUUID() {\n  const randomString = Math.random().toString(16) + Date.now().toString(16) + Math.random().toString(16);\n  const uuidString = randomString.replace(/\\./g, \"\");\n  const uuid = [\n    uuidString.slice(0, 8),\n    uuidString.slice(8, 12),\n    \"4\" + uuidString.slice(12, 15) + \"-8\" + uuidString.slice(15, 18),\n    uuidString.slice(18, 30)\n  ].join(\"-\");\n  return uuid;\n}\n\n// src/SessionToken.ts\nvar SessionToken = class {\n  constructor(id) {\n    this.id = id != null ? id : generateUUID();\n  }\n  toString() {\n    return this.id;\n  }\n  static convert(token) {\n    return new SessionToken(token instanceof SessionToken ? token.id : token.toString());\n  }\n};\n\n// src/MapboxError.ts\nvar UNKNOWN_ERROR = \"Unknown error\";\nvar MapboxError = class extends Error {\n  constructor(json, statusCode) {\n    super(String(json.message || json.error || UNKNOWN_ERROR));\n    this.name = \"MapboxError\";\n    this.statusCode = statusCode;\n  }\n  toString() {\n    return `${this.name} (${this.statusCode}): ${this.message}`;\n  }\n};\nfunction handleNonOkRes(res) {\n  return __async(this, null, function* () {\n    if (!res.ok) {\n      const json = yield res.json();\n      throw new MapboxError(json, res.status);\n    }\n  });\n}\n\n// src/fetch.ts\nvar _fetchImpl = globalThis.fetch;\nvar _abortControllerImpl = globalThis.AbortController;\nfunction polyfillFetch({ fetch, AbortController }, force = false) {\n  if (!fetch) {\n    throw new Error(\"Fetch implementation must include implementations of `fetch`.\");\n  }\n  if (_fetchImpl && !force) {\n    return;\n  }\n  _fetchImpl = fetch;\n  _abortControllerImpl = AbortController;\n}\nfunction getFetch() {\n  if (!_fetchImpl) {\n    throw new Error(\"Fetch implementation not found. Please include a fetch polyfill in your application or use `polyfillFetch` from `@mapbox/search-js-core` to fix this issue.\");\n  }\n  return {\n    fetch: _fetchImpl,\n    AbortController: _abortControllerImpl\n  };\n}\n\n// src/utils/queryParams.ts\nfunction queryParams(...objects) {\n  const params = [];\n  for (const obj of objects) {\n    if (!obj)\n      continue;\n    const entries = Object.entries(obj);\n    for (const [key, value] of entries) {\n      if (value == null)\n        continue;\n      params.push(`${key}=${encodeURIComponent(String(value))}`);\n    }\n  }\n  return params.join(\"&\");\n}\n\n// src/autofill/AddressAutofillCore.ts\nvar _getQueryParams, getQueryParams_fn;\nvar _AddressAutofillCore = class {\n  constructor(options = {}) {\n    __privateAdd(this, _getQueryParams);\n    const _a = options, { accessToken } = _a, defaults = __objRest(_a, [\"accessToken\"]);\n    this.accessToken = accessToken;\n    this.defaults = __spreadValues(__spreadValues({}, _AddressAutofillCore.defaults), defaults);\n  }\n  suggest(searchText, optionsArg) {\n    return __async(this, null, function* () {\n      if (!searchText) {\n        throw new Error(\"searchText is required\");\n      }\n      const { sessionToken, signal } = optionsArg;\n      const options = __spreadProps(__spreadValues(__spreadValues({}, this.defaults), optionsArg), {\n        sessionToken\n      });\n      const url = new URL(`${SUGGEST_URL}/${encodeURIComponent(searchText)}`);\n      url.search = __privateMethod(this, _getQueryParams, getQueryParams_fn).call(this, options);\n      const { fetch } = getFetch();\n      const res = yield fetch(url.toString(), {\n        signal\n      });\n      yield handleNonOkRes(res);\n      const json = yield res.json();\n      return __spreadProps(__spreadValues({}, json), {\n        suggestions: json.suggestions.map((suggestion) => {\n          return __spreadProps(__spreadValues({}, suggestion), {\n            original_search_text: searchText\n          });\n        }),\n        url: url.toString()\n      });\n    });\n  }\n  retrieve(suggestion, optionsArg) {\n    return __async(this, null, function* () {\n      if (!suggestion) {\n        throw new Error(\"suggestion is required\");\n      }\n      if (!this.canRetrieve(suggestion)) {\n        throw new Error(\"suggestion cannot be retrieved\");\n      }\n      const { sessionToken: sessionTokenLike, signal } = optionsArg;\n      const sessionToken = SessionToken.convert(sessionTokenLike);\n      const url = new URL(`${RETRIEVE_URL}/${suggestion.action.id}`);\n      url.search = queryParams({\n        access_token: this.accessToken,\n        session_token: sessionToken.id\n      });\n      const { fetch } = getFetch();\n      const res = yield fetch(url.toString(), { signal });\n      yield handleNonOkRes(res);\n      const json = yield res.json();\n      json.url = url.toString();\n      return json;\n    });\n  }\n  canRetrieve(suggestion) {\n    const action = suggestion.action;\n    return typeof (action == null ? void 0 : action.id) === \"string\";\n  }\n};\nvar AddressAutofillCore = _AddressAutofillCore;\n_getQueryParams = new WeakSet();\ngetQueryParams_fn = function(options) {\n  return queryParams({\n    types: \"address\",\n    access_token: this.accessToken,\n    streets: options.streets,\n    language: options.language,\n    country: options.country,\n    limit: options.limit\n  }, options.sessionToken && {\n    session_token: SessionToken.convert(options.sessionToken).id\n  }, options.proximity && {\n    proximity: typeof options.proximity === \"string\" ? options.proximity : LngLat.convert(options.proximity).toArray().join(\",\")\n  }, options.bbox && {\n    bbox: typeof options.bbox === \"string\" ? options.bbox : LngLatBounds.convert(options.bbox).toFlatArray().join(\",\")\n  });\n};\nAddressAutofillCore.defaults = {\n  language: \"en\",\n  proximity: \"ip\",\n  streets: true\n};\n\n// src/searchbox/constants.ts\nvar SEARCH_URL2 = `https://api.mapbox.com/search/searchbox/v1`;\nvar ENDPOINT_SUGGEST2 = \"suggest\";\nvar ENDPOINT_RETRIEVE2 = \"retrieve\";\nvar ENDPOINT_CATEGORY = \"category\";\nvar ENDPOINT_REVERSE = \"reverse\";\nvar SUGGEST_URL2 = `${SEARCH_URL2}/${ENDPOINT_SUGGEST2}`;\nvar RETRIEVE_URL2 = `${SEARCH_URL2}/${ENDPOINT_RETRIEVE2}`;\nvar CATEGORY_URL = `${SEARCH_URL2}/${ENDPOINT_CATEGORY}`;\nvar REVERSE_URL = `${SEARCH_URL2}/${ENDPOINT_REVERSE}`;\n\n// src/searchbox/SearchBoxCore.ts\nvar _getQueryParams2, getQueryParams_fn2;\nvar _SearchBoxCore = class {\n  constructor(options = {}) {\n    __privateAdd(this, _getQueryParams2);\n    const _a = options, { accessToken } = _a, defaults = __objRest(_a, [\"accessToken\"]);\n    this.accessToken = accessToken;\n    this.defaults = __spreadValues(__spreadValues({}, _SearchBoxCore.defaults), defaults);\n  }\n  suggest(searchText, optionsArg) {\n    return __async(this, null, function* () {\n      if (!searchText) {\n        throw new Error(\"searchText is required\");\n      }\n      const { sessionToken, signal } = optionsArg;\n      const options = __spreadProps(__spreadValues(__spreadValues({}, this.defaults), optionsArg), {\n        q: searchText,\n        sessionToken\n      });\n      if (options.eta_type && (!options.origin || !options.navigation_profile)) {\n        throw new Error(\"to provide eta estimate: eta, navigation_profile, and origin are required\");\n      }\n      if (options.origin && !options.navigation_profile) {\n        throw new Error(\"to provide distance estimate: both navigation_profile and origin are required\");\n      }\n      const url = new URL(SUGGEST_URL2);\n      url.search = __privateMethod(this, _getQueryParams2, getQueryParams_fn2).call(this, options);\n      const { fetch } = getFetch();\n      const res = yield fetch(url.toString(), {\n        signal\n      });\n      yield handleNonOkRes(res);\n      const json = yield res.json();\n      json.url = url.toString();\n      return json;\n    });\n  }\n  retrieve(suggestion, optionsArg) {\n    return __async(this, null, function* () {\n      if (!suggestion) {\n        throw new Error(\"suggestion is required\");\n      }\n      const { sessionToken: sessionTokenLike, signal } = optionsArg;\n      const sessionToken = SessionToken.convert(sessionTokenLike);\n      const url = new URL(`${RETRIEVE_URL2}/${encodeURIComponent(suggestion.mapbox_id)}`);\n      url.search = queryParams({\n        access_token: this.accessToken,\n        session_token: sessionToken.id\n      });\n      const { fetch } = getFetch();\n      const res = yield fetch(url.toString(), {\n        signal\n      });\n      yield handleNonOkRes(res);\n      const json = yield res.json();\n      json.url = url.toString();\n      return json;\n    });\n  }\n  category(_0) {\n    return __async(this, arguments, function* (category, optionsArg = {}) {\n      if (!category) {\n        throw new Error(\"category is required\");\n      }\n      const options = __spreadValues(__spreadValues({}, this.defaults), optionsArg);\n      const url = new URL(`${CATEGORY_URL}/${encodeURIComponent(category)}`);\n      url.search = __privateMethod(this, _getQueryParams2, getQueryParams_fn2).call(this, options);\n      const { fetch } = getFetch();\n      const res = yield fetch(url.toString(), {\n        signal: options.signal\n      });\n      yield handleNonOkRes(res);\n      const json = yield res.json();\n      json.url = url.toString();\n      return json;\n    });\n  }\n  reverse(_0) {\n    return __async(this, arguments, function* (lngLat, optionsArg = {}) {\n      if (!lngLat) {\n        throw new Error(\"lngLat is required\");\n      }\n      const [lng, lat] = typeof lngLat === \"string\" ? lngLat.split(\",\").map((x) => parseFloat(x)) : LngLat.convert(lngLat).toArray();\n      if (isNaN(lng) || isNaN(lat)) {\n        throw new Error(\"lngLat is required\");\n      }\n      const options = __spreadValues(__spreadValues({}, this.defaults), optionsArg);\n      const url = new URL(REVERSE_URL);\n      url.search = queryParams({\n        access_token: this.accessToken,\n        language: options.language,\n        limit: options.limit,\n        longitude: lng,\n        latitude: lat\n      }, options.types && {\n        types: typeof options.types === \"string\" ? options.types : [...options.types].join(\",\")\n      });\n      const { fetch } = getFetch();\n      const res = yield fetch(url.toString(), {\n        signal: options.signal\n      });\n      yield handleNonOkRes(res);\n      const json = yield res.json();\n      json.url = url.toString();\n      return json;\n    });\n  }\n};\nvar SearchBoxCore = _SearchBoxCore;\n_getQueryParams2 = new WeakSet();\ngetQueryParams_fn2 = function(options) {\n  return queryParams({\n    q: options.q,\n    access_token: this.accessToken,\n    language: options.language,\n    limit: options.limit,\n    navigation_profile: options.navigation_profile,\n    route: options.route,\n    route_geometry: options.route_geometry,\n    sar_type: options.sar_type,\n    time_deviation: options.time_deviation,\n    eta_type: options.eta_type,\n    country: options.country,\n    poi_category: options.poi_category,\n    radius: options.radius,\n    user_id: options.user_id,\n    rich_metadata_provider: options.rich_metadata_provider,\n    poi_category_exclusions: options.poi_category_exclusions\n  }, options.sessionToken && {\n    session_token: SessionToken.convert(options.sessionToken).id\n  }, options.proximity && {\n    proximity: typeof options.proximity === \"string\" ? options.proximity : LngLat.convert(options.proximity).toArray().join(\",\")\n  }, options.origin && {\n    origin: typeof options.origin === \"string\" ? options.origin : LngLat.convert(options.origin).toArray().join(\",\")\n  }, options.bbox && {\n    bbox: typeof options.bbox === \"string\" ? options.bbox : LngLatBounds.convert(options.bbox).toFlatArray().join(\",\")\n  }, options.types && {\n    types: typeof options.types === \"string\" ? options.types : [...options.types].join(\",\")\n  });\n};\nSearchBoxCore.defaults = {\n  language: \"en\"\n};\n\n// src/validate/constants.ts\nvar SEARCH_URL3 = `https://api.mapbox.com/autofill/v1`;\nvar ENDPOINT_VALIDATE = \"retrieve\";\nvar VALIDATE_URL = `${SEARCH_URL3}/${ENDPOINT_VALIDATE}`;\n\n// src/validate/ValidationCore.ts\nvar _getQueryParams3, getQueryParams_fn3;\nvar _ValidationCore = class {\n  constructor(options = {}) {\n    __privateAdd(this, _getQueryParams3);\n    const _a = options, { accessToken } = _a, defaults = __objRest(_a, [\"accessToken\"]);\n    this.accessToken = accessToken;\n    this.defaults = __spreadValues(__spreadValues({}, _ValidationCore.defaults), defaults);\n  }\n  validate(searchText, optionsArg) {\n    return __async(this, null, function* () {\n      if (!searchText) {\n        throw new Error(\"searchText is required\");\n      }\n      const { sessionToken, signal } = optionsArg;\n      const options = __spreadProps(__spreadValues(__spreadValues({}, this.defaults), optionsArg), {\n        sessionToken\n      });\n      const url = new URL(`${VALIDATE_URL}/${encodeURIComponent(searchText)}`);\n      url.search = __privateMethod(this, _getQueryParams3, getQueryParams_fn3).call(this, options);\n      const { fetch } = getFetch();\n      const res = yield fetch(url.toString(), {\n        signal\n      });\n      yield handleNonOkRes(res);\n      const json = yield res.json();\n      json.url = url.toString();\n      if (json.features.length > 0) {\n        json.features = [json.features[0]];\n      }\n      return json;\n    });\n  }\n};\nvar ValidationCore = _ValidationCore;\n_getQueryParams3 = new WeakSet();\ngetQueryParams_fn3 = function(options) {\n  return queryParams({\n    access_token: this.accessToken,\n    language: options.language,\n    country: options.country\n  }, options.sessionToken && {\n    session_token: SessionToken.convert(options.sessionToken).id\n  }, options.proximity && {\n    proximity: typeof options.proximity === \"string\" ? options.proximity : LngLat.convert(options.proximity).toArray().join(\",\")\n  }, options.bbox && {\n    bbox: typeof options.bbox === \"string\" ? options.bbox : LngLatBounds.convert(options.bbox).toFlatArray().join(\",\")\n  });\n};\nValidationCore.defaults = {\n  language: \"en\",\n  proximity: \"ip\"\n};\n\n// src/geocode/constants.ts\nvar BASE_URL = `https://api.mapbox.com/search/geocode/v6`;\nvar FORWARD_URL = `${BASE_URL}/forward`;\nvar REVERSE_URL2 = `${BASE_URL}/reverse`;\nvar BATCH_URL = `${BASE_URL}/batch`;\n\n// src/geocode/GeocodingCore.ts\nvar REVERSE_GEOCODE_COORD_REGEX = /^[ ]*(-?\\d{1,3}(\\.\\d{0,256})?)[, ]+(-?\\d{1,3}(\\.\\d{0,256})?)[ ]*$/;\nvar SPACES_OR_COMMA_REGEX = /[\\s,]+/;\nvar _getQueryParams4, getQueryParams_fn4;\nvar GeocodingCore = class {\n  constructor(options = {}) {\n    __privateAdd(this, _getQueryParams4);\n    const _a = options, { accessToken } = _a, defaults = __objRest(_a, [\"accessToken\"]);\n    this.accessToken = accessToken;\n    this.defaults = __spreadValues({}, defaults);\n  }\n  forward(searchText, optionsArg) {\n    return __async(this, null, function* () {\n      if (!searchText) {\n        throw new Error(\"searchText is required\");\n      }\n      let signal;\n      if (optionsArg) {\n        ({ signal } = optionsArg);\n      }\n      const options = __spreadProps(__spreadValues(__spreadValues({}, this.defaults), optionsArg), {\n        q: searchText\n      });\n      const url = new URL(`${FORWARD_URL}`);\n      url.search = __privateMethod(this, _getQueryParams4, getQueryParams_fn4).call(this, options);\n      const { fetch } = getFetch();\n      const fetchInit = signal ? { signal } : {};\n      const res = yield fetch(url.toString(), fetchInit);\n      yield handleNonOkRes(res);\n      const json = yield res.json();\n      json.url = url.toString();\n      return json;\n    });\n  }\n  reverse(lngLat, optionsArg) {\n    return __async(this, null, function* () {\n      if (!lngLat) {\n        throw new Error(\"lngLat is required\");\n      }\n      let signal;\n      if (optionsArg) {\n        ({ signal } = optionsArg);\n      }\n      let lngLatObj;\n      if (typeof lngLat === \"string\") {\n        const [lng, lat] = lngLat.split(\",\");\n        lngLatObj = new LngLat(Number(lng), Number(lat));\n      } else {\n        lngLatObj = LngLat.convert(lngLat);\n      }\n      const options = __spreadProps(__spreadValues(__spreadValues({}, this.defaults), optionsArg), {\n        longitude: lngLatObj.lng,\n        latitude: lngLatObj.lat\n      });\n      const url = new URL(`${REVERSE_URL2}`);\n      url.search = __privateMethod(this, _getQueryParams4, getQueryParams_fn4).call(this, options, true);\n      const { fetch } = getFetch();\n      const fetchInit = signal ? { signal } : {};\n      const res = yield fetch(url.toString(), fetchInit);\n      yield handleNonOkRes(res);\n      const json = yield res.json();\n      json.url = url.toString();\n      return json;\n    });\n  }\n  suggest(searchText, optionsArg) {\n    return __async(this, null, function* () {\n      const isReverseQuery = REVERSE_GEOCODE_COORD_REGEX.test(searchText);\n      if (isReverseQuery) {\n        const coordinates = searchText.trim().split(SPACES_OR_COMMA_REGEX).map((part) => part.trim()).join(\",\");\n        return this.reverse(coordinates, optionsArg);\n      } else {\n        return this.forward(searchText, optionsArg);\n      }\n    });\n  }\n  retrieve(suggestion) {\n    return __async(this, null, function* () {\n      return suggestion;\n    });\n  }\n};\n_getQueryParams4 = new WeakSet();\ngetQueryParams_fn4 = function(options, isReverse = false) {\n  if (isReverse) {\n    [\"proximity\", \"autocomplete\", \"bbox\"].forEach((key) => {\n      if (key in options) {\n        delete options[key];\n      }\n    });\n  }\n  return queryParams({\n    q: options.q,\n    longitude: options.longitude,\n    latitude: options.latitude,\n    access_token: this.accessToken,\n    permanent: options.permanent,\n    language: options.language,\n    country: options.country,\n    limit: options.limit,\n    autocomplete: options.autocomplete,\n    worldview: options.worldview\n  }, options.proximity && {\n    proximity: typeof options.proximity === \"string\" ? options.proximity : LngLat.convert(options.proximity).toArray().join(\",\")\n  }, options.bbox && {\n    bbox: typeof options.bbox === \"string\" ? options.bbox : LngLatBounds.convert(options.bbox).toFlatArray().join(\",\")\n  }, options.types && {\n    types: typeof options.types === \"string\" ? options.types : [...options.types].join(\",\")\n  });\n};\n\n// src/types.ts\nvar MatchCodeType = /* @__PURE__ */ ((MatchCodeType2) => {\n  MatchCodeType2[\"matched\"] = \"matched\";\n  MatchCodeType2[\"unmatched\"] = \"unmatched\";\n  MatchCodeType2[\"plausible\"] = \"plausible\";\n  MatchCodeType2[\"not_applicable\"] = \"not_applicable\";\n  MatchCodeType2[\"inferred\"] = \"inferred\";\n  return MatchCodeType2;\n})(MatchCodeType || {});\nvar MatchCodeConfidence = /* @__PURE__ */ ((MatchCodeConfidence2) => {\n  MatchCodeConfidence2[\"exact\"] = \"exact\";\n  MatchCodeConfidence2[\"high\"] = \"high\";\n  MatchCodeConfidence2[\"medium\"] = \"medium\";\n  MatchCodeConfidence2[\"low\"] = \"low\";\n  return MatchCodeConfidence2;\n})(MatchCodeConfidence || {});\n\n// src/utils/Evented.ts\nvar _listeners;\nvar Evented = class {\n  constructor() {\n    __privateAdd(this, _listeners, {});\n  }\n  addEventListener(type, listener) {\n    const listenersArr = __privateGet(this, _listeners);\n    if (!listenersArr[type]) {\n      listenersArr[type] = [];\n    }\n    listenersArr[type].push(listener);\n  }\n  removeEventListener(type, listener) {\n    const listenersArr = __privateGet(this, _listeners);\n    if (!listenersArr[type]) {\n      return;\n    }\n    const listeners = listenersArr[type];\n    const index = listeners.indexOf(listener);\n    if (index !== -1) {\n      listeners.splice(index, 1);\n    }\n  }\n  fire(type, arg0) {\n    const listenersArr = __privateGet(this, _listeners);\n    if (!listenersArr[type]) {\n      return;\n    }\n    const listeners = listenersArr[type];\n    for (const listener of listeners) {\n      listener(arg0);\n    }\n  }\n};\n_listeners = new WeakMap();\n\n// src/utils/debounce.ts\nfunction debounce(func, wait, signalFn) {\n  let timeout = null;\n  return (...args) => {\n    if (timeout !== null) {\n      clearTimeout(timeout);\n    }\n    const signal = signalFn && signalFn();\n    timeout = setTimeout(() => {\n      timeout = null;\n      if (signal == null ? void 0 : signal.aborted) {\n        return;\n      }\n      func(...args);\n    }, wait);\n  };\n}\n\n// src/SearchSession.ts\nfunction createAbortController() {\n  const { AbortController } = getFetch();\n  return new AbortController();\n}\nvar _suggestions, _abort, _suggestDebounce;\nvar SearchSession = class extends Evented {\n  constructor(search, wait = 0) {\n    super();\n    this.sessionToken = new SessionToken();\n    __privateAdd(this, _suggestions, void 0);\n    __privateAdd(this, _abort, createAbortController());\n    __privateAdd(this, _suggestDebounce, void 0);\n    __privateSet(this, _suggestDebounce, debounce((_0, ..._1) => __async(this, [_0, ..._1], function* (searchText, options = {}) {\n      __privateGet(this, _abort).abort();\n      __privateSet(this, _abort, createAbortController());\n      if (!searchText) {\n        __privateSet(this, _suggestions, null);\n        this.fire(\"suggest\", __privateGet(this, _suggestions));\n        return;\n      }\n      try {\n        const res = yield this.search.suggest(searchText, __spreadProps(__spreadValues({\n          sessionToken: this.sessionToken\n        }, options), {\n          signal: __privateGet(this, _abort).signal\n        }));\n        __privateSet(this, _suggestions, res);\n        this.fire(\"suggest\", res);\n      } catch (err) {\n        if (err.name === \"AbortError\") {\n          return;\n        }\n        this.fire(\"suggesterror\", err);\n      }\n    }), wait, () => __privateGet(this, _abort).signal));\n    Object.defineProperties(this, {\n      search: {\n        value: search,\n        writable: false\n      },\n      debounce: {\n        value: wait,\n        writable: false\n      }\n    });\n  }\n  get suggestions() {\n    return __privateGet(this, _suggestions);\n  }\n  suggest(searchText, options) {\n    __privateGet(this, _suggestDebounce).call(this, searchText, options);\n    return new Promise((resolve, reject) => {\n      let suggestFn;\n      let suggestErrorFn;\n      suggestFn = (res) => {\n        this.removeEventListener(\"suggest\", suggestFn);\n        this.removeEventListener(\"suggesterror\", suggestErrorFn);\n        resolve(res);\n      };\n      suggestErrorFn = (err) => {\n        this.removeEventListener(\"suggest\", suggestFn);\n        this.removeEventListener(\"suggesterror\", suggestErrorFn);\n        reject(err);\n      };\n      this.addEventListener(\"suggest\", suggestFn);\n      this.addEventListener(\"suggesterror\", suggestErrorFn);\n    });\n  }\n  clear() {\n    this.suggest(\"\");\n  }\n  retrieve(suggestion, options) {\n    return __async(this, null, function* () {\n      const res = yield this.search.retrieve(suggestion, __spreadValues({\n        sessionToken: this.sessionToken\n      }, options));\n      this.fire(\"retrieve\", res);\n      return res;\n    });\n  }\n  canRetrieve(suggestion) {\n    if (!this.search.canRetrieve) {\n      return true;\n    }\n    return this.search.canRetrieve(suggestion);\n  }\n  canSuggest(suggestion) {\n    if (!this.search.canSuggest) {\n      return true;\n    }\n    return this.search.canSuggest(suggestion);\n  }\n  abort() {\n    __privateGet(this, _abort).abort();\n    __privateSet(this, _abort, createAbortController());\n  }\n};\n_suggestions = new WeakMap();\n_abort = new WeakMap();\n_suggestDebounce = new WeakMap();\n\n// src/featureToSuggestion.ts\nfunction featureToSuggestion(feature) {\n  const { properties } = feature;\n  return __spreadValues({}, properties);\n}\n\n//# sourceMappingURL=index-esm.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQG1hcGJveC9zZWFyY2gtanMtY29yZS9kaXN0L2luZGV4LWVzbS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4RUFBOEUsNkRBQTZEO0FBQzNJO0FBQ0EsK0JBQStCO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCLFdBQVcsR0FBRyxpQkFBaUI7QUFDcEQsc0JBQXNCLFdBQVcsR0FBRyxrQkFBa0I7O0FBRXREO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaURBQWlELElBQUksSUFBSSxJQUFJO0FBQzdEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIsU0FBUyxJQUFJLFNBQVM7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJFQUEyRSx1QkFBdUIsYUFBYSx1QkFBdUI7QUFDdEk7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixvQkFBb0IsSUFBSSxvQkFBb0I7QUFDdkU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsV0FBVyxHQUFHLGdCQUFnQixLQUFLLGFBQWE7QUFDOUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsd0JBQXdCO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQixJQUFJLEdBQUcsa0NBQWtDO0FBQzlEO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQjtBQUMxQjtBQUNBLDBCQUEwQixjQUFjO0FBQ3hDO0FBQ0Esb0RBQW9EO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsdUJBQXVCO0FBQ3JDLG9FQUFvRTtBQUNwRTtBQUNBLE9BQU87QUFDUCw2QkFBNkIsWUFBWSxHQUFHLCtCQUErQjtBQUMzRTtBQUNBLGNBQWMsUUFBUTtBQUN0QjtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSw0Q0FBNEM7QUFDNUM7QUFDQSxnREFBZ0Q7QUFDaEQ7QUFDQSxXQUFXO0FBQ1gsU0FBUztBQUNUO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLHlDQUF5QztBQUN2RDtBQUNBLDZCQUE2QixhQUFhLEdBQUcscUJBQXFCO0FBQ2xFO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxjQUFjLFFBQVE7QUFDdEIsZ0RBQWdELFFBQVE7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxHQUFHO0FBQ0g7QUFDQSxHQUFHO0FBQ0g7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQixZQUFZLEdBQUcsa0JBQWtCO0FBQ3ZELHVCQUF1QixZQUFZLEdBQUcsbUJBQW1CO0FBQ3pELHNCQUFzQixZQUFZLEdBQUcsa0JBQWtCO0FBQ3ZELHFCQUFxQixZQUFZLEdBQUcsaUJBQWlCOztBQUVyRDtBQUNBO0FBQ0E7QUFDQSwwQkFBMEI7QUFDMUI7QUFDQSwwQkFBMEIsY0FBYztBQUN4QztBQUNBLG9EQUFvRDtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLHVCQUF1QjtBQUNyQyxvRUFBb0U7QUFDcEU7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyxRQUFRO0FBQ3RCO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyx5Q0FBeUM7QUFDdkQ7QUFDQSw2QkFBNkIsY0FBYyxHQUFHLHlDQUF5QztBQUN2RjtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsY0FBYyxRQUFRO0FBQ3RCO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLHdFQUF3RTtBQUN4RTtBQUNBO0FBQ0E7QUFDQSxzREFBc0Q7QUFDdEQsNkJBQTZCLGFBQWEsR0FBRyw2QkFBNkI7QUFDMUU7QUFDQSxjQUFjLFFBQVE7QUFDdEI7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0Esc0VBQXNFO0FBQ3RFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0RBQXNEO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsT0FBTztBQUNQLGNBQWMsUUFBUTtBQUN0QjtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsR0FBRztBQUNIO0FBQ0EsR0FBRztBQUNIO0FBQ0EsR0FBRztBQUNIO0FBQ0EsR0FBRztBQUNIO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQixZQUFZLEdBQUcsa0JBQWtCOztBQUV2RDtBQUNBO0FBQ0E7QUFDQSwwQkFBMEI7QUFDMUI7QUFDQSwwQkFBMEIsY0FBYztBQUN4QztBQUNBLG9EQUFvRDtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLHVCQUF1QjtBQUNyQyxvRUFBb0U7QUFDcEU7QUFDQSxPQUFPO0FBQ1AsNkJBQTZCLGFBQWEsR0FBRywrQkFBK0I7QUFDNUU7QUFDQSxjQUFjLFFBQVE7QUFDdEI7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxHQUFHO0FBQ0g7QUFDQSxHQUFHO0FBQ0g7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EscUJBQXFCLFNBQVM7QUFDOUIsc0JBQXNCLFNBQVM7QUFDL0IsbUJBQW1CLFNBQVM7O0FBRTVCO0FBQ0EsOENBQThDLElBQUksTUFBTSxNQUFNLGNBQWMsSUFBSSxNQUFNLE1BQU07QUFDNUY7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCO0FBQzFCO0FBQ0EsMEJBQTBCLGNBQWM7QUFDeEM7QUFDQSxxQ0FBcUM7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsU0FBUztBQUNwQjtBQUNBLG9FQUFvRTtBQUNwRTtBQUNBLE9BQU87QUFDUCw2QkFBNkIsWUFBWTtBQUN6QztBQUNBLGNBQWMsUUFBUTtBQUN0QixtQ0FBbUMsU0FBUztBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLFNBQVM7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0Esb0VBQW9FO0FBQ3BFO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsNkJBQTZCLGFBQWE7QUFDMUM7QUFDQSxjQUFjLFFBQVE7QUFDdEIsbUNBQW1DLFNBQVM7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxHQUFHO0FBQ0g7QUFDQSxHQUFHO0FBQ0g7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMscUJBQXFCO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsMkJBQTJCOztBQUU1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQztBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFVBQVUsa0JBQWtCO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0hBQStIO0FBQy9IO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsVUFBVSxhQUFhO0FBQ3ZCLDBCQUEwQjtBQUMxQjtBQW9CRTtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcm91dGUtcGxhbm5lci8uL25vZGVfbW9kdWxlcy9AbWFwYm94L3NlYXJjaC1qcy1jb3JlL2Rpc3QvaW5kZXgtZXNtLmpzP2JiYTUiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIF9fZGVmUHJvcCA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eTtcbnZhciBfX2RlZlByb3BzID0gT2JqZWN0LmRlZmluZVByb3BlcnRpZXM7XG52YXIgX19nZXRPd25Qcm9wRGVzY3MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycztcbnZhciBfX2dldE93blByb3BTeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scztcbnZhciBfX2hhc093blByb3AgPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5O1xudmFyIF9fcHJvcElzRW51bSA9IE9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGU7XG52YXIgX19kZWZOb3JtYWxQcm9wID0gKG9iaiwga2V5LCB2YWx1ZSkgPT4ga2V5IGluIG9iaiA/IF9fZGVmUHJvcChvYmosIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUsIHdyaXRhYmxlOiB0cnVlLCB2YWx1ZSB9KSA6IG9ialtrZXldID0gdmFsdWU7XG52YXIgX19zcHJlYWRWYWx1ZXMgPSAoYSwgYikgPT4ge1xuICBmb3IgKHZhciBwcm9wIGluIGIgfHwgKGIgPSB7fSkpXG4gICAgaWYgKF9faGFzT3duUHJvcC5jYWxsKGIsIHByb3ApKVxuICAgICAgX19kZWZOb3JtYWxQcm9wKGEsIHByb3AsIGJbcHJvcF0pO1xuICBpZiAoX19nZXRPd25Qcm9wU3ltYm9scylcbiAgICBmb3IgKHZhciBwcm9wIG9mIF9fZ2V0T3duUHJvcFN5bWJvbHMoYikpIHtcbiAgICAgIGlmIChfX3Byb3BJc0VudW0uY2FsbChiLCBwcm9wKSlcbiAgICAgICAgX19kZWZOb3JtYWxQcm9wKGEsIHByb3AsIGJbcHJvcF0pO1xuICAgIH1cbiAgcmV0dXJuIGE7XG59O1xudmFyIF9fc3ByZWFkUHJvcHMgPSAoYSwgYikgPT4gX19kZWZQcm9wcyhhLCBfX2dldE93blByb3BEZXNjcyhiKSk7XG52YXIgX19vYmpSZXN0ID0gKHNvdXJjZSwgZXhjbHVkZSkgPT4ge1xuICB2YXIgdGFyZ2V0ID0ge307XG4gIGZvciAodmFyIHByb3AgaW4gc291cmNlKVxuICAgIGlmIChfX2hhc093blByb3AuY2FsbChzb3VyY2UsIHByb3ApICYmIGV4Y2x1ZGUuaW5kZXhPZihwcm9wKSA8IDApXG4gICAgICB0YXJnZXRbcHJvcF0gPSBzb3VyY2VbcHJvcF07XG4gIGlmIChzb3VyY2UgIT0gbnVsbCAmJiBfX2dldE93blByb3BTeW1ib2xzKVxuICAgIGZvciAodmFyIHByb3Agb2YgX19nZXRPd25Qcm9wU3ltYm9scyhzb3VyY2UpKSB7XG4gICAgICBpZiAoZXhjbHVkZS5pbmRleE9mKHByb3ApIDwgMCAmJiBfX3Byb3BJc0VudW0uY2FsbChzb3VyY2UsIHByb3ApKVxuICAgICAgICB0YXJnZXRbcHJvcF0gPSBzb3VyY2VbcHJvcF07XG4gICAgfVxuICByZXR1cm4gdGFyZ2V0O1xufTtcbnZhciBfX2FjY2Vzc0NoZWNrID0gKG9iaiwgbWVtYmVyLCBtc2cpID0+IHtcbiAgaWYgKCFtZW1iZXIuaGFzKG9iaikpXG4gICAgdGhyb3cgVHlwZUVycm9yKFwiQ2Fubm90IFwiICsgbXNnKTtcbn07XG52YXIgX19wcml2YXRlR2V0ID0gKG9iaiwgbWVtYmVyLCBnZXR0ZXIpID0+IHtcbiAgX19hY2Nlc3NDaGVjayhvYmosIG1lbWJlciwgXCJyZWFkIGZyb20gcHJpdmF0ZSBmaWVsZFwiKTtcbiAgcmV0dXJuIGdldHRlciA/IGdldHRlci5jYWxsKG9iaikgOiBtZW1iZXIuZ2V0KG9iaik7XG59O1xudmFyIF9fcHJpdmF0ZUFkZCA9IChvYmosIG1lbWJlciwgdmFsdWUpID0+IHtcbiAgaWYgKG1lbWJlci5oYXMob2JqKSlcbiAgICB0aHJvdyBUeXBlRXJyb3IoXCJDYW5ub3QgYWRkIHRoZSBzYW1lIHByaXZhdGUgbWVtYmVyIG1vcmUgdGhhbiBvbmNlXCIpO1xuICBtZW1iZXIgaW5zdGFuY2VvZiBXZWFrU2V0ID8gbWVtYmVyLmFkZChvYmopIDogbWVtYmVyLnNldChvYmosIHZhbHVlKTtcbn07XG52YXIgX19wcml2YXRlU2V0ID0gKG9iaiwgbWVtYmVyLCB2YWx1ZSwgc2V0dGVyKSA9PiB7XG4gIF9fYWNjZXNzQ2hlY2sob2JqLCBtZW1iZXIsIFwid3JpdGUgdG8gcHJpdmF0ZSBmaWVsZFwiKTtcbiAgc2V0dGVyID8gc2V0dGVyLmNhbGwob2JqLCB2YWx1ZSkgOiBtZW1iZXIuc2V0KG9iaiwgdmFsdWUpO1xuICByZXR1cm4gdmFsdWU7XG59O1xudmFyIF9fcHJpdmF0ZU1ldGhvZCA9IChvYmosIG1lbWJlciwgbWV0aG9kKSA9PiB7XG4gIF9fYWNjZXNzQ2hlY2sob2JqLCBtZW1iZXIsIFwiYWNjZXNzIHByaXZhdGUgbWV0aG9kXCIpO1xuICByZXR1cm4gbWV0aG9kO1xufTtcbnZhciBfX2FzeW5jID0gKF9fdGhpcywgX19hcmd1bWVudHMsIGdlbmVyYXRvcikgPT4ge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgIHZhciBmdWxmaWxsZWQgPSAodmFsdWUpID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgfVxuICAgIH07XG4gICAgdmFyIHJlamVjdGVkID0gKHZhbHVlKSA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICBzdGVwKGdlbmVyYXRvci50aHJvdyh2YWx1ZSkpO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICByZWplY3QoZSk7XG4gICAgICB9XG4gICAgfTtcbiAgICB2YXIgc3RlcCA9ICh4KSA9PiB4LmRvbmUgPyByZXNvbHZlKHgudmFsdWUpIDogUHJvbWlzZS5yZXNvbHZlKHgudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7XG4gICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KF9fdGhpcywgX19hcmd1bWVudHMpKS5uZXh0KCkpO1xuICB9KTtcbn07XG5cbi8vIHNyYy9hdXRvZmlsbC9jb25zdGFudHMudHNcbnZhciBTRUFSQ0hfVVJMID0gYGh0dHBzOi8vYXBpLm1hcGJveC5jb20vYXV0b2ZpbGwvdjFgO1xudmFyIEVORFBPSU5UX1NVR0dFU1QgPSBcInN1Z2dlc3RcIjtcbnZhciBFTkRQT0lOVF9SRVRSSUVWRSA9IFwicmV0cmlldmVcIjtcbnZhciBTVUdHRVNUX1VSTCA9IGAke1NFQVJDSF9VUkx9LyR7RU5EUE9JTlRfU1VHR0VTVH1gO1xudmFyIFJFVFJJRVZFX1VSTCA9IGAke1NFQVJDSF9VUkx9LyR7RU5EUE9JTlRfUkVUUklFVkV9YDtcblxuLy8gc3JjL0xuZ0xhdC50c1xudmFyIExuZ0xhdCA9IGNsYXNzIHtcbiAgY29uc3RydWN0b3IobG5nLCBsYXQpIHtcbiAgICBpZiAoaXNOYU4obG5nKSB8fCBpc05hTihsYXQpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgTG5nTGF0IG9iamVjdDogKCR7bG5nfSwgJHtsYXR9KWApO1xuICAgIH1cbiAgICB0aGlzLmxuZyA9ICtsbmc7XG4gICAgdGhpcy5sYXQgPSArbGF0O1xuICAgIGlmICh0aGlzLmxhdCA+IDkwIHx8IHRoaXMubGF0IDwgLTkwKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIExuZ0xhdCBsYXRpdHVkZSB2YWx1ZTogbXVzdCBiZSBiZXR3ZWVuIC05MCBhbmQgOTBcIik7XG4gICAgfVxuICAgIGlmICh0aGlzLmxuZyA+IDE4MCB8fCB0aGlzLmxuZyA8IC0xODApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgTG5nTGF0IGxvbmdpdHVkZSB2YWx1ZTogbXVzdCBiZSBiZXR3ZWVuIC0xODAgYW5kIDE4MFwiKTtcbiAgICB9XG4gIH1cbiAgdG9BcnJheSgpIHtcbiAgICByZXR1cm4gW3RoaXMubG5nLCB0aGlzLmxhdF07XG4gIH1cbiAgdG9TdHJpbmcoKSB7XG4gICAgcmV0dXJuIGBMbmdMYXQoJHt0aGlzLmxuZ30sICR7dGhpcy5sYXR9KWA7XG4gIH1cbiAgc3RhdGljIGNvbnZlcnQoaW5wdXQpIHtcbiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBMbmdMYXQpIHtcbiAgICAgIHJldHVybiBuZXcgTG5nTGF0KGlucHV0LmxuZywgaW5wdXQubGF0KTtcbiAgICB9XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoaW5wdXQpICYmIGlucHV0Lmxlbmd0aCA9PT0gMikge1xuICAgICAgcmV0dXJuIG5ldyBMbmdMYXQoTnVtYmVyKGlucHV0WzBdKSwgTnVtYmVyKGlucHV0WzFdKSk7XG4gICAgfVxuICAgIGlmICghQXJyYXkuaXNBcnJheShpbnB1dCkgJiYgdHlwZW9mIGlucHV0ID09IFwib2JqZWN0XCIgJiYgaW5wdXQgIT09IG51bGwgJiYgKFwibG5nXCIgaW4gaW5wdXQgfHwgXCJsb25cIiBpbiBpbnB1dCkgJiYgXCJsYXRcIiBpbiBpbnB1dCkge1xuICAgICAgcmV0dXJuIG5ldyBMbmdMYXQoTnVtYmVyKFwibG5nXCIgaW4gaW5wdXQgPyBpbnB1dC5sbmcgOiBpbnB1dC5sb24pLCBOdW1iZXIoaW5wdXQubGF0KSk7XG4gICAgfVxuICAgIHRocm93IG5ldyBFcnJvcihcImBMbmdMYXRMaWtlYCBhcmd1bWVudCBtdXN0IGJlIHNwZWNpZmllZCBhcyBhbiBvYmplY3Qge2xuZzogPGxuZz4sIGxhdDogPGxhdD59LCBhbiBvYmplY3Qge2xvbjogPGxuZz4sIGxhdDogPGxhdD59LCBvciBhbiBhcnJheSBvZiBbPGxuZz4sIDxsYXQ+XVwiKTtcbiAgfVxufTtcblxuLy8gc3JjL0xuZ0xhdEJvdW5kcy50c1xudmFyIExuZ0xhdEJvdW5kcyA9IGNsYXNzIHtcbiAgY29uc3RydWN0b3Ioc3csIG5lKSB7XG4gICAgdGhpcy5fc3cgPSBMbmdMYXQuY29udmVydChzdyk7XG4gICAgdGhpcy5fbmUgPSBMbmdMYXQuY29udmVydChuZSk7XG4gIH1cbiAgZ2V0U291dGhXZXN0KCkge1xuICAgIHJldHVybiB0aGlzLl9zdztcbiAgfVxuICBnZXROb3J0aEVhc3QoKSB7XG4gICAgcmV0dXJuIHRoaXMuX25lO1xuICB9XG4gIGdldE5vcnRoV2VzdCgpIHtcbiAgICByZXR1cm4gbmV3IExuZ0xhdCh0aGlzLmdldFdlc3QoKSwgdGhpcy5nZXROb3J0aCgpKTtcbiAgfVxuICBnZXRTb3V0aEVhc3QoKSB7XG4gICAgcmV0dXJuIG5ldyBMbmdMYXQodGhpcy5nZXRFYXN0KCksIHRoaXMuZ2V0U291dGgoKSk7XG4gIH1cbiAgZ2V0V2VzdCgpIHtcbiAgICByZXR1cm4gdGhpcy5fc3cubG5nO1xuICB9XG4gIGdldFNvdXRoKCkge1xuICAgIHJldHVybiB0aGlzLl9zdy5sYXQ7XG4gIH1cbiAgZ2V0RWFzdCgpIHtcbiAgICByZXR1cm4gdGhpcy5fbmUubG5nO1xuICB9XG4gIGdldE5vcnRoKCkge1xuICAgIHJldHVybiB0aGlzLl9uZS5sYXQ7XG4gIH1cbiAgdG9BcnJheSgpIHtcbiAgICByZXR1cm4gW3RoaXMuX3N3LnRvQXJyYXkoKSwgdGhpcy5fbmUudG9BcnJheSgpXTtcbiAgfVxuICB0b0ZsYXRBcnJheSgpIHtcbiAgICByZXR1cm4gW3RoaXMuX3N3LmxuZywgdGhpcy5fc3cubGF0LCB0aGlzLl9uZS5sbmcsIHRoaXMuX25lLmxhdF07XG4gIH1cbiAgdG9TdHJpbmcoKSB7XG4gICAgcmV0dXJuIGBMbmdMYXRCb3VuZHMoJHt0aGlzLl9zdy50b1N0cmluZygpfSwgJHt0aGlzLl9uZS50b1N0cmluZygpfSlgO1xuICB9XG4gIHN0YXRpYyBjb252ZXJ0KGlucHV0KSB7XG4gICAgaWYgKCFpbnB1dCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBMbmdMYXRCb3VuZHMgY29udmVydCB2YWx1ZTogZmFsc3lcIik7XG4gICAgfVxuICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIExuZ0xhdEJvdW5kcykge1xuICAgICAgcmV0dXJuIG5ldyBMbmdMYXRCb3VuZHMoaW5wdXQuZ2V0U291dGhXZXN0KCksIGlucHV0LmdldE5vcnRoRWFzdCgpKTtcbiAgICB9XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoaW5wdXQpICYmIGlucHV0Lmxlbmd0aCA9PT0gMikge1xuICAgICAgcmV0dXJuIG5ldyBMbmdMYXRCb3VuZHMoTG5nTGF0LmNvbnZlcnQoaW5wdXRbMF0pLCBMbmdMYXQuY29udmVydChpbnB1dFsxXSkpO1xuICAgIH1cbiAgICBpZiAoQXJyYXkuaXNBcnJheShpbnB1dCkgJiYgaW5wdXQubGVuZ3RoID09PSA0KSB7XG4gICAgICByZXR1cm4gbmV3IExuZ0xhdEJvdW5kcyhMbmdMYXQuY29udmVydChbaW5wdXRbMF0sIGlucHV0WzFdXSksIExuZ0xhdC5jb252ZXJ0KFtpbnB1dFsyXSwgaW5wdXRbM11dKSk7XG4gICAgfVxuICAgIHRocm93IG5ldyBFcnJvcihcImBMbmdMYXRCb3VuZHNMaWtlYCBhcmd1bWVudCBtdXN0IGJlIHNwZWNpZmllZCBhcyBhbiBhcnJheSBbPExuZ0xhdExpa2U+LCA8TG5nTGF0TGlrZT5dIG9yIGFuIGFycmF5IFs8d2VzdD4sIDxzb3V0aD4sIDxlYXN0PiwgPG5vcnRoPl1cIik7XG4gIH1cbn07XG5cbi8vIHNyYy91dGlscy91dWlkLnRzXG5mdW5jdGlvbiBnZW5lcmF0ZVVVSUQoKSB7XG4gIGNvbnN0IHJhbmRvbVN0cmluZyA9IE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMTYpICsgRGF0ZS5ub3coKS50b1N0cmluZygxNikgKyBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDE2KTtcbiAgY29uc3QgdXVpZFN0cmluZyA9IHJhbmRvbVN0cmluZy5yZXBsYWNlKC9cXC4vZywgXCJcIik7XG4gIGNvbnN0IHV1aWQgPSBbXG4gICAgdXVpZFN0cmluZy5zbGljZSgwLCA4KSxcbiAgICB1dWlkU3RyaW5nLnNsaWNlKDgsIDEyKSxcbiAgICBcIjRcIiArIHV1aWRTdHJpbmcuc2xpY2UoMTIsIDE1KSArIFwiLThcIiArIHV1aWRTdHJpbmcuc2xpY2UoMTUsIDE4KSxcbiAgICB1dWlkU3RyaW5nLnNsaWNlKDE4LCAzMClcbiAgXS5qb2luKFwiLVwiKTtcbiAgcmV0dXJuIHV1aWQ7XG59XG5cbi8vIHNyYy9TZXNzaW9uVG9rZW4udHNcbnZhciBTZXNzaW9uVG9rZW4gPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKGlkKSB7XG4gICAgdGhpcy5pZCA9IGlkICE9IG51bGwgPyBpZCA6IGdlbmVyYXRlVVVJRCgpO1xuICB9XG4gIHRvU3RyaW5nKCkge1xuICAgIHJldHVybiB0aGlzLmlkO1xuICB9XG4gIHN0YXRpYyBjb252ZXJ0KHRva2VuKSB7XG4gICAgcmV0dXJuIG5ldyBTZXNzaW9uVG9rZW4odG9rZW4gaW5zdGFuY2VvZiBTZXNzaW9uVG9rZW4gPyB0b2tlbi5pZCA6IHRva2VuLnRvU3RyaW5nKCkpO1xuICB9XG59O1xuXG4vLyBzcmMvTWFwYm94RXJyb3IudHNcbnZhciBVTktOT1dOX0VSUk9SID0gXCJVbmtub3duIGVycm9yXCI7XG52YXIgTWFwYm94RXJyb3IgPSBjbGFzcyBleHRlbmRzIEVycm9yIHtcbiAgY29uc3RydWN0b3IoanNvbiwgc3RhdHVzQ29kZSkge1xuICAgIHN1cGVyKFN0cmluZyhqc29uLm1lc3NhZ2UgfHwganNvbi5lcnJvciB8fCBVTktOT1dOX0VSUk9SKSk7XG4gICAgdGhpcy5uYW1lID0gXCJNYXBib3hFcnJvclwiO1xuICAgIHRoaXMuc3RhdHVzQ29kZSA9IHN0YXR1c0NvZGU7XG4gIH1cbiAgdG9TdHJpbmcoKSB7XG4gICAgcmV0dXJuIGAke3RoaXMubmFtZX0gKCR7dGhpcy5zdGF0dXNDb2RlfSk6ICR7dGhpcy5tZXNzYWdlfWA7XG4gIH1cbn07XG5mdW5jdGlvbiBoYW5kbGVOb25Pa1JlcyhyZXMpIHtcbiAgcmV0dXJuIF9fYXN5bmModGhpcywgbnVsbCwgZnVuY3Rpb24qICgpIHtcbiAgICBpZiAoIXJlcy5vaykge1xuICAgICAgY29uc3QganNvbiA9IHlpZWxkIHJlcy5qc29uKCk7XG4gICAgICB0aHJvdyBuZXcgTWFwYm94RXJyb3IoanNvbiwgcmVzLnN0YXR1cyk7XG4gICAgfVxuICB9KTtcbn1cblxuLy8gc3JjL2ZldGNoLnRzXG52YXIgX2ZldGNoSW1wbCA9IGdsb2JhbFRoaXMuZmV0Y2g7XG52YXIgX2Fib3J0Q29udHJvbGxlckltcGwgPSBnbG9iYWxUaGlzLkFib3J0Q29udHJvbGxlcjtcbmZ1bmN0aW9uIHBvbHlmaWxsRmV0Y2goeyBmZXRjaCwgQWJvcnRDb250cm9sbGVyIH0sIGZvcmNlID0gZmFsc2UpIHtcbiAgaWYgKCFmZXRjaCkge1xuICAgIHRocm93IG5ldyBFcnJvcihcIkZldGNoIGltcGxlbWVudGF0aW9uIG11c3QgaW5jbHVkZSBpbXBsZW1lbnRhdGlvbnMgb2YgYGZldGNoYC5cIik7XG4gIH1cbiAgaWYgKF9mZXRjaEltcGwgJiYgIWZvcmNlKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIF9mZXRjaEltcGwgPSBmZXRjaDtcbiAgX2Fib3J0Q29udHJvbGxlckltcGwgPSBBYm9ydENvbnRyb2xsZXI7XG59XG5mdW5jdGlvbiBnZXRGZXRjaCgpIHtcbiAgaWYgKCFfZmV0Y2hJbXBsKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiRmV0Y2ggaW1wbGVtZW50YXRpb24gbm90IGZvdW5kLiBQbGVhc2UgaW5jbHVkZSBhIGZldGNoIHBvbHlmaWxsIGluIHlvdXIgYXBwbGljYXRpb24gb3IgdXNlIGBwb2x5ZmlsbEZldGNoYCBmcm9tIGBAbWFwYm94L3NlYXJjaC1qcy1jb3JlYCB0byBmaXggdGhpcyBpc3N1ZS5cIik7XG4gIH1cbiAgcmV0dXJuIHtcbiAgICBmZXRjaDogX2ZldGNoSW1wbCxcbiAgICBBYm9ydENvbnRyb2xsZXI6IF9hYm9ydENvbnRyb2xsZXJJbXBsXG4gIH07XG59XG5cbi8vIHNyYy91dGlscy9xdWVyeVBhcmFtcy50c1xuZnVuY3Rpb24gcXVlcnlQYXJhbXMoLi4ub2JqZWN0cykge1xuICBjb25zdCBwYXJhbXMgPSBbXTtcbiAgZm9yIChjb25zdCBvYmogb2Ygb2JqZWN0cykge1xuICAgIGlmICghb2JqKVxuICAgICAgY29udGludWU7XG4gICAgY29uc3QgZW50cmllcyA9IE9iamVjdC5lbnRyaWVzKG9iaik7XG4gICAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgZW50cmllcykge1xuICAgICAgaWYgKHZhbHVlID09IG51bGwpXG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgcGFyYW1zLnB1c2goYCR7a2V5fT0ke2VuY29kZVVSSUNvbXBvbmVudChTdHJpbmcodmFsdWUpKX1gKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHBhcmFtcy5qb2luKFwiJlwiKTtcbn1cblxuLy8gc3JjL2F1dG9maWxsL0FkZHJlc3NBdXRvZmlsbENvcmUudHNcbnZhciBfZ2V0UXVlcnlQYXJhbXMsIGdldFF1ZXJ5UGFyYW1zX2ZuO1xudmFyIF9BZGRyZXNzQXV0b2ZpbGxDb3JlID0gY2xhc3Mge1xuICBjb25zdHJ1Y3RvcihvcHRpb25zID0ge30pIHtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX2dldFF1ZXJ5UGFyYW1zKTtcbiAgICBjb25zdCBfYSA9IG9wdGlvbnMsIHsgYWNjZXNzVG9rZW4gfSA9IF9hLCBkZWZhdWx0cyA9IF9fb2JqUmVzdChfYSwgW1wiYWNjZXNzVG9rZW5cIl0pO1xuICAgIHRoaXMuYWNjZXNzVG9rZW4gPSBhY2Nlc3NUb2tlbjtcbiAgICB0aGlzLmRlZmF1bHRzID0gX19zcHJlYWRWYWx1ZXMoX19zcHJlYWRWYWx1ZXMoe30sIF9BZGRyZXNzQXV0b2ZpbGxDb3JlLmRlZmF1bHRzKSwgZGVmYXVsdHMpO1xuICB9XG4gIHN1Z2dlc3Qoc2VhcmNoVGV4dCwgb3B0aW9uc0FyZykge1xuICAgIHJldHVybiBfX2FzeW5jKHRoaXMsIG51bGwsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICBpZiAoIXNlYXJjaFRleHQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwic2VhcmNoVGV4dCBpcyByZXF1aXJlZFwiKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHsgc2Vzc2lvblRva2VuLCBzaWduYWwgfSA9IG9wdGlvbnNBcmc7XG4gICAgICBjb25zdCBvcHRpb25zID0gX19zcHJlYWRQcm9wcyhfX3NwcmVhZFZhbHVlcyhfX3NwcmVhZFZhbHVlcyh7fSwgdGhpcy5kZWZhdWx0cyksIG9wdGlvbnNBcmcpLCB7XG4gICAgICAgIHNlc3Npb25Ub2tlblxuICAgICAgfSk7XG4gICAgICBjb25zdCB1cmwgPSBuZXcgVVJMKGAke1NVR0dFU1RfVVJMfS8ke2VuY29kZVVSSUNvbXBvbmVudChzZWFyY2hUZXh0KX1gKTtcbiAgICAgIHVybC5zZWFyY2ggPSBfX3ByaXZhdGVNZXRob2QodGhpcywgX2dldFF1ZXJ5UGFyYW1zLCBnZXRRdWVyeVBhcmFtc19mbikuY2FsbCh0aGlzLCBvcHRpb25zKTtcbiAgICAgIGNvbnN0IHsgZmV0Y2ggfSA9IGdldEZldGNoKCk7XG4gICAgICBjb25zdCByZXMgPSB5aWVsZCBmZXRjaCh1cmwudG9TdHJpbmcoKSwge1xuICAgICAgICBzaWduYWxcbiAgICAgIH0pO1xuICAgICAgeWllbGQgaGFuZGxlTm9uT2tSZXMocmVzKTtcbiAgICAgIGNvbnN0IGpzb24gPSB5aWVsZCByZXMuanNvbigpO1xuICAgICAgcmV0dXJuIF9fc3ByZWFkUHJvcHMoX19zcHJlYWRWYWx1ZXMoe30sIGpzb24pLCB7XG4gICAgICAgIHN1Z2dlc3Rpb25zOiBqc29uLnN1Z2dlc3Rpb25zLm1hcCgoc3VnZ2VzdGlvbikgPT4ge1xuICAgICAgICAgIHJldHVybiBfX3NwcmVhZFByb3BzKF9fc3ByZWFkVmFsdWVzKHt9LCBzdWdnZXN0aW9uKSwge1xuICAgICAgICAgICAgb3JpZ2luYWxfc2VhcmNoX3RleHQ6IHNlYXJjaFRleHRcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSksXG4gICAgICAgIHVybDogdXJsLnRvU3RyaW5nKClcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG4gIHJldHJpZXZlKHN1Z2dlc3Rpb24sIG9wdGlvbnNBcmcpIHtcbiAgICByZXR1cm4gX19hc3luYyh0aGlzLCBudWxsLCBmdW5jdGlvbiogKCkge1xuICAgICAgaWYgKCFzdWdnZXN0aW9uKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcInN1Z2dlc3Rpb24gaXMgcmVxdWlyZWRcIik7XG4gICAgICB9XG4gICAgICBpZiAoIXRoaXMuY2FuUmV0cmlldmUoc3VnZ2VzdGlvbikpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwic3VnZ2VzdGlvbiBjYW5ub3QgYmUgcmV0cmlldmVkXCIpO1xuICAgICAgfVxuICAgICAgY29uc3QgeyBzZXNzaW9uVG9rZW46IHNlc3Npb25Ub2tlbkxpa2UsIHNpZ25hbCB9ID0gb3B0aW9uc0FyZztcbiAgICAgIGNvbnN0IHNlc3Npb25Ub2tlbiA9IFNlc3Npb25Ub2tlbi5jb252ZXJ0KHNlc3Npb25Ub2tlbkxpa2UpO1xuICAgICAgY29uc3QgdXJsID0gbmV3IFVSTChgJHtSRVRSSUVWRV9VUkx9LyR7c3VnZ2VzdGlvbi5hY3Rpb24uaWR9YCk7XG4gICAgICB1cmwuc2VhcmNoID0gcXVlcnlQYXJhbXMoe1xuICAgICAgICBhY2Nlc3NfdG9rZW46IHRoaXMuYWNjZXNzVG9rZW4sXG4gICAgICAgIHNlc3Npb25fdG9rZW46IHNlc3Npb25Ub2tlbi5pZFxuICAgICAgfSk7XG4gICAgICBjb25zdCB7IGZldGNoIH0gPSBnZXRGZXRjaCgpO1xuICAgICAgY29uc3QgcmVzID0geWllbGQgZmV0Y2godXJsLnRvU3RyaW5nKCksIHsgc2lnbmFsIH0pO1xuICAgICAgeWllbGQgaGFuZGxlTm9uT2tSZXMocmVzKTtcbiAgICAgIGNvbnN0IGpzb24gPSB5aWVsZCByZXMuanNvbigpO1xuICAgICAganNvbi51cmwgPSB1cmwudG9TdHJpbmcoKTtcbiAgICAgIHJldHVybiBqc29uO1xuICAgIH0pO1xuICB9XG4gIGNhblJldHJpZXZlKHN1Z2dlc3Rpb24pIHtcbiAgICBjb25zdCBhY3Rpb24gPSBzdWdnZXN0aW9uLmFjdGlvbjtcbiAgICByZXR1cm4gdHlwZW9mIChhY3Rpb24gPT0gbnVsbCA/IHZvaWQgMCA6IGFjdGlvbi5pZCkgPT09IFwic3RyaW5nXCI7XG4gIH1cbn07XG52YXIgQWRkcmVzc0F1dG9maWxsQ29yZSA9IF9BZGRyZXNzQXV0b2ZpbGxDb3JlO1xuX2dldFF1ZXJ5UGFyYW1zID0gbmV3IFdlYWtTZXQoKTtcbmdldFF1ZXJ5UGFyYW1zX2ZuID0gZnVuY3Rpb24ob3B0aW9ucykge1xuICByZXR1cm4gcXVlcnlQYXJhbXMoe1xuICAgIHR5cGVzOiBcImFkZHJlc3NcIixcbiAgICBhY2Nlc3NfdG9rZW46IHRoaXMuYWNjZXNzVG9rZW4sXG4gICAgc3RyZWV0czogb3B0aW9ucy5zdHJlZXRzLFxuICAgIGxhbmd1YWdlOiBvcHRpb25zLmxhbmd1YWdlLFxuICAgIGNvdW50cnk6IG9wdGlvbnMuY291bnRyeSxcbiAgICBsaW1pdDogb3B0aW9ucy5saW1pdFxuICB9LCBvcHRpb25zLnNlc3Npb25Ub2tlbiAmJiB7XG4gICAgc2Vzc2lvbl90b2tlbjogU2Vzc2lvblRva2VuLmNvbnZlcnQob3B0aW9ucy5zZXNzaW9uVG9rZW4pLmlkXG4gIH0sIG9wdGlvbnMucHJveGltaXR5ICYmIHtcbiAgICBwcm94aW1pdHk6IHR5cGVvZiBvcHRpb25zLnByb3hpbWl0eSA9PT0gXCJzdHJpbmdcIiA/IG9wdGlvbnMucHJveGltaXR5IDogTG5nTGF0LmNvbnZlcnQob3B0aW9ucy5wcm94aW1pdHkpLnRvQXJyYXkoKS5qb2luKFwiLFwiKVxuICB9LCBvcHRpb25zLmJib3ggJiYge1xuICAgIGJib3g6IHR5cGVvZiBvcHRpb25zLmJib3ggPT09IFwic3RyaW5nXCIgPyBvcHRpb25zLmJib3ggOiBMbmdMYXRCb3VuZHMuY29udmVydChvcHRpb25zLmJib3gpLnRvRmxhdEFycmF5KCkuam9pbihcIixcIilcbiAgfSk7XG59O1xuQWRkcmVzc0F1dG9maWxsQ29yZS5kZWZhdWx0cyA9IHtcbiAgbGFuZ3VhZ2U6IFwiZW5cIixcbiAgcHJveGltaXR5OiBcImlwXCIsXG4gIHN0cmVldHM6IHRydWVcbn07XG5cbi8vIHNyYy9zZWFyY2hib3gvY29uc3RhbnRzLnRzXG52YXIgU0VBUkNIX1VSTDIgPSBgaHR0cHM6Ly9hcGkubWFwYm94LmNvbS9zZWFyY2gvc2VhcmNoYm94L3YxYDtcbnZhciBFTkRQT0lOVF9TVUdHRVNUMiA9IFwic3VnZ2VzdFwiO1xudmFyIEVORFBPSU5UX1JFVFJJRVZFMiA9IFwicmV0cmlldmVcIjtcbnZhciBFTkRQT0lOVF9DQVRFR09SWSA9IFwiY2F0ZWdvcnlcIjtcbnZhciBFTkRQT0lOVF9SRVZFUlNFID0gXCJyZXZlcnNlXCI7XG52YXIgU1VHR0VTVF9VUkwyID0gYCR7U0VBUkNIX1VSTDJ9LyR7RU5EUE9JTlRfU1VHR0VTVDJ9YDtcbnZhciBSRVRSSUVWRV9VUkwyID0gYCR7U0VBUkNIX1VSTDJ9LyR7RU5EUE9JTlRfUkVUUklFVkUyfWA7XG52YXIgQ0FURUdPUllfVVJMID0gYCR7U0VBUkNIX1VSTDJ9LyR7RU5EUE9JTlRfQ0FURUdPUll9YDtcbnZhciBSRVZFUlNFX1VSTCA9IGAke1NFQVJDSF9VUkwyfS8ke0VORFBPSU5UX1JFVkVSU0V9YDtcblxuLy8gc3JjL3NlYXJjaGJveC9TZWFyY2hCb3hDb3JlLnRzXG52YXIgX2dldFF1ZXJ5UGFyYW1zMiwgZ2V0UXVlcnlQYXJhbXNfZm4yO1xudmFyIF9TZWFyY2hCb3hDb3JlID0gY2xhc3Mge1xuICBjb25zdHJ1Y3RvcihvcHRpb25zID0ge30pIHtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX2dldFF1ZXJ5UGFyYW1zMik7XG4gICAgY29uc3QgX2EgPSBvcHRpb25zLCB7IGFjY2Vzc1Rva2VuIH0gPSBfYSwgZGVmYXVsdHMgPSBfX29ialJlc3QoX2EsIFtcImFjY2Vzc1Rva2VuXCJdKTtcbiAgICB0aGlzLmFjY2Vzc1Rva2VuID0gYWNjZXNzVG9rZW47XG4gICAgdGhpcy5kZWZhdWx0cyA9IF9fc3ByZWFkVmFsdWVzKF9fc3ByZWFkVmFsdWVzKHt9LCBfU2VhcmNoQm94Q29yZS5kZWZhdWx0cyksIGRlZmF1bHRzKTtcbiAgfVxuICBzdWdnZXN0KHNlYXJjaFRleHQsIG9wdGlvbnNBcmcpIHtcbiAgICByZXR1cm4gX19hc3luYyh0aGlzLCBudWxsLCBmdW5jdGlvbiogKCkge1xuICAgICAgaWYgKCFzZWFyY2hUZXh0KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcInNlYXJjaFRleHQgaXMgcmVxdWlyZWRcIik7XG4gICAgICB9XG4gICAgICBjb25zdCB7IHNlc3Npb25Ub2tlbiwgc2lnbmFsIH0gPSBvcHRpb25zQXJnO1xuICAgICAgY29uc3Qgb3B0aW9ucyA9IF9fc3ByZWFkUHJvcHMoX19zcHJlYWRWYWx1ZXMoX19zcHJlYWRWYWx1ZXMoe30sIHRoaXMuZGVmYXVsdHMpLCBvcHRpb25zQXJnKSwge1xuICAgICAgICBxOiBzZWFyY2hUZXh0LFxuICAgICAgICBzZXNzaW9uVG9rZW5cbiAgICAgIH0pO1xuICAgICAgaWYgKG9wdGlvbnMuZXRhX3R5cGUgJiYgKCFvcHRpb25zLm9yaWdpbiB8fCAhb3B0aW9ucy5uYXZpZ2F0aW9uX3Byb2ZpbGUpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcInRvIHByb3ZpZGUgZXRhIGVzdGltYXRlOiBldGEsIG5hdmlnYXRpb25fcHJvZmlsZSwgYW5kIG9yaWdpbiBhcmUgcmVxdWlyZWRcIik7XG4gICAgICB9XG4gICAgICBpZiAob3B0aW9ucy5vcmlnaW4gJiYgIW9wdGlvbnMubmF2aWdhdGlvbl9wcm9maWxlKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcInRvIHByb3ZpZGUgZGlzdGFuY2UgZXN0aW1hdGU6IGJvdGggbmF2aWdhdGlvbl9wcm9maWxlIGFuZCBvcmlnaW4gYXJlIHJlcXVpcmVkXCIpO1xuICAgICAgfVxuICAgICAgY29uc3QgdXJsID0gbmV3IFVSTChTVUdHRVNUX1VSTDIpO1xuICAgICAgdXJsLnNlYXJjaCA9IF9fcHJpdmF0ZU1ldGhvZCh0aGlzLCBfZ2V0UXVlcnlQYXJhbXMyLCBnZXRRdWVyeVBhcmFtc19mbjIpLmNhbGwodGhpcywgb3B0aW9ucyk7XG4gICAgICBjb25zdCB7IGZldGNoIH0gPSBnZXRGZXRjaCgpO1xuICAgICAgY29uc3QgcmVzID0geWllbGQgZmV0Y2godXJsLnRvU3RyaW5nKCksIHtcbiAgICAgICAgc2lnbmFsXG4gICAgICB9KTtcbiAgICAgIHlpZWxkIGhhbmRsZU5vbk9rUmVzKHJlcyk7XG4gICAgICBjb25zdCBqc29uID0geWllbGQgcmVzLmpzb24oKTtcbiAgICAgIGpzb24udXJsID0gdXJsLnRvU3RyaW5nKCk7XG4gICAgICByZXR1cm4ganNvbjtcbiAgICB9KTtcbiAgfVxuICByZXRyaWV2ZShzdWdnZXN0aW9uLCBvcHRpb25zQXJnKSB7XG4gICAgcmV0dXJuIF9fYXN5bmModGhpcywgbnVsbCwgZnVuY3Rpb24qICgpIHtcbiAgICAgIGlmICghc3VnZ2VzdGlvbikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJzdWdnZXN0aW9uIGlzIHJlcXVpcmVkXCIpO1xuICAgICAgfVxuICAgICAgY29uc3QgeyBzZXNzaW9uVG9rZW46IHNlc3Npb25Ub2tlbkxpa2UsIHNpZ25hbCB9ID0gb3B0aW9uc0FyZztcbiAgICAgIGNvbnN0IHNlc3Npb25Ub2tlbiA9IFNlc3Npb25Ub2tlbi5jb252ZXJ0KHNlc3Npb25Ub2tlbkxpa2UpO1xuICAgICAgY29uc3QgdXJsID0gbmV3IFVSTChgJHtSRVRSSUVWRV9VUkwyfS8ke2VuY29kZVVSSUNvbXBvbmVudChzdWdnZXN0aW9uLm1hcGJveF9pZCl9YCk7XG4gICAgICB1cmwuc2VhcmNoID0gcXVlcnlQYXJhbXMoe1xuICAgICAgICBhY2Nlc3NfdG9rZW46IHRoaXMuYWNjZXNzVG9rZW4sXG4gICAgICAgIHNlc3Npb25fdG9rZW46IHNlc3Npb25Ub2tlbi5pZFxuICAgICAgfSk7XG4gICAgICBjb25zdCB7IGZldGNoIH0gPSBnZXRGZXRjaCgpO1xuICAgICAgY29uc3QgcmVzID0geWllbGQgZmV0Y2godXJsLnRvU3RyaW5nKCksIHtcbiAgICAgICAgc2lnbmFsXG4gICAgICB9KTtcbiAgICAgIHlpZWxkIGhhbmRsZU5vbk9rUmVzKHJlcyk7XG4gICAgICBjb25zdCBqc29uID0geWllbGQgcmVzLmpzb24oKTtcbiAgICAgIGpzb24udXJsID0gdXJsLnRvU3RyaW5nKCk7XG4gICAgICByZXR1cm4ganNvbjtcbiAgICB9KTtcbiAgfVxuICBjYXRlZ29yeShfMCkge1xuICAgIHJldHVybiBfX2FzeW5jKHRoaXMsIGFyZ3VtZW50cywgZnVuY3Rpb24qIChjYXRlZ29yeSwgb3B0aW9uc0FyZyA9IHt9KSB7XG4gICAgICBpZiAoIWNhdGVnb3J5KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcImNhdGVnb3J5IGlzIHJlcXVpcmVkXCIpO1xuICAgICAgfVxuICAgICAgY29uc3Qgb3B0aW9ucyA9IF9fc3ByZWFkVmFsdWVzKF9fc3ByZWFkVmFsdWVzKHt9LCB0aGlzLmRlZmF1bHRzKSwgb3B0aW9uc0FyZyk7XG4gICAgICBjb25zdCB1cmwgPSBuZXcgVVJMKGAke0NBVEVHT1JZX1VSTH0vJHtlbmNvZGVVUklDb21wb25lbnQoY2F0ZWdvcnkpfWApO1xuICAgICAgdXJsLnNlYXJjaCA9IF9fcHJpdmF0ZU1ldGhvZCh0aGlzLCBfZ2V0UXVlcnlQYXJhbXMyLCBnZXRRdWVyeVBhcmFtc19mbjIpLmNhbGwodGhpcywgb3B0aW9ucyk7XG4gICAgICBjb25zdCB7IGZldGNoIH0gPSBnZXRGZXRjaCgpO1xuICAgICAgY29uc3QgcmVzID0geWllbGQgZmV0Y2godXJsLnRvU3RyaW5nKCksIHtcbiAgICAgICAgc2lnbmFsOiBvcHRpb25zLnNpZ25hbFxuICAgICAgfSk7XG4gICAgICB5aWVsZCBoYW5kbGVOb25Pa1JlcyhyZXMpO1xuICAgICAgY29uc3QganNvbiA9IHlpZWxkIHJlcy5qc29uKCk7XG4gICAgICBqc29uLnVybCA9IHVybC50b1N0cmluZygpO1xuICAgICAgcmV0dXJuIGpzb247XG4gICAgfSk7XG4gIH1cbiAgcmV2ZXJzZShfMCkge1xuICAgIHJldHVybiBfX2FzeW5jKHRoaXMsIGFyZ3VtZW50cywgZnVuY3Rpb24qIChsbmdMYXQsIG9wdGlvbnNBcmcgPSB7fSkge1xuICAgICAgaWYgKCFsbmdMYXQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwibG5nTGF0IGlzIHJlcXVpcmVkXCIpO1xuICAgICAgfVxuICAgICAgY29uc3QgW2xuZywgbGF0XSA9IHR5cGVvZiBsbmdMYXQgPT09IFwic3RyaW5nXCIgPyBsbmdMYXQuc3BsaXQoXCIsXCIpLm1hcCgoeCkgPT4gcGFyc2VGbG9hdCh4KSkgOiBMbmdMYXQuY29udmVydChsbmdMYXQpLnRvQXJyYXkoKTtcbiAgICAgIGlmIChpc05hTihsbmcpIHx8IGlzTmFOKGxhdCkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwibG5nTGF0IGlzIHJlcXVpcmVkXCIpO1xuICAgICAgfVxuICAgICAgY29uc3Qgb3B0aW9ucyA9IF9fc3ByZWFkVmFsdWVzKF9fc3ByZWFkVmFsdWVzKHt9LCB0aGlzLmRlZmF1bHRzKSwgb3B0aW9uc0FyZyk7XG4gICAgICBjb25zdCB1cmwgPSBuZXcgVVJMKFJFVkVSU0VfVVJMKTtcbiAgICAgIHVybC5zZWFyY2ggPSBxdWVyeVBhcmFtcyh7XG4gICAgICAgIGFjY2Vzc190b2tlbjogdGhpcy5hY2Nlc3NUb2tlbixcbiAgICAgICAgbGFuZ3VhZ2U6IG9wdGlvbnMubGFuZ3VhZ2UsXG4gICAgICAgIGxpbWl0OiBvcHRpb25zLmxpbWl0LFxuICAgICAgICBsb25naXR1ZGU6IGxuZyxcbiAgICAgICAgbGF0aXR1ZGU6IGxhdFxuICAgICAgfSwgb3B0aW9ucy50eXBlcyAmJiB7XG4gICAgICAgIHR5cGVzOiB0eXBlb2Ygb3B0aW9ucy50eXBlcyA9PT0gXCJzdHJpbmdcIiA/IG9wdGlvbnMudHlwZXMgOiBbLi4ub3B0aW9ucy50eXBlc10uam9pbihcIixcIilcbiAgICAgIH0pO1xuICAgICAgY29uc3QgeyBmZXRjaCB9ID0gZ2V0RmV0Y2goKTtcbiAgICAgIGNvbnN0IHJlcyA9IHlpZWxkIGZldGNoKHVybC50b1N0cmluZygpLCB7XG4gICAgICAgIHNpZ25hbDogb3B0aW9ucy5zaWduYWxcbiAgICAgIH0pO1xuICAgICAgeWllbGQgaGFuZGxlTm9uT2tSZXMocmVzKTtcbiAgICAgIGNvbnN0IGpzb24gPSB5aWVsZCByZXMuanNvbigpO1xuICAgICAganNvbi51cmwgPSB1cmwudG9TdHJpbmcoKTtcbiAgICAgIHJldHVybiBqc29uO1xuICAgIH0pO1xuICB9XG59O1xudmFyIFNlYXJjaEJveENvcmUgPSBfU2VhcmNoQm94Q29yZTtcbl9nZXRRdWVyeVBhcmFtczIgPSBuZXcgV2Vha1NldCgpO1xuZ2V0UXVlcnlQYXJhbXNfZm4yID0gZnVuY3Rpb24ob3B0aW9ucykge1xuICByZXR1cm4gcXVlcnlQYXJhbXMoe1xuICAgIHE6IG9wdGlvbnMucSxcbiAgICBhY2Nlc3NfdG9rZW46IHRoaXMuYWNjZXNzVG9rZW4sXG4gICAgbGFuZ3VhZ2U6IG9wdGlvbnMubGFuZ3VhZ2UsXG4gICAgbGltaXQ6IG9wdGlvbnMubGltaXQsXG4gICAgbmF2aWdhdGlvbl9wcm9maWxlOiBvcHRpb25zLm5hdmlnYXRpb25fcHJvZmlsZSxcbiAgICByb3V0ZTogb3B0aW9ucy5yb3V0ZSxcbiAgICByb3V0ZV9nZW9tZXRyeTogb3B0aW9ucy5yb3V0ZV9nZW9tZXRyeSxcbiAgICBzYXJfdHlwZTogb3B0aW9ucy5zYXJfdHlwZSxcbiAgICB0aW1lX2RldmlhdGlvbjogb3B0aW9ucy50aW1lX2RldmlhdGlvbixcbiAgICBldGFfdHlwZTogb3B0aW9ucy5ldGFfdHlwZSxcbiAgICBjb3VudHJ5OiBvcHRpb25zLmNvdW50cnksXG4gICAgcG9pX2NhdGVnb3J5OiBvcHRpb25zLnBvaV9jYXRlZ29yeSxcbiAgICByYWRpdXM6IG9wdGlvbnMucmFkaXVzLFxuICAgIHVzZXJfaWQ6IG9wdGlvbnMudXNlcl9pZCxcbiAgICByaWNoX21ldGFkYXRhX3Byb3ZpZGVyOiBvcHRpb25zLnJpY2hfbWV0YWRhdGFfcHJvdmlkZXIsXG4gICAgcG9pX2NhdGVnb3J5X2V4Y2x1c2lvbnM6IG9wdGlvbnMucG9pX2NhdGVnb3J5X2V4Y2x1c2lvbnNcbiAgfSwgb3B0aW9ucy5zZXNzaW9uVG9rZW4gJiYge1xuICAgIHNlc3Npb25fdG9rZW46IFNlc3Npb25Ub2tlbi5jb252ZXJ0KG9wdGlvbnMuc2Vzc2lvblRva2VuKS5pZFxuICB9LCBvcHRpb25zLnByb3hpbWl0eSAmJiB7XG4gICAgcHJveGltaXR5OiB0eXBlb2Ygb3B0aW9ucy5wcm94aW1pdHkgPT09IFwic3RyaW5nXCIgPyBvcHRpb25zLnByb3hpbWl0eSA6IExuZ0xhdC5jb252ZXJ0KG9wdGlvbnMucHJveGltaXR5KS50b0FycmF5KCkuam9pbihcIixcIilcbiAgfSwgb3B0aW9ucy5vcmlnaW4gJiYge1xuICAgIG9yaWdpbjogdHlwZW9mIG9wdGlvbnMub3JpZ2luID09PSBcInN0cmluZ1wiID8gb3B0aW9ucy5vcmlnaW4gOiBMbmdMYXQuY29udmVydChvcHRpb25zLm9yaWdpbikudG9BcnJheSgpLmpvaW4oXCIsXCIpXG4gIH0sIG9wdGlvbnMuYmJveCAmJiB7XG4gICAgYmJveDogdHlwZW9mIG9wdGlvbnMuYmJveCA9PT0gXCJzdHJpbmdcIiA/IG9wdGlvbnMuYmJveCA6IExuZ0xhdEJvdW5kcy5jb252ZXJ0KG9wdGlvbnMuYmJveCkudG9GbGF0QXJyYXkoKS5qb2luKFwiLFwiKVxuICB9LCBvcHRpb25zLnR5cGVzICYmIHtcbiAgICB0eXBlczogdHlwZW9mIG9wdGlvbnMudHlwZXMgPT09IFwic3RyaW5nXCIgPyBvcHRpb25zLnR5cGVzIDogWy4uLm9wdGlvbnMudHlwZXNdLmpvaW4oXCIsXCIpXG4gIH0pO1xufTtcblNlYXJjaEJveENvcmUuZGVmYXVsdHMgPSB7XG4gIGxhbmd1YWdlOiBcImVuXCJcbn07XG5cbi8vIHNyYy92YWxpZGF0ZS9jb25zdGFudHMudHNcbnZhciBTRUFSQ0hfVVJMMyA9IGBodHRwczovL2FwaS5tYXBib3guY29tL2F1dG9maWxsL3YxYDtcbnZhciBFTkRQT0lOVF9WQUxJREFURSA9IFwicmV0cmlldmVcIjtcbnZhciBWQUxJREFURV9VUkwgPSBgJHtTRUFSQ0hfVVJMM30vJHtFTkRQT0lOVF9WQUxJREFURX1gO1xuXG4vLyBzcmMvdmFsaWRhdGUvVmFsaWRhdGlvbkNvcmUudHNcbnZhciBfZ2V0UXVlcnlQYXJhbXMzLCBnZXRRdWVyeVBhcmFtc19mbjM7XG52YXIgX1ZhbGlkYXRpb25Db3JlID0gY2xhc3Mge1xuICBjb25zdHJ1Y3RvcihvcHRpb25zID0ge30pIHtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX2dldFF1ZXJ5UGFyYW1zMyk7XG4gICAgY29uc3QgX2EgPSBvcHRpb25zLCB7IGFjY2Vzc1Rva2VuIH0gPSBfYSwgZGVmYXVsdHMgPSBfX29ialJlc3QoX2EsIFtcImFjY2Vzc1Rva2VuXCJdKTtcbiAgICB0aGlzLmFjY2Vzc1Rva2VuID0gYWNjZXNzVG9rZW47XG4gICAgdGhpcy5kZWZhdWx0cyA9IF9fc3ByZWFkVmFsdWVzKF9fc3ByZWFkVmFsdWVzKHt9LCBfVmFsaWRhdGlvbkNvcmUuZGVmYXVsdHMpLCBkZWZhdWx0cyk7XG4gIH1cbiAgdmFsaWRhdGUoc2VhcmNoVGV4dCwgb3B0aW9uc0FyZykge1xuICAgIHJldHVybiBfX2FzeW5jKHRoaXMsIG51bGwsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICBpZiAoIXNlYXJjaFRleHQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwic2VhcmNoVGV4dCBpcyByZXF1aXJlZFwiKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHsgc2Vzc2lvblRva2VuLCBzaWduYWwgfSA9IG9wdGlvbnNBcmc7XG4gICAgICBjb25zdCBvcHRpb25zID0gX19zcHJlYWRQcm9wcyhfX3NwcmVhZFZhbHVlcyhfX3NwcmVhZFZhbHVlcyh7fSwgdGhpcy5kZWZhdWx0cyksIG9wdGlvbnNBcmcpLCB7XG4gICAgICAgIHNlc3Npb25Ub2tlblxuICAgICAgfSk7XG4gICAgICBjb25zdCB1cmwgPSBuZXcgVVJMKGAke1ZBTElEQVRFX1VSTH0vJHtlbmNvZGVVUklDb21wb25lbnQoc2VhcmNoVGV4dCl9YCk7XG4gICAgICB1cmwuc2VhcmNoID0gX19wcml2YXRlTWV0aG9kKHRoaXMsIF9nZXRRdWVyeVBhcmFtczMsIGdldFF1ZXJ5UGFyYW1zX2ZuMykuY2FsbCh0aGlzLCBvcHRpb25zKTtcbiAgICAgIGNvbnN0IHsgZmV0Y2ggfSA9IGdldEZldGNoKCk7XG4gICAgICBjb25zdCByZXMgPSB5aWVsZCBmZXRjaCh1cmwudG9TdHJpbmcoKSwge1xuICAgICAgICBzaWduYWxcbiAgICAgIH0pO1xuICAgICAgeWllbGQgaGFuZGxlTm9uT2tSZXMocmVzKTtcbiAgICAgIGNvbnN0IGpzb24gPSB5aWVsZCByZXMuanNvbigpO1xuICAgICAganNvbi51cmwgPSB1cmwudG9TdHJpbmcoKTtcbiAgICAgIGlmIChqc29uLmZlYXR1cmVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAganNvbi5mZWF0dXJlcyA9IFtqc29uLmZlYXR1cmVzWzBdXTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBqc29uO1xuICAgIH0pO1xuICB9XG59O1xudmFyIFZhbGlkYXRpb25Db3JlID0gX1ZhbGlkYXRpb25Db3JlO1xuX2dldFF1ZXJ5UGFyYW1zMyA9IG5ldyBXZWFrU2V0KCk7XG5nZXRRdWVyeVBhcmFtc19mbjMgPSBmdW5jdGlvbihvcHRpb25zKSB7XG4gIHJldHVybiBxdWVyeVBhcmFtcyh7XG4gICAgYWNjZXNzX3Rva2VuOiB0aGlzLmFjY2Vzc1Rva2VuLFxuICAgIGxhbmd1YWdlOiBvcHRpb25zLmxhbmd1YWdlLFxuICAgIGNvdW50cnk6IG9wdGlvbnMuY291bnRyeVxuICB9LCBvcHRpb25zLnNlc3Npb25Ub2tlbiAmJiB7XG4gICAgc2Vzc2lvbl90b2tlbjogU2Vzc2lvblRva2VuLmNvbnZlcnQob3B0aW9ucy5zZXNzaW9uVG9rZW4pLmlkXG4gIH0sIG9wdGlvbnMucHJveGltaXR5ICYmIHtcbiAgICBwcm94aW1pdHk6IHR5cGVvZiBvcHRpb25zLnByb3hpbWl0eSA9PT0gXCJzdHJpbmdcIiA/IG9wdGlvbnMucHJveGltaXR5IDogTG5nTGF0LmNvbnZlcnQob3B0aW9ucy5wcm94aW1pdHkpLnRvQXJyYXkoKS5qb2luKFwiLFwiKVxuICB9LCBvcHRpb25zLmJib3ggJiYge1xuICAgIGJib3g6IHR5cGVvZiBvcHRpb25zLmJib3ggPT09IFwic3RyaW5nXCIgPyBvcHRpb25zLmJib3ggOiBMbmdMYXRCb3VuZHMuY29udmVydChvcHRpb25zLmJib3gpLnRvRmxhdEFycmF5KCkuam9pbihcIixcIilcbiAgfSk7XG59O1xuVmFsaWRhdGlvbkNvcmUuZGVmYXVsdHMgPSB7XG4gIGxhbmd1YWdlOiBcImVuXCIsXG4gIHByb3hpbWl0eTogXCJpcFwiXG59O1xuXG4vLyBzcmMvZ2VvY29kZS9jb25zdGFudHMudHNcbnZhciBCQVNFX1VSTCA9IGBodHRwczovL2FwaS5tYXBib3guY29tL3NlYXJjaC9nZW9jb2RlL3Y2YDtcbnZhciBGT1JXQVJEX1VSTCA9IGAke0JBU0VfVVJMfS9mb3J3YXJkYDtcbnZhciBSRVZFUlNFX1VSTDIgPSBgJHtCQVNFX1VSTH0vcmV2ZXJzZWA7XG52YXIgQkFUQ0hfVVJMID0gYCR7QkFTRV9VUkx9L2JhdGNoYDtcblxuLy8gc3JjL2dlb2NvZGUvR2VvY29kaW5nQ29yZS50c1xudmFyIFJFVkVSU0VfR0VPQ09ERV9DT09SRF9SRUdFWCA9IC9eWyBdKigtP1xcZHsxLDN9KFxcLlxcZHswLDI1Nn0pPylbLCBdKygtP1xcZHsxLDN9KFxcLlxcZHswLDI1Nn0pPylbIF0qJC87XG52YXIgU1BBQ0VTX09SX0NPTU1BX1JFR0VYID0gL1tcXHMsXSsvO1xudmFyIF9nZXRRdWVyeVBhcmFtczQsIGdldFF1ZXJ5UGFyYW1zX2ZuNDtcbnZhciBHZW9jb2RpbmdDb3JlID0gY2xhc3Mge1xuICBjb25zdHJ1Y3RvcihvcHRpb25zID0ge30pIHtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX2dldFF1ZXJ5UGFyYW1zNCk7XG4gICAgY29uc3QgX2EgPSBvcHRpb25zLCB7IGFjY2Vzc1Rva2VuIH0gPSBfYSwgZGVmYXVsdHMgPSBfX29ialJlc3QoX2EsIFtcImFjY2Vzc1Rva2VuXCJdKTtcbiAgICB0aGlzLmFjY2Vzc1Rva2VuID0gYWNjZXNzVG9rZW47XG4gICAgdGhpcy5kZWZhdWx0cyA9IF9fc3ByZWFkVmFsdWVzKHt9LCBkZWZhdWx0cyk7XG4gIH1cbiAgZm9yd2FyZChzZWFyY2hUZXh0LCBvcHRpb25zQXJnKSB7XG4gICAgcmV0dXJuIF9fYXN5bmModGhpcywgbnVsbCwgZnVuY3Rpb24qICgpIHtcbiAgICAgIGlmICghc2VhcmNoVGV4dCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJzZWFyY2hUZXh0IGlzIHJlcXVpcmVkXCIpO1xuICAgICAgfVxuICAgICAgbGV0IHNpZ25hbDtcbiAgICAgIGlmIChvcHRpb25zQXJnKSB7XG4gICAgICAgICh7IHNpZ25hbCB9ID0gb3B0aW9uc0FyZyk7XG4gICAgICB9XG4gICAgICBjb25zdCBvcHRpb25zID0gX19zcHJlYWRQcm9wcyhfX3NwcmVhZFZhbHVlcyhfX3NwcmVhZFZhbHVlcyh7fSwgdGhpcy5kZWZhdWx0cyksIG9wdGlvbnNBcmcpLCB7XG4gICAgICAgIHE6IHNlYXJjaFRleHRcbiAgICAgIH0pO1xuICAgICAgY29uc3QgdXJsID0gbmV3IFVSTChgJHtGT1JXQVJEX1VSTH1gKTtcbiAgICAgIHVybC5zZWFyY2ggPSBfX3ByaXZhdGVNZXRob2QodGhpcywgX2dldFF1ZXJ5UGFyYW1zNCwgZ2V0UXVlcnlQYXJhbXNfZm40KS5jYWxsKHRoaXMsIG9wdGlvbnMpO1xuICAgICAgY29uc3QgeyBmZXRjaCB9ID0gZ2V0RmV0Y2goKTtcbiAgICAgIGNvbnN0IGZldGNoSW5pdCA9IHNpZ25hbCA/IHsgc2lnbmFsIH0gOiB7fTtcbiAgICAgIGNvbnN0IHJlcyA9IHlpZWxkIGZldGNoKHVybC50b1N0cmluZygpLCBmZXRjaEluaXQpO1xuICAgICAgeWllbGQgaGFuZGxlTm9uT2tSZXMocmVzKTtcbiAgICAgIGNvbnN0IGpzb24gPSB5aWVsZCByZXMuanNvbigpO1xuICAgICAganNvbi51cmwgPSB1cmwudG9TdHJpbmcoKTtcbiAgICAgIHJldHVybiBqc29uO1xuICAgIH0pO1xuICB9XG4gIHJldmVyc2UobG5nTGF0LCBvcHRpb25zQXJnKSB7XG4gICAgcmV0dXJuIF9fYXN5bmModGhpcywgbnVsbCwgZnVuY3Rpb24qICgpIHtcbiAgICAgIGlmICghbG5nTGF0KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcImxuZ0xhdCBpcyByZXF1aXJlZFwiKTtcbiAgICAgIH1cbiAgICAgIGxldCBzaWduYWw7XG4gICAgICBpZiAob3B0aW9uc0FyZykge1xuICAgICAgICAoeyBzaWduYWwgfSA9IG9wdGlvbnNBcmcpO1xuICAgICAgfVxuICAgICAgbGV0IGxuZ0xhdE9iajtcbiAgICAgIGlmICh0eXBlb2YgbG5nTGF0ID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIGNvbnN0IFtsbmcsIGxhdF0gPSBsbmdMYXQuc3BsaXQoXCIsXCIpO1xuICAgICAgICBsbmdMYXRPYmogPSBuZXcgTG5nTGF0KE51bWJlcihsbmcpLCBOdW1iZXIobGF0KSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBsbmdMYXRPYmogPSBMbmdMYXQuY29udmVydChsbmdMYXQpO1xuICAgICAgfVxuICAgICAgY29uc3Qgb3B0aW9ucyA9IF9fc3ByZWFkUHJvcHMoX19zcHJlYWRWYWx1ZXMoX19zcHJlYWRWYWx1ZXMoe30sIHRoaXMuZGVmYXVsdHMpLCBvcHRpb25zQXJnKSwge1xuICAgICAgICBsb25naXR1ZGU6IGxuZ0xhdE9iai5sbmcsXG4gICAgICAgIGxhdGl0dWRlOiBsbmdMYXRPYmoubGF0XG4gICAgICB9KTtcbiAgICAgIGNvbnN0IHVybCA9IG5ldyBVUkwoYCR7UkVWRVJTRV9VUkwyfWApO1xuICAgICAgdXJsLnNlYXJjaCA9IF9fcHJpdmF0ZU1ldGhvZCh0aGlzLCBfZ2V0UXVlcnlQYXJhbXM0LCBnZXRRdWVyeVBhcmFtc19mbjQpLmNhbGwodGhpcywgb3B0aW9ucywgdHJ1ZSk7XG4gICAgICBjb25zdCB7IGZldGNoIH0gPSBnZXRGZXRjaCgpO1xuICAgICAgY29uc3QgZmV0Y2hJbml0ID0gc2lnbmFsID8geyBzaWduYWwgfSA6IHt9O1xuICAgICAgY29uc3QgcmVzID0geWllbGQgZmV0Y2godXJsLnRvU3RyaW5nKCksIGZldGNoSW5pdCk7XG4gICAgICB5aWVsZCBoYW5kbGVOb25Pa1JlcyhyZXMpO1xuICAgICAgY29uc3QganNvbiA9IHlpZWxkIHJlcy5qc29uKCk7XG4gICAgICBqc29uLnVybCA9IHVybC50b1N0cmluZygpO1xuICAgICAgcmV0dXJuIGpzb247XG4gICAgfSk7XG4gIH1cbiAgc3VnZ2VzdChzZWFyY2hUZXh0LCBvcHRpb25zQXJnKSB7XG4gICAgcmV0dXJuIF9fYXN5bmModGhpcywgbnVsbCwgZnVuY3Rpb24qICgpIHtcbiAgICAgIGNvbnN0IGlzUmV2ZXJzZVF1ZXJ5ID0gUkVWRVJTRV9HRU9DT0RFX0NPT1JEX1JFR0VYLnRlc3Qoc2VhcmNoVGV4dCk7XG4gICAgICBpZiAoaXNSZXZlcnNlUXVlcnkpIHtcbiAgICAgICAgY29uc3QgY29vcmRpbmF0ZXMgPSBzZWFyY2hUZXh0LnRyaW0oKS5zcGxpdChTUEFDRVNfT1JfQ09NTUFfUkVHRVgpLm1hcCgocGFydCkgPT4gcGFydC50cmltKCkpLmpvaW4oXCIsXCIpO1xuICAgICAgICByZXR1cm4gdGhpcy5yZXZlcnNlKGNvb3JkaW5hdGVzLCBvcHRpb25zQXJnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZvcndhcmQoc2VhcmNoVGV4dCwgb3B0aW9uc0FyZyk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbiAgcmV0cmlldmUoc3VnZ2VzdGlvbikge1xuICAgIHJldHVybiBfX2FzeW5jKHRoaXMsIG51bGwsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICByZXR1cm4gc3VnZ2VzdGlvbjtcbiAgICB9KTtcbiAgfVxufTtcbl9nZXRRdWVyeVBhcmFtczQgPSBuZXcgV2Vha1NldCgpO1xuZ2V0UXVlcnlQYXJhbXNfZm40ID0gZnVuY3Rpb24ob3B0aW9ucywgaXNSZXZlcnNlID0gZmFsc2UpIHtcbiAgaWYgKGlzUmV2ZXJzZSkge1xuICAgIFtcInByb3hpbWl0eVwiLCBcImF1dG9jb21wbGV0ZVwiLCBcImJib3hcIl0uZm9yRWFjaCgoa2V5KSA9PiB7XG4gICAgICBpZiAoa2V5IGluIG9wdGlvbnMpIHtcbiAgICAgICAgZGVsZXRlIG9wdGlvbnNba2V5XTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuICByZXR1cm4gcXVlcnlQYXJhbXMoe1xuICAgIHE6IG9wdGlvbnMucSxcbiAgICBsb25naXR1ZGU6IG9wdGlvbnMubG9uZ2l0dWRlLFxuICAgIGxhdGl0dWRlOiBvcHRpb25zLmxhdGl0dWRlLFxuICAgIGFjY2Vzc190b2tlbjogdGhpcy5hY2Nlc3NUb2tlbixcbiAgICBwZXJtYW5lbnQ6IG9wdGlvbnMucGVybWFuZW50LFxuICAgIGxhbmd1YWdlOiBvcHRpb25zLmxhbmd1YWdlLFxuICAgIGNvdW50cnk6IG9wdGlvbnMuY291bnRyeSxcbiAgICBsaW1pdDogb3B0aW9ucy5saW1pdCxcbiAgICBhdXRvY29tcGxldGU6IG9wdGlvbnMuYXV0b2NvbXBsZXRlLFxuICAgIHdvcmxkdmlldzogb3B0aW9ucy53b3JsZHZpZXdcbiAgfSwgb3B0aW9ucy5wcm94aW1pdHkgJiYge1xuICAgIHByb3hpbWl0eTogdHlwZW9mIG9wdGlvbnMucHJveGltaXR5ID09PSBcInN0cmluZ1wiID8gb3B0aW9ucy5wcm94aW1pdHkgOiBMbmdMYXQuY29udmVydChvcHRpb25zLnByb3hpbWl0eSkudG9BcnJheSgpLmpvaW4oXCIsXCIpXG4gIH0sIG9wdGlvbnMuYmJveCAmJiB7XG4gICAgYmJveDogdHlwZW9mIG9wdGlvbnMuYmJveCA9PT0gXCJzdHJpbmdcIiA/IG9wdGlvbnMuYmJveCA6IExuZ0xhdEJvdW5kcy5jb252ZXJ0KG9wdGlvbnMuYmJveCkudG9GbGF0QXJyYXkoKS5qb2luKFwiLFwiKVxuICB9LCBvcHRpb25zLnR5cGVzICYmIHtcbiAgICB0eXBlczogdHlwZW9mIG9wdGlvbnMudHlwZXMgPT09IFwic3RyaW5nXCIgPyBvcHRpb25zLnR5cGVzIDogWy4uLm9wdGlvbnMudHlwZXNdLmpvaW4oXCIsXCIpXG4gIH0pO1xufTtcblxuLy8gc3JjL3R5cGVzLnRzXG52YXIgTWF0Y2hDb2RlVHlwZSA9IC8qIEBfX1BVUkVfXyAqLyAoKE1hdGNoQ29kZVR5cGUyKSA9PiB7XG4gIE1hdGNoQ29kZVR5cGUyW1wibWF0Y2hlZFwiXSA9IFwibWF0Y2hlZFwiO1xuICBNYXRjaENvZGVUeXBlMltcInVubWF0Y2hlZFwiXSA9IFwidW5tYXRjaGVkXCI7XG4gIE1hdGNoQ29kZVR5cGUyW1wicGxhdXNpYmxlXCJdID0gXCJwbGF1c2libGVcIjtcbiAgTWF0Y2hDb2RlVHlwZTJbXCJub3RfYXBwbGljYWJsZVwiXSA9IFwibm90X2FwcGxpY2FibGVcIjtcbiAgTWF0Y2hDb2RlVHlwZTJbXCJpbmZlcnJlZFwiXSA9IFwiaW5mZXJyZWRcIjtcbiAgcmV0dXJuIE1hdGNoQ29kZVR5cGUyO1xufSkoTWF0Y2hDb2RlVHlwZSB8fCB7fSk7XG52YXIgTWF0Y2hDb2RlQ29uZmlkZW5jZSA9IC8qIEBfX1BVUkVfXyAqLyAoKE1hdGNoQ29kZUNvbmZpZGVuY2UyKSA9PiB7XG4gIE1hdGNoQ29kZUNvbmZpZGVuY2UyW1wiZXhhY3RcIl0gPSBcImV4YWN0XCI7XG4gIE1hdGNoQ29kZUNvbmZpZGVuY2UyW1wiaGlnaFwiXSA9IFwiaGlnaFwiO1xuICBNYXRjaENvZGVDb25maWRlbmNlMltcIm1lZGl1bVwiXSA9IFwibWVkaXVtXCI7XG4gIE1hdGNoQ29kZUNvbmZpZGVuY2UyW1wibG93XCJdID0gXCJsb3dcIjtcbiAgcmV0dXJuIE1hdGNoQ29kZUNvbmZpZGVuY2UyO1xufSkoTWF0Y2hDb2RlQ29uZmlkZW5jZSB8fCB7fSk7XG5cbi8vIHNyYy91dGlscy9FdmVudGVkLnRzXG52YXIgX2xpc3RlbmVycztcbnZhciBFdmVudGVkID0gY2xhc3Mge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX2xpc3RlbmVycywge30pO1xuICB9XG4gIGFkZEV2ZW50TGlzdGVuZXIodHlwZSwgbGlzdGVuZXIpIHtcbiAgICBjb25zdCBsaXN0ZW5lcnNBcnIgPSBfX3ByaXZhdGVHZXQodGhpcywgX2xpc3RlbmVycyk7XG4gICAgaWYgKCFsaXN0ZW5lcnNBcnJbdHlwZV0pIHtcbiAgICAgIGxpc3RlbmVyc0Fyclt0eXBlXSA9IFtdO1xuICAgIH1cbiAgICBsaXN0ZW5lcnNBcnJbdHlwZV0ucHVzaChsaXN0ZW5lcik7XG4gIH1cbiAgcmVtb3ZlRXZlbnRMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcikge1xuICAgIGNvbnN0IGxpc3RlbmVyc0FyciA9IF9fcHJpdmF0ZUdldCh0aGlzLCBfbGlzdGVuZXJzKTtcbiAgICBpZiAoIWxpc3RlbmVyc0Fyclt0eXBlXSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBsaXN0ZW5lcnMgPSBsaXN0ZW5lcnNBcnJbdHlwZV07XG4gICAgY29uc3QgaW5kZXggPSBsaXN0ZW5lcnMuaW5kZXhPZihsaXN0ZW5lcik7XG4gICAgaWYgKGluZGV4ICE9PSAtMSkge1xuICAgICAgbGlzdGVuZXJzLnNwbGljZShpbmRleCwgMSk7XG4gICAgfVxuICB9XG4gIGZpcmUodHlwZSwgYXJnMCkge1xuICAgIGNvbnN0IGxpc3RlbmVyc0FyciA9IF9fcHJpdmF0ZUdldCh0aGlzLCBfbGlzdGVuZXJzKTtcbiAgICBpZiAoIWxpc3RlbmVyc0Fyclt0eXBlXSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBsaXN0ZW5lcnMgPSBsaXN0ZW5lcnNBcnJbdHlwZV07XG4gICAgZm9yIChjb25zdCBsaXN0ZW5lciBvZiBsaXN0ZW5lcnMpIHtcbiAgICAgIGxpc3RlbmVyKGFyZzApO1xuICAgIH1cbiAgfVxufTtcbl9saXN0ZW5lcnMgPSBuZXcgV2Vha01hcCgpO1xuXG4vLyBzcmMvdXRpbHMvZGVib3VuY2UudHNcbmZ1bmN0aW9uIGRlYm91bmNlKGZ1bmMsIHdhaXQsIHNpZ25hbEZuKSB7XG4gIGxldCB0aW1lb3V0ID0gbnVsbDtcbiAgcmV0dXJuICguLi5hcmdzKSA9PiB7XG4gICAgaWYgKHRpbWVvdXQgIT09IG51bGwpIHtcbiAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KTtcbiAgICB9XG4gICAgY29uc3Qgc2lnbmFsID0gc2lnbmFsRm4gJiYgc2lnbmFsRm4oKTtcbiAgICB0aW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICB0aW1lb3V0ID0gbnVsbDtcbiAgICAgIGlmIChzaWduYWwgPT0gbnVsbCA/IHZvaWQgMCA6IHNpZ25hbC5hYm9ydGVkKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGZ1bmMoLi4uYXJncyk7XG4gICAgfSwgd2FpdCk7XG4gIH07XG59XG5cbi8vIHNyYy9TZWFyY2hTZXNzaW9uLnRzXG5mdW5jdGlvbiBjcmVhdGVBYm9ydENvbnRyb2xsZXIoKSB7XG4gIGNvbnN0IHsgQWJvcnRDb250cm9sbGVyIH0gPSBnZXRGZXRjaCgpO1xuICByZXR1cm4gbmV3IEFib3J0Q29udHJvbGxlcigpO1xufVxudmFyIF9zdWdnZXN0aW9ucywgX2Fib3J0LCBfc3VnZ2VzdERlYm91bmNlO1xudmFyIFNlYXJjaFNlc3Npb24gPSBjbGFzcyBleHRlbmRzIEV2ZW50ZWQge1xuICBjb25zdHJ1Y3RvcihzZWFyY2gsIHdhaXQgPSAwKSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLnNlc3Npb25Ub2tlbiA9IG5ldyBTZXNzaW9uVG9rZW4oKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX3N1Z2dlc3Rpb25zLCB2b2lkIDApO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfYWJvcnQsIGNyZWF0ZUFib3J0Q29udHJvbGxlcigpKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX3N1Z2dlc3REZWJvdW5jZSwgdm9pZCAwKTtcbiAgICBfX3ByaXZhdGVTZXQodGhpcywgX3N1Z2dlc3REZWJvdW5jZSwgZGVib3VuY2UoKF8wLCAuLi5fMSkgPT4gX19hc3luYyh0aGlzLCBbXzAsIC4uLl8xXSwgZnVuY3Rpb24qIChzZWFyY2hUZXh0LCBvcHRpb25zID0ge30pIHtcbiAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfYWJvcnQpLmFib3J0KCk7XG4gICAgICBfX3ByaXZhdGVTZXQodGhpcywgX2Fib3J0LCBjcmVhdGVBYm9ydENvbnRyb2xsZXIoKSk7XG4gICAgICBpZiAoIXNlYXJjaFRleHQpIHtcbiAgICAgICAgX19wcml2YXRlU2V0KHRoaXMsIF9zdWdnZXN0aW9ucywgbnVsbCk7XG4gICAgICAgIHRoaXMuZmlyZShcInN1Z2dlc3RcIiwgX19wcml2YXRlR2V0KHRoaXMsIF9zdWdnZXN0aW9ucykpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCByZXMgPSB5aWVsZCB0aGlzLnNlYXJjaC5zdWdnZXN0KHNlYXJjaFRleHQsIF9fc3ByZWFkUHJvcHMoX19zcHJlYWRWYWx1ZXMoe1xuICAgICAgICAgIHNlc3Npb25Ub2tlbjogdGhpcy5zZXNzaW9uVG9rZW5cbiAgICAgICAgfSwgb3B0aW9ucyksIHtcbiAgICAgICAgICBzaWduYWw6IF9fcHJpdmF0ZUdldCh0aGlzLCBfYWJvcnQpLnNpZ25hbFxuICAgICAgICB9KSk7XG4gICAgICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfc3VnZ2VzdGlvbnMsIHJlcyk7XG4gICAgICAgIHRoaXMuZmlyZShcInN1Z2dlc3RcIiwgcmVzKTtcbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBpZiAoZXJyLm5hbWUgPT09IFwiQWJvcnRFcnJvclwiKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZmlyZShcInN1Z2dlc3RlcnJvclwiLCBlcnIpO1xuICAgICAgfVxuICAgIH0pLCB3YWl0LCAoKSA9PiBfX3ByaXZhdGVHZXQodGhpcywgX2Fib3J0KS5zaWduYWwpKTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0aGlzLCB7XG4gICAgICBzZWFyY2g6IHtcbiAgICAgICAgdmFsdWU6IHNlYXJjaCxcbiAgICAgICAgd3JpdGFibGU6IGZhbHNlXG4gICAgICB9LFxuICAgICAgZGVib3VuY2U6IHtcbiAgICAgICAgdmFsdWU6IHdhaXQsXG4gICAgICAgIHdyaXRhYmxlOiBmYWxzZVxuICAgICAgfVxuICAgIH0pO1xuICB9XG4gIGdldCBzdWdnZXN0aW9ucygpIHtcbiAgICByZXR1cm4gX19wcml2YXRlR2V0KHRoaXMsIF9zdWdnZXN0aW9ucyk7XG4gIH1cbiAgc3VnZ2VzdChzZWFyY2hUZXh0LCBvcHRpb25zKSB7XG4gICAgX19wcml2YXRlR2V0KHRoaXMsIF9zdWdnZXN0RGVib3VuY2UpLmNhbGwodGhpcywgc2VhcmNoVGV4dCwgb3B0aW9ucyk7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIGxldCBzdWdnZXN0Rm47XG4gICAgICBsZXQgc3VnZ2VzdEVycm9yRm47XG4gICAgICBzdWdnZXN0Rm4gPSAocmVzKSA9PiB7XG4gICAgICAgIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInN1Z2dlc3RcIiwgc3VnZ2VzdEZuKTtcbiAgICAgICAgdGhpcy5yZW1vdmVFdmVudExpc3RlbmVyKFwic3VnZ2VzdGVycm9yXCIsIHN1Z2dlc3RFcnJvckZuKTtcbiAgICAgICAgcmVzb2x2ZShyZXMpO1xuICAgICAgfTtcbiAgICAgIHN1Z2dlc3RFcnJvckZuID0gKGVycikgPT4ge1xuICAgICAgICB0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJzdWdnZXN0XCIsIHN1Z2dlc3RGbik7XG4gICAgICAgIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInN1Z2dlc3RlcnJvclwiLCBzdWdnZXN0RXJyb3JGbik7XG4gICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgfTtcbiAgICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcihcInN1Z2dlc3RcIiwgc3VnZ2VzdEZuKTtcbiAgICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcihcInN1Z2dlc3RlcnJvclwiLCBzdWdnZXN0RXJyb3JGbik7XG4gICAgfSk7XG4gIH1cbiAgY2xlYXIoKSB7XG4gICAgdGhpcy5zdWdnZXN0KFwiXCIpO1xuICB9XG4gIHJldHJpZXZlKHN1Z2dlc3Rpb24sIG9wdGlvbnMpIHtcbiAgICByZXR1cm4gX19hc3luYyh0aGlzLCBudWxsLCBmdW5jdGlvbiogKCkge1xuICAgICAgY29uc3QgcmVzID0geWllbGQgdGhpcy5zZWFyY2gucmV0cmlldmUoc3VnZ2VzdGlvbiwgX19zcHJlYWRWYWx1ZXMoe1xuICAgICAgICBzZXNzaW9uVG9rZW46IHRoaXMuc2Vzc2lvblRva2VuXG4gICAgICB9LCBvcHRpb25zKSk7XG4gICAgICB0aGlzLmZpcmUoXCJyZXRyaWV2ZVwiLCByZXMpO1xuICAgICAgcmV0dXJuIHJlcztcbiAgICB9KTtcbiAgfVxuICBjYW5SZXRyaWV2ZShzdWdnZXN0aW9uKSB7XG4gICAgaWYgKCF0aGlzLnNlYXJjaC5jYW5SZXRyaWV2ZSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLnNlYXJjaC5jYW5SZXRyaWV2ZShzdWdnZXN0aW9uKTtcbiAgfVxuICBjYW5TdWdnZXN0KHN1Z2dlc3Rpb24pIHtcbiAgICBpZiAoIXRoaXMuc2VhcmNoLmNhblN1Z2dlc3QpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5zZWFyY2guY2FuU3VnZ2VzdChzdWdnZXN0aW9uKTtcbiAgfVxuICBhYm9ydCgpIHtcbiAgICBfX3ByaXZhdGVHZXQodGhpcywgX2Fib3J0KS5hYm9ydCgpO1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfYWJvcnQsIGNyZWF0ZUFib3J0Q29udHJvbGxlcigpKTtcbiAgfVxufTtcbl9zdWdnZXN0aW9ucyA9IG5ldyBXZWFrTWFwKCk7XG5fYWJvcnQgPSBuZXcgV2Vha01hcCgpO1xuX3N1Z2dlc3REZWJvdW5jZSA9IG5ldyBXZWFrTWFwKCk7XG5cbi8vIHNyYy9mZWF0dXJlVG9TdWdnZXN0aW9uLnRzXG5mdW5jdGlvbiBmZWF0dXJlVG9TdWdnZXN0aW9uKGZlYXR1cmUpIHtcbiAgY29uc3QgeyBwcm9wZXJ0aWVzIH0gPSBmZWF0dXJlO1xuICByZXR1cm4gX19zcHJlYWRWYWx1ZXMoe30sIHByb3BlcnRpZXMpO1xufVxuZXhwb3J0IHtcbiAgQWRkcmVzc0F1dG9maWxsQ29yZSxcbiAgRXZlbnRlZCxcbiAgR2VvY29kaW5nQ29yZSxcbiAgTG5nTGF0LFxuICBMbmdMYXRCb3VuZHMsXG4gIEFkZHJlc3NBdXRvZmlsbENvcmUgYXMgTWFwYm94QXV0b2ZpbGwsXG4gIE1hcGJveEVycm9yLFxuICBHZW9jb2RpbmdDb3JlIGFzIE1hcGJveEdlb2NvZGUsXG4gIFZhbGlkYXRpb25Db3JlIGFzIE1hcGJveFZhbGlkYXRlLFxuICBNYXRjaENvZGVDb25maWRlbmNlLFxuICBNYXRjaENvZGVUeXBlLFxuICBTZWFyY2hCb3hDb3JlLFxuICBTZWFyY2hTZXNzaW9uLFxuICBTZXNzaW9uVG9rZW4sXG4gIFZhbGlkYXRpb25Db3JlLFxuICBkZWJvdW5jZSxcbiAgZmVhdHVyZVRvU3VnZ2VzdGlvbixcbiAgcG9seWZpbGxGZXRjaFxufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LWVzbS5qcy5tYXBcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@mapbox/search-js-core/dist/index-esm.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@mapbox/search-js-react/dist/index-esm.js":
/*!****************************************************************!*\
  !*** ./node_modules/@mapbox/search-js-react/dist/index-esm.js ***!
  \****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AddressAutofill: () => (/* binding */ AddressAutofill),\n/* harmony export */   AddressMinimap: () => (/* binding */ AddressMinimap),\n/* harmony export */   Geocoder: () => (/* binding */ Geocoder),\n/* harmony export */   SearchBox: () => (/* binding */ SearchBox),\n/* harmony export */   config: () => (/* reexport safe */ _mapbox_search_js_web__WEBPACK_IMPORTED_MODULE_0__.config),\n/* harmony export */   useAddressAutofillCore: () => (/* binding */ useAddressAutofillCore),\n/* harmony export */   useConfirmAddress: () => (/* binding */ useConfirmAddress),\n/* harmony export */   useEvented: () => (/* binding */ useEvented),\n/* harmony export */   useGeocodingCore: () => (/* binding */ useGeocodingCore),\n/* harmony export */   useMapboxAutofill: () => (/* binding */ useAddressAutofillCore),\n/* harmony export */   useSearchBoxCore: () => (/* binding */ useSearchBoxCore),\n/* harmony export */   useSearchSession: () => (/* binding */ useSearchSession)\n/* harmony export */ });\n/* harmony import */ var _mapbox_search_js_web__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @mapbox/search-js-web */ \"(ssr)/./node_modules/@mapbox/search-js-web/dist/index-esm.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"(ssr)/./node_modules/next/dist/server/future/route-modules/app-page/vendored/ssr/react.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _mapbox_search_js_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @mapbox/search-js-core */ \"(ssr)/./node_modules/@mapbox/search-js-core/dist/index-esm.js\");\nvar __defProp = Object.defineProperty;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __objRest = (source, exclude) => {\n  var target = {};\n  for (var prop in source)\n    if (__hasOwnProp.call(source, prop) && exclude.indexOf(prop) < 0)\n      target[prop] = source[prop];\n  if (source != null && __getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(source)) {\n      if (exclude.indexOf(prop) < 0 && __propIsEnum.call(source, prop))\n        target[prop] = source[prop];\n    }\n  return target;\n};\n\n// src/index.ts\n\n\n\n// src/components/AddressAutofill.tsx\n\nvar AddressAutofill = react__WEBPACK_IMPORTED_MODULE_1___default().forwardRef((props, refProp) => {\n  const {\n    accessToken,\n    options,\n    theme,\n    popoverOptions,\n    confirmOnBrowserAutofill,\n    browserAutofillEnabled,\n    children,\n    onChange,\n    onSuggest,\n    onSuggestError,\n    onRetrieve,\n    interceptSearch\n  } = props;\n  const ref = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)();\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useImperativeHandle)(refProp, () => ({\n    focus: () => {\n      if (ref.current)\n        return ref.current.focus();\n      throw new Error(\"AddressAutofill is not mounted\");\n    }\n  }));\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (ref.current)\n      ref.current.options = options;\n  }, [ref.current, options]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (ref.current)\n      ref.current.interceptSearch = interceptSearch;\n  }, [ref.current, options]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (ref.current)\n      ref.current.theme = theme;\n  }, [ref.current, theme]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (ref.current)\n      ref.current.popoverOptions = popoverOptions;\n  }, [ref.current, popoverOptions]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (ref.current)\n      ref.current.confirmOnBrowserAutofill = confirmOnBrowserAutofill;\n  }, [ref.current, confirmOnBrowserAutofill]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (ref.current)\n      ref.current.browserAutofillEnabled = browserAutofillEnabled;\n  }, [ref.current, browserAutofillEnabled]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    const node = ref.current;\n    if (!node)\n      return;\n    if (!onSuggest)\n      return;\n    const fn = (e) => onSuggest(e.detail);\n    node.addEventListener(\"suggest\", fn);\n    return () => {\n      node.removeEventListener(\"suggest\", fn);\n    };\n  }, [ref.current, onSuggest]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    const node = ref.current;\n    if (!node)\n      return;\n    if (!onSuggestError)\n      return;\n    const fn = (e) => onSuggestError(e.detail);\n    node.addEventListener(\"suggesterror\", fn);\n    return () => {\n      node.removeEventListener(\"suggesterror\", fn);\n    };\n  }, [ref.current, onSuggestError]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    const node = ref.current;\n    if (!node)\n      return;\n    if (!onRetrieve)\n      return;\n    const fn = (e) => onRetrieve(e.detail);\n    node.addEventListener(\"retrieve\", fn);\n    return () => {\n      node.removeEventListener(\"retrieve\", fn);\n    };\n  }, [ref.current, onRetrieve]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    const node = ref.current;\n    if (!node)\n      return;\n    if (!onChange)\n      return;\n    const fn = (e) => {\n      if (e.target !== e.currentTarget)\n        return;\n      onChange(e.detail);\n    };\n    node.addEventListener(\"input\", fn);\n    return () => {\n      node.removeEventListener(\"input\", fn);\n    };\n  }, [ref.current, onChange]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (ref.current)\n      ref.current.accessToken = accessToken;\n  }, [ref.current, accessToken]);\n  return /* @__PURE__ */ react__WEBPACK_IMPORTED_MODULE_1___default().createElement(\"mapbox-address-autofill\", {\n    ref\n  }, children);\n});\n\n// src/components/SearchBox.tsx\n\nvar SearchBox = react__WEBPACK_IMPORTED_MODULE_1___default().forwardRef((props, refProp) => {\n  const {\n    accessToken,\n    options,\n    theme,\n    popoverOptions,\n    placeholder,\n    map,\n    marker,\n    mapboxgl,\n    value,\n    onChange,\n    onSuggest,\n    onSuggestError,\n    onRetrieve,\n    onClear,\n    interceptSearch\n  } = props;\n  const ref = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)();\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useImperativeHandle)(refProp, () => ({\n    focus: () => {\n      if (ref.current)\n        return ref.current.focus();\n      throw new Error(\"SearchBox is not mounted\");\n    },\n    search: (text) => {\n      if (ref.current)\n        return ref.current.search(text);\n      throw new Error(\"SearchBox is not mounted\");\n    }\n  }));\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (ref.current)\n      ref.current.options = options || {};\n  }, [ref.current, options]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (ref.current)\n      ref.current.interceptSearch = interceptSearch;\n  }, [ref.current, interceptSearch]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (ref.current)\n      ref.current.theme = theme;\n  }, [ref.current, theme]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (ref.current)\n      ref.current.popoverOptions = popoverOptions;\n  }, [ref.current, popoverOptions]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (ref.current)\n      ref.current.placeholder = placeholder;\n  }, [ref.current, placeholder]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (ref.current)\n      ref.current.value = value || \"\";\n  }, [ref.current, value]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    const node = ref.current;\n    if (!node)\n      return;\n    node.bindMap(map);\n    return () => {\n      node.unbindMap();\n    };\n  }, [ref.current, map]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (ref.current)\n      ref.current.marker = marker;\n  }, [ref.current, marker]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (ref.current)\n      ref.current.mapboxgl = mapboxgl;\n  }, [ref.current, mapboxgl]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    const node = ref.current;\n    if (!node)\n      return;\n    if (!onSuggest)\n      return;\n    const fn = (e) => onSuggest(e.detail);\n    node.addEventListener(\"suggest\", fn);\n    return () => {\n      node.removeEventListener(\"suggest\", fn);\n    };\n  }, [ref.current, onSuggest]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    const node = ref.current;\n    if (!node)\n      return;\n    if (!onSuggestError)\n      return;\n    const fn = (e) => onSuggestError(e.detail);\n    node.addEventListener(\"suggesterror\", fn);\n    return () => {\n      node.removeEventListener(\"suggesterror\", fn);\n    };\n  }, [ref.current, onSuggestError]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    const node = ref.current;\n    if (!node)\n      return;\n    if (!onRetrieve)\n      return;\n    const fn = (e) => onRetrieve(e.detail);\n    node.addEventListener(\"retrieve\", fn);\n    return () => {\n      node.removeEventListener(\"retrieve\", fn);\n    };\n  }, [ref.current, onRetrieve]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    const node = ref.current;\n    if (!node)\n      return;\n    if (!onChange)\n      return;\n    const fn = (e) => {\n      if (e.target !== e.currentTarget)\n        return;\n      onChange(e.detail);\n    };\n    node.addEventListener(\"input\", fn);\n    return () => {\n      node.removeEventListener(\"input\", fn);\n    };\n  }, [ref.current, onChange]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    const node = ref.current;\n    if (!node)\n      return;\n    if (!onClear)\n      return;\n    const fn = () => {\n      onClear();\n    };\n    node.addEventListener(\"clear\", fn);\n    return () => {\n      node.removeEventListener(\"clear\", fn);\n    };\n  }, [ref.current, onClear]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (ref.current)\n      ref.current.accessToken = accessToken;\n  }, [ref.current, accessToken]);\n  return /* @__PURE__ */ react__WEBPACK_IMPORTED_MODULE_1___default().createElement(\"mapbox-search-box\", {\n    ref\n  });\n});\n\n// src/components/Geocoder.tsx\n\nvar Geocoder = react__WEBPACK_IMPORTED_MODULE_1___default().forwardRef((props, refProp) => {\n  const {\n    accessToken,\n    options,\n    theme,\n    popoverOptions,\n    placeholder,\n    map,\n    marker,\n    mapboxgl,\n    value,\n    onChange,\n    onSuggest,\n    onSuggestError,\n    onRetrieve,\n    onClear,\n    interceptSearch\n  } = props;\n  const ref = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)();\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useImperativeHandle)(refProp, () => ({\n    focus: () => {\n      if (ref.current)\n        return ref.current.focus();\n      throw new Error(\"Geocoder is not mounted\");\n    },\n    search: (text) => {\n      if (ref.current)\n        return ref.current.search(text);\n      throw new Error(\"Geocoder is not mounted\");\n    }\n  }));\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (ref.current)\n      ref.current.options = options || {};\n  }, [ref.current, options]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (ref.current)\n      ref.current.interceptSearch = interceptSearch;\n  }, [ref.current, interceptSearch]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (ref.current)\n      ref.current.theme = theme;\n  }, [ref.current, theme]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (ref.current)\n      ref.current.popoverOptions = popoverOptions;\n  }, [ref.current, popoverOptions]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (ref.current)\n      ref.current.placeholder = placeholder;\n  }, [ref.current, placeholder]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (ref.current)\n      ref.current.value = value || \"\";\n  }, [ref.current, value]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    const node = ref.current;\n    if (!node)\n      return;\n    node.bindMap(map);\n    return () => {\n      node.unbindMap();\n    };\n  }, [ref.current, map]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (ref.current)\n      ref.current.marker = marker;\n  }, [ref.current, marker]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (ref.current)\n      ref.current.mapboxgl = mapboxgl;\n  }, [ref.current, mapboxgl]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    const node = ref.current;\n    if (!node)\n      return;\n    if (!onSuggest)\n      return;\n    const fn = (e) => onSuggest(e.detail);\n    node.addEventListener(\"suggest\", fn);\n    return () => {\n      node.removeEventListener(\"suggest\", fn);\n    };\n  }, [ref.current, onSuggest]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    const node = ref.current;\n    if (!node)\n      return;\n    if (!onSuggestError)\n      return;\n    const fn = (e) => onSuggestError(e.detail);\n    node.addEventListener(\"suggesterror\", fn);\n    return () => {\n      node.removeEventListener(\"suggesterror\", fn);\n    };\n  }, [ref.current, onSuggestError]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    const node = ref.current;\n    if (!node)\n      return;\n    if (!onRetrieve)\n      return;\n    const fn = (e) => onRetrieve(e.detail);\n    node.addEventListener(\"retrieve\", fn);\n    return () => {\n      node.removeEventListener(\"retrieve\", fn);\n    };\n  }, [ref.current, onRetrieve]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    const node = ref.current;\n    if (!node)\n      return;\n    if (!onChange)\n      return;\n    const fn = (e) => {\n      if (e.target !== e.currentTarget)\n        return;\n      onChange(e.detail);\n    };\n    node.addEventListener(\"input\", fn);\n    return () => {\n      node.removeEventListener(\"input\", fn);\n    };\n  }, [ref.current, onChange]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    const node = ref.current;\n    if (!node)\n      return;\n    if (!onClear)\n      return;\n    const fn = () => {\n      onClear();\n    };\n    node.addEventListener(\"clear\", fn);\n    return () => {\n      node.removeEventListener(\"clear\", fn);\n    };\n  }, [ref.current, onClear]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (ref.current)\n      ref.current.accessToken = accessToken;\n  }, [ref.current, accessToken]);\n  return /* @__PURE__ */ react__WEBPACK_IMPORTED_MODULE_1___default().createElement(\"mapbox-geocoder\", {\n    ref\n  });\n});\n\n// src/components/AddressMinimap.tsx\n\nfunction AddressMinimap(props) {\n  const {\n    canAdjustMarker = false,\n    keepMarkerCentered = false,\n    markerAnchor = \"bottom\",\n    onSaveMarkerLocation,\n    show = false,\n    accessToken,\n    feature = null,\n    adjustBtnText,\n    saveBtnText,\n    cancelBtnText,\n    satelliteToggle = false,\n    theme,\n    mapStyleMode = \"default\",\n    defaultMapStyle = [\"mapbox\", \"streets-v11\"],\n    footer\n  } = props;\n  const ref = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)();\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (!ref.current)\n      return;\n    if (show) {\n      ref.current.show();\n    } else {\n      ref.current.hide();\n    }\n  }, [ref.current, show]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (ref.current)\n      ref.current.theme = theme;\n  }, [ref.current, theme]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (ref.current)\n      ref.current.feature = show ? feature : null;\n  }, [ref.current, feature, show]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (ref.current)\n      ref.current.mapStyleMode = mapStyleMode;\n  }, [ref.current, mapStyleMode]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (adjustBtnText === void 0)\n      return;\n    if (ref.current)\n      ref.current.adjustBtnText = adjustBtnText;\n  }, [ref.current, adjustBtnText]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (saveBtnText === void 0)\n      return;\n    if (ref.current)\n      ref.current.saveBtnText = saveBtnText;\n  }, [ref.current, saveBtnText]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (cancelBtnText === void 0)\n      return;\n    if (ref.current)\n      ref.current.cancelBtnText = cancelBtnText;\n  }, [ref.current, cancelBtnText]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (ref.current)\n      ref.current.defaultMapStyle = defaultMapStyle;\n  }, [ref.current, defaultMapStyle]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (footer === void 0)\n      return;\n    if (ref.current)\n      ref.current.footer = footer;\n  }, [ref.current, footer]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (ref.current)\n      ref.current.accessToken = accessToken;\n  }, [ref.current, accessToken]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (ref.current)\n      ref.current.onSaveMarkerLocation = onSaveMarkerLocation;\n  }, [ref.current, onSaveMarkerLocation]);\n  return /* @__PURE__ */ react__WEBPACK_IMPORTED_MODULE_1___default().createElement(\"mapbox-address-minimap\", {\n    ref,\n    \"can-adjust-marker\": canAdjustMarker,\n    \"keep-marker-centered\": keepMarkerCentered,\n    \"marker-anchor\": markerAnchor,\n    \"satellite-toggle\": satelliteToggle\n  });\n}\n\n// src/hooks/useEvented.tsx\n\nfunction useEvented(evented, eventName, cb) {\n  const cbRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(cb);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    cbRef.current = cb;\n  });\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (!evented)\n      return;\n    const fn = (object) => cbRef.current(object);\n    evented.addEventListener(eventName, fn);\n    return () => {\n      evented.removeEventListener(eventName, fn);\n    };\n  }, [evented, eventName, cbRef]);\n}\n\n// src/hooks/useAddressAutofillCore.tsx\n\n\nvar DEFAULTS = _mapbox_search_js_core__WEBPACK_IMPORTED_MODULE_2__.AddressAutofillCore.defaults;\nfunction useAddressAutofillCore(options) {\n  const autofill = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(() => {\n    return new _mapbox_search_js_core__WEBPACK_IMPORTED_MODULE_2__.AddressAutofillCore();\n  }, []);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    const _a = options, { accessToken } = _a, restOptions = __objRest(_a, [\"accessToken\"]);\n    autofill.accessToken = accessToken;\n    autofill.defaults = __spreadValues(__spreadValues({}, DEFAULTS), restOptions);\n  }, [options]);\n  return autofill;\n}\n\n// src/hooks/useSearchBoxCore.tsx\n\n\nvar DEFAULTS2 = _mapbox_search_js_core__WEBPACK_IMPORTED_MODULE_2__.SearchBoxCore.defaults;\nfunction useSearchBoxCore(options) {\n  const search = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(() => {\n    return new _mapbox_search_js_core__WEBPACK_IMPORTED_MODULE_2__.SearchBoxCore();\n  }, []);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    const _a = options, { accessToken } = _a, restOptions = __objRest(_a, [\"accessToken\"]);\n    search.accessToken = accessToken;\n    search.defaults = __spreadValues(__spreadValues({}, DEFAULTS2), restOptions);\n  }, [options]);\n  return search;\n}\n\n// src/hooks/useGeocodingCore.tsx\n\n\nfunction useGeocodingCore(options) {\n  const search = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(() => {\n    return new _mapbox_search_js_core__WEBPACK_IMPORTED_MODULE_2__.GeocodingCore();\n  }, []);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    const _a = options, { accessToken } = _a, restOptions = __objRest(_a, [\"accessToken\"]);\n    search.accessToken = accessToken;\n    search.defaults = __spreadValues({}, restOptions);\n  }, [options]);\n  return search;\n}\n\n// src/hooks/useSearchSession.tsx\n\n\nfunction useSearchSession(search) {\n  const searchSession = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(() => {\n    return new _mapbox_search_js_core__WEBPACK_IMPORTED_MODULE_2__.SearchSession(search);\n  }, [search]);\n  if (search instanceof _mapbox_search_js_core__WEBPACK_IMPORTED_MODULE_2__.SearchBoxCore) {\n    return searchSession;\n  } else if (search instanceof _mapbox_search_js_core__WEBPACK_IMPORTED_MODULE_2__.GeocodingCore) {\n    return searchSession;\n  } else {\n    return searchSession;\n  }\n}\n\n// src/hooks/useConfirmAddress.tsx\n\n\nfunction useConfirmAddress(optionsArg = {}) {\n  const formRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n  return (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(() => {\n    return {\n      formRef,\n      showConfirm: () => (0,_mapbox_search_js_web__WEBPACK_IMPORTED_MODULE_0__.confirmAddress)(formRef.current, optionsArg)\n    };\n  }, [formRef, optionsArg]);\n}\n\n//# sourceMappingURL=index-esm.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQG1hcGJveC9zZWFyY2gtanMtcmVhY3QvZGlzdC9pbmRleC1lc20uanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEVBQThFLDZEQUE2RDtBQUMzSTtBQUNBLCtCQUErQjtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDK0I7QUFDZ0I7O0FBRS9DO0FBQ3NFO0FBQ3RFLHNCQUFzQix1REFBZ0I7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0osY0FBYyw2Q0FBTTtBQUNwQixFQUFFLDBEQUFtQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUUsZ0RBQVM7QUFDWDtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUUsZ0RBQVM7QUFDWDtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUUsZ0RBQVM7QUFDWDtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUUsZ0RBQVM7QUFDWDtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUUsZ0RBQVM7QUFDWDtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUUsZ0RBQVM7QUFDWDtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUUsZ0RBQVM7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxFQUFFLGdEQUFTO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsRUFBRSxnREFBUztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUUsZ0RBQVM7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUUsZ0RBQVM7QUFDWDtBQUNBO0FBQ0EsR0FBRztBQUNILHlCQUF5QiwwREFBbUI7QUFDNUM7QUFDQSxHQUFHO0FBQ0gsQ0FBQzs7QUFFRDtBQUN3SDtBQUN4SCxnQkFBZ0IsdURBQWlCO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKLGNBQWMsNkNBQU87QUFDckIsRUFBRSwwREFBb0I7QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxFQUFFLGdEQUFVO0FBQ1o7QUFDQTtBQUNBLEdBQUc7QUFDSCxFQUFFLGdEQUFVO0FBQ1o7QUFDQTtBQUNBLEdBQUc7QUFDSCxFQUFFLGdEQUFVO0FBQ1o7QUFDQTtBQUNBLEdBQUc7QUFDSCxFQUFFLGdEQUFVO0FBQ1o7QUFDQTtBQUNBLEdBQUc7QUFDSCxFQUFFLGdEQUFVO0FBQ1o7QUFDQTtBQUNBLEdBQUc7QUFDSCxFQUFFLGdEQUFVO0FBQ1o7QUFDQTtBQUNBLEdBQUc7QUFDSCxFQUFFLGdEQUFVO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsRUFBRSxnREFBVTtBQUNaO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsRUFBRSxnREFBVTtBQUNaO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsRUFBRSxnREFBVTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUUsZ0RBQVU7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxFQUFFLGdEQUFVO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsRUFBRSxnREFBVTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsRUFBRSxnREFBVTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxFQUFFLGdEQUFVO0FBQ1o7QUFDQTtBQUNBLEdBQUc7QUFDSCx5QkFBeUIsMERBQW9CO0FBQzdDO0FBQ0EsR0FBRztBQUNILENBQUM7O0FBRUQ7QUFDd0g7QUFDeEgsZUFBZSx1REFBaUI7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0osY0FBYyw2Q0FBTztBQUNyQixFQUFFLDBEQUFvQjtBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUUsZ0RBQVU7QUFDWjtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUUsZ0RBQVU7QUFDWjtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUUsZ0RBQVU7QUFDWjtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUUsZ0RBQVU7QUFDWjtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUUsZ0RBQVU7QUFDWjtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUUsZ0RBQVU7QUFDWjtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUUsZ0RBQVU7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxFQUFFLGdEQUFVO0FBQ1o7QUFDQTtBQUNBLEdBQUc7QUFDSCxFQUFFLGdEQUFVO0FBQ1o7QUFDQTtBQUNBLEdBQUc7QUFDSCxFQUFFLGdEQUFVO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsRUFBRSxnREFBVTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUUsZ0RBQVU7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxFQUFFLGdEQUFVO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxFQUFFLGdEQUFVO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUUsZ0RBQVU7QUFDWjtBQUNBO0FBQ0EsR0FBRztBQUNILHlCQUF5QiwwREFBb0I7QUFDN0M7QUFDQSxHQUFHO0FBQ0gsQ0FBQzs7QUFFRDtBQUMyRTtBQUMzRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKLGNBQWMsNkNBQU87QUFDckIsRUFBRSxnREFBVTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsRUFBRSxnREFBVTtBQUNaO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsRUFBRSxnREFBVTtBQUNaO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsRUFBRSxnREFBVTtBQUNaO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsRUFBRSxnREFBVTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUUsZ0RBQVU7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxFQUFFLGdEQUFVO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsRUFBRSxnREFBVTtBQUNaO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsRUFBRSxnREFBVTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUUsZ0RBQVU7QUFDWjtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUUsZ0RBQVU7QUFDWjtBQUNBO0FBQ0EsR0FBRztBQUNILHlCQUF5QiwwREFBb0I7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNtRTtBQUNuRTtBQUNBLGdCQUFnQiw2Q0FBTztBQUN2QixFQUFFLGdEQUFVO0FBQ1o7QUFDQSxHQUFHO0FBQ0gsRUFBRSxnREFBVTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ3lEO0FBR3pCO0FBQ2hDLGVBQWUsdUVBQW1CO0FBQ2xDO0FBQ0EsbUJBQW1CLDhDQUFPO0FBQzFCLGVBQWUsdUVBQW1CO0FBQ2xDLEdBQUc7QUFDSCxFQUFFLGdEQUFVO0FBQ1osMEJBQTBCLGNBQWM7QUFDeEM7QUFDQSx3REFBd0Q7QUFDeEQsR0FBRztBQUNIO0FBQ0E7O0FBRUE7QUFDcUU7QUFDZDtBQUN2RCxnQkFBZ0IsaUVBQWE7QUFDN0I7QUFDQSxpQkFBaUIsOENBQVE7QUFDekIsZUFBZSxpRUFBYTtBQUM1QixHQUFHO0FBQ0gsRUFBRSxnREFBVTtBQUNaLDBCQUEwQixjQUFjO0FBQ3hDO0FBQ0Esc0RBQXNEO0FBQ3RELEdBQUc7QUFDSDtBQUNBOztBQUVBO0FBQ3FFO0FBQ2Q7QUFDdkQ7QUFDQSxpQkFBaUIsOENBQVE7QUFDekIsZUFBZSxpRUFBYTtBQUM1QixHQUFHO0FBQ0gsRUFBRSxnREFBVTtBQUNaLDBCQUEwQixjQUFjO0FBQ3hDO0FBQ0EsdUNBQXVDO0FBQ3ZDLEdBQUc7QUFDSDtBQUNBOztBQUVBO0FBS2dDO0FBQ1k7QUFDNUM7QUFDQSx3QkFBd0IsOENBQVE7QUFDaEMsZUFBZSxpRUFBYTtBQUM1QixHQUFHO0FBQ0gsd0JBQXdCLGlFQUFjO0FBQ3RDO0FBQ0EsSUFBSSwyQkFBMkIsaUVBQWM7QUFDN0M7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBOztBQUVBO0FBQytEO0FBR2hDO0FBQy9CLDBDQUEwQztBQUMxQyxrQkFBa0IsNkNBQU87QUFDekIsU0FBUyw4Q0FBUTtBQUNqQjtBQUNBO0FBQ0EseUJBQXlCLHFFQUFjO0FBQ3ZDO0FBQ0EsR0FBRztBQUNIO0FBY0U7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3JvdXRlLXBsYW5uZXIvLi9ub2RlX21vZHVsZXMvQG1hcGJveC9zZWFyY2gtanMtcmVhY3QvZGlzdC9pbmRleC1lc20uanM/YmQyNyJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgX19kZWZQcm9wID0gT2JqZWN0LmRlZmluZVByb3BlcnR5O1xudmFyIF9fZ2V0T3duUHJvcFN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzO1xudmFyIF9faGFzT3duUHJvcCA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7XG52YXIgX19wcm9wSXNFbnVtID0gT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZTtcbnZhciBfX2RlZk5vcm1hbFByb3AgPSAob2JqLCBrZXksIHZhbHVlKSA9PiBrZXkgaW4gb2JqID8gX19kZWZQcm9wKG9iaiwga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSwgd3JpdGFibGU6IHRydWUsIHZhbHVlIH0pIDogb2JqW2tleV0gPSB2YWx1ZTtcbnZhciBfX3NwcmVhZFZhbHVlcyA9IChhLCBiKSA9PiB7XG4gIGZvciAodmFyIHByb3AgaW4gYiB8fCAoYiA9IHt9KSlcbiAgICBpZiAoX19oYXNPd25Qcm9wLmNhbGwoYiwgcHJvcCkpXG4gICAgICBfX2RlZk5vcm1hbFByb3AoYSwgcHJvcCwgYltwcm9wXSk7XG4gIGlmIChfX2dldE93blByb3BTeW1ib2xzKVxuICAgIGZvciAodmFyIHByb3Agb2YgX19nZXRPd25Qcm9wU3ltYm9scyhiKSkge1xuICAgICAgaWYgKF9fcHJvcElzRW51bS5jYWxsKGIsIHByb3ApKVxuICAgICAgICBfX2RlZk5vcm1hbFByb3AoYSwgcHJvcCwgYltwcm9wXSk7XG4gICAgfVxuICByZXR1cm4gYTtcbn07XG52YXIgX19vYmpSZXN0ID0gKHNvdXJjZSwgZXhjbHVkZSkgPT4ge1xuICB2YXIgdGFyZ2V0ID0ge307XG4gIGZvciAodmFyIHByb3AgaW4gc291cmNlKVxuICAgIGlmIChfX2hhc093blByb3AuY2FsbChzb3VyY2UsIHByb3ApICYmIGV4Y2x1ZGUuaW5kZXhPZihwcm9wKSA8IDApXG4gICAgICB0YXJnZXRbcHJvcF0gPSBzb3VyY2VbcHJvcF07XG4gIGlmIChzb3VyY2UgIT0gbnVsbCAmJiBfX2dldE93blByb3BTeW1ib2xzKVxuICAgIGZvciAodmFyIHByb3Agb2YgX19nZXRPd25Qcm9wU3ltYm9scyhzb3VyY2UpKSB7XG4gICAgICBpZiAoZXhjbHVkZS5pbmRleE9mKHByb3ApIDwgMCAmJiBfX3Byb3BJc0VudW0uY2FsbChzb3VyY2UsIHByb3ApKVxuICAgICAgICB0YXJnZXRbcHJvcF0gPSBzb3VyY2VbcHJvcF07XG4gICAgfVxuICByZXR1cm4gdGFyZ2V0O1xufTtcblxuLy8gc3JjL2luZGV4LnRzXG5pbXBvcnQgXCJAbWFwYm94L3NlYXJjaC1qcy13ZWJcIjtcbmltcG9ydCB7IGNvbmZpZyB9IGZyb20gXCJAbWFwYm94L3NlYXJjaC1qcy13ZWJcIjtcblxuLy8gc3JjL2NvbXBvbmVudHMvQWRkcmVzc0F1dG9maWxsLnRzeFxuaW1wb3J0IFJlYWN0LCB7IHVzZVJlZiwgdXNlRWZmZWN0LCB1c2VJbXBlcmF0aXZlSGFuZGxlIH0gZnJvbSBcInJlYWN0XCI7XG52YXIgQWRkcmVzc0F1dG9maWxsID0gUmVhY3QuZm9yd2FyZFJlZigocHJvcHMsIHJlZlByb3ApID0+IHtcbiAgY29uc3Qge1xuICAgIGFjY2Vzc1Rva2VuLFxuICAgIG9wdGlvbnMsXG4gICAgdGhlbWUsXG4gICAgcG9wb3Zlck9wdGlvbnMsXG4gICAgY29uZmlybU9uQnJvd3NlckF1dG9maWxsLFxuICAgIGJyb3dzZXJBdXRvZmlsbEVuYWJsZWQsXG4gICAgY2hpbGRyZW4sXG4gICAgb25DaGFuZ2UsXG4gICAgb25TdWdnZXN0LFxuICAgIG9uU3VnZ2VzdEVycm9yLFxuICAgIG9uUmV0cmlldmUsXG4gICAgaW50ZXJjZXB0U2VhcmNoXG4gIH0gPSBwcm9wcztcbiAgY29uc3QgcmVmID0gdXNlUmVmKCk7XG4gIHVzZUltcGVyYXRpdmVIYW5kbGUocmVmUHJvcCwgKCkgPT4gKHtcbiAgICBmb2N1czogKCkgPT4ge1xuICAgICAgaWYgKHJlZi5jdXJyZW50KVxuICAgICAgICByZXR1cm4gcmVmLmN1cnJlbnQuZm9jdXMoKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkFkZHJlc3NBdXRvZmlsbCBpcyBub3QgbW91bnRlZFwiKTtcbiAgICB9XG4gIH0pKTtcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAocmVmLmN1cnJlbnQpXG4gICAgICByZWYuY3VycmVudC5vcHRpb25zID0gb3B0aW9ucztcbiAgfSwgW3JlZi5jdXJyZW50LCBvcHRpb25zXSk7XG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKHJlZi5jdXJyZW50KVxuICAgICAgcmVmLmN1cnJlbnQuaW50ZXJjZXB0U2VhcmNoID0gaW50ZXJjZXB0U2VhcmNoO1xuICB9LCBbcmVmLmN1cnJlbnQsIG9wdGlvbnNdKTtcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAocmVmLmN1cnJlbnQpXG4gICAgICByZWYuY3VycmVudC50aGVtZSA9IHRoZW1lO1xuICB9LCBbcmVmLmN1cnJlbnQsIHRoZW1lXSk7XG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKHJlZi5jdXJyZW50KVxuICAgICAgcmVmLmN1cnJlbnQucG9wb3Zlck9wdGlvbnMgPSBwb3BvdmVyT3B0aW9ucztcbiAgfSwgW3JlZi5jdXJyZW50LCBwb3BvdmVyT3B0aW9uc10pO1xuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChyZWYuY3VycmVudClcbiAgICAgIHJlZi5jdXJyZW50LmNvbmZpcm1PbkJyb3dzZXJBdXRvZmlsbCA9IGNvbmZpcm1PbkJyb3dzZXJBdXRvZmlsbDtcbiAgfSwgW3JlZi5jdXJyZW50LCBjb25maXJtT25Ccm93c2VyQXV0b2ZpbGxdKTtcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAocmVmLmN1cnJlbnQpXG4gICAgICByZWYuY3VycmVudC5icm93c2VyQXV0b2ZpbGxFbmFibGVkID0gYnJvd3NlckF1dG9maWxsRW5hYmxlZDtcbiAgfSwgW3JlZi5jdXJyZW50LCBicm93c2VyQXV0b2ZpbGxFbmFibGVkXSk7XG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgY29uc3Qgbm9kZSA9IHJlZi5jdXJyZW50O1xuICAgIGlmICghbm9kZSlcbiAgICAgIHJldHVybjtcbiAgICBpZiAoIW9uU3VnZ2VzdClcbiAgICAgIHJldHVybjtcbiAgICBjb25zdCBmbiA9IChlKSA9PiBvblN1Z2dlc3QoZS5kZXRhaWwpO1xuICAgIG5vZGUuYWRkRXZlbnRMaXN0ZW5lcihcInN1Z2dlc3RcIiwgZm4pO1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBub2RlLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJzdWdnZXN0XCIsIGZuKTtcbiAgICB9O1xuICB9LCBbcmVmLmN1cnJlbnQsIG9uU3VnZ2VzdF0pO1xuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGNvbnN0IG5vZGUgPSByZWYuY3VycmVudDtcbiAgICBpZiAoIW5vZGUpXG4gICAgICByZXR1cm47XG4gICAgaWYgKCFvblN1Z2dlc3RFcnJvcilcbiAgICAgIHJldHVybjtcbiAgICBjb25zdCBmbiA9IChlKSA9PiBvblN1Z2dlc3RFcnJvcihlLmRldGFpbCk7XG4gICAgbm9kZS5hZGRFdmVudExpc3RlbmVyKFwic3VnZ2VzdGVycm9yXCIsIGZuKTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgbm9kZS5yZW1vdmVFdmVudExpc3RlbmVyKFwic3VnZ2VzdGVycm9yXCIsIGZuKTtcbiAgICB9O1xuICB9LCBbcmVmLmN1cnJlbnQsIG9uU3VnZ2VzdEVycm9yXSk7XG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgY29uc3Qgbm9kZSA9IHJlZi5jdXJyZW50O1xuICAgIGlmICghbm9kZSlcbiAgICAgIHJldHVybjtcbiAgICBpZiAoIW9uUmV0cmlldmUpXG4gICAgICByZXR1cm47XG4gICAgY29uc3QgZm4gPSAoZSkgPT4gb25SZXRyaWV2ZShlLmRldGFpbCk7XG4gICAgbm9kZS5hZGRFdmVudExpc3RlbmVyKFwicmV0cmlldmVcIiwgZm4pO1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBub2RlLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJyZXRyaWV2ZVwiLCBmbik7XG4gICAgfTtcbiAgfSwgW3JlZi5jdXJyZW50LCBvblJldHJpZXZlXSk7XG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgY29uc3Qgbm9kZSA9IHJlZi5jdXJyZW50O1xuICAgIGlmICghbm9kZSlcbiAgICAgIHJldHVybjtcbiAgICBpZiAoIW9uQ2hhbmdlKVxuICAgICAgcmV0dXJuO1xuICAgIGNvbnN0IGZuID0gKGUpID0+IHtcbiAgICAgIGlmIChlLnRhcmdldCAhPT0gZS5jdXJyZW50VGFyZ2V0KVxuICAgICAgICByZXR1cm47XG4gICAgICBvbkNoYW5nZShlLmRldGFpbCk7XG4gICAgfTtcbiAgICBub2RlLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCBmbik7XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIG5vZGUucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIGZuKTtcbiAgICB9O1xuICB9LCBbcmVmLmN1cnJlbnQsIG9uQ2hhbmdlXSk7XG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKHJlZi5jdXJyZW50KVxuICAgICAgcmVmLmN1cnJlbnQuYWNjZXNzVG9rZW4gPSBhY2Nlc3NUb2tlbjtcbiAgfSwgW3JlZi5jdXJyZW50LCBhY2Nlc3NUb2tlbl0pO1xuICByZXR1cm4gLyogQF9fUFVSRV9fICovIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXCJtYXBib3gtYWRkcmVzcy1hdXRvZmlsbFwiLCB7XG4gICAgcmVmXG4gIH0sIGNoaWxkcmVuKTtcbn0pO1xuXG4vLyBzcmMvY29tcG9uZW50cy9TZWFyY2hCb3gudHN4XG5pbXBvcnQgUmVhY3QyLCB7IHVzZVJlZiBhcyB1c2VSZWYyLCB1c2VFZmZlY3QgYXMgdXNlRWZmZWN0MiwgdXNlSW1wZXJhdGl2ZUhhbmRsZSBhcyB1c2VJbXBlcmF0aXZlSGFuZGxlMiB9IGZyb20gXCJyZWFjdFwiO1xudmFyIFNlYXJjaEJveCA9IFJlYWN0Mi5mb3J3YXJkUmVmKChwcm9wcywgcmVmUHJvcCkgPT4ge1xuICBjb25zdCB7XG4gICAgYWNjZXNzVG9rZW4sXG4gICAgb3B0aW9ucyxcbiAgICB0aGVtZSxcbiAgICBwb3BvdmVyT3B0aW9ucyxcbiAgICBwbGFjZWhvbGRlcixcbiAgICBtYXAsXG4gICAgbWFya2VyLFxuICAgIG1hcGJveGdsLFxuICAgIHZhbHVlLFxuICAgIG9uQ2hhbmdlLFxuICAgIG9uU3VnZ2VzdCxcbiAgICBvblN1Z2dlc3RFcnJvcixcbiAgICBvblJldHJpZXZlLFxuICAgIG9uQ2xlYXIsXG4gICAgaW50ZXJjZXB0U2VhcmNoXG4gIH0gPSBwcm9wcztcbiAgY29uc3QgcmVmID0gdXNlUmVmMigpO1xuICB1c2VJbXBlcmF0aXZlSGFuZGxlMihyZWZQcm9wLCAoKSA9PiAoe1xuICAgIGZvY3VzOiAoKSA9PiB7XG4gICAgICBpZiAocmVmLmN1cnJlbnQpXG4gICAgICAgIHJldHVybiByZWYuY3VycmVudC5mb2N1cygpO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiU2VhcmNoQm94IGlzIG5vdCBtb3VudGVkXCIpO1xuICAgIH0sXG4gICAgc2VhcmNoOiAodGV4dCkgPT4ge1xuICAgICAgaWYgKHJlZi5jdXJyZW50KVxuICAgICAgICByZXR1cm4gcmVmLmN1cnJlbnQuc2VhcmNoKHRleHQpO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiU2VhcmNoQm94IGlzIG5vdCBtb3VudGVkXCIpO1xuICAgIH1cbiAgfSkpO1xuICB1c2VFZmZlY3QyKCgpID0+IHtcbiAgICBpZiAocmVmLmN1cnJlbnQpXG4gICAgICByZWYuY3VycmVudC5vcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgfSwgW3JlZi5jdXJyZW50LCBvcHRpb25zXSk7XG4gIHVzZUVmZmVjdDIoKCkgPT4ge1xuICAgIGlmIChyZWYuY3VycmVudClcbiAgICAgIHJlZi5jdXJyZW50LmludGVyY2VwdFNlYXJjaCA9IGludGVyY2VwdFNlYXJjaDtcbiAgfSwgW3JlZi5jdXJyZW50LCBpbnRlcmNlcHRTZWFyY2hdKTtcbiAgdXNlRWZmZWN0MigoKSA9PiB7XG4gICAgaWYgKHJlZi5jdXJyZW50KVxuICAgICAgcmVmLmN1cnJlbnQudGhlbWUgPSB0aGVtZTtcbiAgfSwgW3JlZi5jdXJyZW50LCB0aGVtZV0pO1xuICB1c2VFZmZlY3QyKCgpID0+IHtcbiAgICBpZiAocmVmLmN1cnJlbnQpXG4gICAgICByZWYuY3VycmVudC5wb3BvdmVyT3B0aW9ucyA9IHBvcG92ZXJPcHRpb25zO1xuICB9LCBbcmVmLmN1cnJlbnQsIHBvcG92ZXJPcHRpb25zXSk7XG4gIHVzZUVmZmVjdDIoKCkgPT4ge1xuICAgIGlmIChyZWYuY3VycmVudClcbiAgICAgIHJlZi5jdXJyZW50LnBsYWNlaG9sZGVyID0gcGxhY2Vob2xkZXI7XG4gIH0sIFtyZWYuY3VycmVudCwgcGxhY2Vob2xkZXJdKTtcbiAgdXNlRWZmZWN0MigoKSA9PiB7XG4gICAgaWYgKHJlZi5jdXJyZW50KVxuICAgICAgcmVmLmN1cnJlbnQudmFsdWUgPSB2YWx1ZSB8fCBcIlwiO1xuICB9LCBbcmVmLmN1cnJlbnQsIHZhbHVlXSk7XG4gIHVzZUVmZmVjdDIoKCkgPT4ge1xuICAgIGNvbnN0IG5vZGUgPSByZWYuY3VycmVudDtcbiAgICBpZiAoIW5vZGUpXG4gICAgICByZXR1cm47XG4gICAgbm9kZS5iaW5kTWFwKG1hcCk7XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIG5vZGUudW5iaW5kTWFwKCk7XG4gICAgfTtcbiAgfSwgW3JlZi5jdXJyZW50LCBtYXBdKTtcbiAgdXNlRWZmZWN0MigoKSA9PiB7XG4gICAgaWYgKHJlZi5jdXJyZW50KVxuICAgICAgcmVmLmN1cnJlbnQubWFya2VyID0gbWFya2VyO1xuICB9LCBbcmVmLmN1cnJlbnQsIG1hcmtlcl0pO1xuICB1c2VFZmZlY3QyKCgpID0+IHtcbiAgICBpZiAocmVmLmN1cnJlbnQpXG4gICAgICByZWYuY3VycmVudC5tYXBib3hnbCA9IG1hcGJveGdsO1xuICB9LCBbcmVmLmN1cnJlbnQsIG1hcGJveGdsXSk7XG4gIHVzZUVmZmVjdDIoKCkgPT4ge1xuICAgIGNvbnN0IG5vZGUgPSByZWYuY3VycmVudDtcbiAgICBpZiAoIW5vZGUpXG4gICAgICByZXR1cm47XG4gICAgaWYgKCFvblN1Z2dlc3QpXG4gICAgICByZXR1cm47XG4gICAgY29uc3QgZm4gPSAoZSkgPT4gb25TdWdnZXN0KGUuZGV0YWlsKTtcbiAgICBub2RlLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWdnZXN0XCIsIGZuKTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgbm9kZS5yZW1vdmVFdmVudExpc3RlbmVyKFwic3VnZ2VzdFwiLCBmbik7XG4gICAgfTtcbiAgfSwgW3JlZi5jdXJyZW50LCBvblN1Z2dlc3RdKTtcbiAgdXNlRWZmZWN0MigoKSA9PiB7XG4gICAgY29uc3Qgbm9kZSA9IHJlZi5jdXJyZW50O1xuICAgIGlmICghbm9kZSlcbiAgICAgIHJldHVybjtcbiAgICBpZiAoIW9uU3VnZ2VzdEVycm9yKVxuICAgICAgcmV0dXJuO1xuICAgIGNvbnN0IGZuID0gKGUpID0+IG9uU3VnZ2VzdEVycm9yKGUuZGV0YWlsKTtcbiAgICBub2RlLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWdnZXN0ZXJyb3JcIiwgZm4pO1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBub2RlLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJzdWdnZXN0ZXJyb3JcIiwgZm4pO1xuICAgIH07XG4gIH0sIFtyZWYuY3VycmVudCwgb25TdWdnZXN0RXJyb3JdKTtcbiAgdXNlRWZmZWN0MigoKSA9PiB7XG4gICAgY29uc3Qgbm9kZSA9IHJlZi5jdXJyZW50O1xuICAgIGlmICghbm9kZSlcbiAgICAgIHJldHVybjtcbiAgICBpZiAoIW9uUmV0cmlldmUpXG4gICAgICByZXR1cm47XG4gICAgY29uc3QgZm4gPSAoZSkgPT4gb25SZXRyaWV2ZShlLmRldGFpbCk7XG4gICAgbm9kZS5hZGRFdmVudExpc3RlbmVyKFwicmV0cmlldmVcIiwgZm4pO1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBub2RlLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJyZXRyaWV2ZVwiLCBmbik7XG4gICAgfTtcbiAgfSwgW3JlZi5jdXJyZW50LCBvblJldHJpZXZlXSk7XG4gIHVzZUVmZmVjdDIoKCkgPT4ge1xuICAgIGNvbnN0IG5vZGUgPSByZWYuY3VycmVudDtcbiAgICBpZiAoIW5vZGUpXG4gICAgICByZXR1cm47XG4gICAgaWYgKCFvbkNoYW5nZSlcbiAgICAgIHJldHVybjtcbiAgICBjb25zdCBmbiA9IChlKSA9PiB7XG4gICAgICBpZiAoZS50YXJnZXQgIT09IGUuY3VycmVudFRhcmdldClcbiAgICAgICAgcmV0dXJuO1xuICAgICAgb25DaGFuZ2UoZS5kZXRhaWwpO1xuICAgIH07XG4gICAgbm9kZS5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgZm4pO1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBub2RlLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCBmbik7XG4gICAgfTtcbiAgfSwgW3JlZi5jdXJyZW50LCBvbkNoYW5nZV0pO1xuICB1c2VFZmZlY3QyKCgpID0+IHtcbiAgICBjb25zdCBub2RlID0gcmVmLmN1cnJlbnQ7XG4gICAgaWYgKCFub2RlKVxuICAgICAgcmV0dXJuO1xuICAgIGlmICghb25DbGVhcilcbiAgICAgIHJldHVybjtcbiAgICBjb25zdCBmbiA9ICgpID0+IHtcbiAgICAgIG9uQ2xlYXIoKTtcbiAgICB9O1xuICAgIG5vZGUuYWRkRXZlbnRMaXN0ZW5lcihcImNsZWFyXCIsIGZuKTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgbm9kZS5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xlYXJcIiwgZm4pO1xuICAgIH07XG4gIH0sIFtyZWYuY3VycmVudCwgb25DbGVhcl0pO1xuICB1c2VFZmZlY3QyKCgpID0+IHtcbiAgICBpZiAocmVmLmN1cnJlbnQpXG4gICAgICByZWYuY3VycmVudC5hY2Nlc3NUb2tlbiA9IGFjY2Vzc1Rva2VuO1xuICB9LCBbcmVmLmN1cnJlbnQsIGFjY2Vzc1Rva2VuXSk7XG4gIHJldHVybiAvKiBAX19QVVJFX18gKi8gUmVhY3QyLmNyZWF0ZUVsZW1lbnQoXCJtYXBib3gtc2VhcmNoLWJveFwiLCB7XG4gICAgcmVmXG4gIH0pO1xufSk7XG5cbi8vIHNyYy9jb21wb25lbnRzL0dlb2NvZGVyLnRzeFxuaW1wb3J0IFJlYWN0MywgeyB1c2VSZWYgYXMgdXNlUmVmMywgdXNlRWZmZWN0IGFzIHVzZUVmZmVjdDMsIHVzZUltcGVyYXRpdmVIYW5kbGUgYXMgdXNlSW1wZXJhdGl2ZUhhbmRsZTMgfSBmcm9tIFwicmVhY3RcIjtcbnZhciBHZW9jb2RlciA9IFJlYWN0My5mb3J3YXJkUmVmKChwcm9wcywgcmVmUHJvcCkgPT4ge1xuICBjb25zdCB7XG4gICAgYWNjZXNzVG9rZW4sXG4gICAgb3B0aW9ucyxcbiAgICB0aGVtZSxcbiAgICBwb3BvdmVyT3B0aW9ucyxcbiAgICBwbGFjZWhvbGRlcixcbiAgICBtYXAsXG4gICAgbWFya2VyLFxuICAgIG1hcGJveGdsLFxuICAgIHZhbHVlLFxuICAgIG9uQ2hhbmdlLFxuICAgIG9uU3VnZ2VzdCxcbiAgICBvblN1Z2dlc3RFcnJvcixcbiAgICBvblJldHJpZXZlLFxuICAgIG9uQ2xlYXIsXG4gICAgaW50ZXJjZXB0U2VhcmNoXG4gIH0gPSBwcm9wcztcbiAgY29uc3QgcmVmID0gdXNlUmVmMygpO1xuICB1c2VJbXBlcmF0aXZlSGFuZGxlMyhyZWZQcm9wLCAoKSA9PiAoe1xuICAgIGZvY3VzOiAoKSA9PiB7XG4gICAgICBpZiAocmVmLmN1cnJlbnQpXG4gICAgICAgIHJldHVybiByZWYuY3VycmVudC5mb2N1cygpO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiR2VvY29kZXIgaXMgbm90IG1vdW50ZWRcIik7XG4gICAgfSxcbiAgICBzZWFyY2g6ICh0ZXh0KSA9PiB7XG4gICAgICBpZiAocmVmLmN1cnJlbnQpXG4gICAgICAgIHJldHVybiByZWYuY3VycmVudC5zZWFyY2godGV4dCk7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJHZW9jb2RlciBpcyBub3QgbW91bnRlZFwiKTtcbiAgICB9XG4gIH0pKTtcbiAgdXNlRWZmZWN0MygoKSA9PiB7XG4gICAgaWYgKHJlZi5jdXJyZW50KVxuICAgICAgcmVmLmN1cnJlbnQub3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gIH0sIFtyZWYuY3VycmVudCwgb3B0aW9uc10pO1xuICB1c2VFZmZlY3QzKCgpID0+IHtcbiAgICBpZiAocmVmLmN1cnJlbnQpXG4gICAgICByZWYuY3VycmVudC5pbnRlcmNlcHRTZWFyY2ggPSBpbnRlcmNlcHRTZWFyY2g7XG4gIH0sIFtyZWYuY3VycmVudCwgaW50ZXJjZXB0U2VhcmNoXSk7XG4gIHVzZUVmZmVjdDMoKCkgPT4ge1xuICAgIGlmIChyZWYuY3VycmVudClcbiAgICAgIHJlZi5jdXJyZW50LnRoZW1lID0gdGhlbWU7XG4gIH0sIFtyZWYuY3VycmVudCwgdGhlbWVdKTtcbiAgdXNlRWZmZWN0MygoKSA9PiB7XG4gICAgaWYgKHJlZi5jdXJyZW50KVxuICAgICAgcmVmLmN1cnJlbnQucG9wb3Zlck9wdGlvbnMgPSBwb3BvdmVyT3B0aW9ucztcbiAgfSwgW3JlZi5jdXJyZW50LCBwb3BvdmVyT3B0aW9uc10pO1xuICB1c2VFZmZlY3QzKCgpID0+IHtcbiAgICBpZiAocmVmLmN1cnJlbnQpXG4gICAgICByZWYuY3VycmVudC5wbGFjZWhvbGRlciA9IHBsYWNlaG9sZGVyO1xuICB9LCBbcmVmLmN1cnJlbnQsIHBsYWNlaG9sZGVyXSk7XG4gIHVzZUVmZmVjdDMoKCkgPT4ge1xuICAgIGlmIChyZWYuY3VycmVudClcbiAgICAgIHJlZi5jdXJyZW50LnZhbHVlID0gdmFsdWUgfHwgXCJcIjtcbiAgfSwgW3JlZi5jdXJyZW50LCB2YWx1ZV0pO1xuICB1c2VFZmZlY3QzKCgpID0+IHtcbiAgICBjb25zdCBub2RlID0gcmVmLmN1cnJlbnQ7XG4gICAgaWYgKCFub2RlKVxuICAgICAgcmV0dXJuO1xuICAgIG5vZGUuYmluZE1hcChtYXApO1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBub2RlLnVuYmluZE1hcCgpO1xuICAgIH07XG4gIH0sIFtyZWYuY3VycmVudCwgbWFwXSk7XG4gIHVzZUVmZmVjdDMoKCkgPT4ge1xuICAgIGlmIChyZWYuY3VycmVudClcbiAgICAgIHJlZi5jdXJyZW50Lm1hcmtlciA9IG1hcmtlcjtcbiAgfSwgW3JlZi5jdXJyZW50LCBtYXJrZXJdKTtcbiAgdXNlRWZmZWN0MygoKSA9PiB7XG4gICAgaWYgKHJlZi5jdXJyZW50KVxuICAgICAgcmVmLmN1cnJlbnQubWFwYm94Z2wgPSBtYXBib3hnbDtcbiAgfSwgW3JlZi5jdXJyZW50LCBtYXBib3hnbF0pO1xuICB1c2VFZmZlY3QzKCgpID0+IHtcbiAgICBjb25zdCBub2RlID0gcmVmLmN1cnJlbnQ7XG4gICAgaWYgKCFub2RlKVxuICAgICAgcmV0dXJuO1xuICAgIGlmICghb25TdWdnZXN0KVxuICAgICAgcmV0dXJuO1xuICAgIGNvbnN0IGZuID0gKGUpID0+IG9uU3VnZ2VzdChlLmRldGFpbCk7XG4gICAgbm9kZS5hZGRFdmVudExpc3RlbmVyKFwic3VnZ2VzdFwiLCBmbik7XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIG5vZGUucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInN1Z2dlc3RcIiwgZm4pO1xuICAgIH07XG4gIH0sIFtyZWYuY3VycmVudCwgb25TdWdnZXN0XSk7XG4gIHVzZUVmZmVjdDMoKCkgPT4ge1xuICAgIGNvbnN0IG5vZGUgPSByZWYuY3VycmVudDtcbiAgICBpZiAoIW5vZGUpXG4gICAgICByZXR1cm47XG4gICAgaWYgKCFvblN1Z2dlc3RFcnJvcilcbiAgICAgIHJldHVybjtcbiAgICBjb25zdCBmbiA9IChlKSA9PiBvblN1Z2dlc3RFcnJvcihlLmRldGFpbCk7XG4gICAgbm9kZS5hZGRFdmVudExpc3RlbmVyKFwic3VnZ2VzdGVycm9yXCIsIGZuKTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgbm9kZS5yZW1vdmVFdmVudExpc3RlbmVyKFwic3VnZ2VzdGVycm9yXCIsIGZuKTtcbiAgICB9O1xuICB9LCBbcmVmLmN1cnJlbnQsIG9uU3VnZ2VzdEVycm9yXSk7XG4gIHVzZUVmZmVjdDMoKCkgPT4ge1xuICAgIGNvbnN0IG5vZGUgPSByZWYuY3VycmVudDtcbiAgICBpZiAoIW5vZGUpXG4gICAgICByZXR1cm47XG4gICAgaWYgKCFvblJldHJpZXZlKVxuICAgICAgcmV0dXJuO1xuICAgIGNvbnN0IGZuID0gKGUpID0+IG9uUmV0cmlldmUoZS5kZXRhaWwpO1xuICAgIG5vZGUuYWRkRXZlbnRMaXN0ZW5lcihcInJldHJpZXZlXCIsIGZuKTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgbm9kZS5yZW1vdmVFdmVudExpc3RlbmVyKFwicmV0cmlldmVcIiwgZm4pO1xuICAgIH07XG4gIH0sIFtyZWYuY3VycmVudCwgb25SZXRyaWV2ZV0pO1xuICB1c2VFZmZlY3QzKCgpID0+IHtcbiAgICBjb25zdCBub2RlID0gcmVmLmN1cnJlbnQ7XG4gICAgaWYgKCFub2RlKVxuICAgICAgcmV0dXJuO1xuICAgIGlmICghb25DaGFuZ2UpXG4gICAgICByZXR1cm47XG4gICAgY29uc3QgZm4gPSAoZSkgPT4ge1xuICAgICAgaWYgKGUudGFyZ2V0ICE9PSBlLmN1cnJlbnRUYXJnZXQpXG4gICAgICAgIHJldHVybjtcbiAgICAgIG9uQ2hhbmdlKGUuZGV0YWlsKTtcbiAgICB9O1xuICAgIG5vZGUuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIGZuKTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgbm9kZS5yZW1vdmVFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgZm4pO1xuICAgIH07XG4gIH0sIFtyZWYuY3VycmVudCwgb25DaGFuZ2VdKTtcbiAgdXNlRWZmZWN0MygoKSA9PiB7XG4gICAgY29uc3Qgbm9kZSA9IHJlZi5jdXJyZW50O1xuICAgIGlmICghbm9kZSlcbiAgICAgIHJldHVybjtcbiAgICBpZiAoIW9uQ2xlYXIpXG4gICAgICByZXR1cm47XG4gICAgY29uc3QgZm4gPSAoKSA9PiB7XG4gICAgICBvbkNsZWFyKCk7XG4gICAgfTtcbiAgICBub2RlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGVhclwiLCBmbik7XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIG5vZGUucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsZWFyXCIsIGZuKTtcbiAgICB9O1xuICB9LCBbcmVmLmN1cnJlbnQsIG9uQ2xlYXJdKTtcbiAgdXNlRWZmZWN0MygoKSA9PiB7XG4gICAgaWYgKHJlZi5jdXJyZW50KVxuICAgICAgcmVmLmN1cnJlbnQuYWNjZXNzVG9rZW4gPSBhY2Nlc3NUb2tlbjtcbiAgfSwgW3JlZi5jdXJyZW50LCBhY2Nlc3NUb2tlbl0pO1xuICByZXR1cm4gLyogQF9fUFVSRV9fICovIFJlYWN0My5jcmVhdGVFbGVtZW50KFwibWFwYm94LWdlb2NvZGVyXCIsIHtcbiAgICByZWZcbiAgfSk7XG59KTtcblxuLy8gc3JjL2NvbXBvbmVudHMvQWRkcmVzc01pbmltYXAudHN4XG5pbXBvcnQgUmVhY3Q0LCB7IHVzZVJlZiBhcyB1c2VSZWY0LCB1c2VFZmZlY3QgYXMgdXNlRWZmZWN0NCB9IGZyb20gXCJyZWFjdFwiO1xuZnVuY3Rpb24gQWRkcmVzc01pbmltYXAocHJvcHMpIHtcbiAgY29uc3Qge1xuICAgIGNhbkFkanVzdE1hcmtlciA9IGZhbHNlLFxuICAgIGtlZXBNYXJrZXJDZW50ZXJlZCA9IGZhbHNlLFxuICAgIG1hcmtlckFuY2hvciA9IFwiYm90dG9tXCIsXG4gICAgb25TYXZlTWFya2VyTG9jYXRpb24sXG4gICAgc2hvdyA9IGZhbHNlLFxuICAgIGFjY2Vzc1Rva2VuLFxuICAgIGZlYXR1cmUgPSBudWxsLFxuICAgIGFkanVzdEJ0blRleHQsXG4gICAgc2F2ZUJ0blRleHQsXG4gICAgY2FuY2VsQnRuVGV4dCxcbiAgICBzYXRlbGxpdGVUb2dnbGUgPSBmYWxzZSxcbiAgICB0aGVtZSxcbiAgICBtYXBTdHlsZU1vZGUgPSBcImRlZmF1bHRcIixcbiAgICBkZWZhdWx0TWFwU3R5bGUgPSBbXCJtYXBib3hcIiwgXCJzdHJlZXRzLXYxMVwiXSxcbiAgICBmb290ZXJcbiAgfSA9IHByb3BzO1xuICBjb25zdCByZWYgPSB1c2VSZWY0KCk7XG4gIHVzZUVmZmVjdDQoKCkgPT4ge1xuICAgIGlmICghcmVmLmN1cnJlbnQpXG4gICAgICByZXR1cm47XG4gICAgaWYgKHNob3cpIHtcbiAgICAgIHJlZi5jdXJyZW50LnNob3coKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVmLmN1cnJlbnQuaGlkZSgpO1xuICAgIH1cbiAgfSwgW3JlZi5jdXJyZW50LCBzaG93XSk7XG4gIHVzZUVmZmVjdDQoKCkgPT4ge1xuICAgIGlmIChyZWYuY3VycmVudClcbiAgICAgIHJlZi5jdXJyZW50LnRoZW1lID0gdGhlbWU7XG4gIH0sIFtyZWYuY3VycmVudCwgdGhlbWVdKTtcbiAgdXNlRWZmZWN0NCgoKSA9PiB7XG4gICAgaWYgKHJlZi5jdXJyZW50KVxuICAgICAgcmVmLmN1cnJlbnQuZmVhdHVyZSA9IHNob3cgPyBmZWF0dXJlIDogbnVsbDtcbiAgfSwgW3JlZi5jdXJyZW50LCBmZWF0dXJlLCBzaG93XSk7XG4gIHVzZUVmZmVjdDQoKCkgPT4ge1xuICAgIGlmIChyZWYuY3VycmVudClcbiAgICAgIHJlZi5jdXJyZW50Lm1hcFN0eWxlTW9kZSA9IG1hcFN0eWxlTW9kZTtcbiAgfSwgW3JlZi5jdXJyZW50LCBtYXBTdHlsZU1vZGVdKTtcbiAgdXNlRWZmZWN0NCgoKSA9PiB7XG4gICAgaWYgKGFkanVzdEJ0blRleHQgPT09IHZvaWQgMClcbiAgICAgIHJldHVybjtcbiAgICBpZiAocmVmLmN1cnJlbnQpXG4gICAgICByZWYuY3VycmVudC5hZGp1c3RCdG5UZXh0ID0gYWRqdXN0QnRuVGV4dDtcbiAgfSwgW3JlZi5jdXJyZW50LCBhZGp1c3RCdG5UZXh0XSk7XG4gIHVzZUVmZmVjdDQoKCkgPT4ge1xuICAgIGlmIChzYXZlQnRuVGV4dCA9PT0gdm9pZCAwKVxuICAgICAgcmV0dXJuO1xuICAgIGlmIChyZWYuY3VycmVudClcbiAgICAgIHJlZi5jdXJyZW50LnNhdmVCdG5UZXh0ID0gc2F2ZUJ0blRleHQ7XG4gIH0sIFtyZWYuY3VycmVudCwgc2F2ZUJ0blRleHRdKTtcbiAgdXNlRWZmZWN0NCgoKSA9PiB7XG4gICAgaWYgKGNhbmNlbEJ0blRleHQgPT09IHZvaWQgMClcbiAgICAgIHJldHVybjtcbiAgICBpZiAocmVmLmN1cnJlbnQpXG4gICAgICByZWYuY3VycmVudC5jYW5jZWxCdG5UZXh0ID0gY2FuY2VsQnRuVGV4dDtcbiAgfSwgW3JlZi5jdXJyZW50LCBjYW5jZWxCdG5UZXh0XSk7XG4gIHVzZUVmZmVjdDQoKCkgPT4ge1xuICAgIGlmIChyZWYuY3VycmVudClcbiAgICAgIHJlZi5jdXJyZW50LmRlZmF1bHRNYXBTdHlsZSA9IGRlZmF1bHRNYXBTdHlsZTtcbiAgfSwgW3JlZi5jdXJyZW50LCBkZWZhdWx0TWFwU3R5bGVdKTtcbiAgdXNlRWZmZWN0NCgoKSA9PiB7XG4gICAgaWYgKGZvb3RlciA9PT0gdm9pZCAwKVxuICAgICAgcmV0dXJuO1xuICAgIGlmIChyZWYuY3VycmVudClcbiAgICAgIHJlZi5jdXJyZW50LmZvb3RlciA9IGZvb3RlcjtcbiAgfSwgW3JlZi5jdXJyZW50LCBmb290ZXJdKTtcbiAgdXNlRWZmZWN0NCgoKSA9PiB7XG4gICAgaWYgKHJlZi5jdXJyZW50KVxuICAgICAgcmVmLmN1cnJlbnQuYWNjZXNzVG9rZW4gPSBhY2Nlc3NUb2tlbjtcbiAgfSwgW3JlZi5jdXJyZW50LCBhY2Nlc3NUb2tlbl0pO1xuICB1c2VFZmZlY3Q0KCgpID0+IHtcbiAgICBpZiAocmVmLmN1cnJlbnQpXG4gICAgICByZWYuY3VycmVudC5vblNhdmVNYXJrZXJMb2NhdGlvbiA9IG9uU2F2ZU1hcmtlckxvY2F0aW9uO1xuICB9LCBbcmVmLmN1cnJlbnQsIG9uU2F2ZU1hcmtlckxvY2F0aW9uXSk7XG4gIHJldHVybiAvKiBAX19QVVJFX18gKi8gUmVhY3Q0LmNyZWF0ZUVsZW1lbnQoXCJtYXBib3gtYWRkcmVzcy1taW5pbWFwXCIsIHtcbiAgICByZWYsXG4gICAgXCJjYW4tYWRqdXN0LW1hcmtlclwiOiBjYW5BZGp1c3RNYXJrZXIsXG4gICAgXCJrZWVwLW1hcmtlci1jZW50ZXJlZFwiOiBrZWVwTWFya2VyQ2VudGVyZWQsXG4gICAgXCJtYXJrZXItYW5jaG9yXCI6IG1hcmtlckFuY2hvcixcbiAgICBcInNhdGVsbGl0ZS10b2dnbGVcIjogc2F0ZWxsaXRlVG9nZ2xlXG4gIH0pO1xufVxuXG4vLyBzcmMvaG9va3MvdXNlRXZlbnRlZC50c3hcbmltcG9ydCB7IHVzZUVmZmVjdCBhcyB1c2VFZmZlY3Q1LCB1c2VSZWYgYXMgdXNlUmVmNSB9IGZyb20gXCJyZWFjdFwiO1xuZnVuY3Rpb24gdXNlRXZlbnRlZChldmVudGVkLCBldmVudE5hbWUsIGNiKSB7XG4gIGNvbnN0IGNiUmVmID0gdXNlUmVmNShjYik7XG4gIHVzZUVmZmVjdDUoKCkgPT4ge1xuICAgIGNiUmVmLmN1cnJlbnQgPSBjYjtcbiAgfSk7XG4gIHVzZUVmZmVjdDUoKCkgPT4ge1xuICAgIGlmICghZXZlbnRlZClcbiAgICAgIHJldHVybjtcbiAgICBjb25zdCBmbiA9IChvYmplY3QpID0+IGNiUmVmLmN1cnJlbnQob2JqZWN0KTtcbiAgICBldmVudGVkLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBmbik7XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIGV2ZW50ZWQucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudE5hbWUsIGZuKTtcbiAgICB9O1xuICB9LCBbZXZlbnRlZCwgZXZlbnROYW1lLCBjYlJlZl0pO1xufVxuXG4vLyBzcmMvaG9va3MvdXNlQWRkcmVzc0F1dG9maWxsQ29yZS50c3hcbmltcG9ydCB7IHVzZUVmZmVjdCBhcyB1c2VFZmZlY3Q2LCB1c2VNZW1vIH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQge1xuICBBZGRyZXNzQXV0b2ZpbGxDb3JlXG59IGZyb20gXCJAbWFwYm94L3NlYXJjaC1qcy1jb3JlXCI7XG52YXIgREVGQVVMVFMgPSBBZGRyZXNzQXV0b2ZpbGxDb3JlLmRlZmF1bHRzO1xuZnVuY3Rpb24gdXNlQWRkcmVzc0F1dG9maWxsQ29yZShvcHRpb25zKSB7XG4gIGNvbnN0IGF1dG9maWxsID0gdXNlTWVtbygoKSA9PiB7XG4gICAgcmV0dXJuIG5ldyBBZGRyZXNzQXV0b2ZpbGxDb3JlKCk7XG4gIH0sIFtdKTtcbiAgdXNlRWZmZWN0NigoKSA9PiB7XG4gICAgY29uc3QgX2EgPSBvcHRpb25zLCB7IGFjY2Vzc1Rva2VuIH0gPSBfYSwgcmVzdE9wdGlvbnMgPSBfX29ialJlc3QoX2EsIFtcImFjY2Vzc1Rva2VuXCJdKTtcbiAgICBhdXRvZmlsbC5hY2Nlc3NUb2tlbiA9IGFjY2Vzc1Rva2VuO1xuICAgIGF1dG9maWxsLmRlZmF1bHRzID0gX19zcHJlYWRWYWx1ZXMoX19zcHJlYWRWYWx1ZXMoe30sIERFRkFVTFRTKSwgcmVzdE9wdGlvbnMpO1xuICB9LCBbb3B0aW9uc10pO1xuICByZXR1cm4gYXV0b2ZpbGw7XG59XG5cbi8vIHNyYy9ob29rcy91c2VTZWFyY2hCb3hDb3JlLnRzeFxuaW1wb3J0IHsgdXNlRWZmZWN0IGFzIHVzZUVmZmVjdDcsIHVzZU1lbW8gYXMgdXNlTWVtbzIgfSBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7IFNlYXJjaEJveENvcmUgfSBmcm9tIFwiQG1hcGJveC9zZWFyY2gtanMtY29yZVwiO1xudmFyIERFRkFVTFRTMiA9IFNlYXJjaEJveENvcmUuZGVmYXVsdHM7XG5mdW5jdGlvbiB1c2VTZWFyY2hCb3hDb3JlKG9wdGlvbnMpIHtcbiAgY29uc3Qgc2VhcmNoID0gdXNlTWVtbzIoKCkgPT4ge1xuICAgIHJldHVybiBuZXcgU2VhcmNoQm94Q29yZSgpO1xuICB9LCBbXSk7XG4gIHVzZUVmZmVjdDcoKCkgPT4ge1xuICAgIGNvbnN0IF9hID0gb3B0aW9ucywgeyBhY2Nlc3NUb2tlbiB9ID0gX2EsIHJlc3RPcHRpb25zID0gX19vYmpSZXN0KF9hLCBbXCJhY2Nlc3NUb2tlblwiXSk7XG4gICAgc2VhcmNoLmFjY2Vzc1Rva2VuID0gYWNjZXNzVG9rZW47XG4gICAgc2VhcmNoLmRlZmF1bHRzID0gX19zcHJlYWRWYWx1ZXMoX19zcHJlYWRWYWx1ZXMoe30sIERFRkFVTFRTMiksIHJlc3RPcHRpb25zKTtcbiAgfSwgW29wdGlvbnNdKTtcbiAgcmV0dXJuIHNlYXJjaDtcbn1cblxuLy8gc3JjL2hvb2tzL3VzZUdlb2NvZGluZ0NvcmUudHN4XG5pbXBvcnQgeyB1c2VFZmZlY3QgYXMgdXNlRWZmZWN0OCwgdXNlTWVtbyBhcyB1c2VNZW1vMyB9IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IHsgR2VvY29kaW5nQ29yZSB9IGZyb20gXCJAbWFwYm94L3NlYXJjaC1qcy1jb3JlXCI7XG5mdW5jdGlvbiB1c2VHZW9jb2RpbmdDb3JlKG9wdGlvbnMpIHtcbiAgY29uc3Qgc2VhcmNoID0gdXNlTWVtbzMoKCkgPT4ge1xuICAgIHJldHVybiBuZXcgR2VvY29kaW5nQ29yZSgpO1xuICB9LCBbXSk7XG4gIHVzZUVmZmVjdDgoKCkgPT4ge1xuICAgIGNvbnN0IF9hID0gb3B0aW9ucywgeyBhY2Nlc3NUb2tlbiB9ID0gX2EsIHJlc3RPcHRpb25zID0gX19vYmpSZXN0KF9hLCBbXCJhY2Nlc3NUb2tlblwiXSk7XG4gICAgc2VhcmNoLmFjY2Vzc1Rva2VuID0gYWNjZXNzVG9rZW47XG4gICAgc2VhcmNoLmRlZmF1bHRzID0gX19zcHJlYWRWYWx1ZXMoe30sIHJlc3RPcHRpb25zKTtcbiAgfSwgW29wdGlvbnNdKTtcbiAgcmV0dXJuIHNlYXJjaDtcbn1cblxuLy8gc3JjL2hvb2tzL3VzZVNlYXJjaFNlc3Npb24udHN4XG5pbXBvcnQge1xuICBTZWFyY2hCb3hDb3JlIGFzIFNlYXJjaEJveENvcmUyLFxuICBHZW9jb2RpbmdDb3JlIGFzIEdlb2NvZGluZ0NvcmUyLFxuICBTZWFyY2hTZXNzaW9uXG59IGZyb20gXCJAbWFwYm94L3NlYXJjaC1qcy1jb3JlXCI7XG5pbXBvcnQgeyB1c2VNZW1vIGFzIHVzZU1lbW80IH0gZnJvbSBcInJlYWN0XCI7XG5mdW5jdGlvbiB1c2VTZWFyY2hTZXNzaW9uKHNlYXJjaCkge1xuICBjb25zdCBzZWFyY2hTZXNzaW9uID0gdXNlTWVtbzQoKCkgPT4ge1xuICAgIHJldHVybiBuZXcgU2VhcmNoU2Vzc2lvbihzZWFyY2gpO1xuICB9LCBbc2VhcmNoXSk7XG4gIGlmIChzZWFyY2ggaW5zdGFuY2VvZiBTZWFyY2hCb3hDb3JlMikge1xuICAgIHJldHVybiBzZWFyY2hTZXNzaW9uO1xuICB9IGVsc2UgaWYgKHNlYXJjaCBpbnN0YW5jZW9mIEdlb2NvZGluZ0NvcmUyKSB7XG4gICAgcmV0dXJuIHNlYXJjaFNlc3Npb247XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHNlYXJjaFNlc3Npb247XG4gIH1cbn1cblxuLy8gc3JjL2hvb2tzL3VzZUNvbmZpcm1BZGRyZXNzLnRzeFxuaW1wb3J0IHsgdXNlTWVtbyBhcyB1c2VNZW1vNSwgdXNlUmVmIGFzIHVzZVJlZjYgfSBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7XG4gIGNvbmZpcm1BZGRyZXNzXG59IGZyb20gXCJAbWFwYm94L3NlYXJjaC1qcy13ZWJcIjtcbmZ1bmN0aW9uIHVzZUNvbmZpcm1BZGRyZXNzKG9wdGlvbnNBcmcgPSB7fSkge1xuICBjb25zdCBmb3JtUmVmID0gdXNlUmVmNihudWxsKTtcbiAgcmV0dXJuIHVzZU1lbW81KCgpID0+IHtcbiAgICByZXR1cm4ge1xuICAgICAgZm9ybVJlZixcbiAgICAgIHNob3dDb25maXJtOiAoKSA9PiBjb25maXJtQWRkcmVzcyhmb3JtUmVmLmN1cnJlbnQsIG9wdGlvbnNBcmcpXG4gICAgfTtcbiAgfSwgW2Zvcm1SZWYsIG9wdGlvbnNBcmddKTtcbn1cbmV4cG9ydCB7XG4gIEFkZHJlc3NBdXRvZmlsbCxcbiAgQWRkcmVzc01pbmltYXAsXG4gIEdlb2NvZGVyLFxuICBTZWFyY2hCb3gsXG4gIGNvbmZpZyxcbiAgdXNlQWRkcmVzc0F1dG9maWxsQ29yZSxcbiAgdXNlQ29uZmlybUFkZHJlc3MsXG4gIHVzZUV2ZW50ZWQsXG4gIHVzZUdlb2NvZGluZ0NvcmUsXG4gIHVzZUFkZHJlc3NBdXRvZmlsbENvcmUgYXMgdXNlTWFwYm94QXV0b2ZpbGwsXG4gIHVzZVNlYXJjaEJveENvcmUsXG4gIHVzZVNlYXJjaFNlc3Npb25cbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC1lc20uanMubWFwXG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@mapbox/search-js-react/dist/index-esm.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@mapbox/search-js-web/dist/index-esm.js":
/*!**************************************************************!*\
  !*** ./node_modules/@mapbox/search-js-web/dist/index-esm.js ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   MapboxAddressAutofill: () => (/* binding */ MapboxAddressAutofill),\n/* harmony export */   MapboxAddressConfirmation: () => (/* binding */ MapboxAddressConfirmation),\n/* harmony export */   MapboxAddressMinimap: () => (/* binding */ MapboxAddressMinimap),\n/* harmony export */   MapboxGeocoder: () => (/* binding */ MapboxGeocoder),\n/* harmony export */   MapboxHTMLEvent: () => (/* binding */ MapboxHTMLEvent),\n/* harmony export */   MapboxSearchBox: () => (/* binding */ MapboxSearchBox),\n/* harmony export */   autofill: () => (/* binding */ autofill),\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   confirmAddress: () => (/* binding */ confirmAddress),\n/* harmony export */   getAutofillSearchText: () => (/* binding */ getAutofillSearchText),\n/* harmony export */   getFormAutofillValues: () => (/* binding */ getFormAutofillValues)\n/* harmony export */ });\n/* harmony import */ var _mapbox_search_js_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @mapbox/search-js-core */ \"(ssr)/./node_modules/@mapbox/search-js-core/dist/index-esm.js\");\n/* harmony import */ var _floating_ui_dom__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @floating-ui/dom */ \"(ssr)/./node_modules/@floating-ui/core/dist/floating-ui.core.mjs\");\n/* harmony import */ var _floating_ui_dom__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @floating-ui/dom */ \"(ssr)/./node_modules/@floating-ui/dom/dist/floating-ui.dom.mjs\");\n/* harmony import */ var no_scroll__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! no-scroll */ \"(ssr)/./node_modules/no-scroll/index.js\");\n/* harmony import */ var no_scroll__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(no_scroll__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var focus_trap__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! focus-trap */ \"(ssr)/./node_modules/focus-trap/dist/focus-trap.esm.js\");\n/* harmony import */ var subtag__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! subtag */ \"(ssr)/./node_modules/subtag/subtag.js\");\n/* harmony import */ var subtag__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(subtag__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var _mapbox_sphericalmercator__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @mapbox/sphericalmercator */ \"(ssr)/./node_modules/@mapbox/sphericalmercator/sphericalmercator.js\");\n/* harmony import */ var _mapbox_sphericalmercator__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(_mapbox_sphericalmercator__WEBPACK_IMPORTED_MODULE_6__);\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nvar __accessCheck = (obj, member, msg) => {\n  if (!member.has(obj))\n    throw TypeError(\"Cannot \" + msg);\n};\nvar __privateGet = (obj, member, getter) => {\n  __accessCheck(obj, member, \"read from private field\");\n  return getter ? getter.call(obj) : member.get(obj);\n};\nvar __privateAdd = (obj, member, value) => {\n  if (member.has(obj))\n    throw TypeError(\"Cannot add the same private member more than once\");\n  member instanceof WeakSet ? member.add(obj) : member.set(obj, value);\n};\nvar __privateSet = (obj, member, value, setter) => {\n  __accessCheck(obj, member, \"write to private field\");\n  setter ? setter.call(obj, value) : member.set(obj, value);\n  return value;\n};\nvar __privateMethod = (obj, member, method) => {\n  __accessCheck(obj, member, \"access private method\");\n  return method;\n};\nvar __async = (__this, __arguments, generator) => {\n  return new Promise((resolve, reject) => {\n    var fulfilled = (value) => {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    };\n    var rejected = (value) => {\n      try {\n        step(generator.throw(value));\n      } catch (e) {\n        reject(e);\n      }\n    };\n    var step = (x) => x.done ? resolve(x.value) : Promise.resolve(x.value).then(fulfilled, rejected);\n    step((generator = generator.apply(__this, __arguments)).next());\n  });\n};\n\n// src/utils/dom.ts\nvar subdoc = document.implementation.createHTMLDocument();\nfunction bindElements(root, elements) {\n  const binding = {};\n  for (const [key, selector] of Object.entries(elements)) {\n    binding[key] = root.querySelector(selector);\n  }\n  return binding;\n}\nfunction getChildElements(node) {\n  return Array.from(node.childNodes || []).filter((el) => el.nodeType === Node.ELEMENT_NODE);\n}\nfunction createElementFromString(innerHTML) {\n  const template = document.createElement(\"template\");\n  template.innerHTML = innerHTML;\n  return template.content.firstElementChild;\n}\nfunction createCSSStyleSheet(text) {\n  const style = subdoc.createElement(\"style\");\n  style.textContent = text;\n  subdoc.head.appendChild(style);\n  return style.sheet;\n}\nfunction isVisible(element) {\n  const style = window.getComputedStyle(element);\n  return style.display !== \"none\";\n}\nfunction setValue(input, value) {\n  if (!input) {\n    return;\n  }\n  const set = Object.getOwnPropertyDescriptor(input.constructor.prototype, \"value\").set;\n  set.call(input, value);\n  const wrapperState = input;\n  if (wrapperState._valueTracker) {\n    wrapperState._valueTracker.setValue(\"\");\n  }\n  const onInputEvent = new Event(\"input\", {\n    bubbles: true\n  });\n  onInputEvent.simulated = true;\n  input.dispatchEvent(onInputEvent);\n  const onChangeEvent = new Event(\"change\", {\n    bubbles: true\n  });\n  onChangeEvent.simulated = true;\n  input.dispatchEvent(onChangeEvent);\n}\nfunction getElementSize(element, deep = false) {\n  let width;\n  let height;\n  const elementRect = element.getBoundingClientRect();\n  if (element.style.display === \"none\" || elementRect.height === 0 && elementRect.width === 0) {\n    const clone = element.cloneNode(deep);\n    element.parentElement.appendChild(clone);\n    clone.style.setProperty(\"display\", \"block\", \"important\");\n    const cloneRect = clone.getBoundingClientRect();\n    width = cloneRect.width;\n    height = cloneRect.height;\n    clone.style.setProperty(\"display\", \"none\");\n    clone.remove();\n  } else {\n    width = elementRect.width;\n    height = elementRect.height;\n  }\n  return {\n    height: Math.floor(height),\n    width: Math.floor(width)\n  };\n}\nfunction addDocumentStyle(css) {\n  const style = document.createElement(\"style\");\n  style.innerHTML = css;\n  document.head.appendChild(style);\n}\n\n// src/utils/class_name_transformers.ts\nvar IDENTIFIER_REGEX = new RegExp(\"[_a-zA-Z]+[_a-zA-Z0-9-]*\", \"g\");\nvar CLASS_NAME_REGEX = new RegExp(`\\\\.${IDENTIFIER_REGEX.source}`, \"g\");\nvar CONDITION_RULE_REGEX = new RegExp(`^\\\\s*(@(?:media|supports)[^{]*){(.*)}\\\\s*$`);\nfunction transformClassSelectors(css, transform) {\n  return css.replace(CLASS_NAME_REGEX, (className) => {\n    return \".\" + transform(className.slice(1));\n  });\n}\nfunction transformCSSClassRules(text, transform) {\n  const sheet = createCSSStyleSheet(text);\n  const rules = sheet.cssRules;\n  function transformCSSRule(rule) {\n    if (rule instanceof CSSStyleRule) {\n      const selector = transformClassSelectors(rule.selectorText, transform);\n      return `${selector} { ${rule.style.cssText} }`;\n    }\n    const atRule = CONDITION_RULE_REGEX.exec(rule.cssText.split(\"\\n\").join(\"\"));\n    if (atRule && atRule.length > 2) {\n      const rule2 = atRule[1];\n      const contents = atRule[2];\n      return `${rule2} { ${transformCSSClassRules(contents, transform)} }`;\n    }\n    return rule.cssText;\n  }\n  let style = \"\";\n  for (const rule of Array.from(rules)) {\n    style += transformCSSRule(rule) + \"\\n\\n\";\n  }\n  return style.trim();\n}\nfunction transformDOMClassAttributes(content, transform) {\n  const elements = Array.from(content.querySelectorAll(\"[class]\"));\n  elements.push(content);\n  for (const element of elements) {\n    const { classList } = element;\n    for (const className of Array.from(classList)) {\n      classList.remove(className);\n      classList.add(transform(className));\n    }\n  }\n  return content;\n}\n\n// src/utils/index.ts\n\n\n// src/utils/map.ts\nvar FLY_TO_SPEED = 1.4;\nfunction bboxViewport(map, bounds, delta = 0.5) {\n  const { center, zoom } = map.cameraForBounds(bounds);\n  const transformedZoom = Math.max(zoom - delta, 0);\n  return {\n    center,\n    zoom: transformedZoom,\n    speed: FLY_TO_SPEED\n  };\n}\nfunction getMaxZoom(placeType) {\n  switch (placeType) {\n    case \"street\":\n      return 15;\n    case \"neighborhood\":\n    case \"postcode\":\n    case \"locality\":\n    case \"oaza\":\n      return 14;\n    case \"place\":\n    case \"city\":\n      return 13;\n    case \"district\":\n      return 9;\n    case \"region\":\n    case \"prefecture\":\n      return 6;\n    case \"country\":\n      return 4;\n    default:\n      return 16;\n  }\n}\nfunction getStaticBaseUrl(username, styleId) {\n  return `https://api.mapbox.com/styles/v1/${username}/${styleId}/static/`;\n}\n\n// src/icons/close.svg\nvar close_default = '<svg viewBox=\"0 0 18 18\" xmlns=\"http://www.w3.org/2000/svg\"><path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M3.8 3.8a1 1 0 0 1 1.4 0L9 7.58l3.8-3.8a1 1 0 1 1 1.4 1.42L10.42 9l3.8 3.8a1 1 0 0 1-1.42 1.4L9 10.42l-3.8 3.8a1 1 0 0 1-1.4-1.42L7.58 9l-3.8-3.8a1 1 0 0 1 0-1.4Z\" fill=\"currentColor\"/></svg>';\n\n// src/icons/loading.svg\nvar loading_default = '<svg viewBox=\"0 0 18 18\" xmlns=\"http://www.w3.org/2000/svg\"><path fill=\"#333\" d=\"M4.4 4.4l.8.8c2.1-2.1 5.5-2.1 7.6 0l.8-.8c-2.5-2.5-6.7-2.5-9.2 0z\"/><path opacity=\".1\" d=\"M12.8 12.9c-2.1 2.1-5.5 2.1-7.6 0-2.1-2.1-2.1-5.5 0-7.7l-.8-.8c-2.5 2.5-2.5 6.7 0 9.2s6.6 2.5 9.2 0 2.5-6.6 0-9.2l-.8.8c2.2 2.1 2.2 5.6 0 7.7z\"/></svg>';\n\n// src/constants.ts\nvar STATIC_BASE_URL_SATELLITE = getStaticBaseUrl(\"mapbox\", \"satellite-streets-v11\");\nvar AUTOFILL_SKU_TOKEN_PREFIX = \"20d01\";\nvar MAPBOX_DOMAINS = [\"mapbox.com\", \"mapbox.cn\", \"tilestream.net\"];\nvar LISTBOX_TEMPLATE = createElementFromString(`\n<template>\n  <div class=\"MapboxSearch\">\n    <div class=\"Label\" role=\"label\" aria-live=\"polite\" aria-atomic=\"true\">\n    </div>\n    <div class=\"Results\" aria-hidden=\"true\">\n      <div class=\"ResultsList\" role=\"listbox\">\n      </div>\n      <div class=\"ResultsAttribution\" aria-hidden=\"true\">\n        <a href=\"https://www.mapbox.com/search-service\" target=\"_blank\" tabindex=\"-1\">\n          Powered by Mapbox\n        </a>\n      </div>\n    </div>\n  </div>\n</template>\n`);\nvar LISTBOX_SUGGESTION_TEMPLATE = createElementFromString(`\n<template>\n  <div class=\"Suggestion\" role=\"option\" tabindex=\"-1\">\n    <div class=\"SuggestionIcon\" aria-hidden=\"true\"></div>\n    <div class=\"SuggestionText\">\n      <div class=\"SuggestionName\"></div>\n      <div class=\"SuggestionDesc\"></div>\n    </div>\n  </div>\n</template>\n`);\nvar SEARCHBOX_TEMPLATE = createElementFromString(`\n<template>\n  <div class=\"SearchBox\">\n    <div class=\"SearchIcon\"></div>\n    <input class=\"Input\" type=\"text\" />\n    <div class=\"ActionIcon\">\n      <button aria-label=\"Clear\" class=\"ClearBtn\" type=\"button\">${close_default}</button>\n      <div class=\"LoadingIcon\">${loading_default}</div>\n    </div>\n  </div>\n</template>\n`);\nvar GEOCODER_TEMPLATE = createElementFromString(`\n<template>\n  <div class=\"Geocoder\">\n    <div class=\"SearchIcon\"></div>\n    <input class=\"Input\" type=\"text\" />\n    <div class=\"ActionIcon\">\n      <button aria-label=\"Clear\" class=\"ClearBtn\" type=\"button\">${close_default}</button>\n      <div class=\"LoadingIcon\">${loading_default}</div>\n    </div>\n  </div>\n</template>\n`);\n\n// src/utils/index.ts\nfunction randomValidID() {\n  return `mbx` + new _mapbox_search_js_core__WEBPACK_IMPORTED_MODULE_0__.SessionToken().id.slice(0, 8);\n}\nfunction tryParseJSON(json) {\n  try {\n    return JSON.parse(json);\n  } catch (e) {\n    return null;\n  }\n}\nfunction deepEquals(a, b) {\n  if (a == null || b == null) {\n    return a === b;\n  }\n  if (typeof a !== \"object\" || typeof b !== \"object\") {\n    return a === b;\n  }\n  const aKeys = Object.keys(a);\n  const bKeys = Object.keys(b);\n  if (aKeys.length !== bKeys.length) {\n    return false;\n  }\n  for (const key of aKeys) {\n    if (!deepEquals(a[key], b[key])) {\n      return false;\n    }\n  }\n  return true;\n}\nfunction round(num, decimalPlaces) {\n  const factorOfTen = Math.pow(10, decimalPlaces);\n  return Math.round(num * factorOfTen) / factorOfTen;\n}\nfunction isLocalServer(hostname) {\n  return Boolean(hostname.match(/localhost|[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}|::1|\\.local|^$/gi));\n}\nfunction isMapboxDomain(hostname) {\n  return Boolean(MAPBOX_DOMAINS.some((domain) => hostname.includes(domain)));\n}\n\n// src/components/HTMLScopedElement.ts\nvar _seed, _templateUserStyleElement, _transform;\nvar HTMLScopedElement = class extends HTMLElement {\n  constructor() {\n    super(...arguments);\n    __privateAdd(this, _seed, randomValidID());\n    __privateAdd(this, _templateUserStyleElement, void 0);\n    __privateAdd(this, _transform, (className) => {\n      return `${__privateGet(this, _seed)}--${className}`;\n    });\n  }\n  get template() {\n    return null;\n  }\n  get templateStyle() {\n    return null;\n  }\n  get templateUserStyle() {\n    return null;\n  }\n  clonedCallback(oldSeed, newSeed) {\n    const seedTransform = (className) => className.replace(oldSeed, newSeed);\n    transformDOMClassAttributes(this, seedTransform);\n    const styles = Array.from(this.querySelectorAll(\"style\"));\n    for (const style of styles) {\n      style.textContent = transformClassSelectors(style.textContent, seedTransform);\n    }\n    if (styles.length) {\n      __privateSet(this, _templateUserStyleElement, styles[styles.length - 1]);\n    }\n    const nodesWithId = Array.from(this.querySelectorAll(`[id^=\"${oldSeed}\"]`));\n    for (const node of nodesWithId) {\n      node.id = node.id.replace(oldSeed, newSeed);\n    }\n  }\n  connectedCallback() {\n    if (this.childElementCount > 0) {\n      const oldSeed = this.dataset.seed;\n      const newSeed = __privateGet(this, _seed);\n      if (oldSeed && oldSeed !== newSeed) {\n        this.clonedCallback(oldSeed, newSeed);\n        this.dataset.seed = newSeed;\n      }\n      return;\n    }\n    this.dataset.seed = __privateGet(this, _seed);\n    const template = this.template;\n    if (template) {\n      const element = this.prepareTemplate(template);\n      this.appendChild(element);\n    }\n    const templateStyle = this.templateStyle;\n    if (templateStyle) {\n      const style = document.createElement(\"style\");\n      style.textContent = this.prepareCSS(templateStyle);\n      this.appendChild(style);\n    }\n    const userStyle = document.createElement(\"style\");\n    if (this.templateUserStyle) {\n      userStyle.textContent = this.prepareCSS(this.templateUserStyle);\n    }\n    this.appendChild(userStyle);\n    __privateSet(this, _templateUserStyleElement, userStyle);\n  }\n  prepareTemplate(template) {\n    const element = template.content.firstElementChild;\n    return transformDOMClassAttributes(element.cloneNode(true), __privateGet(this, _transform));\n  }\n  prepareCSS(css) {\n    return transformCSSClassRules(css, __privateGet(this, _transform));\n  }\n  updateTemplateUserStyle(style) {\n    if (!__privateGet(this, _templateUserStyleElement)) {\n      return;\n    }\n    __privateGet(this, _templateUserStyleElement).textContent = this.prepareCSS(style);\n  }\n  querySelector(selectors) {\n    return super.querySelector(transformClassSelectors(selectors, __privateGet(this, _transform)));\n  }\n  querySelectorAll(selectors) {\n    return super.querySelectorAll(transformClassSelectors(selectors, __privateGet(this, _transform)));\n  }\n  addEventListener(type, listener, options) {\n    super.addEventListener(type, listener, options);\n  }\n  removeEventListener(type, listener, options) {\n    super.removeEventListener(type, listener, options);\n  }\n  dispatchEvent(event) {\n    return super.dispatchEvent(event);\n  }\n};\n_seed = new WeakMap();\n_templateUserStyleElement = new WeakMap();\n_transform = new WeakMap();\n\n// src/icons/question.svg\nvar question_default = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><svg viewBox=\"0 0 18 18\" xmlns=\"http://www.w3.org/2000/svg\"><path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M9 16A7 7 0 1 0 9 2a7 7 0 0 0 0 14ZM6.88 4.88a2.58 2.58 0 0 1 1.83-.75h1.08a2.58 2.58 0 0 1 2.59 2.58v.16c0 1-.53 1.94-1.4 2.46l-.56.34c-.27.16-.45.42-.52.71-.03.14-.14.25-.28.25H8.38a.23.23 0 0 1-.24-.25c.08-.91.59-1.74 1.38-2.21l.56-.34c.34-.2.54-.57.54-.96V6.7a.83.83 0 0 0-.83-.83H8.71a.83.83 0 0 0-.84.83v.18a.87.87 0 1 1-1.75 0V6.7c0-.69.28-1.34.76-1.83ZM10 13a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z\" fill=\"currentColor\"/></svg>';\n\n// src/icons/marker.svg\nvar marker_default = '<svg width=\"48\" height=\"56\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><g filter=\"url(#a)\"><path d=\"m24 50.4 13.79-14.12a18.82 18.82 0 0 0 4.23-20.86 19.23 19.23 0 0 0-7.19-8.6 19.76 19.76 0 0 0-21.66 0c-3.21 2.11-5.71 5.1-7.19 8.6a18.82 18.82 0 0 0 4.23 20.86L24 50.4Z\" fill=\"currentColor\"/><path d=\"M37.26 35.75 24 49.34 10.75 35.76l-.01-.01A18.07 18.07 0 0 1 6.68 15.7a18.48 18.48 0 0 1 6.9-8.26 19 19 0 0 1 20.84 0 18.48 18.48 0 0 1 6.9 8.26 18.07 18.07 0 0 1-4.06 20.04Z\" stroke=\"#fff\" stroke-width=\"1.5\"/></g><circle cx=\"24\" cy=\"22.45\" fill=\"#fff\" r=\"5.85\"/><defs><filter id=\"a\" x=\".5\" y=\".6\" width=\"47\" height=\"54.8\" filterUnits=\"userSpaceOnUse\" color-interpolation-filters=\"sRGB\"><feFlood flood-opacity=\"0\" result=\"BackgroundImageFix\"/><feColorMatrix in=\"SourceAlpha\" values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0\" result=\"hardAlpha\"/><feOffset dy=\"1\"/><feGaussianBlur stdDeviation=\"2\"/><feColorMatrix values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.2 0\"/><feBlend in2=\"BackgroundImageFix\" result=\"effect1_dropShadow_17_871\"/><feBlend in=\"SourceGraphic\" in2=\"effect1_dropShadow_17_871\" result=\"shape\"/></filter></defs></svg>';\n\n// src/icons/street.svg\nvar street_default = '<svg width=\"24\" height=\"24\" viewBox=\"0 0 18 18\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\\n  <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M1.08 14.94 5.625 3.06h1.17l-3.42 11.88H1.08Zm15.885 0L12.42 3.06h-1.17l3.42 11.88h2.295Zm-6.86-1.44H7.946l.128-2.61h1.912l.119 2.61Zm-.217-4.77H8.181l.088-1.8h1.537l.082 1.8ZM9.74 5.49h-1.4l.049-.99h1.306l.045.99Z\" fill=\"currentColor\" />\\n</svg>';\n\n// src/icons/addressMarker.svg\nvar addressMarker_default = `<!-- TODO: I'm not sure if the way I added the circle will \"scale\" properly, need to check that -->\n<svg width=\"24\" height=\"24\" viewBox=\"0 0 18 18\" xmlns=\"http://www.w3.org/2000/svg\">\n  <path fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\" d=\"M4 7a5 5 0 1 1 10 0c0 3.025-3.28 6.713-5 9-1.72-2.287-5-5.975-5-9z\"></path>\n    <circle cx=\"9\" cy=\"7\" r=\"2\" fill=\"currentColor\"></circle>\n</svg>`;\n\n// src/icons/search.svg\nvar search_default = '<svg viewBox=\"0 0 18 18\" xmlns=\"http://www.w3.org/2000/svg\">\\n  <path d=\"M7.4 2.5c-2.7 0-4.9 2.2-4.9 4.9s2.2 4.9 4.9 4.9c1 0 1.8-.2 2.5-.8l3.7 3.7c.2.2.4.3.8.3.7 0 1.1-.4 1.1-1.1 0-.3-.1-.5-.3-.8L11.4 10c.4-.8.8-1.6.8-2.5.1-2.8-2.1-5-4.8-5zm0 1.6c1.8 0 3.2 1.4 3.2 3.2s-1.4 3.2-3.2 3.2-3.3-1.3-3.3-3.1 1.4-3.3 3.3-3.3z\"/>\\n</svg>';\n\n// package.json\nvar version = \"1.0.0-beta.22\";\n\n// src/theme.ts\nvar styleToggleSatelliteImg = `https://api.mapbox.com/search-js/v${version}/img/style-toggle-satellite.jpg`;\nvar styleToggleDefaultImg = `https://api.mapbox.com/search-js/v${version}/img/style-toggle-default.jpg`;\nvar MOBILE_BREAKPOINT = 768 - 1;\nvar MOBILE_MEDIA_QUERY = `@media only screen and (max-width: ${MOBILE_BREAKPOINT}px)`;\nvar DEFAULT_THEME = {\n  variables: {\n    unit: [\"mobile\", \"16px\", \"14px\"],\n    unitHeader: [\"mobile\", \"24px\", \"18px\"],\n    minWidth: \"min(300px, 100vw)\",\n    spacing: \"0.75em\",\n    padding: \"0.5em 0.75em\",\n    paddingFooterLabel: \"0.5em 0.75em\",\n    paddingModal: \"1.25em\",\n    colorText: \"rgba(0, 0, 0, 0.75)\",\n    colorPrimary: \"#4264FB\",\n    colorSecondary: \"#667F91\",\n    colorBackground: \"#fff\",\n    colorBackgroundHover: \"#f5f5f5\",\n    colorBackgroundActive: \"#f0f0f0\",\n    colorBackdrop: \"rgba(102, 127, 145, 0.3)\",\n    border: \"none\",\n    borderRadius: \"4px\",\n    boxShadow: `\n      0 0 10px 2px rgba(0, 0, 0, 0.05),\n      0 0 6px 1px rgba(0, 0, 0, 0.1),\n      0 0 0 1px rgba(0, 0, 0, 0.1)\n    `,\n    lineHeight: \"1.2em\",\n    fontFamily: `\n      -apple-system, BlinkMacSystemFont,\n      avenir next, avenir,\n      segoe ui,\n      helvetica neue, helvetica,\n      Ubuntu, roboto, noto, arial, sans-serif\n    `,\n    fontWeight: \"normal\",\n    fontWeightSemibold: \"600\",\n    fontWeightBold: \"bold\",\n    duration: \"150ms\",\n    curve: \"ease-out\"\n  },\n  icons: {\n    close: close_default,\n    question: question_default,\n    marker: marker_default,\n    street: street_default,\n    addressMarker: addressMarker_default,\n    search: search_default\n  },\n  images: {\n    styleToggleDefault: styleToggleDefaultImg,\n    styleToggleSatellite: styleToggleSatelliteImg\n  }\n};\nfunction getThemeCSS(rootSelector, theme = {}) {\n  const variables = __spreadValues(__spreadValues({}, DEFAULT_THEME.variables), theme.variables || {});\n  let cssText = theme.cssText || \"\";\n  let rootVariables = \"\";\n  for (const [key, value] of Object.entries(variables)) {\n    if (!Array.isArray(value)) {\n      rootVariables += `--${key}: ${value};`;\n      continue;\n    }\n    if (value[0] !== \"mobile\") {\n      const valueStr = JSON.stringify(value);\n      throw new Error(`Unsupported expression in theme variables: ${key} ${valueStr}`);\n    }\n    const [, mobileValue, desktopValue] = value;\n    cssText += `${MOBILE_MEDIA_QUERY} { ${rootSelector} { --${key}: ${mobileValue} !important; } }`;\n    rootVariables += `--${key}: ${desktopValue};`;\n  }\n  return cssText + `${rootSelector} { ${rootVariables} }`;\n}\nfunction getIcon(iconName, theme = {}) {\n  const icons = __spreadValues(__spreadValues({}, DEFAULT_THEME.icons), theme.icons || {});\n  const svgString = icons[iconName];\n  return svgString;\n}\nfunction getImage(imageName, theme = {}) {\n  const images = __spreadValues(__spreadValues({}, DEFAULT_THEME.images), theme.images || {});\n  const imgString = images[imageName];\n  return imgString;\n}\n\n// src/utils/popover.ts\n\nvar _options, _defaultOptions;\nvar Popover = class {\n  constructor(referenceEl, floatingEl, options) {\n    __privateAdd(this, _options, void 0);\n    __privateAdd(this, _defaultOptions, {\n      placement: \"bottom-start\",\n      flip: false,\n      offset: 10\n    });\n    this.update = () => __async(this, null, function* () {\n      const config2 = {\n        placement: this.options.placement,\n        middleware: [\n          (0,_floating_ui_dom__WEBPACK_IMPORTED_MODULE_1__.offset)(this.options.offset),\n          this.options.flip && (0,_floating_ui_dom__WEBPACK_IMPORTED_MODULE_1__.flip)()\n        ].filter(Boolean)\n      };\n      const { x, y } = yield (0,_floating_ui_dom__WEBPACK_IMPORTED_MODULE_2__.computePosition)(this.referenceEl, this.floatingEl, config2);\n      Object.assign(this.floatingEl.style, {\n        left: `${x}px`,\n        top: `${y}px`\n      });\n    });\n    this.referenceEl = referenceEl;\n    this.floatingEl = floatingEl;\n    __privateSet(this, _options, __spreadValues(__spreadValues({}, __privateGet(this, _defaultOptions)), options));\n    this.destroy = (0,_floating_ui_dom__WEBPACK_IMPORTED_MODULE_2__.autoUpdate)(this.referenceEl, this.floatingEl, this.update);\n  }\n  get options() {\n    return __privateGet(this, _options);\n  }\n  set options(newOptions) {\n    __privateSet(this, _options, __spreadValues(__spreadValues({}, __privateGet(this, _options)), newOptions));\n  }\n};\n_options = new WeakMap();\n_defaultOptions = new WeakMap();\n\n// src/style.css\nvar style_default = \"*{box-sizing:border-box!important}[role=button]{cursor:pointer}.MapboxSearch{--width:0;display:none}.Results{background-color:var(--colorBackground);border:var(--border);border-radius:var(--borderRadius);box-shadow:var(--boxShadow);color:var(--colorText);font-family:var(--fontFamily);font-size:var(--unit);font-weight:var(--fontWeight);line-height:var(--lineHeight);min-width:var(--minWidth);overflow-y:auto;position:absolute;transform:translateZ(0);transition:visibility var(--duration);width:var(--width);z-index:1000}.Results:not([aria-hidden=true]){visibility:visible}.Results[aria-hidden=true]{animation:fadein var(--duration) var(--curve) reverse forwards;visibility:hidden}.Suggestion{align-items:center;display:flex;padding:var(--padding)}.Suggestion:hover{cursor:pointer}.Suggestion[aria-selected=true]{background-color:var(--colorBackgroundHover)}.Suggestion:active{background-color:var(--colorBackgroundActive)}.SuggestionName{font-weight:var(--fontWeightBold)}.SuggestionIcon{margin-right:6px}.SuggestionIcon[aria-hidden=true]{display:none}.ResultsAttribution{padding:var(--paddingFooterLabel)}.ResultsAttribution a{color:var(--colorSecondary)}.ResultsAttribution a:not(:hover){text-decoration:none}.ResultsList{list-style:none;margin:0;padding:0}.Label{display:none}.Geocoder,.SearchBox{background-color:var(--colorBackground);border:var(--border);border-radius:var(--borderRadius);box-shadow:var(--boxShadow);color:var(--colorText);font-family:var(--fontFamily);font-size:var(--unit);font-weight:var(--fontWeight);line-height:var(--lineHeight);padding:var(--padding);padding-bottom:0;padding-top:0;position:relative;width:100%}.SearchIcon{fill:#757575;left:.5em}.ActionIcon,.SearchIcon{bottom:0;height:20px;margin:auto 0;position:absolute;top:0;width:20px}.ActionIcon{right:.5em}.ActionIcon>button{background:none;border:none;color:inherit;cursor:pointer;font:inherit;height:100%;outline:inherit;padding:0;width:100%}.ActionIcon>button:hover{background:none!important}.ClearBtn{display:none}.ClearBtn:hover{color:#909090}.LoadingIcon{-moz-animation:rotate .8s cubic-bezier(.45,.05,.55,.95) infinite;-webkit-animation:rotate .8s cubic-bezier(.45,.05,.55,.95) infinite;animation:rotate .8s cubic-bezier(.45,.05,.55,.95) infinite;display:none;height:100%}@-webkit-keyframes rotate{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes rotate{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}.Input{background-color:transparent;border:0;color:#404040;color:rgba(0,0,0,.75);font:inherit;height:36px;margin:0;overflow:hidden;padding:0 40px;text-overflow:ellipsis;white-space:nowrap;width:100%}.Input::-ms-clear{display:none}.Input:focus{border:thin dotted;border-radius:var(--borderRadius);box-shadow:none;color:#404040;color:rgba(0,0,0,.75);outline:0}mapbox-address-confirmation-feature[aria-hidden=true],mapbox-address-confirmation-no-feature[aria-hidden=true]{display:none}.MapboxAddressConfirmation{align-items:center;background-color:var(--colorBackdrop);bottom:0;display:flex;justify-content:center;left:0;position:fixed;right:0;top:0;transform:translateZ(0);z-index:1000}.MapboxAddressConfirmation:not([aria-hidden=true]){animation:fadein var(--duration) var(--curve) forwards;visibility:visible}.MapboxAddressConfirmation[aria-hidden=true]{visibility:hidden}.ContentFeature,.ContentNoFeature{width:var(--minWidth)}.Modal{background-color:var(--colorBackground);border:var(--border);border-radius:var(--borderRadius);box-shadow:var(--boxShadow);color:var(--colorText);font-family:var(--fontFamily);font-size:var(--unit);font-weight:var(--fontWeight);line-height:var(--lineHeight);padding:var(--paddingModal);width:100%}@media screen and (max-width:480px){.MapboxAddressConfirmation{align-items:flex-end}.ContentFeature,.ContentNoFeature{width:100%}.Modal{border-bottom-left-radius:0;border-bottom-right-radius:0}}.ModalHeader{align-items:center;color:var(--colorPrimary);display:flex;font-size:var(--unitHeader);font-weight:var(--fontWeightBold);margin-bottom:var(--spacing);user-select:none;width:100%}.ModalMap{height:calc(var(--minWidth)*9/16);margin-left:calc(var(--paddingModal)*-1);width:calc(100% + var(--paddingModal)*2)}.ModalMap[aria-hidden=true]{display:none}.Icon{height:var(--unitHeader);width:var(--unitHeader)}.Icon.IconClose{color:var(--colorSecondary)}.ModalHeaderTitle{flex:1;margin-left:.25em}.ModalFooter{color:var(--colorSecondary);margin-top:var(--spacing);text-align:center}.ModalFooter[aria-hidden=true]{display:none}.ModalSubheader{font-weight:var(--fontWeightBold);user-select:none}.ModalDescription{color:var(--colorPrimary)}.ModalAddress,.ModalSubheader{margin-bottom:var(--spacing)}.ModalAddress.ModalAddressApprove{color:var(--colorPrimary)}.Button{border-radius:var(--borderRadius);cursor:pointer;font-weight:var(--fontWeightSemibold);margin-top:var(--spacing);padding:var(--padding);text-align:center;user-select:none;width:100%}.Button[aria-hidden=true]{display:none}.Button.ButtonPrimary{background-color:var(--colorPrimary);color:var(--colorBackground)}.Button.ButtonSecondary{border:1px solid var(--colorSecondary);color:var(--colorSecondary)}@keyframes fadein{0%{opacity:0}to{opacity:1}}.MapboxAddressMinimap{font-family:var(--fontFamily);font-size:var(--unit);font-weight:var(--fontWeight);line-height:var(--lineHeight)}.MapboxAddressMinimap[aria-hidden=true]{display:none}.MinimapImageContainer{border-radius:var(--borderRadius);overflow:hidden}.MinimapImage{height:unset;max-height:unset;max-width:unset;position:relative;width:unset}.MinimapInnerFrame{border:var(--border);border-radius:inherit;height:inherit;left:0;overflow:hidden;position:absolute;top:0;width:inherit}.MinimapMarker{left:50%;position:absolute;top:50%}.MinimapMarker>svg{color:var(--colorPrimary);display:block!important}.MinimapAttributionLogo{bottom:0;left:0;margin:0 0 6px 6px;position:absolute}.MinimapAttributionLogo a{cursor:pointer;display:block;height:23px;width:88px}.MinimapAttributionText{background-color:hsla(0,0%,100%,.65);bottom:0;font:11px/16px Helvetica Neue,Arial,Helvetica,sans-serif;padding:0 5px;position:absolute;right:0}.MinimapAttributionText a{color:rgba(0,0,0,.75);text-decoration:none}.MinimapAttributionText a:hover{color:inherit;text-decoration:underline}.MinimapAttributionText a:not(:first-child){margin-left:3px}.MinimapStyleToggle{background-position:0;background-repeat:no-repeat;background-size:contain;border:2px solid #fff;border-radius:3px;box-shadow:var(--boxShadow);cursor:pointer;height:2em;position:absolute;right:var(--spacing);top:var(--spacing);width:2em}.MinimapFooter{color:var(--colorSecondary);font-family:var(--fontFamily);font-size:var(--unit);margin-top:var(--spacing)}.MinimapFooter[aria-hidden=true]{display:none}.MinimapEditButtons{bottom:26px;display:flex;font-family:var(--fontFamily);position:absolute;right:var(--spacing)}.MinimapEditButtons .Button{box-shadow:var(--boxShadow)}.MinimapButtonCancel{background-color:var(--colorBackground);margin-left:var(--spacing)}.draggable{cursor:move;cursor:grab}.draggable:active{cursor:grabbing}\";\n\n// src/MapboxHTMLEvent.ts\nvar MapboxHTMLEvent = class extends CustomEvent {\n  constructor(type, detail) {\n    super(type, {\n      composed: true,\n      detail\n    });\n  }\n  clone(newTarget) {\n    const eventClone = new MapboxHTMLEvent(this.type, this.detail);\n    if (newTarget) {\n      Object.defineProperty(eventClone, \"target\", { value: newTarget });\n    }\n    return eventClone;\n  }\n};\n\n// src/utils/aria/messages.ts\nvar LENGTH_MESSAGE = \"Type in 2 or more characters for results.\";\nvar KEYBOARD_NAVIGATION_GUIDE_MESSAGE = \"When autocomplete results are available use up and down arrows to review and enter to select. Touch device users, explore by touch or with swipe gestures.\";\nvar NO_SEARCH_RESULTS_MESSAGE = \"No search results.\";\nvar getSuggestionSelectedMessage = (address, numberOfResults, currentIndex) => `${numberOfResults} ${numberOfResults === 1 ? \"result is\" : \"results are\"} available. ${address}. ${currentIndex} of ${numberOfResults} is selected.`;\nvar getSuggestionsReadyMessage = (numberOfResults) => `${numberOfResults} ${numberOfResults === 1 ? \"result is\" : \"results are\"} available. Use up and down arrows to review and enter to select. Touch device users, explore by touch or with swipe gestures.`;\n\n// src/utils/aria/index.ts\nfunction ariaButtonKeyDown(e) {\n  const el = e.currentTarget;\n  if (e.key === \" \" || e.key === \"Enter\") {\n    e.preventDefault();\n    e.stopPropagation();\n    el.dispatchEvent(new MouseEvent(\"click\", {\n      bubbles: true,\n      composed: true\n    }));\n  }\n}\nvar ARIA_DESCRIPTION_ID = \"search-listbox__description\";\nvar createAriaLiveElement = (seed) => {\n  const container = document.createElement(\"div\");\n  container.setAttribute(\"aria-live\", \"polite\");\n  container.setAttribute(\"aria-atomic\", \"true\");\n  container.setAttribute(\"role\", \"status\");\n  container.setAttribute(\"style\", \"border: 0px;clip: rect(0px, 0px, 0px, 0px);height: 1px;margin-bottom: -1px;margin-right: -1px;overflow: hidden;padding: 0px;position: absolute;white-space: nowrap;width: 1px;\");\n  const description = document.createElement(\"div\");\n  description.setAttribute(\"id\", `${seed}--${ARIA_DESCRIPTION_ID}`);\n  container.appendChild(description);\n  return container;\n};\nvar setLiveRegionMessage = (message, seed) => {\n  var _a;\n  const description = (_a = document.body.querySelector(`[id=\"${seed}--${ARIA_DESCRIPTION_ID}\"]`)) != null ? _a : null;\n  if (description) {\n    description.textContent = message;\n  }\n};\nvar suppressExtensionsAutocomplete = (input) => {\n  input.name = input.name + \" address-search\";\n  input.setAttribute(\"data-lpignore\", \"true\");\n};\nvar getAriaMessage = (searchValue, suggestions, selectedIndex) => {\n  let ariaMessage = null;\n  const noResults = !suggestions || suggestions.length === 0;\n  if ((searchValue == null ? void 0 : searchValue.length) < 2) {\n    ariaMessage = LENGTH_MESSAGE + \" \" + KEYBOARD_NAVIGATION_GUIDE_MESSAGE;\n  } else if (noResults) {\n    ariaMessage = NO_SEARCH_RESULTS_MESSAGE;\n  } else if (selectedIndex !== void 0) {\n    const suggestion = suggestions[selectedIndex];\n    const placeName = suggestion.name || suggestion.feature_name || suggestion.properties.name;\n    ariaMessage = getSuggestionSelectedMessage(placeName, suggestions.length, selectedIndex + 1);\n  } else {\n    ariaMessage = getSuggestionsReadyMessage(suggestions.length);\n  }\n  return ariaMessage;\n};\n\n// src/utils/listbox.ts\nvar getSuggestionTitle = (item, service) => {\n  switch (service) {\n    case 0 /* AddressAutofill */:\n      return item.matching_name || item.feature_name || item.address_line1;\n    case 2 /* SearchBox */:\n      return item.name;\n    case 1 /* Geocoding */:\n      return item.properties.name;\n    default:\n      return \"\";\n  }\n};\nvar buildSuggestionDescription = (item, service) => {\n  switch (service) {\n    case 0 /* AddressAutofill */:\n      return item.description;\n    case 2 /* SearchBox */:\n      if (item.feature_type === \"poi\") {\n        return item.full_address;\n      }\n      return item.place_formatted;\n    case 1 /* Geocoding */:\n      return item.properties.place_formatted;\n    default:\n      return \"\";\n  }\n};\n\n// src/components/MapboxSearchListbox.ts\nfunction getAriaIdForSuggestion(resultListId, i) {\n  return `${resultListId}-${i}`;\n}\nvar _popover, _binding, _labelID, _resultListID, _inputInternal, _searchService, _selectedIndexInternal, _showResults, showResults_fn, _renderResultsList, renderResultsList_fn, _themeInternal, _popoverOptions, _handleInput, _handleSelect, _handleFocus, _handleBlur, _handleKeyDown;\nvar MapboxSearchListbox = class extends HTMLScopedElement {\n  constructor() {\n    super(...arguments);\n    __privateAdd(this, _showResults);\n    __privateAdd(this, _renderResultsList);\n    this.suggestions = null;\n    __privateAdd(this, _popover, null);\n    __privateAdd(this, _binding, void 0);\n    __privateAdd(this, _labelID, void 0);\n    __privateAdd(this, _resultListID, void 0);\n    __privateAdd(this, _inputInternal, void 0);\n    __privateAdd(this, _searchService, null);\n    __privateAdd(this, _selectedIndexInternal, void 0);\n    __privateAdd(this, _themeInternal, {});\n    __privateAdd(this, _popoverOptions, {});\n    __privateAdd(this, _handleInput, (e) => {\n      const { Results } = __privateGet(this, _binding);\n      const input = e.target;\n      if (input.dataset[\"mapboxSuccess\"]) {\n        delete input.dataset[\"mapboxSuccess\"];\n        return;\n      }\n      const searchText = input.value;\n      this.renderAriaMessage();\n      Results.setAttribute(\"aria-busy\", \"true\");\n      this.dispatchEvent(new MapboxHTMLEvent(\"input\", searchText));\n    });\n    this.renderAriaMessage = () => {\n      var _a;\n      const message = getAriaMessage((_a = this.input) == null ? void 0 : _a.value, this.suggestions, this.selectedIndex);\n      setLiveRegionMessage(message, this.dataset.seed);\n    };\n    this.clearAriaMessage = () => {\n      setLiveRegionMessage(\"\", this.dataset.seed);\n    };\n    this.handleSuggest = (suggestions) => {\n      this.suggestions = suggestions;\n      if (!suggestions || suggestions.length === 0) {\n        this.renderAriaMessage();\n      }\n      if (!suggestions) {\n        this.hideResults();\n        return;\n      }\n      __privateMethod(this, _renderResultsList, renderResultsList_fn).call(this);\n      if (suggestions.length) {\n        __privateMethod(this, _showResults, showResults_fn).call(this);\n      }\n      const { Results } = __privateGet(this, _binding);\n      Results.setAttribute(\"aria-busy\", \"false\");\n    };\n    this.handleError = () => {\n      const { Results } = __privateGet(this, _binding);\n      Results.setAttribute(\"aria-busy\", \"false\");\n      this.hideResults();\n    };\n    __privateAdd(this, _handleSelect, (suggestion) => __async(this, null, function* () {\n      const input = this.input;\n      if (input) {\n        input.dataset[\"mapboxSuccess\"] = \"true\";\n      }\n      this.dispatchEvent(new MapboxHTMLEvent(\"select\", suggestion));\n      this.hideResults();\n    }));\n    __privateAdd(this, _handleFocus, () => {\n      const input = this.input;\n      delete input.dataset[\"mapboxSuccess\"];\n      this.dispatchEvent(new MapboxHTMLEvent(\"focus\"));\n      this.renderAriaMessage();\n      __privateMethod(this, _showResults, showResults_fn).call(this);\n    });\n    __privateAdd(this, _handleBlur, () => {\n      if (document.activeElement === this.input) {\n        return;\n      }\n      this.dispatchEvent(new MapboxHTMLEvent(\"blur\"));\n      this.clearAriaMessage();\n      this.hideResults();\n    });\n    this.handleArrowUp = () => {\n      if (this.selectedIndex === void 0) {\n        this.selectedIndex = this.suggestions.length - 1;\n      } else if (this.selectedIndex === 0) {\n        this.selectedIndex = void 0;\n      } else {\n        this.selectedIndex = Math.max(0, this.selectedIndex - 1);\n      }\n    };\n    this.handleArrowDown = () => {\n      if (this.selectedIndex === void 0) {\n        this.selectedIndex = 0;\n      } else if (this.selectedIndex === this.suggestions.length - 1) {\n        this.selectedIndex = void 0;\n      } else {\n        this.selectedIndex = Math.min(this.selectedIndex + 1, this.suggestions.length - 1);\n      }\n    };\n    __privateAdd(this, _handleKeyDown, (e) => {\n      var _a;\n      if (!((_a = this.suggestions) == null ? void 0 : _a.length))\n        return;\n      if (e.key === \"ArrowDown\") {\n        e.preventDefault();\n        this.handleArrowDown();\n        return;\n      }\n      if (e.key === \"ArrowUp\") {\n        e.preventDefault();\n        this.handleArrowUp();\n        return;\n      }\n      if (e.key === \"Escape\") {\n        this.hideResults();\n        return;\n      }\n      if (this.selectedIndex === void 0) {\n        return;\n      }\n      if (e.key === \"Tab\") {\n        __privateGet(this, _handleSelect).call(this, this.suggestions[this.selectedIndex]);\n        return;\n      }\n      if (e.key === \"Enter\") {\n        e.preventDefault();\n        __privateGet(this, _handleSelect).call(this, this.suggestions[this.selectedIndex]);\n        return;\n      }\n    });\n  }\n  get template() {\n    return LISTBOX_TEMPLATE;\n  }\n  get templateStyle() {\n    return style_default;\n  }\n  get templateUserStyle() {\n    return getThemeCSS(\".MapboxSearch\", this.theme);\n  }\n  get input() {\n    return __privateGet(this, _inputInternal);\n  }\n  set input(newInput) {\n    const oldInput = __privateGet(this, _inputInternal);\n    if (oldInput) {\n      oldInput.removeEventListener(\"input\", __privateGet(this, _handleInput));\n      oldInput.removeEventListener(\"focus\", __privateGet(this, _handleFocus));\n      oldInput.removeEventListener(\"blur\", __privateGet(this, _handleBlur));\n      oldInput.removeEventListener(\"keydown\", __privateGet(this, _handleKeyDown));\n      if (__privateGet(this, _popover)) {\n        __privateGet(this, _popover).destroy();\n      }\n    }\n    if (newInput) {\n      newInput.addEventListener(\"input\", __privateGet(this, _handleInput));\n      newInput.addEventListener(\"focus\", __privateGet(this, _handleFocus));\n      newInput.addEventListener(\"blur\", __privateGet(this, _handleBlur));\n      newInput.addEventListener(\"keydown\", __privateGet(this, _handleKeyDown));\n      newInput.setAttribute(\"role\", \"combobox\");\n      newInput.setAttribute(\"aria-autocomplete\", \"list\");\n      newInput.setAttribute(\"aria-controls\", __privateGet(this, _resultListID));\n      if (this.isConnected) {\n        __privateSet(this, _popover, new Popover(newInput, __privateGet(this, _binding).Results, this.popoverOptions));\n      }\n    }\n    __privateSet(this, _inputInternal, newInput);\n  }\n  get searchService() {\n    return __privateGet(this, _searchService);\n  }\n  set searchService(service) {\n    __privateSet(this, _searchService, service);\n  }\n  get selectedIndex() {\n    return __privateGet(this, _selectedIndexInternal);\n  }\n  set selectedIndex(newIndex) {\n    const oldIndex = __privateGet(this, _selectedIndexInternal);\n    __privateSet(this, _selectedIndexInternal, newIndex);\n    const { ResultsList } = __privateGet(this, _binding);\n    const id = getAriaIdForSuggestion(__privateGet(this, _resultListID), newIndex);\n    if (newIndex !== void 0) {\n      this.input.setAttribute(\"aria-activedescendant\", id);\n      ResultsList.setAttribute(\"aria-activedescendant\", id);\n    } else {\n      this.input.removeAttribute(\"aria-activedescendant\");\n      ResultsList.removeAttribute(\"aria-activedescendant\");\n    }\n    if (oldIndex !== newIndex) {\n      const oldId = getAriaIdForSuggestion(__privateGet(this, _resultListID), oldIndex);\n      const oldEl = ResultsList.querySelector(`#${oldId}`);\n      oldEl == null ? void 0 : oldEl.removeAttribute(\"aria-selected\");\n      oldEl == null ? void 0 : oldEl.setAttribute(\"tabindex\", \"-1\");\n      if (newIndex !== void 0) {\n        const el = ResultsList.querySelector(`#${id}`);\n        el == null ? void 0 : el.setAttribute(\"aria-selected\", \"true\");\n        el == null ? void 0 : el.setAttribute(\"tabindex\", \"0\");\n      }\n    }\n    this.renderAriaMessage();\n  }\n  hideResults() {\n    const { Results, ResultsList } = __privateGet(this, _binding);\n    Results.setAttribute(\"aria-hidden\", \"true\");\n    this.input.setAttribute(\"aria-expanded\", \"false\");\n    ResultsList.removeAttribute(\"aria-activedescendant\");\n    this.input.removeAttribute(\"aria-activedescendant\");\n  }\n  renderItem(i) {\n    const element = this.prepareTemplate(LISTBOX_SUGGESTION_TEMPLATE);\n    element.id = getAriaIdForSuggestion(__privateGet(this, _resultListID), i);\n    return element;\n  }\n  fillItem(el, item, i, totalLength) {\n    const iconEl = el.querySelector('[class$=\"SuggestionIcon\"]');\n    const nameEl = el.querySelector('[class$=\"SuggestionName\"]');\n    const descriptionEl = el.querySelector('[class$=\"SuggestionDesc\"]');\n    if (this.searchService === 0 /* AddressAutofill */) {\n      iconEl.innerHTML = getIcon(item.accuracy === \"street\" ? \"street\" : \"addressMarker\", this.theme);\n      iconEl.removeAttribute(\"aria-hidden\");\n    } else {\n      iconEl.setAttribute(\"aria-hidden\", \"true\");\n    }\n    nameEl.textContent = descriptionEl.textContent = \"\";\n    nameEl.textContent = getSuggestionTitle(item, this.searchService);\n    descriptionEl.textContent = buildSuggestionDescription(item, this.searchService);\n    if (i === this.selectedIndex) {\n      el.setAttribute(\"aria-selected\", \"true\");\n    } else {\n      el.removeAttribute(\"aria-selected\");\n    }\n    el.setAttribute(\"aria-posinset\", (i + 1).toString());\n    el.setAttribute(\"aria-setsize\", totalLength.toString());\n  }\n  get theme() {\n    return __privateGet(this, _themeInternal);\n  }\n  set theme(theme) {\n    __privateSet(this, _themeInternal, theme);\n    if (!__privateGet(this, _binding) || !theme) {\n      return;\n    }\n    this.updateTemplateUserStyle(getThemeCSS(\".MapboxSearch\", theme));\n  }\n  get popoverOptions() {\n    return __privateGet(this, _popoverOptions);\n  }\n  set popoverOptions(newOptions) {\n    __privateSet(this, _popoverOptions, newOptions);\n    if (__privateGet(this, _popover)) {\n      __privateGet(this, _popover).options = newOptions;\n      __privateGet(this, _popover).update();\n    }\n  }\n  connectedCallback() {\n    super.connectedCallback();\n    this.dataSeed = this.dataset.seed;\n    __privateSet(this, _labelID, this.dataset.seed + \"-Label\");\n    __privateSet(this, _resultListID, this.dataset.seed + \"-ResultsList\");\n    if (this.input) {\n      this.input.setAttribute(\"aria-controls\", __privateGet(this, _resultListID));\n    }\n    __privateSet(this, _binding, bindElements(this, {\n      MapboxSearch: \".MapboxSearch\",\n      Results: \".Results\",\n      ResultsList: \".ResultsList\",\n      Label: \".Label\"\n    }));\n    const { Results, ResultsList, Label } = __privateGet(this, _binding);\n    Label.id = __privateGet(this, _labelID);\n    ResultsList.id = __privateGet(this, _resultListID);\n    ResultsList.setAttribute(\"aria-labelledby\", __privateGet(this, _labelID));\n    Results.addEventListener(\"blur\", __privateGet(this, _handleBlur));\n    if (!__privateGet(this, _popover) && this.input) {\n      __privateSet(this, _popover, new Popover(this.input, __privateGet(this, _binding).Results, this.popoverOptions));\n    }\n    requestAnimationFrame(() => {\n      if (__privateGet(this, _popover)) {\n        __privateGet(this, _popover).update();\n      }\n    });\n  }\n  disconnectedCallback() {\n    this.input = null;\n    const { Results } = __privateGet(this, _binding);\n    Results.removeEventListener(\"blur\", __privateGet(this, _handleBlur));\n    if (__privateGet(this, _popover))\n      __privateGet(this, _popover).destroy();\n  }\n  focus() {\n    if (document.activeElement === this.input) {\n      __privateGet(this, _handleFocus).call(this);\n    } else {\n      this.input.focus();\n    }\n  }\n  blur() {\n    this.input.blur();\n  }\n  updatePopover() {\n    if (__privateGet(this, _popover)) {\n      __privateGet(this, _popover).update();\n    }\n  }\n};\n_popover = new WeakMap();\n_binding = new WeakMap();\n_labelID = new WeakMap();\n_resultListID = new WeakMap();\n_inputInternal = new WeakMap();\n_searchService = new WeakMap();\n_selectedIndexInternal = new WeakMap();\n_showResults = new WeakSet();\nshowResults_fn = function() {\n  if (!this.suggestions || !this.suggestions.length) {\n    return;\n  }\n  const { Results, MapboxSearch } = __privateGet(this, _binding);\n  const rect = this.input.getBoundingClientRect();\n  MapboxSearch.style.setProperty(\"--width\", `${rect.width}px`);\n  MapboxSearch.style.setProperty(\"display\", \"block\");\n  this.input.setAttribute(\"aria-expanded\", \"true\");\n  Results.removeAttribute(\"aria-hidden\");\n  this.selectedIndex = void 0;\n};\n_renderResultsList = new WeakSet();\nrenderResultsList_fn = function() {\n  const { ResultsList } = __privateGet(this, _binding);\n  if (!this.suggestions || !this.suggestions.length) {\n    ResultsList.innerHTML = \"\";\n    this.hideResults();\n    return;\n  }\n  const elements = getChildElements(ResultsList);\n  if (this.suggestions.length > elements.length) {\n    for (let i = elements.length; i < this.suggestions.length; i++) {\n      const item = this.renderItem(i);\n      elements.push(item);\n      item.onmouseenter = () => {\n        this.selectedIndex = i;\n      };\n      item.onmouseleave = () => {\n        this.selectedIndex = void 0;\n      };\n      ResultsList.appendChild(item);\n    }\n  }\n  if (this.suggestions.length < elements.length) {\n    for (let i = this.suggestions.length; i < elements.length; i++) {\n      elements[i].remove();\n    }\n  }\n  for (const suggestion of this.suggestions) {\n    const i = this.suggestions.indexOf(suggestion);\n    const element = elements[i];\n    this.fillItem(element, suggestion, i, this.suggestions.length);\n    element.onclick = () => {\n      __privateGet(this, _handleSelect).call(this, suggestion);\n    };\n  }\n};\n_themeInternal = new WeakMap();\n_popoverOptions = new WeakMap();\n_handleInput = new WeakMap();\n_handleSelect = new WeakMap();\n_handleFocus = new WeakMap();\n_handleBlur = new WeakMap();\n_handleKeyDown = new WeakMap();\nwindow.MapboxSearchListbox = MapboxSearchListbox;\nif (!window.customElements.get(\"mapbox-search-listbox\")) {\n  customElements.define(\"mapbox-search-listbox\", MapboxSearchListbox);\n}\n\n// src/utils/autofill.ts\n\nvar AUTOFILL_TOKENS = /* @__PURE__ */ new Set([\n  \"street-address\",\n  \"address-line1\",\n  \"address-line2\",\n  \"address-line3\",\n  \"address-level4\",\n  \"address-level3\",\n  \"address-level2\",\n  \"address-level1\",\n  \"country\",\n  \"country-name\",\n  \"postal-code\"\n]);\nvar AUTOFILL_SKIP_TOKENS = /* @__PURE__ */ new Set([\"off\", \"on\", \"true\", \"false\"]);\nfunction findParentForm(el) {\n  let node = el.parentNode;\n  while (node) {\n    if (node instanceof HTMLFormElement) {\n      return node;\n    }\n    node = node.parentNode;\n  }\n  return null;\n}\nfunction findAddressInputs(form) {\n  const parent = form || document;\n  return Array.from(parent.querySelectorAll('input[autocomplete~=\"address-line1\"], input[autocomplete~=\"street-address\"]'));\n}\nvar SECTION = \"section-\";\nvar SECTION_DEFAULT = \"section-default\";\nvar SECTION_SHIPPING = \"section-shipping\";\nvar SECTION_BILLING = \"section-billing\";\nfunction parseFormStructure(form) {\n  const inputs = Array.from(form.querySelectorAll(\"[autocomplete]\")).filter((el) => {\n    const tagName = el.tagName.toLowerCase();\n    return tagName === \"input\" || tagName === \"select\" || tagName === \"textarea\";\n  });\n  const res = [];\n  for (const input of inputs) {\n    if (!isVisible(input)) {\n      continue;\n    }\n    const autocomplete = input.getAttribute(\"autocomplete\") || \"\";\n    if (!autocomplete || AUTOFILL_SKIP_TOKENS.has(autocomplete)) {\n      continue;\n    }\n    const tokens = autocomplete.toLowerCase().split(\" \");\n    if (tokens.length > 3) {\n      continue;\n    }\n    const field = tokens[tokens.length - 1];\n    if (!AUTOFILL_TOKENS.has(field)) {\n      continue;\n    }\n    tokens.pop();\n    let section = SECTION_DEFAULT;\n    if (tokens.length) {\n      const sectionToken = tokens[tokens.length - 1];\n      if (sectionToken === \"shipping\") {\n        section = SECTION_SHIPPING;\n        tokens.pop();\n      }\n      if (sectionToken === \"billing\") {\n        section = SECTION_BILLING;\n        tokens.pop();\n      }\n    }\n    if (tokens.length) {\n      const sectionToken = tokens[tokens.length - 1];\n      if (sectionToken.startsWith(SECTION)) {\n        section = sectionToken;\n      }\n    }\n    res.push({\n      input,\n      section,\n      field\n    });\n  }\n  return res;\n}\nfunction findAddressAutofillInputs(form, ref) {\n  const logicalSections = [];\n  const logicalSectionSections = [];\n  const formStructure = parseFormStructure(form);\n  let foundSection = null;\n  for (const { input, section, field } of formStructure) {\n    let lastIndex = logicalSections.length - 1;\n    let createNewSection = false;\n    if (!logicalSections.length) {\n      createNewSection = true;\n    } else if (logicalSectionSections[lastIndex] !== section) {\n      createNewSection = true;\n    } else if (logicalSections[lastIndex][field]) {\n      createNewSection = true;\n    }\n    if (createNewSection) {\n      if (foundSection) {\n        break;\n      }\n      logicalSections.push({\n        [field]: input\n      });\n      logicalSectionSections.push(section);\n      lastIndex++;\n    } else {\n      logicalSections[lastIndex][field] = input;\n    }\n    if (input === ref) {\n      foundSection = logicalSections[lastIndex];\n    }\n  }\n  return foundSection != null ? foundSection : {};\n}\nfunction setFormAutofillValues(form, ref, suggestion) {\n  var _a;\n  const map = findAddressAutofillInputs(form, ref);\n  const streetAddress = [\n    suggestion.address_line1,\n    suggestion.address_line2,\n    suggestion.address_line3\n  ].filter((part) => Boolean(part)).join(\", \");\n  setValue(map[\"street-address\"], map[\"address-line2\"] ? suggestion.address_line1 || \"\" : streetAddress);\n  setValue(map[\"address-line1\"], suggestion.address_line1 || \"\");\n  setValue(map[\"address-line2\"], suggestion.address_line2 || \"\");\n  setValue(map[\"address-level1\"], suggestion.address_level1 || \"\");\n  setValue(map[\"address-level2\"], suggestion.address_level2 || \"\");\n  setValue(map[\"address-level3\"], suggestion.address_level3 || \"\");\n  const countryCode = suggestion.country_code || ((_a = suggestion.metadata) == null ? void 0 : _a.iso_3166_1) || \"\";\n  if (map.country && map.country instanceof HTMLSelectElement) {\n    let firstOption = map.country.querySelector(`option`).value;\n    if (firstOption === \"\") {\n      firstOption = map.country.querySelectorAll(`option`)[1].value;\n    }\n    const isUpperCase = firstOption === firstOption.toUpperCase();\n    setValue(map[\"country\"], isUpperCase ? countryCode.toUpperCase() : countryCode);\n  } else {\n    setValue(map[\"country\"], countryCode);\n  }\n  setValue(map[\"country-name\"], suggestion.country || \"\");\n  setValue(map[\"postal-code\"], suggestion.postcode || \"\");\n}\nfunction getFormAutofillValues(form, ref) {\n  const map = findAddressAutofillInputs(form, ref);\n  const values = {};\n  for (const [key, input] of Object.entries(map)) {\n    if (input == null ? void 0 : input.value) {\n      values[key] = input.value;\n    }\n  }\n  return values;\n}\nfunction getAutofillSearchText(snapshot) {\n  const searchText = [];\n  if (snapshot[\"street-address\"]) {\n    searchText.push(snapshot[\"street-address\"]);\n  } else {\n    searchText.push(snapshot[\"address-line1\"] || \"\");\n  }\n  searchText.push(snapshot[\"address-line2\"] || \"\");\n  searchText.push(snapshot[\"address-line3\"] || \"\");\n  searchText.push(snapshot[\"address-level3\"] || \"\");\n  searchText.push(snapshot[\"address-level2\"] || \"\");\n  searchText.push(snapshot[\"address-level1\"] || \"\");\n  searchText.push(snapshot[\"postal-code\"] || \"\");\n  if (snapshot[\"country-name\"]) {\n    searchText.push(snapshot[\"country-name\"]);\n  } else {\n    searchText.push(snapshot[\"country\"] || \"\");\n  }\n  return searchText.filter((part) => Boolean(part)).map((part) => part.trim()).join(\", \");\n}\nfunction fillFormWithFeature(feature, input) {\n  const form = findParentForm(input);\n  if (!form) {\n    return;\n  }\n  const suggestion = (0,_mapbox_search_js_core__WEBPACK_IMPORTED_MODULE_0__.featureToSuggestion)(feature);\n  setFormAutofillValues(form, input, suggestion);\n  const inputMap = findAddressAutofillInputs(form, input);\n  if (inputMap[\"address-line2\"] && !suggestion.address_line2) {\n    inputMap[\"address-line2\"].focus();\n  }\n}\nfunction featureToAutofillValueMap(feature) {\n  var _a;\n  const values = {};\n  const streetAddress = [\n    feature.properties.address_line1,\n    feature.properties.address_line2,\n    feature.properties.address_line3\n  ].filter((part) => Boolean(part)).join(\", \");\n  values[\"street-address\"] = streetAddress;\n  values[\"address-line1\"] = feature.properties.address_line1;\n  values[\"address-line2\"] = feature.properties.address_line2;\n  values[\"address-line3\"] = feature.properties.address_line3;\n  values[\"address-level1\"] = feature.properties.address_level1;\n  values[\"address-level2\"] = feature.properties.address_level2;\n  values[\"address-level3\"] = feature.properties.address_level3;\n  values[\"country\"] = (_a = feature.properties.metadata) == null ? void 0 : _a.iso_3166_1;\n  values[\"country-name\"] = feature.properties.country;\n  values[\"postal-code\"] = feature.properties.postcode;\n  return values;\n}\nfunction checkAutofillValuesChanged(targetMap, referenceMap) {\n  for (const [key, value] of Object.entries(targetMap)) {\n    if (referenceMap[key] !== value)\n      return true;\n  }\n  return false;\n}\nvar distinctExactStreetResults = (suggestions) => {\n  return suggestions.filter((item1, idx, arr) => {\n    const title = getSuggestionTitle(item1, 0 /* AddressAutofill */);\n    return item1.accuracy !== \"street\" || arr.findIndex((item2) => title === getSuggestionTitle(item2, 0 /* AddressAutofill */)) === idx;\n  });\n};\nvar toggleAutocompletion = (input, initialAutocompleteValue, enableBrowserAutocomplete) => {\n  const disableValue = \"new-password\";\n  const defaultFallbackValue = \"address-line1\";\n  const autocompleteValue = enableBrowserAutocomplete ? initialAutocompleteValue || defaultFallbackValue : disableValue;\n  if (input) {\n    input.autocomplete = autocompleteValue;\n  }\n};\nvar handleStreetSelection = (input, initialAutocompleteValue, suggestion) => {\n  if (!input || !suggestion) {\n    return;\n  }\n  toggleAutocompletion(input, initialAutocompleteValue, true);\n  const feature = {\n    properties: __spreadProps(__spreadValues({}, suggestion), {\n      address_line1: suggestion.address_line1 + \" \",\n      postcode: null\n    })\n  };\n  fillFormWithFeature(feature, input);\n  toggleAutocompletion(input, initialAutocompleteValue, false);\n  input == null ? void 0 : input.focus();\n};\n\n// src/confirmAddress.ts\n\n\n// src/components/MapboxAddressConfirmation.ts\n\n\n\n\n// src/config.ts\n\nvar Config = class {\n  constructor() {\n    this.feedbackEnabled = true;\n    this.autofillSessionToken = new _mapbox_search_js_core__WEBPACK_IMPORTED_MODULE_0__.SessionToken();\n    this.autofillSessionEnabled = false;\n    this.detectBrowserAutofillEnabled = false;\n  }\n};\nvar config = new Config();\nObject.defineProperty(config, \"autofillSessionToken\", {\n  configurable: false,\n  writable: false\n});\n\n// src/components/MapboxAddressConfirmation.ts\nvar TEMPLATE = createElementFromString(`\n<template>\n  <div class=\"MapboxAddressConfirmation\" aria-hidden=\"true\">\n    <mapbox-address-confirmation-feature class=\"ContentFeature\"></mapbox-address-confirmation-feature>\n    <mapbox-address-confirmation-no-feature class=\"ContentNoFeature\"></mapbox-address-confirmation-no-feature>\n  </div>\n</template>\n`);\nvar _show, _binding2, _focusTrap, _themeInternal2;\nvar MapboxAddressConfirmation = class extends HTMLScopedElement {\n  constructor() {\n    super(...arguments);\n    __privateAdd(this, _show, false);\n    __privateAdd(this, _binding2, void 0);\n    __privateAdd(this, _focusTrap, void 0);\n    __privateAdd(this, _themeInternal2, {});\n  }\n  get template() {\n    return TEMPLATE;\n  }\n  get templateStyle() {\n    return style_default;\n  }\n  get templateUserStyle() {\n    return getThemeCSS(\".MapboxAddressConfirmation\", this.theme);\n  }\n  get theme() {\n    return __privateGet(this, _themeInternal2);\n  }\n  set theme(theme) {\n    __privateSet(this, _themeInternal2, theme);\n    if (!__privateGet(this, _binding2) || !theme) {\n      return;\n    }\n    this.updateTemplateUserStyle(getThemeCSS(\".MapboxAddressConfirmation\", theme));\n    const { ContentFeature, ContentNoFeature } = __privateGet(this, _binding2);\n    ContentFeature.theme = theme;\n    ContentNoFeature.theme = theme;\n  }\n  connectedCallback() {\n    super.connectedCallback();\n    __privateSet(this, _binding2, bindElements(this, {\n      MapboxAddressConfirmation: \".MapboxAddressConfirmation\",\n      ContentFeature: \".ContentFeature\",\n      ContentNoFeature: \".ContentNoFeature\"\n    }));\n    const { MapboxAddressConfirmation: MapboxAddressConfirmation2 } = __privateGet(this, _binding2);\n    MapboxAddressConfirmation2.setAttribute(\"aria-hidden\", \"true\");\n    const theme = this.theme;\n    if (theme) {\n      const { ContentFeature, ContentNoFeature } = __privateGet(this, _binding2);\n      ContentFeature.theme = theme;\n      ContentNoFeature.theme = theme;\n    }\n  }\n  disconnectedCallback() {\n    __privateSet(this, _focusTrap, null);\n  }\n  hide() {\n    var _a;\n    __privateSet(this, _show, false);\n    if (!__privateGet(this, _binding2)) {\n      return;\n    }\n    const { MapboxAddressConfirmation: MapboxAddressConfirmation2 } = __privateGet(this, _binding2);\n    MapboxAddressConfirmation2.setAttribute(\"aria-hidden\", \"true\");\n    (_a = __privateGet(this, _focusTrap)) == null ? void 0 : _a.deactivate();\n    no_scroll__WEBPACK_IMPORTED_MODULE_3___default().off();\n  }\n  show(autofillValues, optionsArg, feature) {\n    return __async(this, null, function* () {\n      var _a;\n      if (!__privateGet(this, _binding2)) {\n        return { type: \"cancel\" };\n      }\n      const { MapboxAddressConfirmation: MapboxAddressConfirmation2, ContentFeature, ContentNoFeature } = __privateGet(this, _binding2);\n      const { accessToken, minimap = false, theme, footer } = optionsArg;\n      this.theme = theme;\n      if (feature) {\n        ContentFeature.removeAttribute(\"aria-hidden\");\n        ContentNoFeature.setAttribute(\"aria-hidden\", \"true\");\n        ContentFeature.minimap = minimap;\n        ContentFeature.accessToken = accessToken;\n        ContentFeature.footer = footer;\n        ContentFeature.update(feature, autofillValues);\n      } else {\n        ContentFeature.setAttribute(\"aria-hidden\", \"true\");\n        ContentNoFeature.removeAttribute(\"aria-hidden\");\n        ContentNoFeature.update(autofillValues);\n      }\n      __privateSet(this, _show, true);\n      MapboxAddressConfirmation2.removeAttribute(\"aria-hidden\");\n      no_scroll__WEBPACK_IMPORTED_MODULE_3___default().on();\n      const activeContentElement = feature ? ContentFeature : ContentNoFeature;\n      __privateSet(this, _focusTrap, (0,focus_trap__WEBPACK_IMPORTED_MODULE_4__.createFocusTrap)(MapboxAddressConfirmation2, {\n        fallbackFocus: activeContentElement,\n        escapeDeactivates: () => {\n          this.hide();\n          return true;\n        }\n      }));\n      (_a = __privateGet(this, _focusTrap)) == null ? void 0 : _a.activate();\n      return new Promise((resolve) => {\n        const eventHost = activeContentElement;\n        const fn = (e) => {\n          eventHost.removeEventListener(\"result\", fn);\n          const result = e.detail;\n          this.hide();\n          if (result === \"change\") {\n            resolve({\n              type: \"change\",\n              feature\n            });\n          } else {\n            resolve({\n              type: result\n            });\n          }\n        };\n        eventHost.addEventListener(\"result\", fn);\n      });\n    });\n  }\n  tryShow(autofillValues, optionsArg) {\n    return __async(this, null, function* () {\n      if (!__privateGet(this, _binding2)) {\n        return { type: \"cancel\" };\n      }\n      const { accessToken, options = {} } = optionsArg;\n      const validate = new _mapbox_search_js_core__WEBPACK_IMPORTED_MODULE_0__.ValidationCore(__spreadValues({\n        accessToken\n      }, options));\n      const searchText = getAutofillSearchText(autofillValues);\n      const featureCollection = yield validate.validate(searchText, {\n        sessionToken: config.autofillSessionToken\n      });\n      const feature = featureCollection.features[0];\n      if (feature) {\n        const defaultValidation = (feature2) => feature2.properties.match_code.confidence === _mapbox_search_js_core__WEBPACK_IMPORTED_MODULE_0__.MatchCodeConfidence.exact;\n        const { skipConfirmModal = defaultValidation } = optionsArg;\n        if (skipConfirmModal(feature)) {\n          return { type: \"nochange\" };\n        }\n      }\n      return yield this.show(autofillValues, optionsArg, feature);\n    });\n  }\n};\n_show = new WeakMap();\n_binding2 = new WeakMap();\n_focusTrap = new WeakMap();\n_themeInternal2 = new WeakMap();\nwindow.MapboxAddressConfirmation = MapboxAddressConfirmation;\nif (!window.customElements.get(\"mapbox-address-confirmation\")) {\n  customElements.define(\"mapbox-address-confirmation\", MapboxAddressConfirmation);\n}\n\n// src/confirmAddress.ts\nvar confirmation = new MapboxAddressConfirmation();\nfunction confirmAddress(_0) {\n  return __async(this, arguments, function* (form, optionsArg = {}) {\n    var _a;\n    const { sections = [] } = optionsArg;\n    if (!confirmation.parentNode) {\n      document.body.appendChild(confirmation);\n    }\n    let collectedResult = { type: \"nochange\" };\n    const inputs = findAddressInputs(form);\n    const structure = parseFormStructure(form);\n    const listboxComponents = Array.from(document.querySelectorAll(\"mapbox-search-listbox\"));\n    for (const input of inputs) {\n      if (sections.length) {\n        const structureRef = structure.find((s) => s.input === input);\n        if (!structureRef) {\n          continue;\n        }\n        if (!sections.includes(structureRef.section)) {\n          continue;\n        }\n      }\n      const autofillValues = getFormAutofillValues(form, input);\n      const listbox = listboxComponents.find((lb) => lb.input === input);\n      const autofill2 = listbox == null ? void 0 : listbox.autofillHost;\n      if (autofill2) {\n        const lastRetrievedFeature = autofill2.retrieveFeature;\n        if (lastRetrievedFeature) {\n          const snapshot = featureToAutofillValueMap(lastRetrievedFeature);\n          if (!checkAutofillValuesChanged(autofillValues, snapshot)) {\n            continue;\n          }\n        }\n      }\n      const accessToken = optionsArg.accessToken || config.accessToken;\n      const result = yield confirmation.tryShow(autofillValues, __spreadProps(__spreadValues({}, optionsArg), {\n        accessToken\n      }));\n      if (result.type === \"change\") {\n        const inputMap = findAddressAutofillInputs(form, input);\n        if ((_a = inputMap[\"address-line2\"]) == null ? void 0 : _a.value) {\n          result.feature.properties.address_line2 = inputMap[\"address-line2\"].value;\n        }\n        if (listbox) {\n          autofill2.simulateRetrieve(result.feature);\n        } else {\n          input.dataset[\"mapboxSuccess\"] = \"true\";\n          const suggestion = (0,_mapbox_search_js_core__WEBPACK_IMPORTED_MODULE_0__.featureToSuggestion)(result.feature);\n          setFormAutofillValues(form, input, suggestion);\n        }\n      }\n      if (result.type === \"change\" && collectedResult.type !== \"cancel\") {\n        collectedResult = result;\n      }\n      if (result.type === \"cancel\") {\n        collectedResult = result;\n      }\n    }\n    return collectedResult;\n  });\n}\n\n// src/utils/confirmation.ts\nfunction createAddressElement(autofillValues, baseAddress, featureName, featureDescription, isSecondary) {\n  if (baseAddress) {\n    const element = createElementFromString(`\n        <span>\n          <span></span>\n          <br />\n          <span></span>\n        </span>\n      `);\n    const [firstLine, lastLine] = Array.from(element.querySelectorAll(\"span > span\"));\n    if (featureName && featureDescription) {\n      firstLine.textContent = featureName;\n      lastLine.textContent = featureDescription;\n    } else {\n      const parts = baseAddress.split(\",\");\n      firstLine.textContent = parts[0].trim();\n      lastLine.textContent = parts.slice(1).join(\",\").trim();\n    }\n    if (!isSecondary) {\n      if (autofillValues[\"address-line2\"]) {\n        const span = document.createElement(\"span\");\n        span.textContent = autofillValues[\"address-line2\"];\n        element.insertBefore(span, lastLine);\n        element.insertBefore(document.createElement(\"br\"), lastLine);\n      }\n      if (autofillValues[\"address-line3\"]) {\n        const span = document.createElement(\"span\");\n        span.textContent = autofillValues[\"address-line3\"];\n        element.insertBefore(span, lastLine);\n        element.insertBefore(document.createElement(\"br\"), lastLine);\n      }\n    }\n    return element;\n  } else {\n    const firstLine = autofillValues[\"street-address\"] || autofillValues[\"address-line1\"] || \"\";\n    const line2 = autofillValues[\"address-line2\"];\n    const line3 = autofillValues[\"address-line3\"];\n    const lastLine = [\n      autofillValues[\"address-level4\"] || \"\",\n      autofillValues[\"address-level3\"] || \"\",\n      autofillValues[\"address-level2\"] || \"\",\n      `${autofillValues[\"address-level1\"] || \"\"} ${autofillValues[\"postal-code\"] || \"\"}`,\n      autofillValues.country || autofillValues[\"country-name\"] || \"\"\n    ].filter(Boolean).join(\", \");\n    const addressLines = [firstLine, line2, line3, lastLine].filter(Boolean);\n    const addressLinesHtml = addressLines.map((val) => `<span>${val}</span>`).join(\"<br />\");\n    const element = createElementFromString(`\n        <span>${addressLinesHtml}</span>\n      `);\n    return element;\n  }\n}\nfunction tryConfirmBrowserAutofill(input, event, confirmOnBrowserAutofill, accessToken) {\n  return __async(this, null, function* () {\n    if (!confirmOnBrowserAutofill)\n      return;\n    const parentForm = findParentForm(input);\n    const formElements = Object.values(findAddressAutofillInputs(parentForm, input));\n    if (!event.detail.elements.some((el) => formElements.includes(el))) {\n      return;\n    }\n    const structure = parseFormStructure(parentForm);\n    const structureRef = structure.find((s) => s.input === input);\n    const autofillInstanceSection = structureRef.section;\n    const browserAutofilledSections = Array.from(new Set(structure.filter((s) => event.detail.elements.includes(s.input)).map((s) => s.section)));\n    if (!browserAutofilledSections.includes(autofillInstanceSection)) {\n      return;\n    }\n    const optionsSections = typeof confirmOnBrowserAutofill === \"object\" && confirmOnBrowserAutofill.sections || [];\n    if (optionsSections.length && !optionsSections.some((section) => browserAutofilledSections.includes(section))) {\n      return;\n    }\n    let optionsArg = typeof confirmOnBrowserAutofill === \"object\" ? confirmOnBrowserAutofill : {};\n    optionsArg = __spreadProps(__spreadValues({}, optionsArg), {\n      accessToken,\n      sections: [autofillInstanceSection]\n    });\n    yield confirmAddress(parentForm, optionsArg);\n  });\n}\n\n// src/utils/contribute.ts\nvar CONTRIBUTE_API_BASE_URL = \"https://contribute-api.mapbox.com/v1\";\nvar CONTRIBUTE_API_STAGING_BASE_URL = \"https://contribute-api-staging.tilestream.net/v1\";\nvar EDIT_SUGGESTION_ENDPOINT = \"edit-suggestion\";\nfunction sendFeedback(accessToken, feedbackArgs) {\n  if (!config.feedbackEnabled)\n    return;\n  const hostname = window.location.hostname;\n  const BASE_URL = isLocalServer(hostname) || isMapboxDomain(hostname) ? CONTRIBUTE_API_STAGING_BASE_URL : CONTRIBUTE_API_BASE_URL;\n  const url = `${BASE_URL}/${EDIT_SUGGESTION_ENDPOINT}/address?access_token=${accessToken}`;\n  const { originalCoordinate, originalAddress, changes } = feedbackArgs;\n  const payload = {\n    action: \"update\",\n    reason: \"incorrect_address\",\n    location: {\n      longitude: originalCoordinate[0],\n      latitude: originalCoordinate[1]\n    },\n    userEmail: \"no-reply-autofill@mapbox.com\",\n    changes,\n    placeName: originalAddress\n  };\n  fetch(url, {\n    method: \"POST\",\n    headers: new Headers({\n      \"User-Agent\": `mapbox-search-js.${version}.${navigator.userAgent}`,\n      \"Content-Type\": \"application/json\"\n    }),\n    body: JSON.stringify(payload)\n  });\n}\n\n// src/components/MapboxAddressConfirmationFeature.ts\nvar TEMPLATE2 = createElementFromString(`\n<template>\n  <div class=\"MapboxAddressConfirmationFeature\">\n    <div class=\"Modal\" aria-modal=\"true\" role=\"dialog\">\n      <div class=\"ModalHeader\">\n        <svg viewBox=\"0 0 18 18\" class=\"Icon IconQuestion\"></svg>\n        <div class=\"ModalHeaderTitle\">Did you mean?</div>\n        <svg\n          viewBox=\"0 0 18 18\"\n          class=\"Icon IconClose\"\n          tabindex=\"0\"\n          role=\"button\"\n          title=\"Close\"\n          aria-label=\"Close\"\n          aria-expanded=\"true\"\n        ></svg>\n      </div>\n\n      <div class=\"ModalAddress ModalAddressApprove\"></div>\n            \n      <div class=\"ModalMap\">\n        <mapbox-address-minimap class=\"Minimap\"></mapbox-address-minimap>\n      </div>\n\n      <div\n        class=\"Button ButtonPrimary ButtonApprove\"\n        tabindex=\"0\"\n        role=\"button\"\n        aria-label=\"Yes\"\n      >\n        Yes\n      </div>\n      \n      <div\n        class=\"Button ButtonSecondary ButtonReject\"\n        tabindex=\"0\"\n        role=\"button\"\n        aria-label=\"No, use the address I provided\"\n      >\n        No, use the address I provided\n      </div>\n\n      <div class=\"ModalFooter\">\n          Your confirmation helps improve address data accuracy.\n      </div>\n    </div>\n  </div>\n</template>\n`);\nvar _binding3, _themeInternal3, _feature, _formValues, _handleClose, _modalID, _modalHeaderTitleID, _modalAddressApproveID;\nvar MapboxAddressConfirmationFeature = class extends HTMLScopedElement {\n  constructor() {\n    super(...arguments);\n    __privateAdd(this, _binding3, void 0);\n    __privateAdd(this, _themeInternal3, {});\n    this.minimap = false;\n    __privateAdd(this, _feature, void 0);\n    __privateAdd(this, _formValues, void 0);\n    this.update = (feature, autofillValues) => {\n      var _a;\n      __privateSet(this, _feature, feature);\n      __privateSet(this, _formValues, autofillValues);\n      const { ModalMap, Minimap, ModalAddressApprove } = __privateGet(this, _binding3);\n      if (this.minimap) {\n        ModalMap.removeAttribute(\"aria-hidden\");\n        Minimap.accessToken = this.accessToken;\n        if (typeof this.minimap === \"object\") {\n          const { defaultMapStyle, theme, mapStyleMode, satelliteToggle } = this.minimap;\n          defaultMapStyle && (Minimap.defaultMapStyle = this.minimap.defaultMapStyle);\n          theme && (Minimap.theme = this.minimap.theme);\n          mapStyleMode && (Minimap.mapStyleMode = mapStyleMode);\n          satelliteToggle !== void 0 && (Minimap.satelliteToggle = satelliteToggle);\n        }\n        Minimap.feature = feature;\n      } else {\n        ModalMap.setAttribute(\"aria-hidden\", \"true\");\n      }\n      const approveAddress = feature.properties.place_name || feature.properties.full_address || feature.properties.address;\n      ModalAddressApprove.innerHTML = \"\";\n      ModalAddressApprove.appendChild(createAddressElement(autofillValues, approveAddress, feature.properties.feature_name, feature.properties.description, ((_a = feature.properties.place_type) == null ? void 0 : _a[0]) === \"secondary_address\"));\n    };\n    __privateAdd(this, _handleClose, () => {\n      this.dispatchEvent(new MapboxHTMLEvent(\"result\", \"cancel\"));\n    });\n    this.approve = () => {\n      this.dispatchEvent(new MapboxHTMLEvent(\"result\", \"change\"));\n    };\n    this.reject = () => {\n      this.dispatchEvent(new MapboxHTMLEvent(\"result\", \"nochange\"));\n      sendFeedback(this.accessToken, {\n        originalCoordinate: __privateGet(this, _feature).geometry.coordinates,\n        originalAddress: __privateGet(this, _feature).properties.full_address,\n        changes: {\n          address: getAutofillSearchText(__privateGet(this, _formValues))\n        }\n      });\n    };\n    __privateAdd(this, _modalID, randomValidID());\n    __privateAdd(this, _modalHeaderTitleID, randomValidID());\n    __privateAdd(this, _modalAddressApproveID, randomValidID());\n  }\n  get template() {\n    return TEMPLATE2;\n  }\n  get templateStyle() {\n    return style_default;\n  }\n  get templateUserStyle() {\n    return getThemeCSS(\".MapboxAddressConfirmationFeature\", this.theme);\n  }\n  get theme() {\n    return __privateGet(this, _themeInternal3);\n  }\n  set theme(theme) {\n    __privateSet(this, _themeInternal3, theme);\n    if (!__privateGet(this, _binding3) || !theme) {\n      return;\n    }\n    this.updateTemplateUserStyle(getThemeCSS(\".MapboxAddressConfirmationFeature\", theme));\n    const { IconQuestion, IconClose } = __privateGet(this, _binding3);\n    IconQuestion.innerHTML = getIcon(\"question\", theme);\n    IconClose.innerHTML = getIcon(\"close\", theme);\n  }\n  set footer(val) {\n    if (val === void 0)\n      return;\n    const footerEl = this.querySelector(\".ModalFooter\");\n    if (typeof val === \"string\") {\n      footerEl.textContent = val;\n      footerEl.removeAttribute(\"aria-hidden\");\n    } else if (!val) {\n      footerEl.setAttribute(\"aria-hidden\", \"true\");\n    } else {\n      footerEl.removeAttribute(\"aria-hidden\");\n    }\n  }\n  connectedCallback() {\n    super.connectedCallback();\n    __privateSet(this, _binding3, bindElements(this, {\n      MapboxAddressConfirmationFeature: \".MapboxAddressConfirmationFeature\",\n      Modal: \".Modal\",\n      ModalHeaderTitle: \".ModalHeaderTitle\",\n      ModalMap: \".ModalMap\",\n      Minimap: \".Minimap\",\n      IconQuestion: \".IconQuestion\",\n      IconClose: \".IconClose\",\n      ButtonApprove: \".ButtonApprove\",\n      ButtonReject: \".ButtonReject\",\n      ModalAddressApprove: \".ModalAddressApprove\"\n    }));\n    const {\n      Modal,\n      ModalHeaderTitle,\n      IconClose,\n      ButtonApprove,\n      ButtonReject,\n      ModalAddressApprove\n    } = __privateGet(this, _binding3);\n    Modal.setAttribute(\"aria-labelledby\", __privateGet(this, _modalHeaderTitleID));\n    Modal.setAttribute(\"aria-describedby\", __privateGet(this, _modalAddressApproveID));\n    IconClose.setAttribute(\"aria-controls\", __privateGet(this, _modalID));\n    Modal.id = __privateGet(this, _modalID);\n    ModalHeaderTitle.id = __privateGet(this, _modalHeaderTitleID);\n    ModalAddressApprove.id = __privateGet(this, _modalAddressApproveID);\n    const buttons = Array.from(this.querySelectorAll('[role=\"button\"]'));\n    for (const button of buttons) {\n      button.addEventListener(\"keydown\", ariaButtonKeyDown);\n    }\n    IconClose.addEventListener(\"click\", __privateGet(this, _handleClose));\n    ButtonApprove.addEventListener(\"click\", this.approve);\n    ButtonReject.addEventListener(\"click\", this.reject);\n    const theme = this.theme;\n    if (theme) {\n      const { IconQuestion, IconClose: IconClose2 } = __privateGet(this, _binding3);\n      IconQuestion.innerHTML = getIcon(\"question\", theme);\n      IconClose2.innerHTML = getIcon(\"close\", theme);\n    }\n  }\n  disconnectedCallback() {\n    const { IconClose, ButtonApprove } = __privateGet(this, _binding3);\n    IconClose.removeEventListener(\"click\", __privateGet(this, _handleClose));\n    ButtonApprove.removeEventListener(\"click\", this.approve);\n  }\n};\n_binding3 = new WeakMap();\n_themeInternal3 = new WeakMap();\n_feature = new WeakMap();\n_formValues = new WeakMap();\n_handleClose = new WeakMap();\n_modalID = new WeakMap();\n_modalHeaderTitleID = new WeakMap();\n_modalAddressApproveID = new WeakMap();\nwindow.MapboxAddressConfirmationFeature = MapboxAddressConfirmationFeature;\nif (!window.customElements.get(\"mapbox-address-confirmation-feature\")) {\n  customElements.define(\"mapbox-address-confirmation-feature\", MapboxAddressConfirmationFeature);\n}\n\n// src/components/MapboxAddressConfirmationNoFeature.ts\nvar TEMPLATE3 = createElementFromString(`\n<template>\n  <div class=\"MapboxAddressConfirmationNoFeature\">\n    <div class=\"Modal\" aria-modal=\"true\" role=\"dialog\">\n      <div class=\"ModalHeader\">\n        <svg viewBox=\"0 0 18 18\" class=\"Icon IconQuestion\"></svg>\n        <div class=\"ModalHeaderTitle\">Confirm address</div>\n        <svg\n          viewBox=\"0 0 18 18\"\n          class=\"Icon IconClose\"\n          tabindex=\"0\"\n          role=\"button\"\n          title=\"Close\"\n          aria-label=\"Close\"\n          aria-expanded=\"true\"\n        ></svg>\n      </div>\n      <div class=\"ModalDescription\">\n        We couldn't verify this address. Please check that your information is correct before continuing.\n      </div>\n      <br />\n      <div class=\"ModalSubheader\">\n        You entered\n      </div>\n      <div class=\"ModalAddress\"></div>\n      <div\n        class=\"Button ButtonPrimary\"\n        tabindex=\"0\"\n        role=\"button\"\n        aria-label=\"Use the address I provided\"\n      >\n        Use the address I provided\n      </div>\n    </div>\n  </div>\n</template>\n`);\nvar _binding4, _themeInternal4, _handleClose2, _modalID2, _modalHeaderTitleID2, _modalAddressID;\nvar MapboxAddressConfirmationNoFeature = class extends HTMLScopedElement {\n  constructor() {\n    super(...arguments);\n    __privateAdd(this, _binding4, void 0);\n    __privateAdd(this, _themeInternal4, {});\n    this.update = (autofillValues) => {\n      const { ModalAddress } = __privateGet(this, _binding4);\n      ModalAddress.innerHTML = \"\";\n      ModalAddress.appendChild(createAddressElement(autofillValues));\n    };\n    __privateAdd(this, _handleClose2, () => {\n      this.dispatchEvent(new MapboxHTMLEvent(\"result\", \"cancel\"));\n    });\n    this.reject = () => {\n      this.dispatchEvent(new MapboxHTMLEvent(\"result\", \"nochange\"));\n    };\n    __privateAdd(this, _modalID2, randomValidID());\n    __privateAdd(this, _modalHeaderTitleID2, randomValidID());\n    __privateAdd(this, _modalAddressID, randomValidID());\n  }\n  get template() {\n    return TEMPLATE3;\n  }\n  get templateStyle() {\n    return style_default;\n  }\n  get templateUserStyle() {\n    return getThemeCSS(\".MapboxAddressConfirmationNoFeature\", this.theme);\n  }\n  get theme() {\n    return __privateGet(this, _themeInternal4);\n  }\n  set theme(theme) {\n    __privateSet(this, _themeInternal4, theme);\n    if (!__privateGet(this, _binding4) || !theme) {\n      return;\n    }\n    this.updateTemplateUserStyle(getThemeCSS(\".MapboxAddressConfirmationNoFeature\", theme));\n    const { IconQuestion, IconClose } = __privateGet(this, _binding4);\n    IconQuestion.innerHTML = getIcon(\"question\", theme);\n    IconClose.innerHTML = getIcon(\"close\", theme);\n  }\n  connectedCallback() {\n    super.connectedCallback();\n    __privateSet(this, _binding4, bindElements(this, {\n      Modal: \".Modal\",\n      ModalHeaderTitle: \".ModalHeaderTitle\",\n      IconQuestion: \".IconQuestion\",\n      IconClose: \".IconClose\",\n      ModalAddress: \".ModalAddress\",\n      ButtonReject: \".Button\"\n    }));\n    const { Modal, ModalHeaderTitle, IconClose, ModalAddress, ButtonReject } = __privateGet(this, _binding4);\n    Modal.setAttribute(\"aria-labelledby\", __privateGet(this, _modalHeaderTitleID2));\n    Modal.setAttribute(\"aria-describedby\", __privateGet(this, _modalAddressID));\n    IconClose.setAttribute(\"aria-controls\", __privateGet(this, _modalID2));\n    Modal.id = __privateGet(this, _modalID2);\n    ModalHeaderTitle.id = __privateGet(this, _modalHeaderTitleID2);\n    ModalAddress.id = __privateGet(this, _modalAddressID);\n    const buttons = Array.from(this.querySelectorAll('[role=\"button\"]'));\n    for (const button of buttons) {\n      button.addEventListener(\"keydown\", ariaButtonKeyDown);\n    }\n    IconClose.addEventListener(\"click\", __privateGet(this, _handleClose2));\n    ButtonReject.addEventListener(\"click\", this.reject);\n    const theme = this.theme;\n    if (theme) {\n      const { IconQuestion, IconClose: IconClose2 } = __privateGet(this, _binding4);\n      IconQuestion.innerHTML = getIcon(\"question\", theme);\n      IconClose2.innerHTML = getIcon(\"close\", theme);\n    }\n  }\n  disconnectedCallback() {\n    const { IconClose, ButtonReject } = __privateGet(this, _binding4);\n    IconClose.removeEventListener(\"click\", __privateGet(this, _handleClose2));\n    ButtonReject.removeEventListener(\"click\", this.reject);\n  }\n};\n_binding4 = new WeakMap();\n_themeInternal4 = new WeakMap();\n_handleClose2 = new WeakMap();\n_modalID2 = new WeakMap();\n_modalHeaderTitleID2 = new WeakMap();\n_modalAddressID = new WeakMap();\nwindow.MapboxAddressConfirmationNoFeature = MapboxAddressConfirmationNoFeature;\nif (!window.customElements.get(\"mapbox-address-confirmation-no-feature\")) {\n  customElements.define(\"mapbox-address-confirmation-no-feature\", MapboxAddressConfirmationNoFeature);\n}\n\n// src/components/MapboxAddressAutofill.ts\n\n\n// src/utils/detect_browser_autofill.ts\n\n\n// src/utils/detect_browser_autofill.css\nvar detect_browser_autofill_default = 'input:-webkit-autofill,select:-webkit-autofill,textarea:-webkit-autofill{animation-name:onbrowserautofillstart}input:not(:-webkit-autofill),select:not(:-webkit-autofill),textarea:not(:-webkit-autofill){animation-name:onbrowserautofillcancel}@keyframes onbrowserautofillstart{0%{animation-name:\"onbrowserautofillstart\"}to{animation-name:\"onbrowserautofillstart\"}}@keyframes onbrowserautofillcancel{0%{animation-name:\"onbrowserautofillcancel\"}to{animation-name:\"onbrowserautofillcancel\"}}';\n\n// src/utils/detect_browser_autofill.ts\nvar ATTR_NAME = \"browser-autofilled\";\nvar AUTOFILLED_ELEMENTS = [];\nfunction dispatchBrowserAutofillEvent() {\n  window.dispatchEvent(new window.CustomEvent(\"browserautofill\", {\n    bubbles: true,\n    cancelable: true,\n    detail: { elements: AUTOFILLED_ELEMENTS }\n  }));\n  AUTOFILLED_ELEMENTS = [];\n}\nvar debouncedAutofill = (0,_mapbox_search_js_core__WEBPACK_IMPORTED_MODULE_0__.debounce)(dispatchBrowserAutofillEvent, 5);\nfunction browserAutofill(element) {\n  if (element.hasAttribute(ATTR_NAME))\n    return;\n  element.setAttribute(ATTR_NAME, \"\");\n  AUTOFILLED_ELEMENTS.push(element);\n  debouncedAutofill();\n}\nfunction cancelBrowserAutofill(element) {\n  if (!element.hasAttribute(ATTR_NAME))\n    return;\n  element.removeAttribute(ATTR_NAME);\n}\nfunction onAnimationStart(event) {\n  event.animationName === \"onbrowserautofillstart\" ? browserAutofill(event.target) : cancelBrowserAutofill(event.target);\n}\nfunction onInput(event) {\n  const targetEl = event.target;\n  targetEl.nodeName.toLowerCase() !== \"select\" && !event.simulated && !(event instanceof MapboxHTMLEvent) && (event.inputType === \"insertReplacementText\" || !(\"data\" in event)) ? browserAutofill(targetEl) : cancelBrowserAutofill(targetEl);\n}\nfunction initDetectBrowserAutofill() {\n  if (config.detectBrowserAutofillEnabled) {\n    return;\n  } else {\n    config.detectBrowserAutofillEnabled = true;\n  }\n  addDocumentStyle(detect_browser_autofill_default);\n  document.addEventListener(\"animationstart\", onAnimationStart, true);\n  document.addEventListener(\"input\", onInput, true);\n}\n\n// src/components/MapboxAddressAutofill.ts\nvar _autofill, _session, _input, _listbox, _initialAutocompleteValue, _browserAutofillEnabled, _handleSuggest, _handleSuggestError, _handleRetrieve, _handleObserve, _observer, _handleBrowserAutofill, _onHandleInput, _onHandleSelect, _onHandleBlur, _onHandleFocus;\nvar MapboxAddressAutofill = class extends HTMLScopedElement {\n  constructor() {\n    super(...arguments);\n    __privateAdd(this, _autofill, new _mapbox_search_js_core__WEBPACK_IMPORTED_MODULE_0__.AddressAutofillCore());\n    __privateAdd(this, _session, new _mapbox_search_js_core__WEBPACK_IMPORTED_MODULE_0__.SearchSession(__privateGet(this, _autofill)));\n    __privateAdd(this, _input, void 0);\n    __privateAdd(this, _listbox, new MapboxSearchListbox());\n    __privateAdd(this, _initialAutocompleteValue, void 0);\n    this.options = {};\n    this.confirmOnBrowserAutofill = false;\n    __privateAdd(this, _browserAutofillEnabled, false);\n    __privateAdd(this, _handleSuggest, (result) => {\n      const filteredSuggestions = (result == null ? void 0 : result.suggestions) ? distinctExactStreetResults(result.suggestions) : null;\n      __privateGet(this, _listbox).handleSuggest(filteredSuggestions);\n      this.dispatchEvent(new MapboxHTMLEvent(\"suggest\", result));\n    });\n    __privateAdd(this, _handleSuggestError, (error) => {\n      __privateGet(this, _listbox).handleError();\n      this.dispatchEvent(new MapboxHTMLEvent(\"suggesterror\", error));\n    });\n    __privateAdd(this, _handleRetrieve, (result) => {\n      var _a;\n      this.dispatchEvent(new MapboxHTMLEvent(\"retrieve\", result));\n      this.retrieveFeature = (_a = result.features) == null ? void 0 : _a[0];\n      if (!__privateGet(this, _input)) {\n        return;\n      }\n      const featureCollection = result;\n      if (!featureCollection || !featureCollection.features || !featureCollection.features.length) {\n        return;\n      }\n      fillFormWithFeature(featureCollection.features[0], __privateGet(this, _input));\n    });\n    __privateAdd(this, _handleObserve, () => {\n      var _a;\n      try {\n        const input = (_a = this.querySelector(\"input\")) != null ? _a : null;\n        __privateSet(this, _input, input);\n        __privateGet(this, _listbox).input = input;\n      } catch (e) {\n        __privateSet(this, _input, null);\n        __privateGet(this, _listbox).input = null;\n        console.error(e.message || e);\n      }\n    });\n    __privateAdd(this, _observer, new MutationObserver(__privateGet(this, _handleObserve)));\n    __privateAdd(this, _handleBrowserAutofill, (e) => {\n      __privateGet(this, _listbox).blur();\n      tryConfirmBrowserAutofill(__privateGet(this, _input), e, this.confirmOnBrowserAutofill, this.accessToken);\n    });\n    this.retrieveFeature = null;\n    this.interceptSearch = null;\n    __privateAdd(this, _onHandleInput, (e) => {\n      this.dispatchEvent(e.clone());\n      const inputText = e.detail;\n      const enableBrowserAutocomplete = this.browserAutofillEnabled === true && (inputText == null ? void 0 : inputText.length) <= 2;\n      toggleAutocompletion(__privateGet(this, _input), __privateGet(this, _initialAutocompleteValue), enableBrowserAutocomplete);\n      const alteredText = this.interceptSearch && this.interceptSearch(inputText);\n      const searchText = this.interceptSearch ? alteredText : inputText;\n      if (this.interceptSearch && !alteredText || (searchText == null ? void 0 : searchText.length) <= 2) {\n        __privateGet(this, _listbox).handleSuggest(null);\n        return;\n      }\n      __privateGet(this, _session).suggest(searchText, this.options);\n    });\n    __privateAdd(this, _onHandleSelect, (e) => {\n      const suggestion = e.detail;\n      if (e.detail.accuracy !== \"street\") {\n        toggleAutocompletion(__privateGet(this, _input), __privateGet(this, _initialAutocompleteValue), true);\n        __privateGet(this, _session).retrieve(suggestion, this.options);\n      } else {\n        handleStreetSelection(__privateGet(this, _input), __privateGet(this, _initialAutocompleteValue), suggestion);\n      }\n    });\n    __privateAdd(this, _onHandleBlur, () => {\n      toggleAutocompletion(__privateGet(this, _input), __privateGet(this, _initialAutocompleteValue), true);\n      __privateGet(this, _session).abort();\n    });\n    __privateAdd(this, _onHandleFocus, () => {\n      var _a;\n      const enableBrowserAutocomplete = this.browserAutofillEnabled === true && ((_a = __privateGet(this, _input).value) == null ? void 0 : _a.length) <= 2;\n      toggleAutocompletion(__privateGet(this, _input), __privateGet(this, _initialAutocompleteValue), enableBrowserAutocomplete);\n    });\n  }\n  get accessToken() {\n    return __privateGet(this, _autofill).accessToken;\n  }\n  set accessToken(newToken) {\n    __privateGet(this, _autofill).accessToken = newToken;\n  }\n  get input() {\n    return __privateGet(this, _input);\n  }\n  get theme() {\n    return __privateGet(this, _listbox).theme;\n  }\n  set theme(theme) {\n    __privateGet(this, _listbox).theme = theme;\n  }\n  get popoverOptions() {\n    return __privateGet(this, _listbox).popoverOptions;\n  }\n  set popoverOptions(newOptions) {\n    __privateGet(this, _listbox).popoverOptions = newOptions;\n  }\n  get browserAutofillEnabled() {\n    return __privateGet(this, _browserAutofillEnabled);\n  }\n  set browserAutofillEnabled(enable) {\n    __privateSet(this, _browserAutofillEnabled, enable);\n  }\n  connectedCallback() {\n    var _a;\n    super.connectedCallback();\n    config.autofillSessionEnabled = true;\n    __privateGet(this, _session).sessionToken = config.autofillSessionToken;\n    __privateGet(this, _listbox).autofillHost = this;\n    __privateGet(this, _listbox).searchService = 0 /* AddressAutofill */;\n    const input = (_a = this.querySelector(\"input\")) != null ? _a : null;\n    __privateGet(this, _observer).observe(this, {\n      subtree: true,\n      childList: true\n    });\n    __privateGet(this, _handleObserve).call(this);\n    __privateGet(this, _listbox).addEventListener(\"input\", __privateGet(this, _onHandleInput));\n    __privateGet(this, _listbox).addEventListener(\"select\", __privateGet(this, _onHandleSelect));\n    __privateGet(this, _listbox).addEventListener(\"blur\", __privateGet(this, _onHandleBlur));\n    __privateGet(this, _listbox).addEventListener(\"focus\", __privateGet(this, _onHandleFocus));\n    __privateGet(this, _session).addEventListener(\"suggest\", __privateGet(this, _handleSuggest));\n    __privateGet(this, _session).addEventListener(\"suggesterror\", __privateGet(this, _handleSuggestError));\n    __privateGet(this, _session).addEventListener(\"retrieve\", __privateGet(this, _handleRetrieve));\n    document.body.appendChild(__privateGet(this, _listbox));\n    if (input) {\n      input.insertAdjacentElement(\"beforebegin\", createAriaLiveElement(__privateGet(this, _listbox).dataSeed));\n      suppressExtensionsAutocomplete(input);\n      __privateSet(this, _initialAutocompleteValue, input.autocomplete);\n    }\n    initDetectBrowserAutofill();\n    window.addEventListener(\"browserautofill\", __privateGet(this, _handleBrowserAutofill));\n  }\n  disconnectedCallback() {\n    __privateGet(this, _listbox).remove();\n    __privateGet(this, _listbox).removeEventListener(\"input\", __privateGet(this, _onHandleInput));\n    __privateGet(this, _listbox).removeEventListener(\"select\", __privateGet(this, _onHandleSelect));\n    __privateGet(this, _listbox).removeEventListener(\"blur\", __privateGet(this, _onHandleBlur));\n    __privateGet(this, _listbox).removeEventListener(\"focus\", __privateGet(this, _onHandleFocus));\n    __privateGet(this, _session).removeEventListener(\"suggest\", __privateGet(this, _handleSuggest));\n    __privateGet(this, _session).removeEventListener(\"suggesterror\", __privateGet(this, _handleSuggestError));\n    __privateGet(this, _session).removeEventListener(\"retrieve\", __privateGet(this, _handleRetrieve));\n    __privateGet(this, _observer).disconnect();\n    window.removeEventListener(\"browserautofill\", __privateGet(this, _handleBrowserAutofill));\n  }\n  attributeChangedCallback(name, oldValue, newValue) {\n    if (name === \"access-token\") {\n      __privateGet(this, _autofill).accessToken = newValue;\n      return;\n    }\n    if (name === \"browser-autofill-enabled\") {\n      __privateSet(this, _browserAutofillEnabled, Boolean(newValue));\n      return;\n    }\n    if (name === \"theme\") {\n      this.theme = tryParseJSON(newValue);\n      return;\n    }\n    if (name === \"popover-options\") {\n      this.popoverOptions = tryParseJSON(newValue);\n      return;\n    }\n    const optionName = name.split(\"-\").join(\"_\");\n    if (!newValue) {\n      delete this.options[optionName];\n    }\n    this.options[optionName] = newValue;\n  }\n  focus() {\n    __privateGet(this, _listbox).focus();\n  }\n  simulateRetrieve(feature) {\n    const input = this.input;\n    if (input) {\n      input.dataset[\"mapboxSuccess\"] = \"true\";\n    }\n    __privateGet(this, _listbox).hideResults();\n    const simResult = {\n      type: \"FeatureCollection\",\n      features: [feature],\n      url: \"\"\n    };\n    __privateGet(this, _handleRetrieve).call(this, simResult);\n  }\n};\n_autofill = new WeakMap();\n_session = new WeakMap();\n_input = new WeakMap();\n_listbox = new WeakMap();\n_initialAutocompleteValue = new WeakMap();\n_browserAutofillEnabled = new WeakMap();\n_handleSuggest = new WeakMap();\n_handleSuggestError = new WeakMap();\n_handleRetrieve = new WeakMap();\n_handleObserve = new WeakMap();\n_observer = new WeakMap();\n_handleBrowserAutofill = new WeakMap();\n_onHandleInput = new WeakMap();\n_onHandleSelect = new WeakMap();\n_onHandleBlur = new WeakMap();\n_onHandleFocus = new WeakMap();\nMapboxAddressAutofill.observedAttributes = [\n  \"access-token\",\n  \"browser-autofill-enabled\",\n  \"theme\",\n  \"popover-options\",\n  \"css-text\",\n  \"language\",\n  \"country\",\n  \"bbox\",\n  \"limit\",\n  \"proximity\",\n  \"streets\"\n];\nwindow.MapboxAddressAutofill = MapboxAddressAutofill;\nif (!window.customElements.get(\"mapbox-address-autofill\")) {\n  customElements.define(\"mapbox-address-autofill\", MapboxAddressAutofill);\n}\n\n// src/components/MapboxSearchBox.ts\n\n\n\n// src/utils/localization.ts\nvar placeholder = {\n  de: \"Suche\",\n  it: \"Ricerca\",\n  en: \"Search\",\n  nl: \"Zoeken\",\n  fr: \"Chercher\",\n  ca: \"Cerca\",\n  he: \"\\u05DC\\u05D7\\u05E4\\u05E9\",\n  ja: \"\\u30B5\\u30FC\\u30C1\",\n  lv: \"Mekl\\u0113t\",\n  pt: \"Procurar\",\n  sr: \"\\u041F\\u0440\\u0435\\u0442\\u0440\\u0430\\u0433\\u0430\",\n  zh: \"\\u641C\\u7D22\",\n  cs: \"Vyhled\\xE1v\\xE1n\\xED\",\n  hu: \"Keres\\xE9s\",\n  ka: \"\\u10EB\\u10D8\\u10D4\\u10D1\\u10D0\",\n  nb: \"S\\xF8ke\",\n  sk: \"Vyh\\u013Ead\\xE1vanie\",\n  th: \"\\u0E04\\u0E49\\u0E19\\u0E2B\\u0E32\",\n  fi: \"Hae\",\n  is: \"Leita\",\n  ko: \"\\uC218\\uC0C9\",\n  pl: \"Szukaj\",\n  sl: \"Iskanje\",\n  fa: \"\\u062C\\u0633\\u062A\\u062C\\u0648\",\n  ru: \"\\u041F\\u043E\\u0438\\u0441\\u043A\"\n};\nvar localization_default = { placeholder };\n\n// src/components/MapboxSearchBox.ts\nvar MAX_ZOOM = 9;\nvar _binding5, _search, _session2, _map, _input2, _listbox2, _getDefaultPlaceholder, getDefaultPlaceholder_fn, _placeholder, _handleSuggest2, _handleSuggestError2, _handleRetrieve2, _mapMarker, _removeMarker, _handleMarker, _onHandleInput2, _onHandleSelect2, _onHandleBlur2, _setActionIcons, _handleClear, _handleMoveEnd;\nvar MapboxSearchBox = class extends HTMLScopedElement {\n  constructor() {\n    super(...arguments);\n    __privateAdd(this, _getDefaultPlaceholder);\n    __privateAdd(this, _binding5, void 0);\n    __privateAdd(this, _search, new _mapbox_search_js_core__WEBPACK_IMPORTED_MODULE_0__.SearchBoxCore({}));\n    __privateAdd(this, _session2, new _mapbox_search_js_core__WEBPACK_IMPORTED_MODULE_0__.SearchSession(__privateGet(this, _search)));\n    __privateAdd(this, _map, null);\n    __privateAdd(this, _input2, void 0);\n    __privateAdd(this, _listbox2, new MapboxSearchListbox());\n    this.options = {};\n    __privateAdd(this, _placeholder, void 0);\n    __privateAdd(this, _handleSuggest2, (result) => {\n      __privateGet(this, _setActionIcons).call(this);\n      __privateGet(this, _listbox2).handleSuggest((result == null ? void 0 : result.suggestions) || null);\n      this.dispatchEvent(new MapboxHTMLEvent(\"suggest\", result));\n    });\n    __privateAdd(this, _handleSuggestError2, (error) => {\n      __privateGet(this, _setActionIcons).call(this);\n      __privateGet(this, _listbox2).handleError();\n      this.dispatchEvent(new MapboxHTMLEvent(\"suggesterror\", error));\n    });\n    __privateAdd(this, _handleRetrieve2, (result) => {\n      __privateGet(this, _setActionIcons).call(this);\n      this.dispatchEvent(new MapboxHTMLEvent(\"retrieve\", result));\n      const featureCollection = result;\n      if (!featureCollection || !featureCollection.features.length) {\n        return;\n      }\n      const suggestion = (0,_mapbox_search_js_core__WEBPACK_IMPORTED_MODULE_0__.featureToSuggestion)(featureCollection.features[0]);\n      __privateGet(this, _input2).value = suggestion.name;\n      const map = __privateGet(this, _map);\n      if (!map) {\n        return;\n      }\n      const feature = featureCollection.features[0];\n      if (!feature) {\n        return;\n      }\n      const placeType = feature.properties.feature_type;\n      const bounds = feature.properties.bbox;\n      if (bounds) {\n        map.flyTo(bboxViewport(map, _mapbox_search_js_core__WEBPACK_IMPORTED_MODULE_0__.LngLatBounds.convert(bounds).toFlatArray()));\n      } else {\n        const center = feature.geometry.coordinates;\n        const zoom = getMaxZoom(placeType);\n        map.flyTo({\n          center,\n          zoom,\n          speed: FLY_TO_SPEED\n        });\n      }\n      if (this.marker && this.mapboxgl) {\n        __privateGet(this, _handleMarker).call(this, feature);\n      }\n    });\n    __privateAdd(this, _mapMarker, void 0);\n    __privateAdd(this, _removeMarker, () => {\n      if (__privateGet(this, _mapMarker)) {\n        __privateGet(this, _mapMarker).remove();\n        __privateSet(this, _mapMarker, null);\n      }\n    });\n    __privateAdd(this, _handleMarker, (feature) => {\n      if (!__privateGet(this, _map)) {\n        return;\n      }\n      __privateGet(this, _removeMarker).call(this);\n      if (!feature)\n        return;\n      const defaultMarkerOptions = {\n        color: \"#4668F2\"\n      };\n      const markerOptions = __spreadValues(__spreadValues({}, defaultMarkerOptions), typeof this.marker === \"object\" && this.marker);\n      __privateSet(this, _mapMarker, new this.mapboxgl.Marker(markerOptions));\n      if (feature.geometry && feature.geometry.type && feature.geometry.type === \"Point\" && feature.geometry.coordinates) {\n        __privateGet(this, _mapMarker).setLngLat(feature.geometry.coordinates).addTo(__privateGet(this, _map));\n      }\n    });\n    this.interceptSearch = null;\n    __privateAdd(this, _onHandleInput2, (e) => {\n      this.dispatchEvent(e.clone());\n      const inputText = e.detail;\n      if (!inputText) {\n        __privateGet(this, _handleClear).call(this);\n        return;\n      }\n      const alteredText = this.interceptSearch && this.interceptSearch(inputText);\n      const searchText = this.interceptSearch ? alteredText : inputText;\n      if (this.interceptSearch && !alteredText) {\n        __privateGet(this, _listbox2).hideResults();\n        return;\n      }\n      __privateGet(this, _session2).suggest(searchText, this.options);\n      __privateGet(this, _setActionIcons).call(this, true);\n    });\n    __privateAdd(this, _onHandleSelect2, (e) => {\n      const suggestion = e.detail;\n      __privateGet(this, _session2).retrieve(suggestion, this.options);\n      __privateGet(this, _setActionIcons).call(this, true);\n    });\n    __privateAdd(this, _onHandleBlur2, () => {\n      __privateGet(this, _session2).abort();\n    });\n    __privateAdd(this, _setActionIcons, (loading = false) => {\n      if (loading) {\n        __privateGet(this, _binding5).ClearBtn.style.display = \"none\";\n        __privateGet(this, _binding5).LoadingIcon.style.display = \"block\";\n      } else {\n        __privateGet(this, _binding5).LoadingIcon.style.display = \"none\";\n        __privateGet(this, _binding5).ClearBtn.style.display = this.value ? \"block\" : \"none\";\n      }\n    });\n    __privateAdd(this, _handleClear, () => {\n      this.value = \"\";\n      __privateGet(this, _setActionIcons).call(this);\n      __privateGet(this, _handleMarker).call(this, null);\n      __privateGet(this, _listbox2).handleSuggest(null);\n      this.dispatchEvent(new MapboxHTMLEvent(\"clear\"));\n    });\n    this.marker = true;\n    __privateAdd(this, _handleMoveEnd, () => {\n      const map = __privateGet(this, _map);\n      const options = __spreadValues({}, this.options);\n      if (map.getZoom() <= MAX_ZOOM) {\n        delete options.proximity;\n        this.options = options;\n        return;\n      }\n      const center = map.getCenter();\n      this.options = __spreadProps(__spreadValues({}, options), {\n        proximity: center\n      });\n    });\n  }\n  get accessToken() {\n    return __privateGet(this, _search).accessToken;\n  }\n  set accessToken(newToken) {\n    __privateGet(this, _search).accessToken = newToken;\n  }\n  get value() {\n    return __privateGet(this, _input2).value;\n  }\n  set value(newValue) {\n    __privateGet(this, _input2).value = newValue || \"\";\n  }\n  get input() {\n    return __privateGet(this, _input2);\n  }\n  get template() {\n    return SEARCHBOX_TEMPLATE;\n  }\n  get templateStyle() {\n    return style_default;\n  }\n  get templateUserStyle() {\n    return getThemeCSS(\".SearchBox\", __privateGet(this, _listbox2).theme);\n  }\n  get theme() {\n    return __privateGet(this, _listbox2).theme;\n  }\n  set theme(theme) {\n    __privateGet(this, _listbox2).theme = theme;\n    if (!__privateGet(this, _binding5) || !theme) {\n      return;\n    }\n    this.updateTemplateUserStyle(getThemeCSS(\".SearchBox\", theme));\n    __privateGet(this, _listbox2).updatePopover();\n    const { SearchIcon } = __privateGet(this, _binding5);\n    SearchIcon.innerHTML = getIcon(\"search\", theme);\n  }\n  get popoverOptions() {\n    return __privateGet(this, _listbox2).popoverOptions;\n  }\n  set popoverOptions(newOptions) {\n    __privateGet(this, _listbox2).popoverOptions = newOptions;\n  }\n  get placeholder() {\n    return __privateGet(this, _placeholder) || __privateMethod(this, _getDefaultPlaceholder, getDefaultPlaceholder_fn).call(this);\n  }\n  set placeholder(text) {\n    __privateSet(this, _placeholder, text);\n    if (__privateGet(this, _input2)) {\n      __privateGet(this, _input2).placeholder = this.placeholder;\n      __privateGet(this, _input2).setAttribute(\"aria-label\", this.placeholder);\n    }\n  }\n  connectedCallback() {\n    super.connectedCallback();\n    __privateSet(this, _binding5, bindElements(this, {\n      SearchBox: \".SearchBox\",\n      SearchIcon: \".SearchIcon\",\n      Input: \".Input\",\n      ClearBtn: \".ClearBtn\",\n      LoadingIcon: \".LoadingIcon\"\n    }));\n    this.theme = __spreadValues({}, this.theme);\n    const { Input, ClearBtn } = __privateGet(this, _binding5);\n    __privateSet(this, _input2, Input);\n    __privateGet(this, _listbox2).input = Input;\n    __privateGet(this, _listbox2).searchService = 2 /* SearchBox */;\n    __privateGet(this, _listbox2).addEventListener(\"input\", __privateGet(this, _onHandleInput2));\n    __privateGet(this, _listbox2).addEventListener(\"select\", __privateGet(this, _onHandleSelect2));\n    __privateGet(this, _listbox2).addEventListener(\"blur\", __privateGet(this, _onHandleBlur2));\n    __privateGet(this, _session2).addEventListener(\"suggest\", __privateGet(this, _handleSuggest2));\n    __privateGet(this, _session2).addEventListener(\"suggesterror\", __privateGet(this, _handleSuggestError2));\n    __privateGet(this, _session2).addEventListener(\"retrieve\", __privateGet(this, _handleRetrieve2));\n    ClearBtn.addEventListener(\"click\", __privateGet(this, _handleClear));\n    this.placeholder = __privateGet(this, _placeholder);\n    this.parentElement.appendChild(__privateGet(this, _listbox2));\n    if (Input) {\n      if (Input.previousElementSibling.hasAttribute(\"aria-live\")) {\n        Input.previousElementSibling.remove();\n      }\n      Input.insertAdjacentElement(\"beforebegin\", createAriaLiveElement(__privateGet(this, _listbox2).dataSeed));\n    }\n  }\n  disconnectedCallback() {\n    __privateGet(this, _listbox2).remove();\n    __privateGet(this, _listbox2).input = null;\n    __privateGet(this, _listbox2).removeEventListener(\"input\", __privateGet(this, _onHandleInput2));\n    __privateGet(this, _listbox2).removeEventListener(\"select\", __privateGet(this, _onHandleSelect2));\n    __privateGet(this, _listbox2).removeEventListener(\"blur\", __privateGet(this, _onHandleBlur2));\n    __privateGet(this, _session2).removeEventListener(\"suggest\", __privateGet(this, _handleSuggest2));\n    __privateGet(this, _session2).removeEventListener(\"suggesterror\", __privateGet(this, _handleSuggestError2));\n    __privateGet(this, _session2).removeEventListener(\"retrieve\", __privateGet(this, _handleRetrieve2));\n  }\n  attributeChangedCallback(name, oldValue, newValue) {\n    if (name === \"access-token\") {\n      __privateGet(this, _search).accessToken = newValue;\n      return;\n    }\n    if (name === \"theme\") {\n      this.theme = tryParseJSON(newValue);\n      return;\n    }\n    if (name === \"popover-options\") {\n      this.popoverOptions = tryParseJSON(newValue);\n      return;\n    }\n    if (name === \"placeholder\") {\n      this.placeholder = newValue;\n      return;\n    }\n    const optionName = name.split(\"-\").join(\"_\");\n    if (!newValue) {\n      delete this.options[optionName];\n    }\n    this.options[optionName] = newValue;\n    if (optionName === \"language\") {\n      this.placeholder = __privateGet(this, _placeholder);\n    }\n  }\n  focus() {\n    __privateGet(this, _listbox2).focus();\n  }\n  search(text) {\n    this.value = text;\n    __privateGet(this, _onHandleInput2).call(this, new MapboxHTMLEvent(\"input\", text));\n  }\n  bindMap(map) {\n    if (__privateGet(this, _map)) {\n      __privateGet(this, _map).off(\"moveend\", __privateGet(this, _handleMoveEnd));\n    }\n    if (map) {\n      map.on(\"moveend\", __privateGet(this, _handleMoveEnd));\n    }\n    __privateSet(this, _map, map);\n  }\n  unbindMap() {\n    this.bindMap(null);\n  }\n  onAdd(map) {\n    this.bindMap(map);\n    this.remove();\n    const container = document.createElement(\"div\");\n    container.className = \"mapboxgl-ctrl\";\n    container.style.width = \"300px\";\n    container.appendChild(this);\n    return container;\n  }\n  onRemove() {\n    this.remove();\n    this.unbindMap();\n    __privateGet(this, _removeMarker).call(this);\n  }\n  getDefaultPosition() {\n    return \"top-right\";\n  }\n};\n_binding5 = new WeakMap();\n_search = new WeakMap();\n_session2 = new WeakMap();\n_map = new WeakMap();\n_input2 = new WeakMap();\n_listbox2 = new WeakMap();\n_getDefaultPlaceholder = new WeakSet();\ngetDefaultPlaceholder_fn = function() {\n  if (this.options.language) {\n    const firstLanguage = this.options.language.split(\",\")[0];\n    const language = subtag__WEBPACK_IMPORTED_MODULE_5___default().language(firstLanguage);\n    const localizedValue = localization_default.placeholder[language];\n    if (localizedValue)\n      return localizedValue;\n  }\n  return \"Search\";\n};\n_placeholder = new WeakMap();\n_handleSuggest2 = new WeakMap();\n_handleSuggestError2 = new WeakMap();\n_handleRetrieve2 = new WeakMap();\n_mapMarker = new WeakMap();\n_removeMarker = new WeakMap();\n_handleMarker = new WeakMap();\n_onHandleInput2 = new WeakMap();\n_onHandleSelect2 = new WeakMap();\n_onHandleBlur2 = new WeakMap();\n_setActionIcons = new WeakMap();\n_handleClear = new WeakMap();\n_handleMoveEnd = new WeakMap();\nMapboxSearchBox.observedAttributes = [\n  \"access-token\",\n  \"theme\",\n  \"popover-options\",\n  \"placeholder\",\n  \"language\",\n  \"country\",\n  \"bbox\",\n  \"limit\",\n  \"navigation-profile\",\n  \"origin\",\n  \"proximity\",\n  \"eta-type\",\n  \"types\"\n];\nwindow.MapboxSearchBox = MapboxSearchBox;\nif (!window.customElements.get(\"mapbox-search-box\")) {\n  customElements.define(\"mapbox-search-box\", MapboxSearchBox);\n}\n\n// src/components/MapboxGeocoder.ts\n\n\nvar MAX_ZOOM2 = 9;\nvar _binding6, _search2, _session3, _map2, _input3, _listbox3, _getDefaultPlaceholder2, getDefaultPlaceholder_fn2, _placeholder2, _handleSuggest3, _handleSuggestError3, _handleRetrieve3, _mapMarker2, _removeMarker2, _handleMarker2, _onHandleInput3, _onHandleSelect3, _onHandleBlur3, _setActionIcons2, _handleClear2, _handleMoveEnd2;\nvar MapboxGeocoder = class extends HTMLScopedElement {\n  constructor() {\n    super(...arguments);\n    __privateAdd(this, _getDefaultPlaceholder2);\n    __privateAdd(this, _binding6, void 0);\n    __privateAdd(this, _search2, new _mapbox_search_js_core__WEBPACK_IMPORTED_MODULE_0__.GeocodingCore({}));\n    __privateAdd(this, _session3, new _mapbox_search_js_core__WEBPACK_IMPORTED_MODULE_0__.SearchSession(__privateGet(this, _search2)));\n    __privateAdd(this, _map2, null);\n    __privateAdd(this, _input3, void 0);\n    __privateAdd(this, _listbox3, new MapboxSearchListbox());\n    this.options = {};\n    __privateAdd(this, _placeholder2, void 0);\n    __privateAdd(this, _handleSuggest3, (result) => {\n      __privateGet(this, _setActionIcons2).call(this);\n      __privateGet(this, _listbox3).handleSuggest((result == null ? void 0 : result.features) || null);\n      this.dispatchEvent(new MapboxHTMLEvent(\"suggest\", result));\n    });\n    __privateAdd(this, _handleSuggestError3, (error) => {\n      __privateGet(this, _setActionIcons2).call(this);\n      __privateGet(this, _listbox3).handleError();\n      this.dispatchEvent(new MapboxHTMLEvent(\"suggesterror\", error));\n    });\n    __privateAdd(this, _handleRetrieve3, (result) => {\n      __privateGet(this, _setActionIcons2).call(this);\n      this.dispatchEvent(new MapboxHTMLEvent(\"retrieve\", result));\n      const feature = result;\n      if (!feature) {\n        return;\n      }\n      __privateGet(this, _input3).value = feature.properties.full_address;\n      const map = __privateGet(this, _map2);\n      if (!map) {\n        return;\n      }\n      const placeType = feature.properties.feature_type;\n      const bounds = feature.properties.bbox;\n      if (bounds) {\n        map.flyTo(bboxViewport(map, _mapbox_search_js_core__WEBPACK_IMPORTED_MODULE_0__.LngLatBounds.convert(bounds).toFlatArray()));\n      } else {\n        const center = feature.geometry.coordinates;\n        const zoom = getMaxZoom(placeType);\n        map.flyTo({\n          center,\n          zoom,\n          speed: FLY_TO_SPEED\n        });\n      }\n      if (this.marker && this.mapboxgl) {\n        __privateGet(this, _handleMarker2).call(this, feature);\n      }\n    });\n    __privateAdd(this, _mapMarker2, void 0);\n    __privateAdd(this, _removeMarker2, () => {\n      if (__privateGet(this, _mapMarker2)) {\n        __privateGet(this, _mapMarker2).remove();\n        __privateSet(this, _mapMarker2, null);\n      }\n    });\n    __privateAdd(this, _handleMarker2, (feature) => {\n      if (!__privateGet(this, _map2)) {\n        return;\n      }\n      __privateGet(this, _removeMarker2).call(this);\n      if (!feature)\n        return;\n      const defaultMarkerOptions = {\n        color: \"#4668F2\"\n      };\n      const markerOptions = __spreadValues(__spreadValues({}, defaultMarkerOptions), typeof this.marker === \"object\" && this.marker);\n      __privateSet(this, _mapMarker2, new this.mapboxgl.Marker(markerOptions));\n      if (feature.geometry && feature.geometry.type && feature.geometry.type === \"Point\" && feature.geometry.coordinates) {\n        __privateGet(this, _mapMarker2).setLngLat(feature.geometry.coordinates).addTo(__privateGet(this, _map2));\n      }\n    });\n    this.interceptSearch = null;\n    __privateAdd(this, _onHandleInput3, (e) => {\n      this.dispatchEvent(e.clone());\n      const inputText = e.detail;\n      if (!inputText) {\n        __privateGet(this, _handleClear2).call(this);\n        return;\n      }\n      const alteredText = this.interceptSearch && this.interceptSearch(inputText);\n      const searchText = this.interceptSearch ? alteredText : inputText;\n      if (this.interceptSearch && !alteredText) {\n        __privateGet(this, _listbox3).hideResults();\n        return;\n      }\n      __privateGet(this, _session3).suggest(searchText, this.options);\n      __privateGet(this, _setActionIcons2).call(this, true);\n    });\n    __privateAdd(this, _onHandleSelect3, (e) => {\n      const suggestion = e.detail;\n      __privateGet(this, _session3).retrieve(suggestion, this.options);\n      __privateGet(this, _setActionIcons2).call(this, true);\n    });\n    __privateAdd(this, _onHandleBlur3, () => {\n      __privateGet(this, _session3).abort();\n    });\n    __privateAdd(this, _setActionIcons2, (loading = false) => {\n      if (loading) {\n        __privateGet(this, _binding6).ClearBtn.style.display = \"none\";\n        __privateGet(this, _binding6).LoadingIcon.style.display = \"block\";\n      } else {\n        __privateGet(this, _binding6).LoadingIcon.style.display = \"none\";\n        __privateGet(this, _binding6).ClearBtn.style.display = this.value ? \"block\" : \"none\";\n      }\n    });\n    __privateAdd(this, _handleClear2, () => {\n      this.value = \"\";\n      __privateGet(this, _setActionIcons2).call(this);\n      __privateGet(this, _handleMarker2).call(this, null);\n      __privateGet(this, _listbox3).handleSuggest(null);\n      this.dispatchEvent(new MapboxHTMLEvent(\"clear\"));\n    });\n    this.marker = true;\n    __privateAdd(this, _handleMoveEnd2, () => {\n      const map = __privateGet(this, _map2);\n      const options = __spreadValues({}, this.options);\n      if (map.getZoom() <= MAX_ZOOM2) {\n        delete options.proximity;\n        this.options = options;\n        return;\n      }\n      const center = map.getCenter();\n      this.options = __spreadProps(__spreadValues({}, options), {\n        proximity: center\n      });\n    });\n  }\n  get accessToken() {\n    return __privateGet(this, _search2).accessToken;\n  }\n  set accessToken(newToken) {\n    __privateGet(this, _search2).accessToken = newToken;\n  }\n  get value() {\n    return __privateGet(this, _input3).value;\n  }\n  set value(newValue) {\n    __privateGet(this, _input3).value = newValue || \"\";\n  }\n  get input() {\n    return __privateGet(this, _input3);\n  }\n  get template() {\n    return GEOCODER_TEMPLATE;\n  }\n  get templateStyle() {\n    return style_default;\n  }\n  get templateUserStyle() {\n    return getThemeCSS(\".Geocoder\", __privateGet(this, _listbox3).theme);\n  }\n  get theme() {\n    return __privateGet(this, _listbox3).theme;\n  }\n  set theme(theme) {\n    __privateGet(this, _listbox3).theme = theme;\n    if (!__privateGet(this, _binding6) || !theme) {\n      return;\n    }\n    this.updateTemplateUserStyle(getThemeCSS(\".Geocoder\", theme));\n    __privateGet(this, _listbox3).updatePopover();\n    const { SearchIcon } = __privateGet(this, _binding6);\n    SearchIcon.innerHTML = getIcon(\"search\", theme);\n  }\n  get popoverOptions() {\n    return __privateGet(this, _listbox3).popoverOptions;\n  }\n  set popoverOptions(newOptions) {\n    __privateGet(this, _listbox3).popoverOptions = newOptions;\n  }\n  get placeholder() {\n    return __privateGet(this, _placeholder2) || __privateMethod(this, _getDefaultPlaceholder2, getDefaultPlaceholder_fn2).call(this);\n  }\n  set placeholder(text) {\n    __privateSet(this, _placeholder2, text);\n    if (__privateGet(this, _input3)) {\n      __privateGet(this, _input3).placeholder = this.placeholder;\n      __privateGet(this, _input3).setAttribute(\"aria-label\", this.placeholder);\n    }\n  }\n  connectedCallback() {\n    super.connectedCallback();\n    __privateSet(this, _binding6, bindElements(this, {\n      Geocoder: \".Geocoder\",\n      SearchIcon: \".SearchIcon\",\n      Input: \".Input\",\n      ClearBtn: \".ClearBtn\",\n      LoadingIcon: \".LoadingIcon\"\n    }));\n    this.theme = __spreadValues({}, this.theme);\n    const { Input, ClearBtn } = __privateGet(this, _binding6);\n    __privateSet(this, _input3, Input);\n    __privateGet(this, _listbox3).input = Input;\n    __privateGet(this, _listbox3).searchService = 1 /* Geocoding */;\n    __privateGet(this, _listbox3).addEventListener(\"input\", __privateGet(this, _onHandleInput3));\n    __privateGet(this, _listbox3).addEventListener(\"select\", __privateGet(this, _onHandleSelect3));\n    __privateGet(this, _listbox3).addEventListener(\"blur\", __privateGet(this, _onHandleBlur3));\n    __privateGet(this, _session3).addEventListener(\"suggest\", __privateGet(this, _handleSuggest3));\n    __privateGet(this, _session3).addEventListener(\"suggesterror\", __privateGet(this, _handleSuggestError3));\n    __privateGet(this, _session3).addEventListener(\"retrieve\", __privateGet(this, _handleRetrieve3));\n    ClearBtn.addEventListener(\"click\", __privateGet(this, _handleClear2));\n    this.placeholder = __privateGet(this, _placeholder2);\n    this.parentElement.appendChild(__privateGet(this, _listbox3));\n    if (Input) {\n      if (Input.previousElementSibling.hasAttribute(\"aria-live\")) {\n        Input.previousElementSibling.remove();\n      }\n      Input.insertAdjacentElement(\"beforebegin\", createAriaLiveElement(__privateGet(this, _listbox3).dataSeed));\n    }\n  }\n  disconnectedCallback() {\n    __privateGet(this, _listbox3).remove();\n    __privateGet(this, _listbox3).input = null;\n    __privateGet(this, _listbox3).removeEventListener(\"input\", __privateGet(this, _onHandleInput3));\n    __privateGet(this, _listbox3).removeEventListener(\"select\", __privateGet(this, _onHandleSelect3));\n    __privateGet(this, _listbox3).removeEventListener(\"blur\", __privateGet(this, _onHandleBlur3));\n    __privateGet(this, _session3).removeEventListener(\"suggest\", __privateGet(this, _handleSuggest3));\n    __privateGet(this, _session3).removeEventListener(\"suggesterror\", __privateGet(this, _handleSuggestError3));\n    __privateGet(this, _session3).removeEventListener(\"retrieve\", __privateGet(this, _handleRetrieve3));\n  }\n  attributeChangedCallback(name, oldValue, newValue) {\n    if (name === \"access-token\") {\n      __privateGet(this, _search2).accessToken = newValue;\n      return;\n    }\n    if (name === \"theme\") {\n      this.theme = tryParseJSON(newValue);\n      return;\n    }\n    if (name === \"popover-options\") {\n      this.popoverOptions = tryParseJSON(newValue);\n      return;\n    }\n    if (name === \"placeholder\") {\n      this.placeholder = newValue;\n      return;\n    }\n    const optionName = name.split(\"-\").join(\"_\");\n    if (!newValue) {\n      delete this.options[optionName];\n    }\n    this.options[optionName] = newValue;\n    if (optionName === \"language\") {\n      this.placeholder = __privateGet(this, _placeholder2);\n    }\n  }\n  focus() {\n    __privateGet(this, _listbox3).focus();\n  }\n  search(text) {\n    this.value = text;\n    __privateGet(this, _onHandleInput3).call(this, new MapboxHTMLEvent(\"input\", text));\n  }\n  bindMap(map) {\n    if (__privateGet(this, _map2)) {\n      __privateGet(this, _map2).off(\"moveend\", __privateGet(this, _handleMoveEnd2));\n    }\n    if (map) {\n      map.on(\"moveend\", __privateGet(this, _handleMoveEnd2));\n    }\n    __privateSet(this, _map2, map);\n  }\n  unbindMap() {\n    this.bindMap(null);\n  }\n  onAdd(map) {\n    this.bindMap(map);\n    this.remove();\n    const container = document.createElement(\"div\");\n    container.className = \"mapboxgl-ctrl\";\n    container.style.width = \"300px\";\n    container.appendChild(this);\n    return container;\n  }\n  onRemove() {\n    this.remove();\n    this.unbindMap();\n    __privateGet(this, _removeMarker2).call(this);\n  }\n  getDefaultPosition() {\n    return \"top-right\";\n  }\n};\n_binding6 = new WeakMap();\n_search2 = new WeakMap();\n_session3 = new WeakMap();\n_map2 = new WeakMap();\n_input3 = new WeakMap();\n_listbox3 = new WeakMap();\n_getDefaultPlaceholder2 = new WeakSet();\ngetDefaultPlaceholder_fn2 = function() {\n  if (this.options.language) {\n    const firstLanguage = this.options.language.split(\",\")[0];\n    const language = subtag__WEBPACK_IMPORTED_MODULE_5___default().language(firstLanguage);\n    const localizedValue = localization_default.placeholder[language];\n    if (localizedValue)\n      return localizedValue;\n  }\n  return \"Search\";\n};\n_placeholder2 = new WeakMap();\n_handleSuggest3 = new WeakMap();\n_handleSuggestError3 = new WeakMap();\n_handleRetrieve3 = new WeakMap();\n_mapMarker2 = new WeakMap();\n_removeMarker2 = new WeakMap();\n_handleMarker2 = new WeakMap();\n_onHandleInput3 = new WeakMap();\n_onHandleSelect3 = new WeakMap();\n_onHandleBlur3 = new WeakMap();\n_setActionIcons2 = new WeakMap();\n_handleClear2 = new WeakMap();\n_handleMoveEnd2 = new WeakMap();\nMapboxGeocoder.observedAttributes = [\n  \"access-token\",\n  \"theme\",\n  \"popover-options\",\n  \"placeholder\",\n  \"autocomplete\",\n  \"language\",\n  \"country\",\n  \"bbox\",\n  \"limit\",\n  \"proximity\",\n  \"types\",\n  \"worldview\",\n  \"permanent\"\n];\nwindow.MapboxGeocoder = MapboxGeocoder;\nif (!window.customElements.get(\"mapbox-geocoder\")) {\n  customElements.define(\"mapbox-geocoder\", MapboxGeocoder);\n}\n\n// src/components/MapboxAddressMinimap.ts\n\n\n// src/utils/minimap.ts\n\nvar merc = new (_mapbox_sphericalmercator__WEBPACK_IMPORTED_MODULE_6___default())({ size: 512, antimeridian: true });\nvar MAX_IMAGE_DIM = 1280;\nfunction getAnchorOffset(marker, anchor) {\n  const { width, height } = getElementSize(marker, true);\n  switch (anchor) {\n    case \"center\":\n      return [0, 0];\n    case \"top\":\n      return [0, height / 2];\n    case \"bottom\":\n      return [0, -1 * height / 2];\n    case \"left\":\n      return [width / 2, 0];\n    case \"right\":\n      return [-1 * width / 2, 0];\n    case \"top-left\":\n      return [width / 2, height / 2];\n    case \"top-right\":\n      return [-1 * width / 2, height / 2];\n    case \"bottom-left\":\n      return [width / 2, -1 * height / 2];\n    case \"bottom-right\":\n      return [-1 * width / 2, -1 * height / 2];\n  }\n}\nvar _anchor, _handleAnchorResize, _markerTransform, _isActive, _originalCoordinate, _onPointerDownMarker, _onPointerUpMarker, _onPointerMoveMarker, _onPointerDownImage, _onPointerUpImage, _onPointerMoveImage, _updatePointerPosition, _updateMarkerTransform, _updateMarkerCorrection;\nvar MarkerController = class {\n  constructor(imageContainer, imageElement, marker, keepMarkerCentered, zoom, anchor) {\n    __privateAdd(this, _anchor, void 0);\n    __privateAdd(this, _handleAnchorResize, () => {\n      [this.anchorOffsetX, this.anchorOffsetY] = getAnchorOffset(this.markerElement, this.anchor);\n      this.markerTransform = {\n        anchorX: this.anchorOffsetX,\n        anchorY: this.anchorOffsetY\n      };\n    });\n    __privateAdd(this, _markerTransform, {\n      anchorX: 0,\n      anchorY: 0,\n      globalX: 0,\n      globalY: 0,\n      correctionX: 0,\n      correctionY: 0\n    });\n    __privateAdd(this, _isActive, false);\n    __privateAdd(this, _originalCoordinate, void 0);\n    __privateAdd(this, _onPointerDownMarker, (m) => {\n      if (!this.isActive)\n        return;\n      m.preventDefault();\n      m.stopPropagation();\n      __privateGet(this, _updatePointerPosition).call(this, m);\n      window.addEventListener(\"pointermove\", __privateGet(this, _onPointerMoveMarker));\n      window.addEventListener(\"pointerup\", __privateGet(this, _onPointerUpMarker));\n    });\n    __privateAdd(this, _onPointerUpMarker, () => {\n      window.removeEventListener(\"pointermove\", __privateGet(this, _onPointerMoveMarker));\n      window.removeEventListener(\"pointerup\", __privateGet(this, _onPointerUpMarker));\n    });\n    __privateAdd(this, _onPointerMoveMarker, (m) => {\n      m.preventDefault();\n      m.stopPropagation();\n      const diffX = this.curPointerXPos - m.pageX;\n      const diffY = this.curPointerYPos - m.pageY;\n      this.markerDeltaX += diffX;\n      this.markerDeltaY -= diffY;\n      this.markerDeltaX = Math.max(Math.min(this.imgElement.width / 2, this.markerDeltaX), this.imgElement.width / 2 * -1);\n      this.markerDeltaY = Math.max(Math.min(this.imgElement.height / 2, this.markerDeltaY), this.imgElement.height / 2 * -1);\n      const imageOffsetX = this.imgCenterPx[0] - this.imgCenterAdjustedPx[0];\n      const imageOffsetY = this.imgCenterPx[1] - this.imgCenterAdjustedPx[1];\n      const deltaX = this.markerDeltaX - imageOffsetX;\n      const deltaY = this.markerDeltaY + imageOffsetY;\n      this.markerTransform = { globalX: deltaX, globalY: deltaY };\n      __privateGet(this, _updatePointerPosition).call(this, m);\n    });\n    __privateAdd(this, _onPointerDownImage, (m) => {\n      if (!this.isActive)\n        return;\n      m.preventDefault();\n      m.stopPropagation();\n      __privateGet(this, _updatePointerPosition).call(this, m);\n      window.addEventListener(\"pointermove\", __privateGet(this, _onPointerMoveImage));\n      window.addEventListener(\"pointerup\", __privateGet(this, _onPointerUpImage));\n    });\n    __privateAdd(this, _onPointerUpImage, () => {\n      window.removeEventListener(\"pointermove\", __privateGet(this, _onPointerMoveImage));\n      window.removeEventListener(\"pointerup\", __privateGet(this, _onPointerUpImage));\n    });\n    __privateAdd(this, _onPointerMoveImage, (m) => {\n      m.preventDefault();\n      let top = Math.round(this.imgContainerElement.scrollTop + (this.curPointerYPos - m.pageY));\n      top = Math.max(Math.min(this.imgElement.height - this.imgContainerElement.clientHeight, top), 0);\n      let left = Math.round(this.imgContainerElement.scrollLeft + (this.curPointerXPos - m.pageX));\n      left = Math.max(Math.min(this.imgElement.width - this.imgContainerElement.clientWidth, left), 0);\n      this.imgContainerElement.scrollTop = top;\n      this.imgContainerElement.scrollLeft = left;\n      const diffX = Math.round(left - (this.imgElement.width - this.imgContainerElement.clientWidth) / 2);\n      const diffY = Math.round((this.imgElement.height - this.imgContainerElement.clientHeight) / 2 - top);\n      this.imgCenterAdjustedPx = [\n        this.imgCenterPx[0] + diffX,\n        this.imgCenterPx[1] - diffY\n      ];\n      if (!this.keepMarkerCentered) {\n        const deltaX = this.markerDeltaX + diffX;\n        const deltaY = this.markerDeltaY + diffY;\n        this.markerTransform = { globalX: deltaX, globalY: deltaY };\n      }\n      __privateGet(this, _updateMarkerCorrection).call(this, left, top);\n      __privateGet(this, _updatePointerPosition).call(this, m);\n    });\n    __privateAdd(this, _updatePointerPosition, (m) => {\n      this.curPointerXPos = m.pageX;\n      this.curPointerYPos = m.pageY;\n    });\n    __privateAdd(this, _updateMarkerTransform, () => {\n      const { anchorX, anchorY, globalX, globalY, correctionX, correctionY } = __privateGet(this, _markerTransform);\n      const transformX = anchorX - globalX + correctionX;\n      const transformY = anchorY + globalY + correctionY;\n      this.markerElement.style.transform = `translate(calc(-50% + ${transformX}px), calc(-50% + ${transformY}px))`;\n    });\n    this.reCenter = () => {\n      const top = (this.imgElement.height - this.imgContainerElement.clientHeight) / 2;\n      const left = (this.imgElement.width - this.imgContainerElement.clientWidth) / 2;\n      this.imgContainerElement.scrollTop = top;\n      this.imgContainerElement.scrollLeft = left;\n      this.imgCenterAdjustedPx = this.imgCenterPx;\n      this.markerDeltaX = this.markerDeltaY = 0;\n      this.markerTransform = {\n        globalX: 0,\n        globalY: 0,\n        correctionX: 0,\n        correctionY: 0\n      };\n    };\n    this.handleMinimapResize = () => {\n      if (!this.imgElement.height || !this.imgElement.width)\n        return;\n      const centerOffsetX = this.imgCenterOffset.x;\n      const centerOffsetY = this.imgCenterOffset.y;\n      const left = this.imgElement.width / 2 - centerOffsetX - this.imgContainerElement.clientWidth / 2;\n      const top = this.imgElement.height / 2 - centerOffsetY - this.imgContainerElement.clientHeight / 2;\n      this.imgContainerElement.scrollLeft = left;\n      this.imgContainerElement.scrollTop = top;\n      __privateGet(this, _updateMarkerCorrection).call(this, left, top);\n    };\n    __privateAdd(this, _updateMarkerCorrection, (scrollLeft, scrollTop) => {\n      const centerOffsetX = this.imgCenterOffset.x;\n      const centerOffsetY = this.imgCenterOffset.y;\n      const { correctionX, correctionY } = this.markerTransform;\n      const corrections = {};\n      if (scrollLeft / 2 < centerOffsetX * -1) {\n        const markerTranslateX = centerOffsetX * -1 - scrollLeft / 2;\n        corrections.correctionX = markerTranslateX * 2;\n      } else if (scrollLeft < 0) {\n        corrections.correctionX = scrollLeft;\n      } else if (correctionX !== 0) {\n        corrections.correctionX = 0;\n      }\n      if (scrollTop / 2 < centerOffsetY * -1) {\n        const markerTranslateY = centerOffsetY * -1 - scrollTop / 2;\n        corrections.correctionY = markerTranslateY * 2;\n      } else if (scrollTop < 0) {\n        corrections.correctionY = scrollTop;\n      } else if (correctionY !== 0) {\n        corrections.correctionY = 0;\n      }\n      this.markerTransform = corrections;\n    });\n    this.markerElement = marker;\n    this.imgContainerElement = imageContainer;\n    this.imgElement = imageElement;\n    this.keepMarkerCentered = keepMarkerCentered;\n    this.zoom = zoom;\n    this.anchor = anchor;\n    this.curPointerXPos = 0;\n    this.curPointerYPos = 0;\n    this.markerDeltaX = 0;\n    this.markerDeltaY = 0;\n    this.imgContainerElement.addEventListener(\"pointerdown\", __privateGet(this, _onPointerDownImage));\n    if (!this.keepMarkerCentered) {\n      this.markerElement.addEventListener(\"pointerdown\", __privateGet(this, _onPointerDownMarker));\n    }\n    const resizeObserver = new ResizeObserver(__privateGet(this, _handleAnchorResize));\n    resizeObserver.observe(this.markerElement);\n  }\n  get anchor() {\n    return __privateGet(this, _anchor);\n  }\n  set anchor(newAnchor) {\n    __privateSet(this, _anchor, newAnchor);\n    [this.anchorOffsetX, this.anchorOffsetY] = getAnchorOffset(this.markerElement, newAnchor);\n    this.markerTransform = {\n      anchorX: this.anchorOffsetX,\n      anchorY: this.anchorOffsetY\n    };\n  }\n  get markerTransform() {\n    return __privateGet(this, _markerTransform);\n  }\n  set markerTransform(val) {\n    __privateSet(this, _markerTransform, __spreadValues(__spreadValues({}, __privateGet(this, _markerTransform)), val));\n    __privateGet(this, _updateMarkerTransform).call(this);\n  }\n  get isActive() {\n    return __privateGet(this, _isActive);\n  }\n  set isActive(val) {\n    this.imgContainerElement.style.touchAction = val ? \"none\" : \"\";\n    __privateSet(this, _isActive, val);\n  }\n  get coordinate() {\n    const adjustedPx = this.keepMarkerCentered ? this.imgCenterAdjustedPx : [\n      this.imgCenterPx[0] - this.markerDeltaX,\n      this.imgCenterPx[1] + this.markerDeltaY\n    ];\n    if (deepEquals(adjustedPx, this.imgCenterPx)) {\n      return __privateGet(this, _originalCoordinate);\n    } else {\n      const lngLat = merc.ll(adjustedPx, this.zoom);\n      return [round(lngLat[0], 6), round(lngLat[1], 6)];\n    }\n  }\n  set coordinate(lngLat) {\n    __privateSet(this, _originalCoordinate, lngLat);\n    this.imgCenterPx = this.imgCenterAdjustedPx = merc.px(lngLat, this.zoom);\n  }\n  get imgCenterOffset() {\n    return {\n      x: this.imgCenterPx[0] - this.imgCenterAdjustedPx[0],\n      y: this.imgCenterPx[1] - this.imgCenterAdjustedPx[1]\n    };\n  }\n};\n_anchor = new WeakMap();\n_handleAnchorResize = new WeakMap();\n_markerTransform = new WeakMap();\n_isActive = new WeakMap();\n_originalCoordinate = new WeakMap();\n_onPointerDownMarker = new WeakMap();\n_onPointerUpMarker = new WeakMap();\n_onPointerMoveMarker = new WeakMap();\n_onPointerDownImage = new WeakMap();\n_onPointerUpImage = new WeakMap();\n_onPointerMoveImage = new WeakMap();\n_updatePointerPosition = new WeakMap();\n_updateMarkerTransform = new WeakMap();\n_updateMarkerCorrection = new WeakMap();\n\n// src/icons/mapboxgl-ctrl-logo.svg\nvar mapboxgl_ctrl_logo_default = '<svg width=\"88\" height=\"23\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" fill-rule=\"evenodd\"><defs><path id=\"g\" d=\"M11.5 2.25a9.25 9.25 0 1 1 0 18.5 9.25 9.25 0 0 1 0-18.5zM7 15.98c-.05-.33-.83-5.8 2.23-8.87a4.4 4.4 0 0 1 3.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39a4.4 4.4 0 0 1-1.28 3.13C12.72 16.93 7 16 7 16v-.02zm8.3-5.48-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z\"/><path id=\"b\" d=\"M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19A3.77 3.77 0 0 1 50.86 15v3.77c0 .13-.1.23-.23.23h-1.4a.23.23 0 0 1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01.01-.01c.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4a.23.23 0 0 1-.23-.23V15a3.7 3.7 0 0 1-2.73 1.19c-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.38-.19a4.24 4.24 0 0 0-4.16 3.29 4.07 4.07 0 0 0 0 1.77 4.23 4.23 0 0 0 4.17 3.3 4.22 4.22 0 0 0 4.26-4.19 4.2 4.2 0 0 0-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18a4 4 0 0 1 3.84 3.28c.13.59.13 1.2 0 1.8a4 4 0 0 1-3.84 3.29A3.77 3.77 0 0 1 60.86 15v.77c0 .12-.1.23-.23.23h-1.4a.23.23 0 0 1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4a.23.23 0 0 1-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55a2.73 2.73 0 0 1 2.44-1.56c1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41a.23.23 0 0 1-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41a.23.23 0 0 1-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.62 0h-1.61a.27.27 0 0 1-.12-.03c-.1-.06-.13-.19-.06-.28l2.43-3.71-2.4-3.65a.21.21 0 0 1-.02-.12.2.2 0 0 1 .2-.21h1.61c.13 0 .24.06.3.17L82 10.54l1.4-2.37a.34.34 0 0 1 .3-.17h1.6l.12.03c.1.06.13.19.06.28l-2.37 3.65 2.43 3.7.01.13a.2.2 0 0 1-.2.21h-1.61a.33.33 0 0 1-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 0 1-.3.17zm-7.12-1.49A2.47 2.47 0 0 1 70.7 12a2.47 2.47 0 0 1 2.42-2.52 2.47 2.47 0 0 1 2.42 2.51 2.48 2.48 0 0 1-2.42 2.52zm-19.87 0a2.48 2.48 0 0 1-2.42-2.48v-.07a2.47 2.47 0 0 1 2.4-2.49 2.47 2.47 0 0 1 2.41 2.51 2.47 2.47 0 0 1-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51a2.47 2.47 0 0 1 2.4-2.52 2.46 2.46 0 0 1 2.41 2.48l.02.08zm18.12 2.47a2.47 2.47 0 0 1-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51a2.47 2.47 0 0 1-2.42 2.51z\"/></defs><mask id=\"c\"><rect width=\"100%\" height=\"100%\" fill=\"#fff\"/><use xlink:href=\"#g\"/><use xlink:href=\"#b\"/></mask><g opacity=\".3\" stroke=\"#000\" stroke-width=\"3\"><circle mask=\"url(#c)\" cx=\"11.5\" cy=\"11.5\" r=\"9.25\"/><use xlink:href=\"#b\" mask=\"url(#c)\"/></g><g opacity=\".9\" fill=\"#fff\"><use xlink:href=\"#g\"/><use xlink:href=\"#b\"/></g></svg>';\n\n// src/components/MapboxAddressMinimap.ts\nvar ZOOM = 16;\nvar TEMPLATE4 = createElementFromString(`\n<template>\n  <div class=\"MapboxAddressMinimap\" aria-hidden=\"true\">\n    <div class=\"MinimapImageContainer\">\n      <img class=\"MinimapImage\" draggable=\"false\"></img>\n      <div class=\"MinimapInnerFrame\">\n        <div class=\"MinimapMarker\"></div>\n        <div class=\"MinimapAttribution\">\n          <div class=\"MinimapAttributionLogo\">\n            <a target=\"_blank\" rel=\"noopener nofollow\" href=\"https://www.mapbox.com/\" aria-label=\"Mapbox logo\">\n              ${mapboxgl_ctrl_logo_default}\n            </a>\n          </div>\n          <div class=\"MinimapAttributionText\">\n            <a target=\"_blank\" href='https://www.mapbox.com/about/maps/'>\\xA9 Mapbox</a><a target=\"_blank\" href='http://www.openstreetmap.org/copyright'>\\xA9 OpenStreetMap</a>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n`);\nvar STYLE_TOGGLE_TEMPLATE = createElementFromString(`\n<template>\n  <button type=\"button\" class=\"MinimapStyleToggle\"></button>\n</template>\n`);\nvar FOOTER_TEMPLATE = createElementFromString(`\n<template>\n  <div class=\"MinimapFooter\">Adjust the marker on the map if it doesn't precisely match your location. This helps improve address data quality.</div>\n</template>\n`);\nvar ADJUST_PIN_TEXT = \"Adjust pin\";\nvar SAVE_TEXT = \"Save\";\nvar CANCEL_TEXT = \"Cancel\";\nvar EDIT_BUTTONS_TEMPLATE = createElementFromString(`\n<template>\n  <div class=\"MinimapEditButtons\">\n    <div class=\"Button ButtonPrimary MinimapButtonAdjust\">${ADJUST_PIN_TEXT}</div>\n    <div class=\"Button ButtonPrimary MinimapButtonSave\" aria-hidden=\"true\">${SAVE_TEXT}</div>\n    <div class=\"Button MinimapButtonCancel\" aria-hidden=\"true\">${CANCEL_TEXT}</div>\n  </div>\n</template>\n`);\nvar _canAdjustMarkerInternal, _isAdjustMarkerEditing, _imageLoaded, _feature2, _url, _width, _height, _binding7, _markerController, _accessToken, _themeInternal5, _satelliteToggleInternal, _mapStyleMode, _adjustBtnText, _saveBtnText, _cancelBtnText, _defaultMapStyle, _footer, _container, _toggleMarkerEditing, _handleStartMarkerEditing, _handleSaveMarkerEditing, _handleCancelMarkerEditing, _handleToggleMapStyle, _handleImageLoad, _handleImageError, _getImageUrl, _updateImageSrc, _getToggleBackgroundImageUrl, _setSize, _addMarkerEditControls, _removeMarkerEditControls, _addSatelliteToggle, _removeSatelliteToggle;\nvar MapboxAddressMinimap = class extends HTMLScopedElement {\n  constructor() {\n    super(...arguments);\n    __privateAdd(this, _canAdjustMarkerInternal, false);\n    this.keepMarkerCentered = false;\n    this.markerAnchor = \"bottom\";\n    __privateAdd(this, _isAdjustMarkerEditing, false);\n    __privateAdd(this, _imageLoaded, false);\n    __privateAdd(this, _feature2, void 0);\n    __privateAdd(this, _url, \"\");\n    __privateAdd(this, _width, void 0);\n    __privateAdd(this, _height, void 0);\n    __privateAdd(this, _binding7, void 0);\n    __privateAdd(this, _markerController, void 0);\n    __privateAdd(this, _accessToken, void 0);\n    __privateAdd(this, _themeInternal5, {});\n    __privateAdd(this, _satelliteToggleInternal, false);\n    __privateAdd(this, _mapStyleMode, \"default\");\n    __privateAdd(this, _adjustBtnText, void 0);\n    __privateAdd(this, _saveBtnText, void 0);\n    __privateAdd(this, _cancelBtnText, void 0);\n    __privateAdd(this, _defaultMapStyle, [\"mapbox\", \"streets-v11\"]);\n    __privateAdd(this, _footer, void 0);\n    __privateAdd(this, _container, void 0);\n    __privateAdd(this, _toggleMarkerEditing, () => {\n      const { ImageContainer, ButtonAdjust, ButtonSave, ButtonCancel } = __privateGet(this, _binding7);\n      if (__privateGet(this, _isAdjustMarkerEditing)) {\n        ImageContainer.classList.add(`${this.dataset.seed}--draggable`);\n        __privateGet(this, _markerController).isActive = true;\n        ButtonAdjust.setAttribute(\"aria-hidden\", \"true\");\n        ButtonSave.removeAttribute(\"aria-hidden\");\n        ButtonCancel.removeAttribute(\"aria-hidden\");\n      } else {\n        ImageContainer.classList.remove(`${this.dataset.seed}--draggable`);\n        __privateGet(this, _markerController).isActive = false;\n        ButtonAdjust.removeAttribute(\"aria-hidden\");\n        ButtonSave.setAttribute(\"aria-hidden\", \"true\");\n        ButtonCancel.setAttribute(\"aria-hidden\", \"true\");\n      }\n    });\n    __privateAdd(this, _handleStartMarkerEditing, () => {\n      __privateSet(this, _isAdjustMarkerEditing, true);\n      __privateGet(this, _toggleMarkerEditing).call(this);\n    });\n    __privateAdd(this, _handleSaveMarkerEditing, () => {\n      if (this.feature.properties.full_address && !deepEquals(this.feature.geometry.coordinates, __privateGet(this, _markerController).coordinate)) {\n        const [lng, lat] = __privateGet(this, _markerController).coordinate;\n        sendFeedback(this.accessToken, {\n          originalCoordinate: this.feature.geometry.coordinates,\n          originalAddress: this.feature.properties.full_address,\n          changes: {\n            location: { longitude: lng, latitude: lat }\n          }\n        });\n      }\n      if (this.onSaveMarkerLocation) {\n        this.onSaveMarkerLocation(__privateGet(this, _markerController).coordinate);\n      }\n      __privateSet(this, _isAdjustMarkerEditing, false);\n      __privateGet(this, _toggleMarkerEditing).call(this);\n    });\n    __privateAdd(this, _handleCancelMarkerEditing, () => {\n      __privateGet(this, _markerController).reCenter();\n      __privateSet(this, _isAdjustMarkerEditing, false);\n      __privateGet(this, _toggleMarkerEditing).call(this);\n    });\n    __privateAdd(this, _handleToggleMapStyle, () => {\n      this.mapStyleMode = this.mapStyleMode === \"default\" ? \"satellite\" : \"default\";\n    });\n    __privateAdd(this, _handleImageLoad, () => {\n      if (!__privateGet(this, _imageLoaded)) {\n        __privateGet(this, _markerController).reCenter();\n      }\n      __privateSet(this, _imageLoaded, true);\n      __privateGet(this, _markerController) && __privateGet(this, _markerController).handleMinimapResize();\n    });\n    __privateAdd(this, _handleImageError, () => {\n      __privateSet(this, _imageLoaded, false);\n    });\n    __privateAdd(this, _getImageUrl, (lngLatLike) => {\n      if (__privateGet(this, _width) === 0 || __privateGet(this, _height) === 0)\n        return \"\";\n      const [username, styleId] = this.defaultMapStyle;\n      const defaultBaseUrl = getStaticBaseUrl(username, styleId);\n      const baseUrl = this.mapStyleMode === \"default\" ? defaultBaseUrl : STATIC_BASE_URL_SATELLITE;\n      const skuToken = AUTOFILL_SKU_TOKEN_PREFIX + config.autofillSessionToken.toString();\n      let imgUrl = baseUrl + _mapbox_search_js_core__WEBPACK_IMPORTED_MODULE_0__.LngLat.convert(lngLatLike).toArray().join(\",\") + \",\" + ZOOM + \",0/\" + Math.min(__privateGet(this, _width) * 2, MAX_IMAGE_DIM) + \"x\" + Math.min(__privateGet(this, _height) * 2, MAX_IMAGE_DIM) + \"?access_token=\" + this.accessToken + \"&attribution=false&logo=false\";\n      if (config.autofillSessionEnabled) {\n        imgUrl += `&sku=${skuToken}`;\n      }\n      return imgUrl;\n    });\n    __privateAdd(this, _updateImageSrc, () => {\n      if (__privateGet(this, _feature2)) {\n        const lngLat = __privateGet(this, _feature2).geometry.coordinates;\n        __privateSet(this, _url, __privateGet(this, _getImageUrl).call(this, lngLat));\n        const { Image } = __privateGet(this, _binding7);\n        Image.src = __privateGet(this, _url);\n      }\n    });\n    __privateAdd(this, _getToggleBackgroundImageUrl, (styleMode) => {\n      return `url(\"${getImage(styleMode === \"default\" ? \"styleToggleDefault\" : \"styleToggleSatellite\", this.theme)}\")`;\n    });\n    __privateAdd(this, _setSize, () => {\n      const { MapboxAddressMinimap: MapboxAddressMinimap2, ImageContainer, Image } = __privateGet(this, _binding7);\n      const { width, height } = getElementSize(this.container);\n      const [oldWidth, oldHeight] = [__privateGet(this, _width), __privateGet(this, _height)];\n      __privateSet(this, _width, Math.min(width, MAX_IMAGE_DIM));\n      __privateSet(this, _height, Math.min(height, MAX_IMAGE_DIM));\n      MapboxAddressMinimap2.style.setProperty(\"width\", `${__privateGet(this, _width)}px`);\n      MapboxAddressMinimap2.style.setProperty(\"height\", `${__privateGet(this, _height)}px`);\n      ImageContainer.style.setProperty(\"height\", `${__privateGet(this, _height)}px`);\n      ImageContainer.style.setProperty(\"width\", `${__privateGet(this, _width)}px`);\n      const [imgWidth, imgHeight] = [Image.width, Image.height];\n      if (__privateGet(this, _width) > oldWidth && __privateGet(this, _width) > imgWidth / 2 && imgWidth < MAX_IMAGE_DIM || __privateGet(this, _height) > oldHeight && __privateGet(this, _height) > imgHeight / 2 && imgHeight < MAX_IMAGE_DIM) {\n        __privateGet(this, _updateImageSrc).call(this);\n      } else {\n        __privateGet(this, _markerController) && __privateGet(this, _markerController).handleMinimapResize();\n      }\n    });\n    __privateAdd(this, _addMarkerEditControls, () => {\n      const existingFooter = this.querySelector(\".MinimapFooter\");\n      if (existingFooter)\n        return;\n      const footerElement = this.prepareTemplate(FOOTER_TEMPLATE);\n      const minimapElement = this.querySelector(\".MapboxAddressMinimap\");\n      if (!minimapElement)\n        return;\n      minimapElement.appendChild(footerElement);\n      const existingEditBtns = this.querySelector(\".MinimapEditButtons\");\n      if (existingEditBtns)\n        return;\n      const editButtonsElement = this.prepareTemplate(EDIT_BUTTONS_TEMPLATE);\n      const innerFrame = this.querySelector(\".MinimapInnerFrame\");\n      innerFrame.appendChild(editButtonsElement);\n      __privateSet(this, _binding7, __spreadProps(__spreadValues({}, __privateGet(this, _binding7)), {\n        EditButtons: this.querySelector(\".MinimapEditButtons\"),\n        ButtonAdjust: this.querySelector(\".MinimapButtonAdjust\"),\n        ButtonSave: this.querySelector(\".MinimapButtonSave\"),\n        ButtonCancel: this.querySelector(\".MinimapButtonCancel\")\n      }));\n      const { ButtonAdjust, ButtonSave, ButtonCancel } = __privateGet(this, _binding7);\n      ButtonAdjust.addEventListener(\"click\", __privateGet(this, _handleStartMarkerEditing));\n      ButtonSave.addEventListener(\"click\", __privateGet(this, _handleSaveMarkerEditing));\n      ButtonCancel.addEventListener(\"click\", __privateGet(this, _handleCancelMarkerEditing));\n    });\n    __privateAdd(this, _removeMarkerEditControls, () => {\n      if (!__privateGet(this, _binding7))\n        return;\n      const { EditButtons, ButtonAdjust, ButtonSave, ButtonCancel } = __privateGet(this, _binding7);\n      const existingFooter = this.querySelector(\".MinimapFooter\");\n      existingFooter == null ? void 0 : existingFooter.remove();\n      EditButtons == null ? void 0 : EditButtons.remove();\n      if (ButtonAdjust) {\n        ButtonAdjust.remove();\n        ButtonAdjust.removeEventListener(\"click\", __privateGet(this, _handleStartMarkerEditing));\n      }\n      if (ButtonSave) {\n        ButtonSave.remove();\n        ButtonSave.removeEventListener(\"click\", __privateGet(this, _handleSaveMarkerEditing));\n      }\n      if (ButtonCancel) {\n        ButtonCancel.remove();\n        ButtonCancel.removeEventListener(\"click\", __privateGet(this, _handleCancelMarkerEditing));\n      }\n      delete __privateGet(this, _binding7).EditButtons;\n      delete __privateGet(this, _binding7).ButtonAdjust;\n      delete __privateGet(this, _binding7).ButtonSave;\n      delete __privateGet(this, _binding7).ButtonCancel;\n    });\n    __privateAdd(this, _addSatelliteToggle, () => {\n      const existingToggle = this.querySelector(\".MinimapStyleToggle\");\n      if (existingToggle)\n        return;\n      const toggleElement = this.prepareTemplate(STYLE_TOGGLE_TEMPLATE);\n      const innerFrame = this.querySelector(\".MinimapInnerFrame\");\n      if (!innerFrame)\n        return;\n      innerFrame.appendChild(toggleElement);\n      __privateGet(this, _binding7).MapStyleToggle = toggleElement;\n      toggleElement.addEventListener(\"click\", __privateGet(this, _handleToggleMapStyle));\n      toggleElement.style.backgroundImage = __privateGet(this, _getToggleBackgroundImageUrl).call(this, this.mapStyleMode === \"default\" ? \"satellite\" : \"default\");\n      toggleElement.setAttribute(\"title\", `Switch to ${this.mapStyleMode === \"default\" ? \"Satellite\" : \"Default\"}`);\n    });\n    __privateAdd(this, _removeSatelliteToggle, () => {\n      if (!__privateGet(this, _binding7))\n        return;\n      const { MapStyleToggle } = __privateGet(this, _binding7);\n      if (!MapStyleToggle)\n        return;\n      MapStyleToggle.remove();\n      MapStyleToggle.removeEventListener(\"click\", __privateGet(this, _handleToggleMapStyle));\n      delete __privateGet(this, _binding7).MapStyleToggle;\n    });\n  }\n  get canAdjustMarker() {\n    return __privateGet(this, _canAdjustMarkerInternal);\n  }\n  set canAdjustMarker(val) {\n    __privateSet(this, _canAdjustMarkerInternal, val);\n    val ? __privateGet(this, _addMarkerEditControls).call(this) : __privateGet(this, _removeMarkerEditControls).call(this);\n  }\n  get accessToken() {\n    return __privateGet(this, _accessToken) || config.accessToken;\n  }\n  set accessToken(newToken) {\n    __privateSet(this, _accessToken, newToken);\n  }\n  get feature() {\n    return __privateGet(this, _feature2);\n  }\n  set feature(feature) {\n    __privateSet(this, _feature2, feature);\n    if (!feature) {\n      this.hide();\n    } else {\n      this.show();\n    }\n  }\n  get template() {\n    return TEMPLATE4;\n  }\n  get templateStyle() {\n    return style_default;\n  }\n  get templateUserStyle() {\n    return getThemeCSS(\".MapboxAddressMinimap\", this.theme);\n  }\n  get satelliteToggle() {\n    return __privateGet(this, _satelliteToggleInternal);\n  }\n  set satelliteToggle(val) {\n    __privateSet(this, _satelliteToggleInternal, val);\n    val ? __privateGet(this, _addSatelliteToggle).call(this) : __privateGet(this, _removeSatelliteToggle).call(this);\n  }\n  get theme() {\n    return __privateGet(this, _themeInternal5);\n  }\n  set theme(theme) {\n    __privateSet(this, _themeInternal5, theme);\n    if (!__privateGet(this, _binding7) || !theme) {\n      return;\n    }\n    this.updateTemplateUserStyle(getThemeCSS(\".MapboxAddressMinimap\", theme));\n    const { Marker, MapStyleToggle } = __privateGet(this, _binding7);\n    Marker.innerHTML = getIcon(\"marker\", theme);\n    if (MapStyleToggle) {\n      MapStyleToggle.style.backgroundImage = __privateGet(this, _getToggleBackgroundImageUrl).call(this, this.mapStyleMode === \"default\" ? \"satellite\" : \"default\");\n    }\n  }\n  get adjustBtnText() {\n    return __privateGet(this, _adjustBtnText) || ADJUST_PIN_TEXT;\n  }\n  set adjustBtnText(val) {\n    __privateSet(this, _adjustBtnText, val);\n    const adjustBtn = this.querySelector(\".MinimapButtonAdjust\");\n    adjustBtn.textContent = val || ADJUST_PIN_TEXT;\n  }\n  get saveBtnText() {\n    return __privateGet(this, _saveBtnText) || SAVE_TEXT;\n  }\n  set saveBtnText(val) {\n    __privateSet(this, _saveBtnText, val);\n    const saveBtn = this.querySelector(\".MinimapButtonSave\");\n    saveBtn.textContent = val || SAVE_TEXT;\n  }\n  get cancelBtnText() {\n    return __privateGet(this, _cancelBtnText) || CANCEL_TEXT;\n  }\n  set cancelBtnText(val) {\n    __privateSet(this, _cancelBtnText, val);\n    const cancelBtn = this.querySelector(\".MinimapButtonCancel\");\n    cancelBtn.textContent = val || CANCEL_TEXT;\n  }\n  get mapStyleMode() {\n    return __privateGet(this, _mapStyleMode);\n  }\n  set mapStyleMode(styleMode) {\n    const prevStyleMode = __privateGet(this, _mapStyleMode);\n    if (prevStyleMode === styleMode)\n      return;\n    __privateSet(this, _mapStyleMode, styleMode);\n    if (!__privateGet(this, _binding7)) {\n      return;\n    }\n    const { MapStyleToggle } = __privateGet(this, _binding7);\n    if (!MapStyleToggle) {\n      return;\n    }\n    MapStyleToggle.style.backgroundImage = __privateGet(this, _getToggleBackgroundImageUrl).call(this, prevStyleMode);\n    MapStyleToggle.setAttribute(\"title\", `Switch to ${prevStyleMode === \"satellite\" ? \"Satellite\" : \"Default\"}`);\n    __privateGet(this, _updateImageSrc).call(this);\n  }\n  get defaultMapStyle() {\n    return __privateGet(this, _defaultMapStyle);\n  }\n  set defaultMapStyle(style) {\n    __privateSet(this, _defaultMapStyle, style);\n    __privateGet(this, _updateImageSrc).call(this);\n  }\n  get footer() {\n    return __privateGet(this, _footer);\n  }\n  set footer(val) {\n    __privateSet(this, _footer, val);\n    const footerEl = this.querySelector(\".MinimapFooter\");\n    if (footerEl) {\n      if (typeof val === \"string\") {\n        footerEl.textContent = val;\n        footerEl.removeAttribute(\"aria-hidden\");\n      } else if (!val) {\n        footerEl.setAttribute(\"aria-hidden\", \"true\");\n      } else {\n        footerEl.removeAttribute(\"aria-hidden\");\n      }\n    }\n  }\n  get container() {\n    return __privateGet(this, _container);\n  }\n  set container(newContainer) {\n    if (newContainer) {\n      newContainer.style.position = \"relative\";\n      __privateSet(this, _container, newContainer);\n    }\n  }\n  show() {\n    if (!__privateGet(this, _feature2)) {\n      return;\n    }\n    const lngLat = __privateGet(this, _feature2).geometry.coordinates;\n    __privateGet(this, _markerController).coordinate = lngLat;\n    __privateSet(this, _url, __privateGet(this, _getImageUrl).call(this, lngLat));\n    const { MapboxAddressMinimap: MapboxAddressMinimap2, Image } = __privateGet(this, _binding7);\n    Image.src = __privateGet(this, _url);\n    MapboxAddressMinimap2.removeAttribute(\"aria-hidden\");\n  }\n  hide() {\n    const { MapboxAddressMinimap: MapboxAddressMinimap2 } = __privateGet(this, _binding7);\n    MapboxAddressMinimap2.setAttribute(\"aria-hidden\", \"true\");\n  }\n  connectedCallback() {\n    super.connectedCallback();\n    __privateSet(this, _binding7, bindElements(this, {\n      MapboxAddressMinimap: \".MapboxAddressMinimap\",\n      ImageContainer: \".MinimapImageContainer\",\n      Image: \".MinimapImage\",\n      Marker: \".MinimapMarker\",\n      MapStyleToggle: \".MinimapStyleToggle\",\n      EditButtons: \".MinimapEditButtons\",\n      ButtonAdjust: \".MinimapButtonAdjust\",\n      ButtonSave: \".MinimapButtonSave\",\n      ButtonCancel: \".MinimapButtonCancel\"\n    }));\n    this.mapStyleMode = __privateGet(this, _mapStyleMode);\n    this.theme = __spreadValues({}, this.theme);\n    if (this.canAdjustMarker) {\n      __privateGet(this, _addMarkerEditControls).call(this);\n    }\n    if (this.satelliteToggle) {\n      __privateGet(this, _addSatelliteToggle).call(this);\n    }\n    this.container = this.parentElement;\n    const resizeObserver = new ResizeObserver(__privateGet(this, _setSize));\n    resizeObserver.observe(this.container);\n    __privateGet(this, _setSize).call(this);\n    const { MapboxAddressMinimap: MapboxAddressMinimap2, ImageContainer, Image, Marker } = __privateGet(this, _binding7);\n    __privateSet(this, _markerController, new MarkerController(ImageContainer, Image, Marker, this.keepMarkerCentered, ZOOM, this.markerAnchor));\n    __privateGet(this, _markerController).reCenter();\n    Image.onload = __privateGet(this, _handleImageLoad);\n    Image.onerror = __privateGet(this, _handleImageError);\n    Image.src = __privateGet(this, _url);\n    if (__privateGet(this, _feature2))\n      MapboxAddressMinimap2.removeAttribute(\"aria-hidden\");\n    else\n      MapboxAddressMinimap2.setAttribute(\"aria-hidden\", \"true\");\n  }\n  attributeChangedCallback(name, oldValue, newValue) {\n    if (name === \"access-token\") {\n      this.accessToken = newValue;\n    } else if (name === \"can-adjust-marker\") {\n      this.canAdjustMarker = newValue === \"true\";\n    } else if (name === \"keep-marker-centered\") {\n      this.keepMarkerCentered = newValue === \"true\";\n    } else if (name === \"marker-anchor\") {\n      const newAnchor = newValue;\n      this.markerAnchor = newAnchor;\n      __privateGet(this, _markerController) && (__privateGet(this, _markerController).anchor = newAnchor);\n    } else if (name === \"satellite-toggle\") {\n      this.satelliteToggle = newValue === \"true\";\n    }\n  }\n};\n_canAdjustMarkerInternal = new WeakMap();\n_isAdjustMarkerEditing = new WeakMap();\n_imageLoaded = new WeakMap();\n_feature2 = new WeakMap();\n_url = new WeakMap();\n_width = new WeakMap();\n_height = new WeakMap();\n_binding7 = new WeakMap();\n_markerController = new WeakMap();\n_accessToken = new WeakMap();\n_themeInternal5 = new WeakMap();\n_satelliteToggleInternal = new WeakMap();\n_mapStyleMode = new WeakMap();\n_adjustBtnText = new WeakMap();\n_saveBtnText = new WeakMap();\n_cancelBtnText = new WeakMap();\n_defaultMapStyle = new WeakMap();\n_footer = new WeakMap();\n_container = new WeakMap();\n_toggleMarkerEditing = new WeakMap();\n_handleStartMarkerEditing = new WeakMap();\n_handleSaveMarkerEditing = new WeakMap();\n_handleCancelMarkerEditing = new WeakMap();\n_handleToggleMapStyle = new WeakMap();\n_handleImageLoad = new WeakMap();\n_handleImageError = new WeakMap();\n_getImageUrl = new WeakMap();\n_updateImageSrc = new WeakMap();\n_getToggleBackgroundImageUrl = new WeakMap();\n_setSize = new WeakMap();\n_addMarkerEditControls = new WeakMap();\n_removeMarkerEditControls = new WeakMap();\n_addSatelliteToggle = new WeakMap();\n_removeSatelliteToggle = new WeakMap();\nMapboxAddressMinimap.observedAttributes = [\n  \"access-token\",\n  \"can-adjust-marker\",\n  \"keep-marker-centered\",\n  \"marker-anchor\",\n  \"satellite-toggle\"\n];\nwindow.MapboxAddressMinimap = MapboxAddressMinimap;\nif (!window.customElements.get(\"mapbox-address-minimap\")) {\n  customElements.define(\"mapbox-address-minimap\", MapboxAddressMinimap);\n}\n\n// src/autofill.ts\n\nvar _input4, _collection, _session4, _initialAutocompleteValue2, _onHandleInput4, _onHandleSelect4, _onHandleBlur4, _onHandleFocus2, _handleSuggest4, _handleSuggestError4, _handleRetrieve4;\nvar AddressAutofillInstance = class {\n  constructor(collection, input, autofillRef) {\n    __privateAdd(this, _input4, void 0);\n    __privateAdd(this, _collection, void 0);\n    __privateAdd(this, _session4, void 0);\n    this.options = {};\n    this.retrieveFeature = null;\n    this.listbox = new MapboxSearchListbox();\n    __privateAdd(this, _initialAutocompleteValue2, void 0);\n    __privateAdd(this, _onHandleInput4, (e) => {\n      const value = e.detail;\n      const enableBrowserAutocomplete = __privateGet(this, _collection).browserAutofillEnabled === true && (value == null ? void 0 : value.length) <= 2;\n      toggleAutocompletion(__privateGet(this, _input4), __privateGet(this, _initialAutocompleteValue2), enableBrowserAutocomplete);\n      if ((value == null ? void 0 : value.length) <= 2) {\n        this.listbox.handleSuggest(null);\n        return;\n      }\n      __privateGet(this, _session4).suggest(value, this.options);\n    });\n    __privateAdd(this, _onHandleSelect4, (e) => {\n      const suggestion = e.detail;\n      if (e.detail.accuracy !== \"street\") {\n        toggleAutocompletion(__privateGet(this, _input4), __privateGet(this, _initialAutocompleteValue2), true);\n        __privateGet(this, _session4).retrieve(suggestion, this.options);\n      } else {\n        handleStreetSelection(__privateGet(this, _input4), __privateGet(this, _initialAutocompleteValue2), suggestion);\n      }\n    });\n    __privateAdd(this, _onHandleBlur4, () => {\n      toggleAutocompletion(__privateGet(this, _input4), __privateGet(this, _initialAutocompleteValue2), true);\n      __privateGet(this, _session4).abort();\n    });\n    __privateAdd(this, _onHandleFocus2, () => {\n      var _a;\n      const enableBrowserAutocomplete = __privateGet(this, _collection).browserAutofillEnabled === true && ((_a = __privateGet(this, _input4).value) == null ? void 0 : _a.length) <= 2;\n      toggleAutocompletion(__privateGet(this, _input4), __privateGet(this, _initialAutocompleteValue2), enableBrowserAutocomplete);\n    });\n    __privateAdd(this, _handleSuggest4, (result) => {\n      const filteredSuggestions = (result == null ? void 0 : result.suggestions) ? distinctExactStreetResults(result.suggestions) : null;\n      this.listbox.handleSuggest(filteredSuggestions);\n      const event = new MapboxHTMLEvent(\"suggest\", result);\n      Object.defineProperty(event, \"target\", { value: __privateGet(this, _input4) });\n      __privateGet(this, _collection).fire(\"suggest\", event);\n    });\n    __privateAdd(this, _handleSuggestError4, (error) => {\n      this.listbox.handleError();\n      const event = new MapboxHTMLEvent(\"suggesterror\", error);\n      Object.defineProperty(event, \"target\", { value: __privateGet(this, _input4) });\n      __privateGet(this, _collection).fire(\"suggesterror\", event);\n    });\n    __privateAdd(this, _handleRetrieve4, (result) => {\n      var _a;\n      const event = new MapboxHTMLEvent(\"retrieve\", result);\n      Object.defineProperty(event, \"target\", { value: __privateGet(this, _input4) });\n      __privateGet(this, _collection).fire(\"retrieve\", event);\n      this.retrieveFeature = (_a = result.features) == null ? void 0 : _a[0];\n      if (!__privateGet(this, _input4)) {\n        return;\n      }\n      const featureCollection = result;\n      if (!featureCollection || !featureCollection.features || !featureCollection.features.length) {\n        return;\n      }\n      fillFormWithFeature(featureCollection.features[0], __privateGet(this, _input4));\n    });\n    __privateSet(this, _input4, input);\n    __privateSet(this, _collection, collection);\n    __privateSet(this, _session4, new _mapbox_search_js_core__WEBPACK_IMPORTED_MODULE_0__.SearchSession(autofillRef));\n    __privateGet(this, _session4).sessionToken = config.autofillSessionToken;\n    this.listbox.input = __privateGet(this, _input4);\n    this.listbox.autofillHost = this;\n    this.listbox.searchService = 0 /* AddressAutofill */;\n    this.listbox.addEventListener(\"input\", __privateGet(this, _onHandleInput4));\n    this.listbox.addEventListener(\"select\", __privateGet(this, _onHandleSelect4));\n    this.listbox.addEventListener(\"blur\", __privateGet(this, _onHandleBlur4));\n    this.listbox.addEventListener(\"focus\", __privateGet(this, _onHandleFocus2));\n    __privateGet(this, _session4).addEventListener(\"suggest\", __privateGet(this, _handleSuggest4));\n    __privateGet(this, _session4).addEventListener(\"suggesterror\", __privateGet(this, _handleSuggestError4));\n    __privateGet(this, _session4).addEventListener(\"retrieve\", __privateGet(this, _handleRetrieve4));\n    document.body.appendChild(this.listbox);\n    if (input) {\n      input.insertAdjacentElement(\"beforebegin\", createAriaLiveElement(this.listbox.dataSeed));\n      suppressExtensionsAutocomplete(input);\n      __privateSet(this, _initialAutocompleteValue2, input.autocomplete);\n    }\n  }\n  get input() {\n    return __privateGet(this, _input4);\n  }\n  remove() {\n    this.listbox.remove();\n    this.listbox.removeEventListener(\"input\", __privateGet(this, _onHandleInput4));\n    this.listbox.removeEventListener(\"select\", __privateGet(this, _onHandleSelect4));\n    this.listbox.removeEventListener(\"blur\", __privateGet(this, _onHandleBlur4));\n    this.listbox.removeEventListener(\"focus\", __privateGet(this, _onHandleFocus2));\n    __privateGet(this, _session4).removeEventListener(\"suggest\", __privateGet(this, _handleSuggest4));\n    __privateGet(this, _session4).removeEventListener(\"suggesterror\", __privateGet(this, _handleSuggestError4));\n    __privateGet(this, _session4).removeEventListener(\"retrieve\", __privateGet(this, _handleRetrieve4));\n  }\n  simulateRetrieve(feature) {\n    const input = __privateGet(this, _input4);\n    if (input) {\n      input.dataset[\"mapboxSuccess\"] = \"true\";\n    }\n    this.listbox.hideResults();\n    const simResult = {\n      type: \"FeatureCollection\",\n      features: [feature],\n      url: \"\"\n    };\n    __privateGet(this, _handleRetrieve4).call(this, simResult);\n  }\n};\n_input4 = new WeakMap();\n_collection = new WeakMap();\n_session4 = new WeakMap();\n_initialAutocompleteValue2 = new WeakMap();\n_onHandleInput4 = new WeakMap();\n_onHandleSelect4 = new WeakMap();\n_onHandleBlur4 = new WeakMap();\n_onHandleFocus2 = new WeakMap();\n_handleSuggest4 = new WeakMap();\n_handleSuggestError4 = new WeakMap();\n_handleRetrieve4 = new WeakMap();\nvar _currentInputs, _autofill2, _options2, _theme, _popoverOptions2, _handleObserve2, _observer2, _handleBrowserAutofill2;\nvar AddressAutofillCollection = class extends _mapbox_search_js_core__WEBPACK_IMPORTED_MODULE_0__.Evented {\n  constructor({\n    accessToken,\n    options,\n    theme,\n    popoverOptions,\n    confirmOnBrowserAutofill,\n    browserAutofillEnabled\n  }) {\n    super();\n    this.instances = [];\n    __privateAdd(this, _currentInputs, void 0);\n    __privateAdd(this, _autofill2, new _mapbox_search_js_core__WEBPACK_IMPORTED_MODULE_0__.AddressAutofillCore());\n    __privateAdd(this, _options2, void 0);\n    __privateAdd(this, _theme, void 0);\n    __privateAdd(this, _popoverOptions2, void 0);\n    this.confirmOnBrowserAutofill = false;\n    this.browserAutofillEnabled = false;\n    __privateAdd(this, _handleObserve2, () => {\n      if (!deepEquals(findAddressInputs(), __privateGet(this, _currentInputs))) {\n        this.update();\n      }\n    });\n    __privateAdd(this, _observer2, new MutationObserver(__privateGet(this, _handleObserve2)));\n    __privateAdd(this, _handleBrowserAutofill2, (e) => __async(this, null, function* () {\n      this.instances.forEach((instance) => instance.listbox.blur());\n      for (const instance of this.instances) {\n        const input = instance.listbox.input;\n        yield tryConfirmBrowserAutofill(input, e, this.confirmOnBrowserAutofill, this.accessToken);\n      }\n    }));\n    initDetectBrowserAutofill();\n    window.addEventListener(\"browserautofill\", __privateGet(this, _handleBrowserAutofill2));\n    config.autofillSessionEnabled = true;\n    this.accessToken = accessToken || config.accessToken;\n    options && (this.options = options);\n    theme && (this.theme = theme);\n    popoverOptions && (this.popoverOptions = popoverOptions);\n    confirmOnBrowserAutofill && (this.confirmOnBrowserAutofill = confirmOnBrowserAutofill);\n    browserAutofillEnabled && (this.browserAutofillEnabled = browserAutofillEnabled);\n    this.update();\n  }\n  get accessToken() {\n    return __privateGet(this, _autofill2).accessToken;\n  }\n  set accessToken(newToken) {\n    __privateGet(this, _autofill2).accessToken = newToken;\n  }\n  get options() {\n    return __privateGet(this, _options2);\n  }\n  set options(newOptions) {\n    __privateSet(this, _options2, __spreadValues(__spreadValues({}, __privateGet(this, _options2)), newOptions));\n    this.instances.forEach((instance) => {\n      instance.options = __spreadValues(__spreadValues({}, instance.options), newOptions);\n    });\n  }\n  get theme() {\n    return __privateGet(this, _theme);\n  }\n  set theme(newTheme) {\n    __privateSet(this, _theme, newTheme);\n    this.instances.forEach((instance) => {\n      instance.listbox.theme = newTheme;\n    });\n  }\n  get popoverOptions() {\n    return __privateGet(this, _popoverOptions2);\n  }\n  set popoverOptions(newOptions) {\n    __privateSet(this, _popoverOptions2, newOptions);\n    this.instances.forEach((instance) => {\n      instance.listbox.popoverOptions = newOptions;\n    });\n  }\n  update() {\n    this.instances.forEach((instance) => {\n      instance.remove();\n    });\n    __privateSet(this, _currentInputs, findAddressInputs());\n    this.instances = [];\n    __privateGet(this, _currentInputs).forEach((input) => {\n      const autofillInstance = new AddressAutofillInstance(this, input, __privateGet(this, _autofill2));\n      autofillInstance.options = this.options;\n      autofillInstance.listbox.theme = this.theme;\n      autofillInstance.listbox.popoverOptions = this.popoverOptions;\n      this.instances.push(autofillInstance);\n    });\n  }\n  observe() {\n    __privateGet(this, _observer2).observe(document, {\n      subtree: true,\n      childList: true\n    });\n    __privateGet(this, _handleObserve2).call(this);\n  }\n  unobserve() {\n    __privateGet(this, _observer2).disconnect();\n  }\n  remove() {\n    this.instances.forEach((instance) => {\n      instance.remove();\n    });\n    this.unobserve();\n    window.removeEventListener(\"browserautofill\", __privateGet(this, _handleBrowserAutofill2));\n  }\n};\n_currentInputs = new WeakMap();\n_autofill2 = new WeakMap();\n_options2 = new WeakMap();\n_theme = new WeakMap();\n_popoverOptions2 = new WeakMap();\n_handleObserve2 = new WeakMap();\n_observer2 = new WeakMap();\n_handleBrowserAutofill2 = new WeakMap();\nfunction autofill(optionsArg) {\n  return new AddressAutofillCollection(optionsArg);\n}\n\n//# sourceMappingURL=index-esm.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQG1hcGJveC9zZWFyY2gtanMtd2ViL2Rpc3QvaW5kZXgtZXNtLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhFQUE4RSw2REFBNkQ7QUFDM0k7QUFDQSwrQkFBK0I7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSx3Q0FBd0Msd0JBQXdCO0FBQ2hFLG1FQUFtRSxJQUFJLEtBQUs7QUFDNUU7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLFlBQVksRUFBRSxxQkFBcUI7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixTQUFTLEVBQUUsOENBQThDO0FBQ3pFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxZQUFZO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ3NEOztBQUV0RDtBQUNBO0FBQ0E7QUFDQSxVQUFVLGVBQWU7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2Q0FBNkMsU0FBUyxHQUFHLFFBQVE7QUFDakU7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrRUFBa0UsY0FBYztBQUNoRixpQ0FBaUMsZ0JBQWdCO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0VBQWtFLGNBQWM7QUFDaEYsaUNBQWlDLGdCQUFnQjtBQUNqRDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EscUJBQXFCLGdFQUFZO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlEQUFpRCxJQUFJLFFBQVEsSUFBSSxRQUFRLElBQUksUUFBUSxJQUFJO0FBQ3pGO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsMEJBQTBCLElBQUksVUFBVTtBQUN4RCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtFQUFrRSxRQUFRO0FBQzFFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLG1FQUFtRSxRQUFRO0FBQzNFLGlFQUFpRSxRQUFRO0FBQ3pFO0FBQ0EsK0RBQStELGtCQUFrQjtBQUNqRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZDQUE2QztBQUM3QyxvREFBb0QsaURBQWlEO0FBQ3JHO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLElBQUksSUFBSSxPQUFPO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0VBQW9FLEtBQUssRUFBRSxTQUFTO0FBQ3BGO0FBQ0E7QUFDQSxrQkFBa0Isc0JBQXNCLEVBQUUsZ0JBQWdCLElBQUksSUFBSSxJQUFJLGFBQWEsZUFBZTtBQUNsRywwQkFBMEIsSUFBSSxJQUFJLGNBQWM7QUFDaEQ7QUFDQSxzQkFBc0IsZ0JBQWdCLEVBQUUsZ0JBQWdCO0FBQ3hEO0FBQ0EscUNBQXFDO0FBQ3JDLGdEQUFnRCx5Q0FBeUM7QUFDekY7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDO0FBQ3ZDLGlEQUFpRCwyQ0FBMkM7QUFDNUY7QUFDQTtBQUNBOztBQUVBO0FBTTBCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLHdEQUFNO0FBQ2hCLCtCQUErQixzREFBSTtBQUNuQztBQUNBO0FBQ0EsY0FBYyxPQUFPLFFBQVEsaUVBQWU7QUFDNUM7QUFDQSxpQkFBaUIsRUFBRTtBQUNuQixnQkFBZ0IsRUFBRTtBQUNsQixPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQSxpRUFBaUU7QUFDakUsbUJBQW1CLDREQUFVO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpRUFBaUU7QUFDakU7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSx1QkFBdUIsZ0NBQWdDLGNBQWMsZUFBZSxjQUFjLFVBQVUsYUFBYSxTQUFTLHdDQUF3QyxxQkFBcUIsa0NBQWtDLDRCQUE0Qix1QkFBdUIsOEJBQThCLHNCQUFzQiw4QkFBOEIsOEJBQThCLDBCQUEwQixnQkFBZ0Isa0JBQWtCLHdCQUF3QixzQ0FBc0MsbUJBQW1CLGFBQWEsaUNBQWlDLG1CQUFtQiwyQkFBMkIsK0RBQStELGtCQUFrQixZQUFZLG1CQUFtQixhQUFhLHVCQUF1QixrQkFBa0IsZUFBZSxnQ0FBZ0MsNkNBQTZDLG1CQUFtQiw4Q0FBOEMsZ0JBQWdCLGtDQUFrQyxnQkFBZ0IsaUJBQWlCLGtDQUFrQyxhQUFhLG9CQUFvQixrQ0FBa0Msc0JBQXNCLDRCQUE0QixrQ0FBa0MscUJBQXFCLGFBQWEsZ0JBQWdCLFNBQVMsVUFBVSxPQUFPLGFBQWEscUJBQXFCLHdDQUF3QyxxQkFBcUIsa0NBQWtDLDRCQUE0Qix1QkFBdUIsOEJBQThCLHNCQUFzQiw4QkFBOEIsOEJBQThCLHVCQUF1QixpQkFBaUIsY0FBYyxrQkFBa0IsV0FBVyxZQUFZLGFBQWEsVUFBVSx3QkFBd0IsU0FBUyxZQUFZLGNBQWMsa0JBQWtCLE1BQU0sV0FBVyxZQUFZLFdBQVcsbUJBQW1CLGdCQUFnQixZQUFZLGNBQWMsZUFBZSxhQUFhLFlBQVksZ0JBQWdCLFVBQVUsV0FBVyx5QkFBeUIsMEJBQTBCLFVBQVUsYUFBYSxnQkFBZ0IsY0FBYyxhQUFhLGlFQUFpRSxvRUFBb0UsNERBQTRELGFBQWEsWUFBWSwwQkFBMEIsR0FBRyw0QkFBNEIsb0JBQW9CLEdBQUcsZ0NBQWdDLHlCQUF5QixrQkFBa0IsR0FBRyw0QkFBNEIsb0JBQW9CLEdBQUcsZ0NBQWdDLHlCQUF5QixPQUFPLDZCQUE2QixTQUFTLGNBQWMsc0JBQXNCLGFBQWEsWUFBWSxTQUFTLGdCQUFnQixlQUFlLHVCQUF1QixtQkFBbUIsV0FBVyxrQkFBa0IsYUFBYSxhQUFhLG1CQUFtQixrQ0FBa0MsZ0JBQWdCLGNBQWMsc0JBQXNCLFVBQVUsK0dBQStHLGFBQWEsMkJBQTJCLG1CQUFtQixzQ0FBc0MsU0FBUyxhQUFhLHVCQUF1QixPQUFPLGVBQWUsUUFBUSxNQUFNLHdCQUF3QixhQUFhLG1EQUFtRCx1REFBdUQsbUJBQW1CLDZDQUE2QyxrQkFBa0Isa0NBQWtDLHNCQUFzQixPQUFPLHdDQUF3QyxxQkFBcUIsa0NBQWtDLDRCQUE0Qix1QkFBdUIsOEJBQThCLHNCQUFzQiw4QkFBOEIsOEJBQThCLDRCQUE0QixXQUFXLG9DQUFvQywyQkFBMkIscUJBQXFCLGtDQUFrQyxXQUFXLE9BQU8sNEJBQTRCLDhCQUE4QixhQUFhLG1CQUFtQiwwQkFBMEIsYUFBYSw0QkFBNEIsa0NBQWtDLDZCQUE2QixpQkFBaUIsV0FBVyxVQUFVLGtDQUFrQyx5Q0FBeUMseUNBQXlDLDRCQUE0QixhQUFhLE1BQU0seUJBQXlCLHdCQUF3QixnQkFBZ0IsNEJBQTRCLGtCQUFrQixPQUFPLGtCQUFrQixhQUFhLDRCQUE0QiwwQkFBMEIsa0JBQWtCLCtCQUErQixhQUFhLGdCQUFnQixrQ0FBa0MsaUJBQWlCLGtCQUFrQiwwQkFBMEIsOEJBQThCLDZCQUE2QixrQ0FBa0MsMEJBQTBCLFFBQVEsa0NBQWtDLGVBQWUsc0NBQXNDLDBCQUEwQix1QkFBdUIsa0JBQWtCLGlCQUFpQixXQUFXLDBCQUEwQixhQUFhLHNCQUFzQixxQ0FBcUMsNkJBQTZCLHdCQUF3Qix1Q0FBdUMsNEJBQTRCLGtCQUFrQixHQUFHLFVBQVUsR0FBRyxXQUFXLHNCQUFzQiw4QkFBOEIsc0JBQXNCLDhCQUE4Qiw4QkFBOEIsd0NBQXdDLGFBQWEsdUJBQXVCLGtDQUFrQyxnQkFBZ0IsY0FBYyxhQUFhLGlCQUFpQixnQkFBZ0Isa0JBQWtCLFlBQVksbUJBQW1CLHFCQUFxQixzQkFBc0IsZUFBZSxPQUFPLGdCQUFnQixrQkFBa0IsTUFBTSxjQUFjLGVBQWUsU0FBUyxrQkFBa0IsUUFBUSxtQkFBbUIsMEJBQTBCLHdCQUF3Qix3QkFBd0IsU0FBUyxPQUFPLG1CQUFtQixrQkFBa0IsMEJBQTBCLGVBQWUsY0FBYyxZQUFZLFdBQVcsd0JBQXdCLHFDQUFxQyxTQUFTLHlEQUF5RCxjQUFjLGtCQUFrQixRQUFRLDBCQUEwQixzQkFBc0IscUJBQXFCLGdDQUFnQyxjQUFjLDBCQUEwQiw0Q0FBNEMsZ0JBQWdCLG9CQUFvQixzQkFBc0IsNEJBQTRCLHdCQUF3QixzQkFBc0Isa0JBQWtCLDRCQUE0QixlQUFlLFdBQVcsa0JBQWtCLHFCQUFxQixtQkFBbUIsVUFBVSxlQUFlLDRCQUE0Qiw4QkFBOEIsc0JBQXNCLDBCQUEwQixpQ0FBaUMsYUFBYSxvQkFBb0IsWUFBWSxhQUFhLDhCQUE4QixrQkFBa0IscUJBQXFCLDRCQUE0Qiw0QkFBNEIscUJBQXFCLHdDQUF3QywyQkFBMkIsV0FBVyxZQUFZLFlBQVksa0JBQWtCLGdCQUFnQjs7QUFFbmdPO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9EQUFvRCxrQkFBa0I7QUFDdEU7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrRkFBa0YsaUJBQWlCLEVBQUUscURBQXFELGFBQWEsUUFBUSxJQUFJLGNBQWMsS0FBSyxpQkFBaUI7QUFDdk4seURBQXlELGlCQUFpQixFQUFFLHFEQUFxRDs7QUFFakk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQ0FBK0MsK0JBQStCLFlBQVksb0JBQW9CLG1CQUFtQixpQkFBaUIsYUFBYSxtQkFBbUIsb0JBQW9CLFdBQVc7QUFDak47QUFDQSxvQ0FBb0MsS0FBSyxJQUFJLG9CQUFvQjtBQUNqRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0VBQWdFLEtBQUssSUFBSSxvQkFBb0I7QUFDN0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxZQUFZLGFBQWEsR0FBRyxFQUFFO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF5QztBQUN6QywwQ0FBMEM7QUFDMUM7QUFDQSxjQUFjLFVBQVU7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsVUFBVTtBQUN4QjtBQUNBO0FBQ0E7QUFDQSxjQUFjLFVBQVU7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLGNBQWM7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtEQUFrRCxNQUFNO0FBQ3hEO0FBQ0E7QUFDQTtBQUNBLGlEQUFpRCxHQUFHO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSx1QkFBdUI7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVksOEJBQThCO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsWUFBWSxVQUFVO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsd0JBQXdCO0FBQ2xDO0FBQ0EsK0NBQStDLFdBQVc7QUFDMUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLGNBQWM7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MsNkJBQTZCO0FBQy9EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQyxxQkFBcUI7QUFDL0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUdnQztBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsd0JBQXdCO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCLDJFQUFtQjtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQ0FBK0M7QUFDL0M7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBR2dDOztBQUVoQztBQUlnQztBQUNDO0FBQ1k7O0FBRTdDO0FBQ3VFO0FBQ3ZFO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQyxnRUFBYTtBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQztBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksbUNBQW1DO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZLHdEQUF3RDtBQUNwRTtBQUNBO0FBQ0E7QUFDQSxjQUFjLG1DQUFtQztBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksd0RBQXdEO0FBQ3BFO0FBQ0E7QUFDQSxJQUFJLG9EQUFZO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxjQUFjLDBGQUEwRjtBQUN4RyxjQUFjLDhDQUE4QztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU0sbURBQVc7QUFDakI7QUFDQSxxQ0FBcUMsMkRBQWU7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFlBQVk7QUFDWjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxjQUFjLDRCQUE0QjtBQUMxQywyQkFBMkIsa0VBQWM7QUFDekM7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSw4RkFBOEYsdUVBQW1CO0FBQ2pILGdCQUFnQix1Q0FBdUM7QUFDdkQ7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGtFQUFrRTtBQUNsRTtBQUNBLFlBQVksZ0JBQWdCO0FBQzVCO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QjtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0ZBQStGO0FBQy9GO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0EsNkJBQTZCLDJFQUFvQjtBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTLHdDQUF3QyxFQUFFLG9DQUFvQztBQUN2RjtBQUNBO0FBQ0E7QUFDQSxnRUFBZ0UsSUFBSTtBQUNwRTtBQUNBLGdCQUFnQixpQkFBaUI7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnREFBZ0Q7QUFDaEQ7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsU0FBUyxHQUFHLHlCQUF5Qix3QkFBd0IsWUFBWTtBQUMxRixVQUFVLCtDQUErQztBQUN6RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0MsUUFBUSxHQUFHLG9CQUFvQjtBQUN2RTtBQUNBLEtBQUs7QUFDTDtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQztBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMseUNBQXlDO0FBQ3ZEO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLHdEQUF3RDtBQUMxRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLDBCQUEwQjtBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLHNDQUFzQztBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSwyQkFBMkI7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQ0FBMEM7QUFDMUM7QUFDQSxjQUFjLGVBQWU7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksMEJBQTBCO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZLGlFQUFpRTtBQUM3RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyxzQ0FBc0M7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksMEJBQTBCO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFJZ0M7O0FBRWhDO0FBQ2tEOztBQUVsRDtBQUNBLGdIQUFnSCxzQ0FBc0MsMkZBQTJGLHVDQUF1QyxrQ0FBa0MsR0FBRyx3Q0FBd0MsR0FBRyx5Q0FBeUMsbUNBQW1DLEdBQUcseUNBQXlDLEdBQUcsMENBQTBDOztBQUU3Z0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2QsR0FBRztBQUNIO0FBQ0E7QUFDQSx3QkFBd0IsZ0VBQVE7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQ0FBc0MsdUVBQW1CO0FBQ3pELHFDQUFxQyxpRUFBYTtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQU1nQztBQUNKOztBQUU1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2Qjs7QUFFN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQyxpRUFBYSxHQUFHO0FBQ3BELHNDQUFzQyxpRUFBYztBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsMkVBQW9CO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQyxnRUFBWTtBQUNoRCxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDREQUE0RDtBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9EQUFvRDtBQUNwRDtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksYUFBYTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLGtDQUFrQztBQUNsQyxZQUFZLGtCQUFrQjtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIsc0RBQWU7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUtnQztBQUNIO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDLGlFQUFhLEdBQUc7QUFDckQsc0NBQXNDLGlFQUFjO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0MsZ0VBQWE7QUFDakQsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0REFBNEQ7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLHVDQUF1QztBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvREFBb0Q7QUFDcEQ7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLGFBQWE7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxrQ0FBa0M7QUFDbEMsWUFBWSxrQkFBa0I7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCLHNEQUFnQjtBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ2dEOztBQUVoRDtBQUMwRDtBQUMxRCxlQUFlLGtFQUFpQixHQUFHLCtCQUErQjtBQUNsRTtBQUNBO0FBQ0EsVUFBVSxnQkFBZ0I7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCO0FBQy9CO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakM7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLGNBQWMsK0RBQStEO0FBQzdFO0FBQ0E7QUFDQSxvRUFBb0UsV0FBVyxtQkFBbUIsV0FBVztBQUM3RyxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLDJCQUEyQjtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUVBQXlFO0FBQ3pFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNERBQTRELGdCQUFnQjtBQUM1RSw2RUFBNkUsVUFBVTtBQUN2RixpRUFBaUUsWUFBWTtBQUM3RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQztBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLHlEQUF5RDtBQUN2RTtBQUNBLHdDQUF3QyxrQkFBa0I7QUFDMUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1IsMkNBQTJDLGtCQUFrQjtBQUM3RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QjtBQUN4QjtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QiwwREFBTTtBQUNuQztBQUNBLDBCQUEwQixTQUFTO0FBQ25DO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsUUFBUTtBQUN4QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EscUJBQXFCLDhGQUE4RjtBQUNuSCxLQUFLO0FBQ0w7QUFDQSxjQUFjLHFFQUFxRTtBQUNuRixjQUFjLGdCQUFnQjtBQUM5QjtBQUNBO0FBQ0E7QUFDQSwwREFBMEQsMkJBQTJCO0FBQ3JGLDJEQUEyRCw0QkFBNEI7QUFDdkYsb0RBQW9ELDRCQUE0QjtBQUNoRixtREFBbUQsMkJBQTJCO0FBQzlFO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1FQUFtRTtBQUNuRTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxjQUFjLHlDQUF5QztBQUN2RDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsY0FBYyxzREFBc0Q7QUFDcEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdURBQXVELDBEQUEwRDtBQUNqSCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsY0FBYyxpQkFBaUI7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLHlCQUF5QjtBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksaUJBQWlCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0RBQXNELHdEQUF3RDtBQUM5RztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxxREFBcUQ7QUFDakU7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLDhDQUE4QztBQUMxRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0Esa0NBQWtDO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSw2RUFBNkU7QUFDekY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQSxNQUFNO0FBQ047QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBS2dDO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQ0FBK0Msb0NBQW9DO0FBQ25GO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLCtDQUErQyxvQ0FBb0M7QUFDbkY7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsK0NBQStDLG9DQUFvQztBQUNuRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0Esc0NBQXNDLGlFQUFjO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QywyREFBTztBQUNyRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSx1Q0FBdUMsdUVBQW9CO0FBQzNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrRUFBa0U7QUFDbEU7QUFDQSx5REFBeUQ7QUFDekQsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFhRTtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcm91dGUtcGxhbm5lci8uL25vZGVfbW9kdWxlcy9AbWFwYm94L3NlYXJjaC1qcy13ZWIvZGlzdC9pbmRleC1lc20uanM/ZmEwNyJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgX19kZWZQcm9wID0gT2JqZWN0LmRlZmluZVByb3BlcnR5O1xudmFyIF9fZGVmUHJvcHMgPSBPYmplY3QuZGVmaW5lUHJvcGVydGllcztcbnZhciBfX2dldE93blByb3BEZXNjcyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzO1xudmFyIF9fZ2V0T3duUHJvcFN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzO1xudmFyIF9faGFzT3duUHJvcCA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7XG52YXIgX19wcm9wSXNFbnVtID0gT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZTtcbnZhciBfX2RlZk5vcm1hbFByb3AgPSAob2JqLCBrZXksIHZhbHVlKSA9PiBrZXkgaW4gb2JqID8gX19kZWZQcm9wKG9iaiwga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSwgd3JpdGFibGU6IHRydWUsIHZhbHVlIH0pIDogb2JqW2tleV0gPSB2YWx1ZTtcbnZhciBfX3NwcmVhZFZhbHVlcyA9IChhLCBiKSA9PiB7XG4gIGZvciAodmFyIHByb3AgaW4gYiB8fCAoYiA9IHt9KSlcbiAgICBpZiAoX19oYXNPd25Qcm9wLmNhbGwoYiwgcHJvcCkpXG4gICAgICBfX2RlZk5vcm1hbFByb3AoYSwgcHJvcCwgYltwcm9wXSk7XG4gIGlmIChfX2dldE93blByb3BTeW1ib2xzKVxuICAgIGZvciAodmFyIHByb3Agb2YgX19nZXRPd25Qcm9wU3ltYm9scyhiKSkge1xuICAgICAgaWYgKF9fcHJvcElzRW51bS5jYWxsKGIsIHByb3ApKVxuICAgICAgICBfX2RlZk5vcm1hbFByb3AoYSwgcHJvcCwgYltwcm9wXSk7XG4gICAgfVxuICByZXR1cm4gYTtcbn07XG52YXIgX19zcHJlYWRQcm9wcyA9IChhLCBiKSA9PiBfX2RlZlByb3BzKGEsIF9fZ2V0T3duUHJvcERlc2NzKGIpKTtcbnZhciBfX2FjY2Vzc0NoZWNrID0gKG9iaiwgbWVtYmVyLCBtc2cpID0+IHtcbiAgaWYgKCFtZW1iZXIuaGFzKG9iaikpXG4gICAgdGhyb3cgVHlwZUVycm9yKFwiQ2Fubm90IFwiICsgbXNnKTtcbn07XG52YXIgX19wcml2YXRlR2V0ID0gKG9iaiwgbWVtYmVyLCBnZXR0ZXIpID0+IHtcbiAgX19hY2Nlc3NDaGVjayhvYmosIG1lbWJlciwgXCJyZWFkIGZyb20gcHJpdmF0ZSBmaWVsZFwiKTtcbiAgcmV0dXJuIGdldHRlciA/IGdldHRlci5jYWxsKG9iaikgOiBtZW1iZXIuZ2V0KG9iaik7XG59O1xudmFyIF9fcHJpdmF0ZUFkZCA9IChvYmosIG1lbWJlciwgdmFsdWUpID0+IHtcbiAgaWYgKG1lbWJlci5oYXMob2JqKSlcbiAgICB0aHJvdyBUeXBlRXJyb3IoXCJDYW5ub3QgYWRkIHRoZSBzYW1lIHByaXZhdGUgbWVtYmVyIG1vcmUgdGhhbiBvbmNlXCIpO1xuICBtZW1iZXIgaW5zdGFuY2VvZiBXZWFrU2V0ID8gbWVtYmVyLmFkZChvYmopIDogbWVtYmVyLnNldChvYmosIHZhbHVlKTtcbn07XG52YXIgX19wcml2YXRlU2V0ID0gKG9iaiwgbWVtYmVyLCB2YWx1ZSwgc2V0dGVyKSA9PiB7XG4gIF9fYWNjZXNzQ2hlY2sob2JqLCBtZW1iZXIsIFwid3JpdGUgdG8gcHJpdmF0ZSBmaWVsZFwiKTtcbiAgc2V0dGVyID8gc2V0dGVyLmNhbGwob2JqLCB2YWx1ZSkgOiBtZW1iZXIuc2V0KG9iaiwgdmFsdWUpO1xuICByZXR1cm4gdmFsdWU7XG59O1xudmFyIF9fcHJpdmF0ZU1ldGhvZCA9IChvYmosIG1lbWJlciwgbWV0aG9kKSA9PiB7XG4gIF9fYWNjZXNzQ2hlY2sob2JqLCBtZW1iZXIsIFwiYWNjZXNzIHByaXZhdGUgbWV0aG9kXCIpO1xuICByZXR1cm4gbWV0aG9kO1xufTtcbnZhciBfX2FzeW5jID0gKF9fdGhpcywgX19hcmd1bWVudHMsIGdlbmVyYXRvcikgPT4ge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgIHZhciBmdWxmaWxsZWQgPSAodmFsdWUpID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgfVxuICAgIH07XG4gICAgdmFyIHJlamVjdGVkID0gKHZhbHVlKSA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICBzdGVwKGdlbmVyYXRvci50aHJvdyh2YWx1ZSkpO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICByZWplY3QoZSk7XG4gICAgICB9XG4gICAgfTtcbiAgICB2YXIgc3RlcCA9ICh4KSA9PiB4LmRvbmUgPyByZXNvbHZlKHgudmFsdWUpIDogUHJvbWlzZS5yZXNvbHZlKHgudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7XG4gICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KF9fdGhpcywgX19hcmd1bWVudHMpKS5uZXh0KCkpO1xuICB9KTtcbn07XG5cbi8vIHNyYy91dGlscy9kb20udHNcbnZhciBzdWJkb2MgPSBkb2N1bWVudC5pbXBsZW1lbnRhdGlvbi5jcmVhdGVIVE1MRG9jdW1lbnQoKTtcbmZ1bmN0aW9uIGJpbmRFbGVtZW50cyhyb290LCBlbGVtZW50cykge1xuICBjb25zdCBiaW5kaW5nID0ge307XG4gIGZvciAoY29uc3QgW2tleSwgc2VsZWN0b3JdIG9mIE9iamVjdC5lbnRyaWVzKGVsZW1lbnRzKSkge1xuICAgIGJpbmRpbmdba2V5XSA9IHJvb3QucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XG4gIH1cbiAgcmV0dXJuIGJpbmRpbmc7XG59XG5mdW5jdGlvbiBnZXRDaGlsZEVsZW1lbnRzKG5vZGUpIHtcbiAgcmV0dXJuIEFycmF5LmZyb20obm9kZS5jaGlsZE5vZGVzIHx8IFtdKS5maWx0ZXIoKGVsKSA9PiBlbC5ub2RlVHlwZSA9PT0gTm9kZS5FTEVNRU5UX05PREUpO1xufVxuZnVuY3Rpb24gY3JlYXRlRWxlbWVudEZyb21TdHJpbmcoaW5uZXJIVE1MKSB7XG4gIGNvbnN0IHRlbXBsYXRlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRlbXBsYXRlXCIpO1xuICB0ZW1wbGF0ZS5pbm5lckhUTUwgPSBpbm5lckhUTUw7XG4gIHJldHVybiB0ZW1wbGF0ZS5jb250ZW50LmZpcnN0RWxlbWVudENoaWxkO1xufVxuZnVuY3Rpb24gY3JlYXRlQ1NTU3R5bGVTaGVldCh0ZXh0KSB7XG4gIGNvbnN0IHN0eWxlID0gc3ViZG9jLmNyZWF0ZUVsZW1lbnQoXCJzdHlsZVwiKTtcbiAgc3R5bGUudGV4dENvbnRlbnQgPSB0ZXh0O1xuICBzdWJkb2MuaGVhZC5hcHBlbmRDaGlsZChzdHlsZSk7XG4gIHJldHVybiBzdHlsZS5zaGVldDtcbn1cbmZ1bmN0aW9uIGlzVmlzaWJsZShlbGVtZW50KSB7XG4gIGNvbnN0IHN0eWxlID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUoZWxlbWVudCk7XG4gIHJldHVybiBzdHlsZS5kaXNwbGF5ICE9PSBcIm5vbmVcIjtcbn1cbmZ1bmN0aW9uIHNldFZhbHVlKGlucHV0LCB2YWx1ZSkge1xuICBpZiAoIWlucHV0KSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGNvbnN0IHNldCA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoaW5wdXQuY29uc3RydWN0b3IucHJvdG90eXBlLCBcInZhbHVlXCIpLnNldDtcbiAgc2V0LmNhbGwoaW5wdXQsIHZhbHVlKTtcbiAgY29uc3Qgd3JhcHBlclN0YXRlID0gaW5wdXQ7XG4gIGlmICh3cmFwcGVyU3RhdGUuX3ZhbHVlVHJhY2tlcikge1xuICAgIHdyYXBwZXJTdGF0ZS5fdmFsdWVUcmFja2VyLnNldFZhbHVlKFwiXCIpO1xuICB9XG4gIGNvbnN0IG9uSW5wdXRFdmVudCA9IG5ldyBFdmVudChcImlucHV0XCIsIHtcbiAgICBidWJibGVzOiB0cnVlXG4gIH0pO1xuICBvbklucHV0RXZlbnQuc2ltdWxhdGVkID0gdHJ1ZTtcbiAgaW5wdXQuZGlzcGF0Y2hFdmVudChvbklucHV0RXZlbnQpO1xuICBjb25zdCBvbkNoYW5nZUV2ZW50ID0gbmV3IEV2ZW50KFwiY2hhbmdlXCIsIHtcbiAgICBidWJibGVzOiB0cnVlXG4gIH0pO1xuICBvbkNoYW5nZUV2ZW50LnNpbXVsYXRlZCA9IHRydWU7XG4gIGlucHV0LmRpc3BhdGNoRXZlbnQob25DaGFuZ2VFdmVudCk7XG59XG5mdW5jdGlvbiBnZXRFbGVtZW50U2l6ZShlbGVtZW50LCBkZWVwID0gZmFsc2UpIHtcbiAgbGV0IHdpZHRoO1xuICBsZXQgaGVpZ2h0O1xuICBjb25zdCBlbGVtZW50UmVjdCA9IGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gIGlmIChlbGVtZW50LnN0eWxlLmRpc3BsYXkgPT09IFwibm9uZVwiIHx8IGVsZW1lbnRSZWN0LmhlaWdodCA9PT0gMCAmJiBlbGVtZW50UmVjdC53aWR0aCA9PT0gMCkge1xuICAgIGNvbnN0IGNsb25lID0gZWxlbWVudC5jbG9uZU5vZGUoZGVlcCk7XG4gICAgZWxlbWVudC5wYXJlbnRFbGVtZW50LmFwcGVuZENoaWxkKGNsb25lKTtcbiAgICBjbG9uZS5zdHlsZS5zZXRQcm9wZXJ0eShcImRpc3BsYXlcIiwgXCJibG9ja1wiLCBcImltcG9ydGFudFwiKTtcbiAgICBjb25zdCBjbG9uZVJlY3QgPSBjbG9uZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICB3aWR0aCA9IGNsb25lUmVjdC53aWR0aDtcbiAgICBoZWlnaHQgPSBjbG9uZVJlY3QuaGVpZ2h0O1xuICAgIGNsb25lLnN0eWxlLnNldFByb3BlcnR5KFwiZGlzcGxheVwiLCBcIm5vbmVcIik7XG4gICAgY2xvbmUucmVtb3ZlKCk7XG4gIH0gZWxzZSB7XG4gICAgd2lkdGggPSBlbGVtZW50UmVjdC53aWR0aDtcbiAgICBoZWlnaHQgPSBlbGVtZW50UmVjdC5oZWlnaHQ7XG4gIH1cbiAgcmV0dXJuIHtcbiAgICBoZWlnaHQ6IE1hdGguZmxvb3IoaGVpZ2h0KSxcbiAgICB3aWR0aDogTWF0aC5mbG9vcih3aWR0aClcbiAgfTtcbn1cbmZ1bmN0aW9uIGFkZERvY3VtZW50U3R5bGUoY3NzKSB7XG4gIGNvbnN0IHN0eWxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInN0eWxlXCIpO1xuICBzdHlsZS5pbm5lckhUTUwgPSBjc3M7XG4gIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoc3R5bGUpO1xufVxuXG4vLyBzcmMvdXRpbHMvY2xhc3NfbmFtZV90cmFuc2Zvcm1lcnMudHNcbnZhciBJREVOVElGSUVSX1JFR0VYID0gbmV3IFJlZ0V4cChcIltfYS16QS1aXStbX2EtekEtWjAtOS1dKlwiLCBcImdcIik7XG52YXIgQ0xBU1NfTkFNRV9SRUdFWCA9IG5ldyBSZWdFeHAoYFxcXFwuJHtJREVOVElGSUVSX1JFR0VYLnNvdXJjZX1gLCBcImdcIik7XG52YXIgQ09ORElUSU9OX1JVTEVfUkVHRVggPSBuZXcgUmVnRXhwKGBeXFxcXHMqKEAoPzptZWRpYXxzdXBwb3J0cylbXntdKil7KC4qKX1cXFxccyokYCk7XG5mdW5jdGlvbiB0cmFuc2Zvcm1DbGFzc1NlbGVjdG9ycyhjc3MsIHRyYW5zZm9ybSkge1xuICByZXR1cm4gY3NzLnJlcGxhY2UoQ0xBU1NfTkFNRV9SRUdFWCwgKGNsYXNzTmFtZSkgPT4ge1xuICAgIHJldHVybiBcIi5cIiArIHRyYW5zZm9ybShjbGFzc05hbWUuc2xpY2UoMSkpO1xuICB9KTtcbn1cbmZ1bmN0aW9uIHRyYW5zZm9ybUNTU0NsYXNzUnVsZXModGV4dCwgdHJhbnNmb3JtKSB7XG4gIGNvbnN0IHNoZWV0ID0gY3JlYXRlQ1NTU3R5bGVTaGVldCh0ZXh0KTtcbiAgY29uc3QgcnVsZXMgPSBzaGVldC5jc3NSdWxlcztcbiAgZnVuY3Rpb24gdHJhbnNmb3JtQ1NTUnVsZShydWxlKSB7XG4gICAgaWYgKHJ1bGUgaW5zdGFuY2VvZiBDU1NTdHlsZVJ1bGUpIHtcbiAgICAgIGNvbnN0IHNlbGVjdG9yID0gdHJhbnNmb3JtQ2xhc3NTZWxlY3RvcnMocnVsZS5zZWxlY3RvclRleHQsIHRyYW5zZm9ybSk7XG4gICAgICByZXR1cm4gYCR7c2VsZWN0b3J9IHsgJHtydWxlLnN0eWxlLmNzc1RleHR9IH1gO1xuICAgIH1cbiAgICBjb25zdCBhdFJ1bGUgPSBDT05ESVRJT05fUlVMRV9SRUdFWC5leGVjKHJ1bGUuY3NzVGV4dC5zcGxpdChcIlxcblwiKS5qb2luKFwiXCIpKTtcbiAgICBpZiAoYXRSdWxlICYmIGF0UnVsZS5sZW5ndGggPiAyKSB7XG4gICAgICBjb25zdCBydWxlMiA9IGF0UnVsZVsxXTtcbiAgICAgIGNvbnN0IGNvbnRlbnRzID0gYXRSdWxlWzJdO1xuICAgICAgcmV0dXJuIGAke3J1bGUyfSB7ICR7dHJhbnNmb3JtQ1NTQ2xhc3NSdWxlcyhjb250ZW50cywgdHJhbnNmb3JtKX0gfWA7XG4gICAgfVxuICAgIHJldHVybiBydWxlLmNzc1RleHQ7XG4gIH1cbiAgbGV0IHN0eWxlID0gXCJcIjtcbiAgZm9yIChjb25zdCBydWxlIG9mIEFycmF5LmZyb20ocnVsZXMpKSB7XG4gICAgc3R5bGUgKz0gdHJhbnNmb3JtQ1NTUnVsZShydWxlKSArIFwiXFxuXFxuXCI7XG4gIH1cbiAgcmV0dXJuIHN0eWxlLnRyaW0oKTtcbn1cbmZ1bmN0aW9uIHRyYW5zZm9ybURPTUNsYXNzQXR0cmlidXRlcyhjb250ZW50LCB0cmFuc2Zvcm0pIHtcbiAgY29uc3QgZWxlbWVudHMgPSBBcnJheS5mcm9tKGNvbnRlbnQucXVlcnlTZWxlY3RvckFsbChcIltjbGFzc11cIikpO1xuICBlbGVtZW50cy5wdXNoKGNvbnRlbnQpO1xuICBmb3IgKGNvbnN0IGVsZW1lbnQgb2YgZWxlbWVudHMpIHtcbiAgICBjb25zdCB7IGNsYXNzTGlzdCB9ID0gZWxlbWVudDtcbiAgICBmb3IgKGNvbnN0IGNsYXNzTmFtZSBvZiBBcnJheS5mcm9tKGNsYXNzTGlzdCkpIHtcbiAgICAgIGNsYXNzTGlzdC5yZW1vdmUoY2xhc3NOYW1lKTtcbiAgICAgIGNsYXNzTGlzdC5hZGQodHJhbnNmb3JtKGNsYXNzTmFtZSkpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gY29udGVudDtcbn1cblxuLy8gc3JjL3V0aWxzL2luZGV4LnRzXG5pbXBvcnQgeyBTZXNzaW9uVG9rZW4gfSBmcm9tIFwiQG1hcGJveC9zZWFyY2gtanMtY29yZVwiO1xuXG4vLyBzcmMvdXRpbHMvbWFwLnRzXG52YXIgRkxZX1RPX1NQRUVEID0gMS40O1xuZnVuY3Rpb24gYmJveFZpZXdwb3J0KG1hcCwgYm91bmRzLCBkZWx0YSA9IDAuNSkge1xuICBjb25zdCB7IGNlbnRlciwgem9vbSB9ID0gbWFwLmNhbWVyYUZvckJvdW5kcyhib3VuZHMpO1xuICBjb25zdCB0cmFuc2Zvcm1lZFpvb20gPSBNYXRoLm1heCh6b29tIC0gZGVsdGEsIDApO1xuICByZXR1cm4ge1xuICAgIGNlbnRlcixcbiAgICB6b29tOiB0cmFuc2Zvcm1lZFpvb20sXG4gICAgc3BlZWQ6IEZMWV9UT19TUEVFRFxuICB9O1xufVxuZnVuY3Rpb24gZ2V0TWF4Wm9vbShwbGFjZVR5cGUpIHtcbiAgc3dpdGNoIChwbGFjZVR5cGUpIHtcbiAgICBjYXNlIFwic3RyZWV0XCI6XG4gICAgICByZXR1cm4gMTU7XG4gICAgY2FzZSBcIm5laWdoYm9yaG9vZFwiOlxuICAgIGNhc2UgXCJwb3N0Y29kZVwiOlxuICAgIGNhc2UgXCJsb2NhbGl0eVwiOlxuICAgIGNhc2UgXCJvYXphXCI6XG4gICAgICByZXR1cm4gMTQ7XG4gICAgY2FzZSBcInBsYWNlXCI6XG4gICAgY2FzZSBcImNpdHlcIjpcbiAgICAgIHJldHVybiAxMztcbiAgICBjYXNlIFwiZGlzdHJpY3RcIjpcbiAgICAgIHJldHVybiA5O1xuICAgIGNhc2UgXCJyZWdpb25cIjpcbiAgICBjYXNlIFwicHJlZmVjdHVyZVwiOlxuICAgICAgcmV0dXJuIDY7XG4gICAgY2FzZSBcImNvdW50cnlcIjpcbiAgICAgIHJldHVybiA0O1xuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gMTY7XG4gIH1cbn1cbmZ1bmN0aW9uIGdldFN0YXRpY0Jhc2VVcmwodXNlcm5hbWUsIHN0eWxlSWQpIHtcbiAgcmV0dXJuIGBodHRwczovL2FwaS5tYXBib3guY29tL3N0eWxlcy92MS8ke3VzZXJuYW1lfS8ke3N0eWxlSWR9L3N0YXRpYy9gO1xufVxuXG4vLyBzcmMvaWNvbnMvY2xvc2Uuc3ZnXG52YXIgY2xvc2VfZGVmYXVsdCA9ICc8c3ZnIHZpZXdCb3g9XCIwIDAgMTggMThcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCI+PHBhdGggZmlsbC1ydWxlPVwiZXZlbm9kZFwiIGNsaXAtcnVsZT1cImV2ZW5vZGRcIiBkPVwiTTMuOCAzLjhhMSAxIDAgMCAxIDEuNCAwTDkgNy41OGwzLjgtMy44YTEgMSAwIDEgMSAxLjQgMS40MkwxMC40MiA5bDMuOCAzLjhhMSAxIDAgMCAxLTEuNDIgMS40TDkgMTAuNDJsLTMuOCAzLjhhMSAxIDAgMCAxLTEuNC0xLjQyTDcuNTggOWwtMy44LTMuOGExIDEgMCAwIDEgMC0xLjRaXCIgZmlsbD1cImN1cnJlbnRDb2xvclwiLz48L3N2Zz4nO1xuXG4vLyBzcmMvaWNvbnMvbG9hZGluZy5zdmdcbnZhciBsb2FkaW5nX2RlZmF1bHQgPSAnPHN2ZyB2aWV3Qm94PVwiMCAwIDE4IDE4XCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiPjxwYXRoIGZpbGw9XCIjMzMzXCIgZD1cIk00LjQgNC40bC44LjhjMi4xLTIuMSA1LjUtMi4xIDcuNiAwbC44LS44Yy0yLjUtMi41LTYuNy0yLjUtOS4yIDB6XCIvPjxwYXRoIG9wYWNpdHk9XCIuMVwiIGQ9XCJNMTIuOCAxMi45Yy0yLjEgMi4xLTUuNSAyLjEtNy42IDAtMi4xLTIuMS0yLjEtNS41IDAtNy43bC0uOC0uOGMtMi41IDIuNS0yLjUgNi43IDAgOS4yczYuNiAyLjUgOS4yIDAgMi41LTYuNiAwLTkuMmwtLjguOGMyLjIgMi4xIDIuMiA1LjYgMCA3Ljd6XCIvPjwvc3ZnPic7XG5cbi8vIHNyYy9jb25zdGFudHMudHNcbnZhciBTVEFUSUNfQkFTRV9VUkxfU0FURUxMSVRFID0gZ2V0U3RhdGljQmFzZVVybChcIm1hcGJveFwiLCBcInNhdGVsbGl0ZS1zdHJlZXRzLXYxMVwiKTtcbnZhciBBVVRPRklMTF9TS1VfVE9LRU5fUFJFRklYID0gXCIyMGQwMVwiO1xudmFyIE1BUEJPWF9ET01BSU5TID0gW1wibWFwYm94LmNvbVwiLCBcIm1hcGJveC5jblwiLCBcInRpbGVzdHJlYW0ubmV0XCJdO1xudmFyIExJU1RCT1hfVEVNUExBVEUgPSBjcmVhdGVFbGVtZW50RnJvbVN0cmluZyhgXG48dGVtcGxhdGU+XG4gIDxkaXYgY2xhc3M9XCJNYXBib3hTZWFyY2hcIj5cbiAgICA8ZGl2IGNsYXNzPVwiTGFiZWxcIiByb2xlPVwibGFiZWxcIiBhcmlhLWxpdmU9XCJwb2xpdGVcIiBhcmlhLWF0b21pYz1cInRydWVcIj5cbiAgICA8L2Rpdj5cbiAgICA8ZGl2IGNsYXNzPVwiUmVzdWx0c1wiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPlxuICAgICAgPGRpdiBjbGFzcz1cIlJlc3VsdHNMaXN0XCIgcm9sZT1cImxpc3Rib3hcIj5cbiAgICAgIDwvZGl2PlxuICAgICAgPGRpdiBjbGFzcz1cIlJlc3VsdHNBdHRyaWJ1dGlvblwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPlxuICAgICAgICA8YSBocmVmPVwiaHR0cHM6Ly93d3cubWFwYm94LmNvbS9zZWFyY2gtc2VydmljZVwiIHRhcmdldD1cIl9ibGFua1wiIHRhYmluZGV4PVwiLTFcIj5cbiAgICAgICAgICBQb3dlcmVkIGJ5IE1hcGJveFxuICAgICAgICA8L2E+XG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cbiAgPC9kaXY+XG48L3RlbXBsYXRlPlxuYCk7XG52YXIgTElTVEJPWF9TVUdHRVNUSU9OX1RFTVBMQVRFID0gY3JlYXRlRWxlbWVudEZyb21TdHJpbmcoYFxuPHRlbXBsYXRlPlxuICA8ZGl2IGNsYXNzPVwiU3VnZ2VzdGlvblwiIHJvbGU9XCJvcHRpb25cIiB0YWJpbmRleD1cIi0xXCI+XG4gICAgPGRpdiBjbGFzcz1cIlN1Z2dlc3Rpb25JY29uXCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+PC9kaXY+XG4gICAgPGRpdiBjbGFzcz1cIlN1Z2dlc3Rpb25UZXh0XCI+XG4gICAgICA8ZGl2IGNsYXNzPVwiU3VnZ2VzdGlvbk5hbWVcIj48L2Rpdj5cbiAgICAgIDxkaXYgY2xhc3M9XCJTdWdnZXN0aW9uRGVzY1wiPjwvZGl2PlxuICAgIDwvZGl2PlxuICA8L2Rpdj5cbjwvdGVtcGxhdGU+XG5gKTtcbnZhciBTRUFSQ0hCT1hfVEVNUExBVEUgPSBjcmVhdGVFbGVtZW50RnJvbVN0cmluZyhgXG48dGVtcGxhdGU+XG4gIDxkaXYgY2xhc3M9XCJTZWFyY2hCb3hcIj5cbiAgICA8ZGl2IGNsYXNzPVwiU2VhcmNoSWNvblwiPjwvZGl2PlxuICAgIDxpbnB1dCBjbGFzcz1cIklucHV0XCIgdHlwZT1cInRleHRcIiAvPlxuICAgIDxkaXYgY2xhc3M9XCJBY3Rpb25JY29uXCI+XG4gICAgICA8YnV0dG9uIGFyaWEtbGFiZWw9XCJDbGVhclwiIGNsYXNzPVwiQ2xlYXJCdG5cIiB0eXBlPVwiYnV0dG9uXCI+JHtjbG9zZV9kZWZhdWx0fTwvYnV0dG9uPlxuICAgICAgPGRpdiBjbGFzcz1cIkxvYWRpbmdJY29uXCI+JHtsb2FkaW5nX2RlZmF1bHR9PC9kaXY+XG4gICAgPC9kaXY+XG4gIDwvZGl2PlxuPC90ZW1wbGF0ZT5cbmApO1xudmFyIEdFT0NPREVSX1RFTVBMQVRFID0gY3JlYXRlRWxlbWVudEZyb21TdHJpbmcoYFxuPHRlbXBsYXRlPlxuICA8ZGl2IGNsYXNzPVwiR2VvY29kZXJcIj5cbiAgICA8ZGl2IGNsYXNzPVwiU2VhcmNoSWNvblwiPjwvZGl2PlxuICAgIDxpbnB1dCBjbGFzcz1cIklucHV0XCIgdHlwZT1cInRleHRcIiAvPlxuICAgIDxkaXYgY2xhc3M9XCJBY3Rpb25JY29uXCI+XG4gICAgICA8YnV0dG9uIGFyaWEtbGFiZWw9XCJDbGVhclwiIGNsYXNzPVwiQ2xlYXJCdG5cIiB0eXBlPVwiYnV0dG9uXCI+JHtjbG9zZV9kZWZhdWx0fTwvYnV0dG9uPlxuICAgICAgPGRpdiBjbGFzcz1cIkxvYWRpbmdJY29uXCI+JHtsb2FkaW5nX2RlZmF1bHR9PC9kaXY+XG4gICAgPC9kaXY+XG4gIDwvZGl2PlxuPC90ZW1wbGF0ZT5cbmApO1xuXG4vLyBzcmMvdXRpbHMvaW5kZXgudHNcbmZ1bmN0aW9uIHJhbmRvbVZhbGlkSUQoKSB7XG4gIHJldHVybiBgbWJ4YCArIG5ldyBTZXNzaW9uVG9rZW4oKS5pZC5zbGljZSgwLCA4KTtcbn1cbmZ1bmN0aW9uIHRyeVBhcnNlSlNPTihqc29uKSB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIEpTT04ucGFyc2UoanNvbik7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuZnVuY3Rpb24gZGVlcEVxdWFscyhhLCBiKSB7XG4gIGlmIChhID09IG51bGwgfHwgYiA9PSBudWxsKSB7XG4gICAgcmV0dXJuIGEgPT09IGI7XG4gIH1cbiAgaWYgKHR5cGVvZiBhICE9PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBiICE9PSBcIm9iamVjdFwiKSB7XG4gICAgcmV0dXJuIGEgPT09IGI7XG4gIH1cbiAgY29uc3QgYUtleXMgPSBPYmplY3Qua2V5cyhhKTtcbiAgY29uc3QgYktleXMgPSBPYmplY3Qua2V5cyhiKTtcbiAgaWYgKGFLZXlzLmxlbmd0aCAhPT0gYktleXMubGVuZ3RoKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIGZvciAoY29uc3Qga2V5IG9mIGFLZXlzKSB7XG4gICAgaWYgKCFkZWVwRXF1YWxzKGFba2V5XSwgYltrZXldKSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gdHJ1ZTtcbn1cbmZ1bmN0aW9uIHJvdW5kKG51bSwgZGVjaW1hbFBsYWNlcykge1xuICBjb25zdCBmYWN0b3JPZlRlbiA9IE1hdGgucG93KDEwLCBkZWNpbWFsUGxhY2VzKTtcbiAgcmV0dXJuIE1hdGgucm91bmQobnVtICogZmFjdG9yT2ZUZW4pIC8gZmFjdG9yT2ZUZW47XG59XG5mdW5jdGlvbiBpc0xvY2FsU2VydmVyKGhvc3RuYW1lKSB7XG4gIHJldHVybiBCb29sZWFuKGhvc3RuYW1lLm1hdGNoKC9sb2NhbGhvc3R8WzAtOV17MSwzfVxcLlswLTldezEsM31cXC5bMC05XXsxLDN9XFwuWzAtOV17MSwzfXw6OjF8XFwubG9jYWx8XiQvZ2kpKTtcbn1cbmZ1bmN0aW9uIGlzTWFwYm94RG9tYWluKGhvc3RuYW1lKSB7XG4gIHJldHVybiBCb29sZWFuKE1BUEJPWF9ET01BSU5TLnNvbWUoKGRvbWFpbikgPT4gaG9zdG5hbWUuaW5jbHVkZXMoZG9tYWluKSkpO1xufVxuXG4vLyBzcmMvY29tcG9uZW50cy9IVE1MU2NvcGVkRWxlbWVudC50c1xudmFyIF9zZWVkLCBfdGVtcGxhdGVVc2VyU3R5bGVFbGVtZW50LCBfdHJhbnNmb3JtO1xudmFyIEhUTUxTY29wZWRFbGVtZW50ID0gY2xhc3MgZXh0ZW5kcyBIVE1MRWxlbWVudCB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKC4uLmFyZ3VtZW50cyk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9zZWVkLCByYW5kb21WYWxpZElEKCkpO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfdGVtcGxhdGVVc2VyU3R5bGVFbGVtZW50LCB2b2lkIDApO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfdHJhbnNmb3JtLCAoY2xhc3NOYW1lKSA9PiB7XG4gICAgICByZXR1cm4gYCR7X19wcml2YXRlR2V0KHRoaXMsIF9zZWVkKX0tLSR7Y2xhc3NOYW1lfWA7XG4gICAgfSk7XG4gIH1cbiAgZ2V0IHRlbXBsYXRlKCkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIGdldCB0ZW1wbGF0ZVN0eWxlKCkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIGdldCB0ZW1wbGF0ZVVzZXJTdHlsZSgpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICBjbG9uZWRDYWxsYmFjayhvbGRTZWVkLCBuZXdTZWVkKSB7XG4gICAgY29uc3Qgc2VlZFRyYW5zZm9ybSA9IChjbGFzc05hbWUpID0+IGNsYXNzTmFtZS5yZXBsYWNlKG9sZFNlZWQsIG5ld1NlZWQpO1xuICAgIHRyYW5zZm9ybURPTUNsYXNzQXR0cmlidXRlcyh0aGlzLCBzZWVkVHJhbnNmb3JtKTtcbiAgICBjb25zdCBzdHlsZXMgPSBBcnJheS5mcm9tKHRoaXMucXVlcnlTZWxlY3RvckFsbChcInN0eWxlXCIpKTtcbiAgICBmb3IgKGNvbnN0IHN0eWxlIG9mIHN0eWxlcykge1xuICAgICAgc3R5bGUudGV4dENvbnRlbnQgPSB0cmFuc2Zvcm1DbGFzc1NlbGVjdG9ycyhzdHlsZS50ZXh0Q29udGVudCwgc2VlZFRyYW5zZm9ybSk7XG4gICAgfVxuICAgIGlmIChzdHlsZXMubGVuZ3RoKSB7XG4gICAgICBfX3ByaXZhdGVTZXQodGhpcywgX3RlbXBsYXRlVXNlclN0eWxlRWxlbWVudCwgc3R5bGVzW3N0eWxlcy5sZW5ndGggLSAxXSk7XG4gICAgfVxuICAgIGNvbnN0IG5vZGVzV2l0aElkID0gQXJyYXkuZnJvbSh0aGlzLnF1ZXJ5U2VsZWN0b3JBbGwoYFtpZF49XCIke29sZFNlZWR9XCJdYCkpO1xuICAgIGZvciAoY29uc3Qgbm9kZSBvZiBub2Rlc1dpdGhJZCkge1xuICAgICAgbm9kZS5pZCA9IG5vZGUuaWQucmVwbGFjZShvbGRTZWVkLCBuZXdTZWVkKTtcbiAgICB9XG4gIH1cbiAgY29ubmVjdGVkQ2FsbGJhY2soKSB7XG4gICAgaWYgKHRoaXMuY2hpbGRFbGVtZW50Q291bnQgPiAwKSB7XG4gICAgICBjb25zdCBvbGRTZWVkID0gdGhpcy5kYXRhc2V0LnNlZWQ7XG4gICAgICBjb25zdCBuZXdTZWVkID0gX19wcml2YXRlR2V0KHRoaXMsIF9zZWVkKTtcbiAgICAgIGlmIChvbGRTZWVkICYmIG9sZFNlZWQgIT09IG5ld1NlZWQpIHtcbiAgICAgICAgdGhpcy5jbG9uZWRDYWxsYmFjayhvbGRTZWVkLCBuZXdTZWVkKTtcbiAgICAgICAgdGhpcy5kYXRhc2V0LnNlZWQgPSBuZXdTZWVkO1xuICAgICAgfVxuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLmRhdGFzZXQuc2VlZCA9IF9fcHJpdmF0ZUdldCh0aGlzLCBfc2VlZCk7XG4gICAgY29uc3QgdGVtcGxhdGUgPSB0aGlzLnRlbXBsYXRlO1xuICAgIGlmICh0ZW1wbGF0ZSkge1xuICAgICAgY29uc3QgZWxlbWVudCA9IHRoaXMucHJlcGFyZVRlbXBsYXRlKHRlbXBsYXRlKTtcbiAgICAgIHRoaXMuYXBwZW5kQ2hpbGQoZWxlbWVudCk7XG4gICAgfVxuICAgIGNvbnN0IHRlbXBsYXRlU3R5bGUgPSB0aGlzLnRlbXBsYXRlU3R5bGU7XG4gICAgaWYgKHRlbXBsYXRlU3R5bGUpIHtcbiAgICAgIGNvbnN0IHN0eWxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInN0eWxlXCIpO1xuICAgICAgc3R5bGUudGV4dENvbnRlbnQgPSB0aGlzLnByZXBhcmVDU1ModGVtcGxhdGVTdHlsZSk7XG4gICAgICB0aGlzLmFwcGVuZENoaWxkKHN0eWxlKTtcbiAgICB9XG4gICAgY29uc3QgdXNlclN0eWxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInN0eWxlXCIpO1xuICAgIGlmICh0aGlzLnRlbXBsYXRlVXNlclN0eWxlKSB7XG4gICAgICB1c2VyU3R5bGUudGV4dENvbnRlbnQgPSB0aGlzLnByZXBhcmVDU1ModGhpcy50ZW1wbGF0ZVVzZXJTdHlsZSk7XG4gICAgfVxuICAgIHRoaXMuYXBwZW5kQ2hpbGQodXNlclN0eWxlKTtcbiAgICBfX3ByaXZhdGVTZXQodGhpcywgX3RlbXBsYXRlVXNlclN0eWxlRWxlbWVudCwgdXNlclN0eWxlKTtcbiAgfVxuICBwcmVwYXJlVGVtcGxhdGUodGVtcGxhdGUpIHtcbiAgICBjb25zdCBlbGVtZW50ID0gdGVtcGxhdGUuY29udGVudC5maXJzdEVsZW1lbnRDaGlsZDtcbiAgICByZXR1cm4gdHJhbnNmb3JtRE9NQ2xhc3NBdHRyaWJ1dGVzKGVsZW1lbnQuY2xvbmVOb2RlKHRydWUpLCBfX3ByaXZhdGVHZXQodGhpcywgX3RyYW5zZm9ybSkpO1xuICB9XG4gIHByZXBhcmVDU1MoY3NzKSB7XG4gICAgcmV0dXJuIHRyYW5zZm9ybUNTU0NsYXNzUnVsZXMoY3NzLCBfX3ByaXZhdGVHZXQodGhpcywgX3RyYW5zZm9ybSkpO1xuICB9XG4gIHVwZGF0ZVRlbXBsYXRlVXNlclN0eWxlKHN0eWxlKSB7XG4gICAgaWYgKCFfX3ByaXZhdGVHZXQodGhpcywgX3RlbXBsYXRlVXNlclN0eWxlRWxlbWVudCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgX19wcml2YXRlR2V0KHRoaXMsIF90ZW1wbGF0ZVVzZXJTdHlsZUVsZW1lbnQpLnRleHRDb250ZW50ID0gdGhpcy5wcmVwYXJlQ1NTKHN0eWxlKTtcbiAgfVxuICBxdWVyeVNlbGVjdG9yKHNlbGVjdG9ycykge1xuICAgIHJldHVybiBzdXBlci5xdWVyeVNlbGVjdG9yKHRyYW5zZm9ybUNsYXNzU2VsZWN0b3JzKHNlbGVjdG9ycywgX19wcml2YXRlR2V0KHRoaXMsIF90cmFuc2Zvcm0pKSk7XG4gIH1cbiAgcXVlcnlTZWxlY3RvckFsbChzZWxlY3RvcnMpIHtcbiAgICByZXR1cm4gc3VwZXIucXVlcnlTZWxlY3RvckFsbCh0cmFuc2Zvcm1DbGFzc1NlbGVjdG9ycyhzZWxlY3RvcnMsIF9fcHJpdmF0ZUdldCh0aGlzLCBfdHJhbnNmb3JtKSkpO1xuICB9XG4gIGFkZEV2ZW50TGlzdGVuZXIodHlwZSwgbGlzdGVuZXIsIG9wdGlvbnMpIHtcbiAgICBzdXBlci5hZGRFdmVudExpc3RlbmVyKHR5cGUsIGxpc3RlbmVyLCBvcHRpb25zKTtcbiAgfVxuICByZW1vdmVFdmVudExpc3RlbmVyKHR5cGUsIGxpc3RlbmVyLCBvcHRpb25zKSB7XG4gICAgc3VwZXIucmVtb3ZlRXZlbnRMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lciwgb3B0aW9ucyk7XG4gIH1cbiAgZGlzcGF0Y2hFdmVudChldmVudCkge1xuICAgIHJldHVybiBzdXBlci5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcbiAgfVxufTtcbl9zZWVkID0gbmV3IFdlYWtNYXAoKTtcbl90ZW1wbGF0ZVVzZXJTdHlsZUVsZW1lbnQgPSBuZXcgV2Vha01hcCgpO1xuX3RyYW5zZm9ybSA9IG5ldyBXZWFrTWFwKCk7XG5cbi8vIHNyYy9pY29ucy9xdWVzdGlvbi5zdmdcbnZhciBxdWVzdGlvbl9kZWZhdWx0ID0gJzw/eG1sIHZlcnNpb249XCIxLjBcIiBlbmNvZGluZz1cIlVURi04XCIgc3RhbmRhbG9uZT1cInllc1wiPz48c3ZnIHZpZXdCb3g9XCIwIDAgMTggMThcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCI+PHBhdGggZmlsbC1ydWxlPVwiZXZlbm9kZFwiIGNsaXAtcnVsZT1cImV2ZW5vZGRcIiBkPVwiTTkgMTZBNyA3IDAgMSAwIDkgMmE3IDcgMCAwIDAgMCAxNFpNNi44OCA0Ljg4YTIuNTggMi41OCAwIDAgMSAxLjgzLS43NWgxLjA4YTIuNTggMi41OCAwIDAgMSAyLjU5IDIuNTh2LjE2YzAgMS0uNTMgMS45NC0xLjQgMi40NmwtLjU2LjM0Yy0uMjcuMTYtLjQ1LjQyLS41Mi43MS0uMDMuMTQtLjE0LjI1LS4yOC4yNUg4LjM4YS4yMy4yMyAwIDAgMS0uMjQtLjI1Yy4wOC0uOTEuNTktMS43NCAxLjM4LTIuMjFsLjU2LS4zNGMuMzQtLjIuNTQtLjU3LjU0LS45NlY2LjdhLjgzLjgzIDAgMCAwLS44My0uODNIOC43MWEuODMuODMgMCAwIDAtLjg0Ljgzdi4xOGEuODcuODcgMCAxIDEtMS43NSAwVjYuN2MwLS42OS4yOC0xLjM0Ljc2LTEuODNaTTEwIDEzYTEgMSAwIDEgMS0yIDAgMSAxIDAgMCAxIDIgMFpcIiBmaWxsPVwiY3VycmVudENvbG9yXCIvPjwvc3ZnPic7XG5cbi8vIHNyYy9pY29ucy9tYXJrZXIuc3ZnXG52YXIgbWFya2VyX2RlZmF1bHQgPSAnPHN2ZyB3aWR0aD1cIjQ4XCIgaGVpZ2h0PVwiNTZcIiBmaWxsPVwibm9uZVwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIj48ZyBmaWx0ZXI9XCJ1cmwoI2EpXCI+PHBhdGggZD1cIm0yNCA1MC40IDEzLjc5LTE0LjEyYTE4LjgyIDE4LjgyIDAgMCAwIDQuMjMtMjAuODYgMTkuMjMgMTkuMjMgMCAwIDAtNy4xOS04LjYgMTkuNzYgMTkuNzYgMCAwIDAtMjEuNjYgMGMtMy4yMSAyLjExLTUuNzEgNS4xLTcuMTkgOC42YTE4LjgyIDE4LjgyIDAgMCAwIDQuMjMgMjAuODZMMjQgNTAuNFpcIiBmaWxsPVwiY3VycmVudENvbG9yXCIvPjxwYXRoIGQ9XCJNMzcuMjYgMzUuNzUgMjQgNDkuMzQgMTAuNzUgMzUuNzZsLS4wMS0uMDFBMTguMDcgMTguMDcgMCAwIDEgNi42OCAxNS43YTE4LjQ4IDE4LjQ4IDAgMCAxIDYuOS04LjI2IDE5IDE5IDAgMCAxIDIwLjg0IDAgMTguNDggMTguNDggMCAwIDEgNi45IDguMjYgMTguMDcgMTguMDcgMCAwIDEtNC4wNiAyMC4wNFpcIiBzdHJva2U9XCIjZmZmXCIgc3Ryb2tlLXdpZHRoPVwiMS41XCIvPjwvZz48Y2lyY2xlIGN4PVwiMjRcIiBjeT1cIjIyLjQ1XCIgZmlsbD1cIiNmZmZcIiByPVwiNS44NVwiLz48ZGVmcz48ZmlsdGVyIGlkPVwiYVwiIHg9XCIuNVwiIHk9XCIuNlwiIHdpZHRoPVwiNDdcIiBoZWlnaHQ9XCI1NC44XCIgZmlsdGVyVW5pdHM9XCJ1c2VyU3BhY2VPblVzZVwiIGNvbG9yLWludGVycG9sYXRpb24tZmlsdGVycz1cInNSR0JcIj48ZmVGbG9vZCBmbG9vZC1vcGFjaXR5PVwiMFwiIHJlc3VsdD1cIkJhY2tncm91bmRJbWFnZUZpeFwiLz48ZmVDb2xvck1hdHJpeCBpbj1cIlNvdXJjZUFscGhhXCIgdmFsdWVzPVwiMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMTI3IDBcIiByZXN1bHQ9XCJoYXJkQWxwaGFcIi8+PGZlT2Zmc2V0IGR5PVwiMVwiLz48ZmVHYXVzc2lhbkJsdXIgc3RkRGV2aWF0aW9uPVwiMlwiLz48ZmVDb2xvck1hdHJpeCB2YWx1ZXM9XCIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwLjIgMFwiLz48ZmVCbGVuZCBpbjI9XCJCYWNrZ3JvdW5kSW1hZ2VGaXhcIiByZXN1bHQ9XCJlZmZlY3QxX2Ryb3BTaGFkb3dfMTdfODcxXCIvPjxmZUJsZW5kIGluPVwiU291cmNlR3JhcGhpY1wiIGluMj1cImVmZmVjdDFfZHJvcFNoYWRvd18xN184NzFcIiByZXN1bHQ9XCJzaGFwZVwiLz48L2ZpbHRlcj48L2RlZnM+PC9zdmc+JztcblxuLy8gc3JjL2ljb25zL3N0cmVldC5zdmdcbnZhciBzdHJlZXRfZGVmYXVsdCA9ICc8c3ZnIHdpZHRoPVwiMjRcIiBoZWlnaHQ9XCIyNFwiIHZpZXdCb3g9XCIwIDAgMTggMThcIiBmaWxsPVwibm9uZVwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIj5cXG4gIDxwYXRoIGZpbGwtcnVsZT1cImV2ZW5vZGRcIiBjbGlwLXJ1bGU9XCJldmVub2RkXCIgZD1cIk0xLjA4IDE0Ljk0IDUuNjI1IDMuMDZoMS4xN2wtMy40MiAxMS44OEgxLjA4Wm0xNS44ODUgMEwxMi40MiAzLjA2aC0xLjE3bDMuNDIgMTEuODhoMi4yOTVabS02Ljg2LTEuNDRINy45NDZsLjEyOC0yLjYxaDEuOTEybC4xMTkgMi42MVptLS4yMTctNC43N0g4LjE4MWwuMDg4LTEuOGgxLjUzN2wuMDgyIDEuOFpNOS43NCA1LjQ5aC0xLjRsLjA0OS0uOTloMS4zMDZsLjA0NS45OVpcIiBmaWxsPVwiY3VycmVudENvbG9yXCIgLz5cXG48L3N2Zz4nO1xuXG4vLyBzcmMvaWNvbnMvYWRkcmVzc01hcmtlci5zdmdcbnZhciBhZGRyZXNzTWFya2VyX2RlZmF1bHQgPSBgPCEtLSBUT0RPOiBJJ20gbm90IHN1cmUgaWYgdGhlIHdheSBJIGFkZGVkIHRoZSBjaXJjbGUgd2lsbCBcInNjYWxlXCIgcHJvcGVybHksIG5lZWQgdG8gY2hlY2sgdGhhdCAtLT5cbjxzdmcgd2lkdGg9XCIyNFwiIGhlaWdodD1cIjI0XCIgdmlld0JveD1cIjAgMCAxOCAxOFwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIj5cbiAgPHBhdGggZmlsbD1cIm5vbmVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIxLjVcIiBkPVwiTTQgN2E1IDUgMCAxIDEgMTAgMGMwIDMuMDI1LTMuMjggNi43MTMtNSA5LTEuNzItMi4yODctNS01Ljk3NS01LTl6XCI+PC9wYXRoPlxuICAgIDxjaXJjbGUgY3g9XCI5XCIgY3k9XCI3XCIgcj1cIjJcIiBmaWxsPVwiY3VycmVudENvbG9yXCI+PC9jaXJjbGU+XG48L3N2Zz5gO1xuXG4vLyBzcmMvaWNvbnMvc2VhcmNoLnN2Z1xudmFyIHNlYXJjaF9kZWZhdWx0ID0gJzxzdmcgdmlld0JveD1cIjAgMCAxOCAxOFwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIj5cXG4gIDxwYXRoIGQ9XCJNNy40IDIuNWMtMi43IDAtNC45IDIuMi00LjkgNC45czIuMiA0LjkgNC45IDQuOWMxIDAgMS44LS4yIDIuNS0uOGwzLjcgMy43Yy4yLjIuNC4zLjguMy43IDAgMS4xLS40IDEuMS0xLjEgMC0uMy0uMS0uNS0uMy0uOEwxMS40IDEwYy40LS44LjgtMS42LjgtMi41LjEtMi44LTIuMS01LTQuOC01em0wIDEuNmMxLjggMCAzLjIgMS40IDMuMiAzLjJzLTEuNCAzLjItMy4yIDMuMi0zLjMtMS4zLTMuMy0zLjEgMS40LTMuMyAzLjMtMy4zelwiLz5cXG48L3N2Zz4nO1xuXG4vLyBwYWNrYWdlLmpzb25cbnZhciB2ZXJzaW9uID0gXCIxLjAuMC1iZXRhLjIyXCI7XG5cbi8vIHNyYy90aGVtZS50c1xudmFyIHN0eWxlVG9nZ2xlU2F0ZWxsaXRlSW1nID0gYGh0dHBzOi8vYXBpLm1hcGJveC5jb20vc2VhcmNoLWpzL3Yke3ZlcnNpb259L2ltZy9zdHlsZS10b2dnbGUtc2F0ZWxsaXRlLmpwZ2A7XG52YXIgc3R5bGVUb2dnbGVEZWZhdWx0SW1nID0gYGh0dHBzOi8vYXBpLm1hcGJveC5jb20vc2VhcmNoLWpzL3Yke3ZlcnNpb259L2ltZy9zdHlsZS10b2dnbGUtZGVmYXVsdC5qcGdgO1xudmFyIE1PQklMRV9CUkVBS1BPSU5UID0gNzY4IC0gMTtcbnZhciBNT0JJTEVfTUVESUFfUVVFUlkgPSBgQG1lZGlhIG9ubHkgc2NyZWVuIGFuZCAobWF4LXdpZHRoOiAke01PQklMRV9CUkVBS1BPSU5UfXB4KWA7XG52YXIgREVGQVVMVF9USEVNRSA9IHtcbiAgdmFyaWFibGVzOiB7XG4gICAgdW5pdDogW1wibW9iaWxlXCIsIFwiMTZweFwiLCBcIjE0cHhcIl0sXG4gICAgdW5pdEhlYWRlcjogW1wibW9iaWxlXCIsIFwiMjRweFwiLCBcIjE4cHhcIl0sXG4gICAgbWluV2lkdGg6IFwibWluKDMwMHB4LCAxMDB2dylcIixcbiAgICBzcGFjaW5nOiBcIjAuNzVlbVwiLFxuICAgIHBhZGRpbmc6IFwiMC41ZW0gMC43NWVtXCIsXG4gICAgcGFkZGluZ0Zvb3RlckxhYmVsOiBcIjAuNWVtIDAuNzVlbVwiLFxuICAgIHBhZGRpbmdNb2RhbDogXCIxLjI1ZW1cIixcbiAgICBjb2xvclRleHQ6IFwicmdiYSgwLCAwLCAwLCAwLjc1KVwiLFxuICAgIGNvbG9yUHJpbWFyeTogXCIjNDI2NEZCXCIsXG4gICAgY29sb3JTZWNvbmRhcnk6IFwiIzY2N0Y5MVwiLFxuICAgIGNvbG9yQmFja2dyb3VuZDogXCIjZmZmXCIsXG4gICAgY29sb3JCYWNrZ3JvdW5kSG92ZXI6IFwiI2Y1ZjVmNVwiLFxuICAgIGNvbG9yQmFja2dyb3VuZEFjdGl2ZTogXCIjZjBmMGYwXCIsXG4gICAgY29sb3JCYWNrZHJvcDogXCJyZ2JhKDEwMiwgMTI3LCAxNDUsIDAuMylcIixcbiAgICBib3JkZXI6IFwibm9uZVwiLFxuICAgIGJvcmRlclJhZGl1czogXCI0cHhcIixcbiAgICBib3hTaGFkb3c6IGBcbiAgICAgIDAgMCAxMHB4IDJweCByZ2JhKDAsIDAsIDAsIDAuMDUpLFxuICAgICAgMCAwIDZweCAxcHggcmdiYSgwLCAwLCAwLCAwLjEpLFxuICAgICAgMCAwIDAgMXB4IHJnYmEoMCwgMCwgMCwgMC4xKVxuICAgIGAsXG4gICAgbGluZUhlaWdodDogXCIxLjJlbVwiLFxuICAgIGZvbnRGYW1pbHk6IGBcbiAgICAgIC1hcHBsZS1zeXN0ZW0sIEJsaW5rTWFjU3lzdGVtRm9udCxcbiAgICAgIGF2ZW5pciBuZXh0LCBhdmVuaXIsXG4gICAgICBzZWdvZSB1aSxcbiAgICAgIGhlbHZldGljYSBuZXVlLCBoZWx2ZXRpY2EsXG4gICAgICBVYnVudHUsIHJvYm90bywgbm90bywgYXJpYWwsIHNhbnMtc2VyaWZcbiAgICBgLFxuICAgIGZvbnRXZWlnaHQ6IFwibm9ybWFsXCIsXG4gICAgZm9udFdlaWdodFNlbWlib2xkOiBcIjYwMFwiLFxuICAgIGZvbnRXZWlnaHRCb2xkOiBcImJvbGRcIixcbiAgICBkdXJhdGlvbjogXCIxNTBtc1wiLFxuICAgIGN1cnZlOiBcImVhc2Utb3V0XCJcbiAgfSxcbiAgaWNvbnM6IHtcbiAgICBjbG9zZTogY2xvc2VfZGVmYXVsdCxcbiAgICBxdWVzdGlvbjogcXVlc3Rpb25fZGVmYXVsdCxcbiAgICBtYXJrZXI6IG1hcmtlcl9kZWZhdWx0LFxuICAgIHN0cmVldDogc3RyZWV0X2RlZmF1bHQsXG4gICAgYWRkcmVzc01hcmtlcjogYWRkcmVzc01hcmtlcl9kZWZhdWx0LFxuICAgIHNlYXJjaDogc2VhcmNoX2RlZmF1bHRcbiAgfSxcbiAgaW1hZ2VzOiB7XG4gICAgc3R5bGVUb2dnbGVEZWZhdWx0OiBzdHlsZVRvZ2dsZURlZmF1bHRJbWcsXG4gICAgc3R5bGVUb2dnbGVTYXRlbGxpdGU6IHN0eWxlVG9nZ2xlU2F0ZWxsaXRlSW1nXG4gIH1cbn07XG5mdW5jdGlvbiBnZXRUaGVtZUNTUyhyb290U2VsZWN0b3IsIHRoZW1lID0ge30pIHtcbiAgY29uc3QgdmFyaWFibGVzID0gX19zcHJlYWRWYWx1ZXMoX19zcHJlYWRWYWx1ZXMoe30sIERFRkFVTFRfVEhFTUUudmFyaWFibGVzKSwgdGhlbWUudmFyaWFibGVzIHx8IHt9KTtcbiAgbGV0IGNzc1RleHQgPSB0aGVtZS5jc3NUZXh0IHx8IFwiXCI7XG4gIGxldCByb290VmFyaWFibGVzID0gXCJcIjtcbiAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXModmFyaWFibGVzKSkge1xuICAgIGlmICghQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcbiAgICAgIHJvb3RWYXJpYWJsZXMgKz0gYC0tJHtrZXl9OiAke3ZhbHVlfTtgO1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIGlmICh2YWx1ZVswXSAhPT0gXCJtb2JpbGVcIikge1xuICAgICAgY29uc3QgdmFsdWVTdHIgPSBKU09OLnN0cmluZ2lmeSh2YWx1ZSk7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuc3VwcG9ydGVkIGV4cHJlc3Npb24gaW4gdGhlbWUgdmFyaWFibGVzOiAke2tleX0gJHt2YWx1ZVN0cn1gKTtcbiAgICB9XG4gICAgY29uc3QgWywgbW9iaWxlVmFsdWUsIGRlc2t0b3BWYWx1ZV0gPSB2YWx1ZTtcbiAgICBjc3NUZXh0ICs9IGAke01PQklMRV9NRURJQV9RVUVSWX0geyAke3Jvb3RTZWxlY3Rvcn0geyAtLSR7a2V5fTogJHttb2JpbGVWYWx1ZX0gIWltcG9ydGFudDsgfSB9YDtcbiAgICByb290VmFyaWFibGVzICs9IGAtLSR7a2V5fTogJHtkZXNrdG9wVmFsdWV9O2A7XG4gIH1cbiAgcmV0dXJuIGNzc1RleHQgKyBgJHtyb290U2VsZWN0b3J9IHsgJHtyb290VmFyaWFibGVzfSB9YDtcbn1cbmZ1bmN0aW9uIGdldEljb24oaWNvbk5hbWUsIHRoZW1lID0ge30pIHtcbiAgY29uc3QgaWNvbnMgPSBfX3NwcmVhZFZhbHVlcyhfX3NwcmVhZFZhbHVlcyh7fSwgREVGQVVMVF9USEVNRS5pY29ucyksIHRoZW1lLmljb25zIHx8IHt9KTtcbiAgY29uc3Qgc3ZnU3RyaW5nID0gaWNvbnNbaWNvbk5hbWVdO1xuICByZXR1cm4gc3ZnU3RyaW5nO1xufVxuZnVuY3Rpb24gZ2V0SW1hZ2UoaW1hZ2VOYW1lLCB0aGVtZSA9IHt9KSB7XG4gIGNvbnN0IGltYWdlcyA9IF9fc3ByZWFkVmFsdWVzKF9fc3ByZWFkVmFsdWVzKHt9LCBERUZBVUxUX1RIRU1FLmltYWdlcyksIHRoZW1lLmltYWdlcyB8fCB7fSk7XG4gIGNvbnN0IGltZ1N0cmluZyA9IGltYWdlc1tpbWFnZU5hbWVdO1xuICByZXR1cm4gaW1nU3RyaW5nO1xufVxuXG4vLyBzcmMvdXRpbHMvcG9wb3Zlci50c1xuaW1wb3J0IHtcbiAgY29tcHV0ZVBvc2l0aW9uLFxuICBhdXRvVXBkYXRlLFxuICBmbGlwLFxuICBvZmZzZXRcbn0gZnJvbSBcIkBmbG9hdGluZy11aS9kb21cIjtcbnZhciBfb3B0aW9ucywgX2RlZmF1bHRPcHRpb25zO1xudmFyIFBvcG92ZXIgPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKHJlZmVyZW5jZUVsLCBmbG9hdGluZ0VsLCBvcHRpb25zKSB7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9vcHRpb25zLCB2b2lkIDApO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfZGVmYXVsdE9wdGlvbnMsIHtcbiAgICAgIHBsYWNlbWVudDogXCJib3R0b20tc3RhcnRcIixcbiAgICAgIGZsaXA6IGZhbHNlLFxuICAgICAgb2Zmc2V0OiAxMFxuICAgIH0pO1xuICAgIHRoaXMudXBkYXRlID0gKCkgPT4gX19hc3luYyh0aGlzLCBudWxsLCBmdW5jdGlvbiogKCkge1xuICAgICAgY29uc3QgY29uZmlnMiA9IHtcbiAgICAgICAgcGxhY2VtZW50OiB0aGlzLm9wdGlvbnMucGxhY2VtZW50LFxuICAgICAgICBtaWRkbGV3YXJlOiBbXG4gICAgICAgICAgb2Zmc2V0KHRoaXMub3B0aW9ucy5vZmZzZXQpLFxuICAgICAgICAgIHRoaXMub3B0aW9ucy5mbGlwICYmIGZsaXAoKVxuICAgICAgICBdLmZpbHRlcihCb29sZWFuKVxuICAgICAgfTtcbiAgICAgIGNvbnN0IHsgeCwgeSB9ID0geWllbGQgY29tcHV0ZVBvc2l0aW9uKHRoaXMucmVmZXJlbmNlRWwsIHRoaXMuZmxvYXRpbmdFbCwgY29uZmlnMik7XG4gICAgICBPYmplY3QuYXNzaWduKHRoaXMuZmxvYXRpbmdFbC5zdHlsZSwge1xuICAgICAgICBsZWZ0OiBgJHt4fXB4YCxcbiAgICAgICAgdG9wOiBgJHt5fXB4YFxuICAgICAgfSk7XG4gICAgfSk7XG4gICAgdGhpcy5yZWZlcmVuY2VFbCA9IHJlZmVyZW5jZUVsO1xuICAgIHRoaXMuZmxvYXRpbmdFbCA9IGZsb2F0aW5nRWw7XG4gICAgX19wcml2YXRlU2V0KHRoaXMsIF9vcHRpb25zLCBfX3NwcmVhZFZhbHVlcyhfX3NwcmVhZFZhbHVlcyh7fSwgX19wcml2YXRlR2V0KHRoaXMsIF9kZWZhdWx0T3B0aW9ucykpLCBvcHRpb25zKSk7XG4gICAgdGhpcy5kZXN0cm95ID0gYXV0b1VwZGF0ZSh0aGlzLnJlZmVyZW5jZUVsLCB0aGlzLmZsb2F0aW5nRWwsIHRoaXMudXBkYXRlKTtcbiAgfVxuICBnZXQgb3B0aW9ucygpIHtcbiAgICByZXR1cm4gX19wcml2YXRlR2V0KHRoaXMsIF9vcHRpb25zKTtcbiAgfVxuICBzZXQgb3B0aW9ucyhuZXdPcHRpb25zKSB7XG4gICAgX19wcml2YXRlU2V0KHRoaXMsIF9vcHRpb25zLCBfX3NwcmVhZFZhbHVlcyhfX3NwcmVhZFZhbHVlcyh7fSwgX19wcml2YXRlR2V0KHRoaXMsIF9vcHRpb25zKSksIG5ld09wdGlvbnMpKTtcbiAgfVxufTtcbl9vcHRpb25zID0gbmV3IFdlYWtNYXAoKTtcbl9kZWZhdWx0T3B0aW9ucyA9IG5ldyBXZWFrTWFwKCk7XG5cbi8vIHNyYy9zdHlsZS5jc3NcbnZhciBzdHlsZV9kZWZhdWx0ID0gXCIqe2JveC1zaXppbmc6Ym9yZGVyLWJveCFpbXBvcnRhbnR9W3JvbGU9YnV0dG9uXXtjdXJzb3I6cG9pbnRlcn0uTWFwYm94U2VhcmNoey0td2lkdGg6MDtkaXNwbGF5Om5vbmV9LlJlc3VsdHN7YmFja2dyb3VuZC1jb2xvcjp2YXIoLS1jb2xvckJhY2tncm91bmQpO2JvcmRlcjp2YXIoLS1ib3JkZXIpO2JvcmRlci1yYWRpdXM6dmFyKC0tYm9yZGVyUmFkaXVzKTtib3gtc2hhZG93OnZhcigtLWJveFNoYWRvdyk7Y29sb3I6dmFyKC0tY29sb3JUZXh0KTtmb250LWZhbWlseTp2YXIoLS1mb250RmFtaWx5KTtmb250LXNpemU6dmFyKC0tdW5pdCk7Zm9udC13ZWlnaHQ6dmFyKC0tZm9udFdlaWdodCk7bGluZS1oZWlnaHQ6dmFyKC0tbGluZUhlaWdodCk7bWluLXdpZHRoOnZhcigtLW1pbldpZHRoKTtvdmVyZmxvdy15OmF1dG87cG9zaXRpb246YWJzb2x1dGU7dHJhbnNmb3JtOnRyYW5zbGF0ZVooMCk7dHJhbnNpdGlvbjp2aXNpYmlsaXR5IHZhcigtLWR1cmF0aW9uKTt3aWR0aDp2YXIoLS13aWR0aCk7ei1pbmRleDoxMDAwfS5SZXN1bHRzOm5vdChbYXJpYS1oaWRkZW49dHJ1ZV0pe3Zpc2liaWxpdHk6dmlzaWJsZX0uUmVzdWx0c1thcmlhLWhpZGRlbj10cnVlXXthbmltYXRpb246ZmFkZWluIHZhcigtLWR1cmF0aW9uKSB2YXIoLS1jdXJ2ZSkgcmV2ZXJzZSBmb3J3YXJkczt2aXNpYmlsaXR5OmhpZGRlbn0uU3VnZ2VzdGlvbnthbGlnbi1pdGVtczpjZW50ZXI7ZGlzcGxheTpmbGV4O3BhZGRpbmc6dmFyKC0tcGFkZGluZyl9LlN1Z2dlc3Rpb246aG92ZXJ7Y3Vyc29yOnBvaW50ZXJ9LlN1Z2dlc3Rpb25bYXJpYS1zZWxlY3RlZD10cnVlXXtiYWNrZ3JvdW5kLWNvbG9yOnZhcigtLWNvbG9yQmFja2dyb3VuZEhvdmVyKX0uU3VnZ2VzdGlvbjphY3RpdmV7YmFja2dyb3VuZC1jb2xvcjp2YXIoLS1jb2xvckJhY2tncm91bmRBY3RpdmUpfS5TdWdnZXN0aW9uTmFtZXtmb250LXdlaWdodDp2YXIoLS1mb250V2VpZ2h0Qm9sZCl9LlN1Z2dlc3Rpb25JY29ue21hcmdpbi1yaWdodDo2cHh9LlN1Z2dlc3Rpb25JY29uW2FyaWEtaGlkZGVuPXRydWVde2Rpc3BsYXk6bm9uZX0uUmVzdWx0c0F0dHJpYnV0aW9ue3BhZGRpbmc6dmFyKC0tcGFkZGluZ0Zvb3RlckxhYmVsKX0uUmVzdWx0c0F0dHJpYnV0aW9uIGF7Y29sb3I6dmFyKC0tY29sb3JTZWNvbmRhcnkpfS5SZXN1bHRzQXR0cmlidXRpb24gYTpub3QoOmhvdmVyKXt0ZXh0LWRlY29yYXRpb246bm9uZX0uUmVzdWx0c0xpc3R7bGlzdC1zdHlsZTpub25lO21hcmdpbjowO3BhZGRpbmc6MH0uTGFiZWx7ZGlzcGxheTpub25lfS5HZW9jb2RlciwuU2VhcmNoQm94e2JhY2tncm91bmQtY29sb3I6dmFyKC0tY29sb3JCYWNrZ3JvdW5kKTtib3JkZXI6dmFyKC0tYm9yZGVyKTtib3JkZXItcmFkaXVzOnZhcigtLWJvcmRlclJhZGl1cyk7Ym94LXNoYWRvdzp2YXIoLS1ib3hTaGFkb3cpO2NvbG9yOnZhcigtLWNvbG9yVGV4dCk7Zm9udC1mYW1pbHk6dmFyKC0tZm9udEZhbWlseSk7Zm9udC1zaXplOnZhcigtLXVuaXQpO2ZvbnQtd2VpZ2h0OnZhcigtLWZvbnRXZWlnaHQpO2xpbmUtaGVpZ2h0OnZhcigtLWxpbmVIZWlnaHQpO3BhZGRpbmc6dmFyKC0tcGFkZGluZyk7cGFkZGluZy1ib3R0b206MDtwYWRkaW5nLXRvcDowO3Bvc2l0aW9uOnJlbGF0aXZlO3dpZHRoOjEwMCV9LlNlYXJjaEljb257ZmlsbDojNzU3NTc1O2xlZnQ6LjVlbX0uQWN0aW9uSWNvbiwuU2VhcmNoSWNvbntib3R0b206MDtoZWlnaHQ6MjBweDttYXJnaW46YXV0byAwO3Bvc2l0aW9uOmFic29sdXRlO3RvcDowO3dpZHRoOjIwcHh9LkFjdGlvbkljb257cmlnaHQ6LjVlbX0uQWN0aW9uSWNvbj5idXR0b257YmFja2dyb3VuZDpub25lO2JvcmRlcjpub25lO2NvbG9yOmluaGVyaXQ7Y3Vyc29yOnBvaW50ZXI7Zm9udDppbmhlcml0O2hlaWdodDoxMDAlO291dGxpbmU6aW5oZXJpdDtwYWRkaW5nOjA7d2lkdGg6MTAwJX0uQWN0aW9uSWNvbj5idXR0b246aG92ZXJ7YmFja2dyb3VuZDpub25lIWltcG9ydGFudH0uQ2xlYXJCdG57ZGlzcGxheTpub25lfS5DbGVhckJ0bjpob3Zlcntjb2xvcjojOTA5MDkwfS5Mb2FkaW5nSWNvbnstbW96LWFuaW1hdGlvbjpyb3RhdGUgLjhzIGN1YmljLWJlemllciguNDUsLjA1LC41NSwuOTUpIGluZmluaXRlOy13ZWJraXQtYW5pbWF0aW9uOnJvdGF0ZSAuOHMgY3ViaWMtYmV6aWVyKC40NSwuMDUsLjU1LC45NSkgaW5maW5pdGU7YW5pbWF0aW9uOnJvdGF0ZSAuOHMgY3ViaWMtYmV6aWVyKC40NSwuMDUsLjU1LC45NSkgaW5maW5pdGU7ZGlzcGxheTpub25lO2hlaWdodDoxMDAlfUAtd2Via2l0LWtleWZyYW1lcyByb3RhdGV7MCV7LXdlYmtpdC10cmFuc2Zvcm06cm90YXRlKDApO3RyYW5zZm9ybTpyb3RhdGUoMCl9dG97LXdlYmtpdC10cmFuc2Zvcm06cm90YXRlKDF0dXJuKTt0cmFuc2Zvcm06cm90YXRlKDF0dXJuKX19QGtleWZyYW1lcyByb3RhdGV7MCV7LXdlYmtpdC10cmFuc2Zvcm06cm90YXRlKDApO3RyYW5zZm9ybTpyb3RhdGUoMCl9dG97LXdlYmtpdC10cmFuc2Zvcm06cm90YXRlKDF0dXJuKTt0cmFuc2Zvcm06cm90YXRlKDF0dXJuKX19LklucHV0e2JhY2tncm91bmQtY29sb3I6dHJhbnNwYXJlbnQ7Ym9yZGVyOjA7Y29sb3I6IzQwNDA0MDtjb2xvcjpyZ2JhKDAsMCwwLC43NSk7Zm9udDppbmhlcml0O2hlaWdodDozNnB4O21hcmdpbjowO292ZXJmbG93OmhpZGRlbjtwYWRkaW5nOjAgNDBweDt0ZXh0LW92ZXJmbG93OmVsbGlwc2lzO3doaXRlLXNwYWNlOm5vd3JhcDt3aWR0aDoxMDAlfS5JbnB1dDo6LW1zLWNsZWFye2Rpc3BsYXk6bm9uZX0uSW5wdXQ6Zm9jdXN7Ym9yZGVyOnRoaW4gZG90dGVkO2JvcmRlci1yYWRpdXM6dmFyKC0tYm9yZGVyUmFkaXVzKTtib3gtc2hhZG93Om5vbmU7Y29sb3I6IzQwNDA0MDtjb2xvcjpyZ2JhKDAsMCwwLC43NSk7b3V0bGluZTowfW1hcGJveC1hZGRyZXNzLWNvbmZpcm1hdGlvbi1mZWF0dXJlW2FyaWEtaGlkZGVuPXRydWVdLG1hcGJveC1hZGRyZXNzLWNvbmZpcm1hdGlvbi1uby1mZWF0dXJlW2FyaWEtaGlkZGVuPXRydWVde2Rpc3BsYXk6bm9uZX0uTWFwYm94QWRkcmVzc0NvbmZpcm1hdGlvbnthbGlnbi1pdGVtczpjZW50ZXI7YmFja2dyb3VuZC1jb2xvcjp2YXIoLS1jb2xvckJhY2tkcm9wKTtib3R0b206MDtkaXNwbGF5OmZsZXg7anVzdGlmeS1jb250ZW50OmNlbnRlcjtsZWZ0OjA7cG9zaXRpb246Zml4ZWQ7cmlnaHQ6MDt0b3A6MDt0cmFuc2Zvcm06dHJhbnNsYXRlWigwKTt6LWluZGV4OjEwMDB9Lk1hcGJveEFkZHJlc3NDb25maXJtYXRpb246bm90KFthcmlhLWhpZGRlbj10cnVlXSl7YW5pbWF0aW9uOmZhZGVpbiB2YXIoLS1kdXJhdGlvbikgdmFyKC0tY3VydmUpIGZvcndhcmRzO3Zpc2liaWxpdHk6dmlzaWJsZX0uTWFwYm94QWRkcmVzc0NvbmZpcm1hdGlvblthcmlhLWhpZGRlbj10cnVlXXt2aXNpYmlsaXR5OmhpZGRlbn0uQ29udGVudEZlYXR1cmUsLkNvbnRlbnROb0ZlYXR1cmV7d2lkdGg6dmFyKC0tbWluV2lkdGgpfS5Nb2RhbHtiYWNrZ3JvdW5kLWNvbG9yOnZhcigtLWNvbG9yQmFja2dyb3VuZCk7Ym9yZGVyOnZhcigtLWJvcmRlcik7Ym9yZGVyLXJhZGl1czp2YXIoLS1ib3JkZXJSYWRpdXMpO2JveC1zaGFkb3c6dmFyKC0tYm94U2hhZG93KTtjb2xvcjp2YXIoLS1jb2xvclRleHQpO2ZvbnQtZmFtaWx5OnZhcigtLWZvbnRGYW1pbHkpO2ZvbnQtc2l6ZTp2YXIoLS11bml0KTtmb250LXdlaWdodDp2YXIoLS1mb250V2VpZ2h0KTtsaW5lLWhlaWdodDp2YXIoLS1saW5lSGVpZ2h0KTtwYWRkaW5nOnZhcigtLXBhZGRpbmdNb2RhbCk7d2lkdGg6MTAwJX1AbWVkaWEgc2NyZWVuIGFuZCAobWF4LXdpZHRoOjQ4MHB4KXsuTWFwYm94QWRkcmVzc0NvbmZpcm1hdGlvbnthbGlnbi1pdGVtczpmbGV4LWVuZH0uQ29udGVudEZlYXR1cmUsLkNvbnRlbnROb0ZlYXR1cmV7d2lkdGg6MTAwJX0uTW9kYWx7Ym9yZGVyLWJvdHRvbS1sZWZ0LXJhZGl1czowO2JvcmRlci1ib3R0b20tcmlnaHQtcmFkaXVzOjB9fS5Nb2RhbEhlYWRlcnthbGlnbi1pdGVtczpjZW50ZXI7Y29sb3I6dmFyKC0tY29sb3JQcmltYXJ5KTtkaXNwbGF5OmZsZXg7Zm9udC1zaXplOnZhcigtLXVuaXRIZWFkZXIpO2ZvbnQtd2VpZ2h0OnZhcigtLWZvbnRXZWlnaHRCb2xkKTttYXJnaW4tYm90dG9tOnZhcigtLXNwYWNpbmcpO3VzZXItc2VsZWN0Om5vbmU7d2lkdGg6MTAwJX0uTW9kYWxNYXB7aGVpZ2h0OmNhbGModmFyKC0tbWluV2lkdGgpKjkvMTYpO21hcmdpbi1sZWZ0OmNhbGModmFyKC0tcGFkZGluZ01vZGFsKSotMSk7d2lkdGg6Y2FsYygxMDAlICsgdmFyKC0tcGFkZGluZ01vZGFsKSoyKX0uTW9kYWxNYXBbYXJpYS1oaWRkZW49dHJ1ZV17ZGlzcGxheTpub25lfS5JY29ue2hlaWdodDp2YXIoLS11bml0SGVhZGVyKTt3aWR0aDp2YXIoLS11bml0SGVhZGVyKX0uSWNvbi5JY29uQ2xvc2V7Y29sb3I6dmFyKC0tY29sb3JTZWNvbmRhcnkpfS5Nb2RhbEhlYWRlclRpdGxle2ZsZXg6MTttYXJnaW4tbGVmdDouMjVlbX0uTW9kYWxGb290ZXJ7Y29sb3I6dmFyKC0tY29sb3JTZWNvbmRhcnkpO21hcmdpbi10b3A6dmFyKC0tc3BhY2luZyk7dGV4dC1hbGlnbjpjZW50ZXJ9Lk1vZGFsRm9vdGVyW2FyaWEtaGlkZGVuPXRydWVde2Rpc3BsYXk6bm9uZX0uTW9kYWxTdWJoZWFkZXJ7Zm9udC13ZWlnaHQ6dmFyKC0tZm9udFdlaWdodEJvbGQpO3VzZXItc2VsZWN0Om5vbmV9Lk1vZGFsRGVzY3JpcHRpb257Y29sb3I6dmFyKC0tY29sb3JQcmltYXJ5KX0uTW9kYWxBZGRyZXNzLC5Nb2RhbFN1YmhlYWRlcnttYXJnaW4tYm90dG9tOnZhcigtLXNwYWNpbmcpfS5Nb2RhbEFkZHJlc3MuTW9kYWxBZGRyZXNzQXBwcm92ZXtjb2xvcjp2YXIoLS1jb2xvclByaW1hcnkpfS5CdXR0b257Ym9yZGVyLXJhZGl1czp2YXIoLS1ib3JkZXJSYWRpdXMpO2N1cnNvcjpwb2ludGVyO2ZvbnQtd2VpZ2h0OnZhcigtLWZvbnRXZWlnaHRTZW1pYm9sZCk7bWFyZ2luLXRvcDp2YXIoLS1zcGFjaW5nKTtwYWRkaW5nOnZhcigtLXBhZGRpbmcpO3RleHQtYWxpZ246Y2VudGVyO3VzZXItc2VsZWN0Om5vbmU7d2lkdGg6MTAwJX0uQnV0dG9uW2FyaWEtaGlkZGVuPXRydWVde2Rpc3BsYXk6bm9uZX0uQnV0dG9uLkJ1dHRvblByaW1hcnl7YmFja2dyb3VuZC1jb2xvcjp2YXIoLS1jb2xvclByaW1hcnkpO2NvbG9yOnZhcigtLWNvbG9yQmFja2dyb3VuZCl9LkJ1dHRvbi5CdXR0b25TZWNvbmRhcnl7Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1jb2xvclNlY29uZGFyeSk7Y29sb3I6dmFyKC0tY29sb3JTZWNvbmRhcnkpfUBrZXlmcmFtZXMgZmFkZWluezAle29wYWNpdHk6MH10b3tvcGFjaXR5OjF9fS5NYXBib3hBZGRyZXNzTWluaW1hcHtmb250LWZhbWlseTp2YXIoLS1mb250RmFtaWx5KTtmb250LXNpemU6dmFyKC0tdW5pdCk7Zm9udC13ZWlnaHQ6dmFyKC0tZm9udFdlaWdodCk7bGluZS1oZWlnaHQ6dmFyKC0tbGluZUhlaWdodCl9Lk1hcGJveEFkZHJlc3NNaW5pbWFwW2FyaWEtaGlkZGVuPXRydWVde2Rpc3BsYXk6bm9uZX0uTWluaW1hcEltYWdlQ29udGFpbmVye2JvcmRlci1yYWRpdXM6dmFyKC0tYm9yZGVyUmFkaXVzKTtvdmVyZmxvdzpoaWRkZW59Lk1pbmltYXBJbWFnZXtoZWlnaHQ6dW5zZXQ7bWF4LWhlaWdodDp1bnNldDttYXgtd2lkdGg6dW5zZXQ7cG9zaXRpb246cmVsYXRpdmU7d2lkdGg6dW5zZXR9Lk1pbmltYXBJbm5lckZyYW1le2JvcmRlcjp2YXIoLS1ib3JkZXIpO2JvcmRlci1yYWRpdXM6aW5oZXJpdDtoZWlnaHQ6aW5oZXJpdDtsZWZ0OjA7b3ZlcmZsb3c6aGlkZGVuO3Bvc2l0aW9uOmFic29sdXRlO3RvcDowO3dpZHRoOmluaGVyaXR9Lk1pbmltYXBNYXJrZXJ7bGVmdDo1MCU7cG9zaXRpb246YWJzb2x1dGU7dG9wOjUwJX0uTWluaW1hcE1hcmtlcj5zdmd7Y29sb3I6dmFyKC0tY29sb3JQcmltYXJ5KTtkaXNwbGF5OmJsb2NrIWltcG9ydGFudH0uTWluaW1hcEF0dHJpYnV0aW9uTG9nb3tib3R0b206MDtsZWZ0OjA7bWFyZ2luOjAgMCA2cHggNnB4O3Bvc2l0aW9uOmFic29sdXRlfS5NaW5pbWFwQXR0cmlidXRpb25Mb2dvIGF7Y3Vyc29yOnBvaW50ZXI7ZGlzcGxheTpibG9jaztoZWlnaHQ6MjNweDt3aWR0aDo4OHB4fS5NaW5pbWFwQXR0cmlidXRpb25UZXh0e2JhY2tncm91bmQtY29sb3I6aHNsYSgwLDAlLDEwMCUsLjY1KTtib3R0b206MDtmb250OjExcHgvMTZweCBIZWx2ZXRpY2EgTmV1ZSxBcmlhbCxIZWx2ZXRpY2Esc2Fucy1zZXJpZjtwYWRkaW5nOjAgNXB4O3Bvc2l0aW9uOmFic29sdXRlO3JpZ2h0OjB9Lk1pbmltYXBBdHRyaWJ1dGlvblRleHQgYXtjb2xvcjpyZ2JhKDAsMCwwLC43NSk7dGV4dC1kZWNvcmF0aW9uOm5vbmV9Lk1pbmltYXBBdHRyaWJ1dGlvblRleHQgYTpob3Zlcntjb2xvcjppbmhlcml0O3RleHQtZGVjb3JhdGlvbjp1bmRlcmxpbmV9Lk1pbmltYXBBdHRyaWJ1dGlvblRleHQgYTpub3QoOmZpcnN0LWNoaWxkKXttYXJnaW4tbGVmdDozcHh9Lk1pbmltYXBTdHlsZVRvZ2dsZXtiYWNrZ3JvdW5kLXBvc2l0aW9uOjA7YmFja2dyb3VuZC1yZXBlYXQ6bm8tcmVwZWF0O2JhY2tncm91bmQtc2l6ZTpjb250YWluO2JvcmRlcjoycHggc29saWQgI2ZmZjtib3JkZXItcmFkaXVzOjNweDtib3gtc2hhZG93OnZhcigtLWJveFNoYWRvdyk7Y3Vyc29yOnBvaW50ZXI7aGVpZ2h0OjJlbTtwb3NpdGlvbjphYnNvbHV0ZTtyaWdodDp2YXIoLS1zcGFjaW5nKTt0b3A6dmFyKC0tc3BhY2luZyk7d2lkdGg6MmVtfS5NaW5pbWFwRm9vdGVye2NvbG9yOnZhcigtLWNvbG9yU2Vjb25kYXJ5KTtmb250LWZhbWlseTp2YXIoLS1mb250RmFtaWx5KTtmb250LXNpemU6dmFyKC0tdW5pdCk7bWFyZ2luLXRvcDp2YXIoLS1zcGFjaW5nKX0uTWluaW1hcEZvb3RlclthcmlhLWhpZGRlbj10cnVlXXtkaXNwbGF5Om5vbmV9Lk1pbmltYXBFZGl0QnV0dG9uc3tib3R0b206MjZweDtkaXNwbGF5OmZsZXg7Zm9udC1mYW1pbHk6dmFyKC0tZm9udEZhbWlseSk7cG9zaXRpb246YWJzb2x1dGU7cmlnaHQ6dmFyKC0tc3BhY2luZyl9Lk1pbmltYXBFZGl0QnV0dG9ucyAuQnV0dG9ue2JveC1zaGFkb3c6dmFyKC0tYm94U2hhZG93KX0uTWluaW1hcEJ1dHRvbkNhbmNlbHtiYWNrZ3JvdW5kLWNvbG9yOnZhcigtLWNvbG9yQmFja2dyb3VuZCk7bWFyZ2luLWxlZnQ6dmFyKC0tc3BhY2luZyl9LmRyYWdnYWJsZXtjdXJzb3I6bW92ZTtjdXJzb3I6Z3JhYn0uZHJhZ2dhYmxlOmFjdGl2ZXtjdXJzb3I6Z3JhYmJpbmd9XCI7XG5cbi8vIHNyYy9NYXBib3hIVE1MRXZlbnQudHNcbnZhciBNYXBib3hIVE1MRXZlbnQgPSBjbGFzcyBleHRlbmRzIEN1c3RvbUV2ZW50IHtcbiAgY29uc3RydWN0b3IodHlwZSwgZGV0YWlsKSB7XG4gICAgc3VwZXIodHlwZSwge1xuICAgICAgY29tcG9zZWQ6IHRydWUsXG4gICAgICBkZXRhaWxcbiAgICB9KTtcbiAgfVxuICBjbG9uZShuZXdUYXJnZXQpIHtcbiAgICBjb25zdCBldmVudENsb25lID0gbmV3IE1hcGJveEhUTUxFdmVudCh0aGlzLnR5cGUsIHRoaXMuZGV0YWlsKTtcbiAgICBpZiAobmV3VGFyZ2V0KSB7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXZlbnRDbG9uZSwgXCJ0YXJnZXRcIiwgeyB2YWx1ZTogbmV3VGFyZ2V0IH0pO1xuICAgIH1cbiAgICByZXR1cm4gZXZlbnRDbG9uZTtcbiAgfVxufTtcblxuLy8gc3JjL3V0aWxzL2FyaWEvbWVzc2FnZXMudHNcbnZhciBMRU5HVEhfTUVTU0FHRSA9IFwiVHlwZSBpbiAyIG9yIG1vcmUgY2hhcmFjdGVycyBmb3IgcmVzdWx0cy5cIjtcbnZhciBLRVlCT0FSRF9OQVZJR0FUSU9OX0dVSURFX01FU1NBR0UgPSBcIldoZW4gYXV0b2NvbXBsZXRlIHJlc3VsdHMgYXJlIGF2YWlsYWJsZSB1c2UgdXAgYW5kIGRvd24gYXJyb3dzIHRvIHJldmlldyBhbmQgZW50ZXIgdG8gc2VsZWN0LiBUb3VjaCBkZXZpY2UgdXNlcnMsIGV4cGxvcmUgYnkgdG91Y2ggb3Igd2l0aCBzd2lwZSBnZXN0dXJlcy5cIjtcbnZhciBOT19TRUFSQ0hfUkVTVUxUU19NRVNTQUdFID0gXCJObyBzZWFyY2ggcmVzdWx0cy5cIjtcbnZhciBnZXRTdWdnZXN0aW9uU2VsZWN0ZWRNZXNzYWdlID0gKGFkZHJlc3MsIG51bWJlck9mUmVzdWx0cywgY3VycmVudEluZGV4KSA9PiBgJHtudW1iZXJPZlJlc3VsdHN9ICR7bnVtYmVyT2ZSZXN1bHRzID09PSAxID8gXCJyZXN1bHQgaXNcIiA6IFwicmVzdWx0cyBhcmVcIn0gYXZhaWxhYmxlLiAke2FkZHJlc3N9LiAke2N1cnJlbnRJbmRleH0gb2YgJHtudW1iZXJPZlJlc3VsdHN9IGlzIHNlbGVjdGVkLmA7XG52YXIgZ2V0U3VnZ2VzdGlvbnNSZWFkeU1lc3NhZ2UgPSAobnVtYmVyT2ZSZXN1bHRzKSA9PiBgJHtudW1iZXJPZlJlc3VsdHN9ICR7bnVtYmVyT2ZSZXN1bHRzID09PSAxID8gXCJyZXN1bHQgaXNcIiA6IFwicmVzdWx0cyBhcmVcIn0gYXZhaWxhYmxlLiBVc2UgdXAgYW5kIGRvd24gYXJyb3dzIHRvIHJldmlldyBhbmQgZW50ZXIgdG8gc2VsZWN0LiBUb3VjaCBkZXZpY2UgdXNlcnMsIGV4cGxvcmUgYnkgdG91Y2ggb3Igd2l0aCBzd2lwZSBnZXN0dXJlcy5gO1xuXG4vLyBzcmMvdXRpbHMvYXJpYS9pbmRleC50c1xuZnVuY3Rpb24gYXJpYUJ1dHRvbktleURvd24oZSkge1xuICBjb25zdCBlbCA9IGUuY3VycmVudFRhcmdldDtcbiAgaWYgKGUua2V5ID09PSBcIiBcIiB8fCBlLmtleSA9PT0gXCJFbnRlclwiKSB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgZWwuZGlzcGF0Y2hFdmVudChuZXcgTW91c2VFdmVudChcImNsaWNrXCIsIHtcbiAgICAgIGJ1YmJsZXM6IHRydWUsXG4gICAgICBjb21wb3NlZDogdHJ1ZVxuICAgIH0pKTtcbiAgfVxufVxudmFyIEFSSUFfREVTQ1JJUFRJT05fSUQgPSBcInNlYXJjaC1saXN0Ym94X19kZXNjcmlwdGlvblwiO1xudmFyIGNyZWF0ZUFyaWFMaXZlRWxlbWVudCA9IChzZWVkKSA9PiB7XG4gIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIGNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoXCJhcmlhLWxpdmVcIiwgXCJwb2xpdGVcIik7XG4gIGNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoXCJhcmlhLWF0b21pY1wiLCBcInRydWVcIik7XG4gIGNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoXCJyb2xlXCIsIFwic3RhdHVzXCIpO1xuICBjb250YWluZXIuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJib3JkZXI6IDBweDtjbGlwOiByZWN0KDBweCwgMHB4LCAwcHgsIDBweCk7aGVpZ2h0OiAxcHg7bWFyZ2luLWJvdHRvbTogLTFweDttYXJnaW4tcmlnaHQ6IC0xcHg7b3ZlcmZsb3c6IGhpZGRlbjtwYWRkaW5nOiAwcHg7cG9zaXRpb246IGFic29sdXRlO3doaXRlLXNwYWNlOiBub3dyYXA7d2lkdGg6IDFweDtcIik7XG4gIGNvbnN0IGRlc2NyaXB0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgZGVzY3JpcHRpb24uc2V0QXR0cmlidXRlKFwiaWRcIiwgYCR7c2VlZH0tLSR7QVJJQV9ERVNDUklQVElPTl9JRH1gKTtcbiAgY29udGFpbmVyLmFwcGVuZENoaWxkKGRlc2NyaXB0aW9uKTtcbiAgcmV0dXJuIGNvbnRhaW5lcjtcbn07XG52YXIgc2V0TGl2ZVJlZ2lvbk1lc3NhZ2UgPSAobWVzc2FnZSwgc2VlZCkgPT4ge1xuICB2YXIgX2E7XG4gIGNvbnN0IGRlc2NyaXB0aW9uID0gKF9hID0gZG9jdW1lbnQuYm9keS5xdWVyeVNlbGVjdG9yKGBbaWQ9XCIke3NlZWR9LS0ke0FSSUFfREVTQ1JJUFRJT05fSUR9XCJdYCkpICE9IG51bGwgPyBfYSA6IG51bGw7XG4gIGlmIChkZXNjcmlwdGlvbikge1xuICAgIGRlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gbWVzc2FnZTtcbiAgfVxufTtcbnZhciBzdXBwcmVzc0V4dGVuc2lvbnNBdXRvY29tcGxldGUgPSAoaW5wdXQpID0+IHtcbiAgaW5wdXQubmFtZSA9IGlucHV0Lm5hbWUgKyBcIiBhZGRyZXNzLXNlYXJjaFwiO1xuICBpbnB1dC5zZXRBdHRyaWJ1dGUoXCJkYXRhLWxwaWdub3JlXCIsIFwidHJ1ZVwiKTtcbn07XG52YXIgZ2V0QXJpYU1lc3NhZ2UgPSAoc2VhcmNoVmFsdWUsIHN1Z2dlc3Rpb25zLCBzZWxlY3RlZEluZGV4KSA9PiB7XG4gIGxldCBhcmlhTWVzc2FnZSA9IG51bGw7XG4gIGNvbnN0IG5vUmVzdWx0cyA9ICFzdWdnZXN0aW9ucyB8fCBzdWdnZXN0aW9ucy5sZW5ndGggPT09IDA7XG4gIGlmICgoc2VhcmNoVmFsdWUgPT0gbnVsbCA/IHZvaWQgMCA6IHNlYXJjaFZhbHVlLmxlbmd0aCkgPCAyKSB7XG4gICAgYXJpYU1lc3NhZ2UgPSBMRU5HVEhfTUVTU0FHRSArIFwiIFwiICsgS0VZQk9BUkRfTkFWSUdBVElPTl9HVUlERV9NRVNTQUdFO1xuICB9IGVsc2UgaWYgKG5vUmVzdWx0cykge1xuICAgIGFyaWFNZXNzYWdlID0gTk9fU0VBUkNIX1JFU1VMVFNfTUVTU0FHRTtcbiAgfSBlbHNlIGlmIChzZWxlY3RlZEluZGV4ICE9PSB2b2lkIDApIHtcbiAgICBjb25zdCBzdWdnZXN0aW9uID0gc3VnZ2VzdGlvbnNbc2VsZWN0ZWRJbmRleF07XG4gICAgY29uc3QgcGxhY2VOYW1lID0gc3VnZ2VzdGlvbi5uYW1lIHx8IHN1Z2dlc3Rpb24uZmVhdHVyZV9uYW1lIHx8IHN1Z2dlc3Rpb24ucHJvcGVydGllcy5uYW1lO1xuICAgIGFyaWFNZXNzYWdlID0gZ2V0U3VnZ2VzdGlvblNlbGVjdGVkTWVzc2FnZShwbGFjZU5hbWUsIHN1Z2dlc3Rpb25zLmxlbmd0aCwgc2VsZWN0ZWRJbmRleCArIDEpO1xuICB9IGVsc2Uge1xuICAgIGFyaWFNZXNzYWdlID0gZ2V0U3VnZ2VzdGlvbnNSZWFkeU1lc3NhZ2Uoc3VnZ2VzdGlvbnMubGVuZ3RoKTtcbiAgfVxuICByZXR1cm4gYXJpYU1lc3NhZ2U7XG59O1xuXG4vLyBzcmMvdXRpbHMvbGlzdGJveC50c1xudmFyIGdldFN1Z2dlc3Rpb25UaXRsZSA9IChpdGVtLCBzZXJ2aWNlKSA9PiB7XG4gIHN3aXRjaCAoc2VydmljZSkge1xuICAgIGNhc2UgMCAvKiBBZGRyZXNzQXV0b2ZpbGwgKi86XG4gICAgICByZXR1cm4gaXRlbS5tYXRjaGluZ19uYW1lIHx8IGl0ZW0uZmVhdHVyZV9uYW1lIHx8IGl0ZW0uYWRkcmVzc19saW5lMTtcbiAgICBjYXNlIDIgLyogU2VhcmNoQm94ICovOlxuICAgICAgcmV0dXJuIGl0ZW0ubmFtZTtcbiAgICBjYXNlIDEgLyogR2VvY29kaW5nICovOlxuICAgICAgcmV0dXJuIGl0ZW0ucHJvcGVydGllcy5uYW1lO1xuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gXCJcIjtcbiAgfVxufTtcbnZhciBidWlsZFN1Z2dlc3Rpb25EZXNjcmlwdGlvbiA9IChpdGVtLCBzZXJ2aWNlKSA9PiB7XG4gIHN3aXRjaCAoc2VydmljZSkge1xuICAgIGNhc2UgMCAvKiBBZGRyZXNzQXV0b2ZpbGwgKi86XG4gICAgICByZXR1cm4gaXRlbS5kZXNjcmlwdGlvbjtcbiAgICBjYXNlIDIgLyogU2VhcmNoQm94ICovOlxuICAgICAgaWYgKGl0ZW0uZmVhdHVyZV90eXBlID09PSBcInBvaVwiKSB7XG4gICAgICAgIHJldHVybiBpdGVtLmZ1bGxfYWRkcmVzcztcbiAgICAgIH1cbiAgICAgIHJldHVybiBpdGVtLnBsYWNlX2Zvcm1hdHRlZDtcbiAgICBjYXNlIDEgLyogR2VvY29kaW5nICovOlxuICAgICAgcmV0dXJuIGl0ZW0ucHJvcGVydGllcy5wbGFjZV9mb3JtYXR0ZWQ7XG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybiBcIlwiO1xuICB9XG59O1xuXG4vLyBzcmMvY29tcG9uZW50cy9NYXBib3hTZWFyY2hMaXN0Ym94LnRzXG5mdW5jdGlvbiBnZXRBcmlhSWRGb3JTdWdnZXN0aW9uKHJlc3VsdExpc3RJZCwgaSkge1xuICByZXR1cm4gYCR7cmVzdWx0TGlzdElkfS0ke2l9YDtcbn1cbnZhciBfcG9wb3ZlciwgX2JpbmRpbmcsIF9sYWJlbElELCBfcmVzdWx0TGlzdElELCBfaW5wdXRJbnRlcm5hbCwgX3NlYXJjaFNlcnZpY2UsIF9zZWxlY3RlZEluZGV4SW50ZXJuYWwsIF9zaG93UmVzdWx0cywgc2hvd1Jlc3VsdHNfZm4sIF9yZW5kZXJSZXN1bHRzTGlzdCwgcmVuZGVyUmVzdWx0c0xpc3RfZm4sIF90aGVtZUludGVybmFsLCBfcG9wb3Zlck9wdGlvbnMsIF9oYW5kbGVJbnB1dCwgX2hhbmRsZVNlbGVjdCwgX2hhbmRsZUZvY3VzLCBfaGFuZGxlQmx1ciwgX2hhbmRsZUtleURvd247XG52YXIgTWFwYm94U2VhcmNoTGlzdGJveCA9IGNsYXNzIGV4dGVuZHMgSFRNTFNjb3BlZEVsZW1lbnQge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlciguLi5hcmd1bWVudHMpO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfc2hvd1Jlc3VsdHMpO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfcmVuZGVyUmVzdWx0c0xpc3QpO1xuICAgIHRoaXMuc3VnZ2VzdGlvbnMgPSBudWxsO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfcG9wb3ZlciwgbnVsbCk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9iaW5kaW5nLCB2b2lkIDApO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfbGFiZWxJRCwgdm9pZCAwKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX3Jlc3VsdExpc3RJRCwgdm9pZCAwKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX2lucHV0SW50ZXJuYWwsIHZvaWQgMCk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9zZWFyY2hTZXJ2aWNlLCBudWxsKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX3NlbGVjdGVkSW5kZXhJbnRlcm5hbCwgdm9pZCAwKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX3RoZW1lSW50ZXJuYWwsIHt9KTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX3BvcG92ZXJPcHRpb25zLCB7fSk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9oYW5kbGVJbnB1dCwgKGUpID0+IHtcbiAgICAgIGNvbnN0IHsgUmVzdWx0cyB9ID0gX19wcml2YXRlR2V0KHRoaXMsIF9iaW5kaW5nKTtcbiAgICAgIGNvbnN0IGlucHV0ID0gZS50YXJnZXQ7XG4gICAgICBpZiAoaW5wdXQuZGF0YXNldFtcIm1hcGJveFN1Y2Nlc3NcIl0pIHtcbiAgICAgICAgZGVsZXRlIGlucHV0LmRhdGFzZXRbXCJtYXBib3hTdWNjZXNzXCJdO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjb25zdCBzZWFyY2hUZXh0ID0gaW5wdXQudmFsdWU7XG4gICAgICB0aGlzLnJlbmRlckFyaWFNZXNzYWdlKCk7XG4gICAgICBSZXN1bHRzLnNldEF0dHJpYnV0ZShcImFyaWEtYnVzeVwiLCBcInRydWVcIik7XG4gICAgICB0aGlzLmRpc3BhdGNoRXZlbnQobmV3IE1hcGJveEhUTUxFdmVudChcImlucHV0XCIsIHNlYXJjaFRleHQpKTtcbiAgICB9KTtcbiAgICB0aGlzLnJlbmRlckFyaWFNZXNzYWdlID0gKCkgPT4ge1xuICAgICAgdmFyIF9hO1xuICAgICAgY29uc3QgbWVzc2FnZSA9IGdldEFyaWFNZXNzYWdlKChfYSA9IHRoaXMuaW5wdXQpID09IG51bGwgPyB2b2lkIDAgOiBfYS52YWx1ZSwgdGhpcy5zdWdnZXN0aW9ucywgdGhpcy5zZWxlY3RlZEluZGV4KTtcbiAgICAgIHNldExpdmVSZWdpb25NZXNzYWdlKG1lc3NhZ2UsIHRoaXMuZGF0YXNldC5zZWVkKTtcbiAgICB9O1xuICAgIHRoaXMuY2xlYXJBcmlhTWVzc2FnZSA9ICgpID0+IHtcbiAgICAgIHNldExpdmVSZWdpb25NZXNzYWdlKFwiXCIsIHRoaXMuZGF0YXNldC5zZWVkKTtcbiAgICB9O1xuICAgIHRoaXMuaGFuZGxlU3VnZ2VzdCA9IChzdWdnZXN0aW9ucykgPT4ge1xuICAgICAgdGhpcy5zdWdnZXN0aW9ucyA9IHN1Z2dlc3Rpb25zO1xuICAgICAgaWYgKCFzdWdnZXN0aW9ucyB8fCBzdWdnZXN0aW9ucy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgdGhpcy5yZW5kZXJBcmlhTWVzc2FnZSgpO1xuICAgICAgfVxuICAgICAgaWYgKCFzdWdnZXN0aW9ucykge1xuICAgICAgICB0aGlzLmhpZGVSZXN1bHRzKCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIF9fcHJpdmF0ZU1ldGhvZCh0aGlzLCBfcmVuZGVyUmVzdWx0c0xpc3QsIHJlbmRlclJlc3VsdHNMaXN0X2ZuKS5jYWxsKHRoaXMpO1xuICAgICAgaWYgKHN1Z2dlc3Rpb25zLmxlbmd0aCkge1xuICAgICAgICBfX3ByaXZhdGVNZXRob2QodGhpcywgX3Nob3dSZXN1bHRzLCBzaG93UmVzdWx0c19mbikuY2FsbCh0aGlzKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHsgUmVzdWx0cyB9ID0gX19wcml2YXRlR2V0KHRoaXMsIF9iaW5kaW5nKTtcbiAgICAgIFJlc3VsdHMuc2V0QXR0cmlidXRlKFwiYXJpYS1idXN5XCIsIFwiZmFsc2VcIik7XG4gICAgfTtcbiAgICB0aGlzLmhhbmRsZUVycm9yID0gKCkgPT4ge1xuICAgICAgY29uc3QgeyBSZXN1bHRzIH0gPSBfX3ByaXZhdGVHZXQodGhpcywgX2JpbmRpbmcpO1xuICAgICAgUmVzdWx0cy5zZXRBdHRyaWJ1dGUoXCJhcmlhLWJ1c3lcIiwgXCJmYWxzZVwiKTtcbiAgICAgIHRoaXMuaGlkZVJlc3VsdHMoKTtcbiAgICB9O1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfaGFuZGxlU2VsZWN0LCAoc3VnZ2VzdGlvbikgPT4gX19hc3luYyh0aGlzLCBudWxsLCBmdW5jdGlvbiogKCkge1xuICAgICAgY29uc3QgaW5wdXQgPSB0aGlzLmlucHV0O1xuICAgICAgaWYgKGlucHV0KSB7XG4gICAgICAgIGlucHV0LmRhdGFzZXRbXCJtYXBib3hTdWNjZXNzXCJdID0gXCJ0cnVlXCI7XG4gICAgICB9XG4gICAgICB0aGlzLmRpc3BhdGNoRXZlbnQobmV3IE1hcGJveEhUTUxFdmVudChcInNlbGVjdFwiLCBzdWdnZXN0aW9uKSk7XG4gICAgICB0aGlzLmhpZGVSZXN1bHRzKCk7XG4gICAgfSkpO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfaGFuZGxlRm9jdXMsICgpID0+IHtcbiAgICAgIGNvbnN0IGlucHV0ID0gdGhpcy5pbnB1dDtcbiAgICAgIGRlbGV0ZSBpbnB1dC5kYXRhc2V0W1wibWFwYm94U3VjY2Vzc1wiXTtcbiAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChuZXcgTWFwYm94SFRNTEV2ZW50KFwiZm9jdXNcIikpO1xuICAgICAgdGhpcy5yZW5kZXJBcmlhTWVzc2FnZSgpO1xuICAgICAgX19wcml2YXRlTWV0aG9kKHRoaXMsIF9zaG93UmVzdWx0cywgc2hvd1Jlc3VsdHNfZm4pLmNhbGwodGhpcyk7XG4gICAgfSk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9oYW5kbGVCbHVyLCAoKSA9PiB7XG4gICAgICBpZiAoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCA9PT0gdGhpcy5pbnB1dCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB0aGlzLmRpc3BhdGNoRXZlbnQobmV3IE1hcGJveEhUTUxFdmVudChcImJsdXJcIikpO1xuICAgICAgdGhpcy5jbGVhckFyaWFNZXNzYWdlKCk7XG4gICAgICB0aGlzLmhpZGVSZXN1bHRzKCk7XG4gICAgfSk7XG4gICAgdGhpcy5oYW5kbGVBcnJvd1VwID0gKCkgPT4ge1xuICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRJbmRleCA9PT0gdm9pZCAwKSB7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWRJbmRleCA9IHRoaXMuc3VnZ2VzdGlvbnMubGVuZ3RoIC0gMTtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5zZWxlY3RlZEluZGV4ID09PSAwKSB7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWRJbmRleCA9IHZvaWQgMDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWRJbmRleCA9IE1hdGgubWF4KDAsIHRoaXMuc2VsZWN0ZWRJbmRleCAtIDEpO1xuICAgICAgfVxuICAgIH07XG4gICAgdGhpcy5oYW5kbGVBcnJvd0Rvd24gPSAoKSA9PiB7XG4gICAgICBpZiAodGhpcy5zZWxlY3RlZEluZGV4ID09PSB2b2lkIDApIHtcbiAgICAgICAgdGhpcy5zZWxlY3RlZEluZGV4ID0gMDtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5zZWxlY3RlZEluZGV4ID09PSB0aGlzLnN1Z2dlc3Rpb25zLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgdGhpcy5zZWxlY3RlZEluZGV4ID0gdm9pZCAwO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5zZWxlY3RlZEluZGV4ID0gTWF0aC5taW4odGhpcy5zZWxlY3RlZEluZGV4ICsgMSwgdGhpcy5zdWdnZXN0aW9ucy5sZW5ndGggLSAxKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfaGFuZGxlS2V5RG93biwgKGUpID0+IHtcbiAgICAgIHZhciBfYTtcbiAgICAgIGlmICghKChfYSA9IHRoaXMuc3VnZ2VzdGlvbnMpID09IG51bGwgPyB2b2lkIDAgOiBfYS5sZW5ndGgpKVxuICAgICAgICByZXR1cm47XG4gICAgICBpZiAoZS5rZXkgPT09IFwiQXJyb3dEb3duXCIpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB0aGlzLmhhbmRsZUFycm93RG93bigpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAoZS5rZXkgPT09IFwiQXJyb3dVcFwiKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgdGhpcy5oYW5kbGVBcnJvd1VwKCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmIChlLmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgICB0aGlzLmhpZGVSZXN1bHRzKCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLnNlbGVjdGVkSW5kZXggPT09IHZvaWQgMCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAoZS5rZXkgPT09IFwiVGFiXCIpIHtcbiAgICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF9oYW5kbGVTZWxlY3QpLmNhbGwodGhpcywgdGhpcy5zdWdnZXN0aW9uc1t0aGlzLnNlbGVjdGVkSW5kZXhdKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKGUua2V5ID09PSBcIkVudGVyXCIpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBfX3ByaXZhdGVHZXQodGhpcywgX2hhbmRsZVNlbGVjdCkuY2FsbCh0aGlzLCB0aGlzLnN1Z2dlc3Rpb25zW3RoaXMuc2VsZWN0ZWRJbmRleF0pO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbiAgZ2V0IHRlbXBsYXRlKCkge1xuICAgIHJldHVybiBMSVNUQk9YX1RFTVBMQVRFO1xuICB9XG4gIGdldCB0ZW1wbGF0ZVN0eWxlKCkge1xuICAgIHJldHVybiBzdHlsZV9kZWZhdWx0O1xuICB9XG4gIGdldCB0ZW1wbGF0ZVVzZXJTdHlsZSgpIHtcbiAgICByZXR1cm4gZ2V0VGhlbWVDU1MoXCIuTWFwYm94U2VhcmNoXCIsIHRoaXMudGhlbWUpO1xuICB9XG4gIGdldCBpbnB1dCgpIHtcbiAgICByZXR1cm4gX19wcml2YXRlR2V0KHRoaXMsIF9pbnB1dEludGVybmFsKTtcbiAgfVxuICBzZXQgaW5wdXQobmV3SW5wdXQpIHtcbiAgICBjb25zdCBvbGRJbnB1dCA9IF9fcHJpdmF0ZUdldCh0aGlzLCBfaW5wdXRJbnRlcm5hbCk7XG4gICAgaWYgKG9sZElucHV0KSB7XG4gICAgICBvbGRJbnB1dC5yZW1vdmVFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgX19wcml2YXRlR2V0KHRoaXMsIF9oYW5kbGVJbnB1dCkpO1xuICAgICAgb2xkSW5wdXQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImZvY3VzXCIsIF9fcHJpdmF0ZUdldCh0aGlzLCBfaGFuZGxlRm9jdXMpKTtcbiAgICAgIG9sZElucHV0LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJibHVyXCIsIF9fcHJpdmF0ZUdldCh0aGlzLCBfaGFuZGxlQmx1cikpO1xuICAgICAgb2xkSW5wdXQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgX19wcml2YXRlR2V0KHRoaXMsIF9oYW5kbGVLZXlEb3duKSk7XG4gICAgICBpZiAoX19wcml2YXRlR2V0KHRoaXMsIF9wb3BvdmVyKSkge1xuICAgICAgICBfX3ByaXZhdGVHZXQodGhpcywgX3BvcG92ZXIpLmRlc3Ryb3koKTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKG5ld0lucHV0KSB7XG4gICAgICBuZXdJbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgX19wcml2YXRlR2V0KHRoaXMsIF9oYW5kbGVJbnB1dCkpO1xuICAgICAgbmV3SW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImZvY3VzXCIsIF9fcHJpdmF0ZUdldCh0aGlzLCBfaGFuZGxlRm9jdXMpKTtcbiAgICAgIG5ld0lucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJibHVyXCIsIF9fcHJpdmF0ZUdldCh0aGlzLCBfaGFuZGxlQmx1cikpO1xuICAgICAgbmV3SW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgX19wcml2YXRlR2V0KHRoaXMsIF9oYW5kbGVLZXlEb3duKSk7XG4gICAgICBuZXdJbnB1dC5zZXRBdHRyaWJ1dGUoXCJyb2xlXCIsIFwiY29tYm9ib3hcIik7XG4gICAgICBuZXdJbnB1dC5zZXRBdHRyaWJ1dGUoXCJhcmlhLWF1dG9jb21wbGV0ZVwiLCBcImxpc3RcIik7XG4gICAgICBuZXdJbnB1dC5zZXRBdHRyaWJ1dGUoXCJhcmlhLWNvbnRyb2xzXCIsIF9fcHJpdmF0ZUdldCh0aGlzLCBfcmVzdWx0TGlzdElEKSk7XG4gICAgICBpZiAodGhpcy5pc0Nvbm5lY3RlZCkge1xuICAgICAgICBfX3ByaXZhdGVTZXQodGhpcywgX3BvcG92ZXIsIG5ldyBQb3BvdmVyKG5ld0lucHV0LCBfX3ByaXZhdGVHZXQodGhpcywgX2JpbmRpbmcpLlJlc3VsdHMsIHRoaXMucG9wb3Zlck9wdGlvbnMpKTtcbiAgICAgIH1cbiAgICB9XG4gICAgX19wcml2YXRlU2V0KHRoaXMsIF9pbnB1dEludGVybmFsLCBuZXdJbnB1dCk7XG4gIH1cbiAgZ2V0IHNlYXJjaFNlcnZpY2UoKSB7XG4gICAgcmV0dXJuIF9fcHJpdmF0ZUdldCh0aGlzLCBfc2VhcmNoU2VydmljZSk7XG4gIH1cbiAgc2V0IHNlYXJjaFNlcnZpY2Uoc2VydmljZSkge1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfc2VhcmNoU2VydmljZSwgc2VydmljZSk7XG4gIH1cbiAgZ2V0IHNlbGVjdGVkSW5kZXgoKSB7XG4gICAgcmV0dXJuIF9fcHJpdmF0ZUdldCh0aGlzLCBfc2VsZWN0ZWRJbmRleEludGVybmFsKTtcbiAgfVxuICBzZXQgc2VsZWN0ZWRJbmRleChuZXdJbmRleCkge1xuICAgIGNvbnN0IG9sZEluZGV4ID0gX19wcml2YXRlR2V0KHRoaXMsIF9zZWxlY3RlZEluZGV4SW50ZXJuYWwpO1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfc2VsZWN0ZWRJbmRleEludGVybmFsLCBuZXdJbmRleCk7XG4gICAgY29uc3QgeyBSZXN1bHRzTGlzdCB9ID0gX19wcml2YXRlR2V0KHRoaXMsIF9iaW5kaW5nKTtcbiAgICBjb25zdCBpZCA9IGdldEFyaWFJZEZvclN1Z2dlc3Rpb24oX19wcml2YXRlR2V0KHRoaXMsIF9yZXN1bHRMaXN0SUQpLCBuZXdJbmRleCk7XG4gICAgaWYgKG5ld0luZGV4ICE9PSB2b2lkIDApIHtcbiAgICAgIHRoaXMuaW5wdXQuc2V0QXR0cmlidXRlKFwiYXJpYS1hY3RpdmVkZXNjZW5kYW50XCIsIGlkKTtcbiAgICAgIFJlc3VsdHNMaXN0LnNldEF0dHJpYnV0ZShcImFyaWEtYWN0aXZlZGVzY2VuZGFudFwiLCBpZCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuaW5wdXQucmVtb3ZlQXR0cmlidXRlKFwiYXJpYS1hY3RpdmVkZXNjZW5kYW50XCIpO1xuICAgICAgUmVzdWx0c0xpc3QucmVtb3ZlQXR0cmlidXRlKFwiYXJpYS1hY3RpdmVkZXNjZW5kYW50XCIpO1xuICAgIH1cbiAgICBpZiAob2xkSW5kZXggIT09IG5ld0luZGV4KSB7XG4gICAgICBjb25zdCBvbGRJZCA9IGdldEFyaWFJZEZvclN1Z2dlc3Rpb24oX19wcml2YXRlR2V0KHRoaXMsIF9yZXN1bHRMaXN0SUQpLCBvbGRJbmRleCk7XG4gICAgICBjb25zdCBvbGRFbCA9IFJlc3VsdHNMaXN0LnF1ZXJ5U2VsZWN0b3IoYCMke29sZElkfWApO1xuICAgICAgb2xkRWwgPT0gbnVsbCA/IHZvaWQgMCA6IG9sZEVsLnJlbW92ZUF0dHJpYnV0ZShcImFyaWEtc2VsZWN0ZWRcIik7XG4gICAgICBvbGRFbCA9PSBudWxsID8gdm9pZCAwIDogb2xkRWwuc2V0QXR0cmlidXRlKFwidGFiaW5kZXhcIiwgXCItMVwiKTtcbiAgICAgIGlmIChuZXdJbmRleCAhPT0gdm9pZCAwKSB7XG4gICAgICAgIGNvbnN0IGVsID0gUmVzdWx0c0xpc3QucXVlcnlTZWxlY3RvcihgIyR7aWR9YCk7XG4gICAgICAgIGVsID09IG51bGwgPyB2b2lkIDAgOiBlbC5zZXRBdHRyaWJ1dGUoXCJhcmlhLXNlbGVjdGVkXCIsIFwidHJ1ZVwiKTtcbiAgICAgICAgZWwgPT0gbnVsbCA/IHZvaWQgMCA6IGVsLnNldEF0dHJpYnV0ZShcInRhYmluZGV4XCIsIFwiMFwiKTtcbiAgICAgIH1cbiAgICB9XG4gICAgdGhpcy5yZW5kZXJBcmlhTWVzc2FnZSgpO1xuICB9XG4gIGhpZGVSZXN1bHRzKCkge1xuICAgIGNvbnN0IHsgUmVzdWx0cywgUmVzdWx0c0xpc3QgfSA9IF9fcHJpdmF0ZUdldCh0aGlzLCBfYmluZGluZyk7XG4gICAgUmVzdWx0cy5zZXRBdHRyaWJ1dGUoXCJhcmlhLWhpZGRlblwiLCBcInRydWVcIik7XG4gICAgdGhpcy5pbnB1dC5zZXRBdHRyaWJ1dGUoXCJhcmlhLWV4cGFuZGVkXCIsIFwiZmFsc2VcIik7XG4gICAgUmVzdWx0c0xpc3QucmVtb3ZlQXR0cmlidXRlKFwiYXJpYS1hY3RpdmVkZXNjZW5kYW50XCIpO1xuICAgIHRoaXMuaW5wdXQucmVtb3ZlQXR0cmlidXRlKFwiYXJpYS1hY3RpdmVkZXNjZW5kYW50XCIpO1xuICB9XG4gIHJlbmRlckl0ZW0oaSkge1xuICAgIGNvbnN0IGVsZW1lbnQgPSB0aGlzLnByZXBhcmVUZW1wbGF0ZShMSVNUQk9YX1NVR0dFU1RJT05fVEVNUExBVEUpO1xuICAgIGVsZW1lbnQuaWQgPSBnZXRBcmlhSWRGb3JTdWdnZXN0aW9uKF9fcHJpdmF0ZUdldCh0aGlzLCBfcmVzdWx0TGlzdElEKSwgaSk7XG4gICAgcmV0dXJuIGVsZW1lbnQ7XG4gIH1cbiAgZmlsbEl0ZW0oZWwsIGl0ZW0sIGksIHRvdGFsTGVuZ3RoKSB7XG4gICAgY29uc3QgaWNvbkVsID0gZWwucXVlcnlTZWxlY3RvcignW2NsYXNzJD1cIlN1Z2dlc3Rpb25JY29uXCJdJyk7XG4gICAgY29uc3QgbmFtZUVsID0gZWwucXVlcnlTZWxlY3RvcignW2NsYXNzJD1cIlN1Z2dlc3Rpb25OYW1lXCJdJyk7XG4gICAgY29uc3QgZGVzY3JpcHRpb25FbCA9IGVsLnF1ZXJ5U2VsZWN0b3IoJ1tjbGFzcyQ9XCJTdWdnZXN0aW9uRGVzY1wiXScpO1xuICAgIGlmICh0aGlzLnNlYXJjaFNlcnZpY2UgPT09IDAgLyogQWRkcmVzc0F1dG9maWxsICovKSB7XG4gICAgICBpY29uRWwuaW5uZXJIVE1MID0gZ2V0SWNvbihpdGVtLmFjY3VyYWN5ID09PSBcInN0cmVldFwiID8gXCJzdHJlZXRcIiA6IFwiYWRkcmVzc01hcmtlclwiLCB0aGlzLnRoZW1lKTtcbiAgICAgIGljb25FbC5yZW1vdmVBdHRyaWJ1dGUoXCJhcmlhLWhpZGRlblwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWNvbkVsLnNldEF0dHJpYnV0ZShcImFyaWEtaGlkZGVuXCIsIFwidHJ1ZVwiKTtcbiAgICB9XG4gICAgbmFtZUVsLnRleHRDb250ZW50ID0gZGVzY3JpcHRpb25FbC50ZXh0Q29udGVudCA9IFwiXCI7XG4gICAgbmFtZUVsLnRleHRDb250ZW50ID0gZ2V0U3VnZ2VzdGlvblRpdGxlKGl0ZW0sIHRoaXMuc2VhcmNoU2VydmljZSk7XG4gICAgZGVzY3JpcHRpb25FbC50ZXh0Q29udGVudCA9IGJ1aWxkU3VnZ2VzdGlvbkRlc2NyaXB0aW9uKGl0ZW0sIHRoaXMuc2VhcmNoU2VydmljZSk7XG4gICAgaWYgKGkgPT09IHRoaXMuc2VsZWN0ZWRJbmRleCkge1xuICAgICAgZWwuc2V0QXR0cmlidXRlKFwiYXJpYS1zZWxlY3RlZFwiLCBcInRydWVcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIGVsLnJlbW92ZUF0dHJpYnV0ZShcImFyaWEtc2VsZWN0ZWRcIik7XG4gICAgfVxuICAgIGVsLnNldEF0dHJpYnV0ZShcImFyaWEtcG9zaW5zZXRcIiwgKGkgKyAxKS50b1N0cmluZygpKTtcbiAgICBlbC5zZXRBdHRyaWJ1dGUoXCJhcmlhLXNldHNpemVcIiwgdG90YWxMZW5ndGgudG9TdHJpbmcoKSk7XG4gIH1cbiAgZ2V0IHRoZW1lKCkge1xuICAgIHJldHVybiBfX3ByaXZhdGVHZXQodGhpcywgX3RoZW1lSW50ZXJuYWwpO1xuICB9XG4gIHNldCB0aGVtZSh0aGVtZSkge1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfdGhlbWVJbnRlcm5hbCwgdGhlbWUpO1xuICAgIGlmICghX19wcml2YXRlR2V0KHRoaXMsIF9iaW5kaW5nKSB8fCAhdGhlbWUpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy51cGRhdGVUZW1wbGF0ZVVzZXJTdHlsZShnZXRUaGVtZUNTUyhcIi5NYXBib3hTZWFyY2hcIiwgdGhlbWUpKTtcbiAgfVxuICBnZXQgcG9wb3Zlck9wdGlvbnMoKSB7XG4gICAgcmV0dXJuIF9fcHJpdmF0ZUdldCh0aGlzLCBfcG9wb3Zlck9wdGlvbnMpO1xuICB9XG4gIHNldCBwb3BvdmVyT3B0aW9ucyhuZXdPcHRpb25zKSB7XG4gICAgX19wcml2YXRlU2V0KHRoaXMsIF9wb3BvdmVyT3B0aW9ucywgbmV3T3B0aW9ucyk7XG4gICAgaWYgKF9fcHJpdmF0ZUdldCh0aGlzLCBfcG9wb3ZlcikpIHtcbiAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfcG9wb3Zlcikub3B0aW9ucyA9IG5ld09wdGlvbnM7XG4gICAgICBfX3ByaXZhdGVHZXQodGhpcywgX3BvcG92ZXIpLnVwZGF0ZSgpO1xuICAgIH1cbiAgfVxuICBjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICBzdXBlci5jb25uZWN0ZWRDYWxsYmFjaygpO1xuICAgIHRoaXMuZGF0YVNlZWQgPSB0aGlzLmRhdGFzZXQuc2VlZDtcbiAgICBfX3ByaXZhdGVTZXQodGhpcywgX2xhYmVsSUQsIHRoaXMuZGF0YXNldC5zZWVkICsgXCItTGFiZWxcIik7XG4gICAgX19wcml2YXRlU2V0KHRoaXMsIF9yZXN1bHRMaXN0SUQsIHRoaXMuZGF0YXNldC5zZWVkICsgXCItUmVzdWx0c0xpc3RcIik7XG4gICAgaWYgKHRoaXMuaW5wdXQpIHtcbiAgICAgIHRoaXMuaW5wdXQuc2V0QXR0cmlidXRlKFwiYXJpYS1jb250cm9sc1wiLCBfX3ByaXZhdGVHZXQodGhpcywgX3Jlc3VsdExpc3RJRCkpO1xuICAgIH1cbiAgICBfX3ByaXZhdGVTZXQodGhpcywgX2JpbmRpbmcsIGJpbmRFbGVtZW50cyh0aGlzLCB7XG4gICAgICBNYXBib3hTZWFyY2g6IFwiLk1hcGJveFNlYXJjaFwiLFxuICAgICAgUmVzdWx0czogXCIuUmVzdWx0c1wiLFxuICAgICAgUmVzdWx0c0xpc3Q6IFwiLlJlc3VsdHNMaXN0XCIsXG4gICAgICBMYWJlbDogXCIuTGFiZWxcIlxuICAgIH0pKTtcbiAgICBjb25zdCB7IFJlc3VsdHMsIFJlc3VsdHNMaXN0LCBMYWJlbCB9ID0gX19wcml2YXRlR2V0KHRoaXMsIF9iaW5kaW5nKTtcbiAgICBMYWJlbC5pZCA9IF9fcHJpdmF0ZUdldCh0aGlzLCBfbGFiZWxJRCk7XG4gICAgUmVzdWx0c0xpc3QuaWQgPSBfX3ByaXZhdGVHZXQodGhpcywgX3Jlc3VsdExpc3RJRCk7XG4gICAgUmVzdWx0c0xpc3Quc2V0QXR0cmlidXRlKFwiYXJpYS1sYWJlbGxlZGJ5XCIsIF9fcHJpdmF0ZUdldCh0aGlzLCBfbGFiZWxJRCkpO1xuICAgIFJlc3VsdHMuYWRkRXZlbnRMaXN0ZW5lcihcImJsdXJcIiwgX19wcml2YXRlR2V0KHRoaXMsIF9oYW5kbGVCbHVyKSk7XG4gICAgaWYgKCFfX3ByaXZhdGVHZXQodGhpcywgX3BvcG92ZXIpICYmIHRoaXMuaW5wdXQpIHtcbiAgICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfcG9wb3ZlciwgbmV3IFBvcG92ZXIodGhpcy5pbnB1dCwgX19wcml2YXRlR2V0KHRoaXMsIF9iaW5kaW5nKS5SZXN1bHRzLCB0aGlzLnBvcG92ZXJPcHRpb25zKSk7XG4gICAgfVxuICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7XG4gICAgICBpZiAoX19wcml2YXRlR2V0KHRoaXMsIF9wb3BvdmVyKSkge1xuICAgICAgICBfX3ByaXZhdGVHZXQodGhpcywgX3BvcG92ZXIpLnVwZGF0ZSgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG4gIGRpc2Nvbm5lY3RlZENhbGxiYWNrKCkge1xuICAgIHRoaXMuaW5wdXQgPSBudWxsO1xuICAgIGNvbnN0IHsgUmVzdWx0cyB9ID0gX19wcml2YXRlR2V0KHRoaXMsIF9iaW5kaW5nKTtcbiAgICBSZXN1bHRzLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJibHVyXCIsIF9fcHJpdmF0ZUdldCh0aGlzLCBfaGFuZGxlQmx1cikpO1xuICAgIGlmIChfX3ByaXZhdGVHZXQodGhpcywgX3BvcG92ZXIpKVxuICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF9wb3BvdmVyKS5kZXN0cm95KCk7XG4gIH1cbiAgZm9jdXMoKSB7XG4gICAgaWYgKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgPT09IHRoaXMuaW5wdXQpIHtcbiAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfaGFuZGxlRm9jdXMpLmNhbGwodGhpcyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuaW5wdXQuZm9jdXMoKTtcbiAgICB9XG4gIH1cbiAgYmx1cigpIHtcbiAgICB0aGlzLmlucHV0LmJsdXIoKTtcbiAgfVxuICB1cGRhdGVQb3BvdmVyKCkge1xuICAgIGlmIChfX3ByaXZhdGVHZXQodGhpcywgX3BvcG92ZXIpKSB7XG4gICAgICBfX3ByaXZhdGVHZXQodGhpcywgX3BvcG92ZXIpLnVwZGF0ZSgpO1xuICAgIH1cbiAgfVxufTtcbl9wb3BvdmVyID0gbmV3IFdlYWtNYXAoKTtcbl9iaW5kaW5nID0gbmV3IFdlYWtNYXAoKTtcbl9sYWJlbElEID0gbmV3IFdlYWtNYXAoKTtcbl9yZXN1bHRMaXN0SUQgPSBuZXcgV2Vha01hcCgpO1xuX2lucHV0SW50ZXJuYWwgPSBuZXcgV2Vha01hcCgpO1xuX3NlYXJjaFNlcnZpY2UgPSBuZXcgV2Vha01hcCgpO1xuX3NlbGVjdGVkSW5kZXhJbnRlcm5hbCA9IG5ldyBXZWFrTWFwKCk7XG5fc2hvd1Jlc3VsdHMgPSBuZXcgV2Vha1NldCgpO1xuc2hvd1Jlc3VsdHNfZm4gPSBmdW5jdGlvbigpIHtcbiAgaWYgKCF0aGlzLnN1Z2dlc3Rpb25zIHx8ICF0aGlzLnN1Z2dlc3Rpb25zLmxlbmd0aCkge1xuICAgIHJldHVybjtcbiAgfVxuICBjb25zdCB7IFJlc3VsdHMsIE1hcGJveFNlYXJjaCB9ID0gX19wcml2YXRlR2V0KHRoaXMsIF9iaW5kaW5nKTtcbiAgY29uc3QgcmVjdCA9IHRoaXMuaW5wdXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gIE1hcGJveFNlYXJjaC5zdHlsZS5zZXRQcm9wZXJ0eShcIi0td2lkdGhcIiwgYCR7cmVjdC53aWR0aH1weGApO1xuICBNYXBib3hTZWFyY2guc3R5bGUuc2V0UHJvcGVydHkoXCJkaXNwbGF5XCIsIFwiYmxvY2tcIik7XG4gIHRoaXMuaW5wdXQuc2V0QXR0cmlidXRlKFwiYXJpYS1leHBhbmRlZFwiLCBcInRydWVcIik7XG4gIFJlc3VsdHMucmVtb3ZlQXR0cmlidXRlKFwiYXJpYS1oaWRkZW5cIik7XG4gIHRoaXMuc2VsZWN0ZWRJbmRleCA9IHZvaWQgMDtcbn07XG5fcmVuZGVyUmVzdWx0c0xpc3QgPSBuZXcgV2Vha1NldCgpO1xucmVuZGVyUmVzdWx0c0xpc3RfZm4gPSBmdW5jdGlvbigpIHtcbiAgY29uc3QgeyBSZXN1bHRzTGlzdCB9ID0gX19wcml2YXRlR2V0KHRoaXMsIF9iaW5kaW5nKTtcbiAgaWYgKCF0aGlzLnN1Z2dlc3Rpb25zIHx8ICF0aGlzLnN1Z2dlc3Rpb25zLmxlbmd0aCkge1xuICAgIFJlc3VsdHNMaXN0LmlubmVySFRNTCA9IFwiXCI7XG4gICAgdGhpcy5oaWRlUmVzdWx0cygpO1xuICAgIHJldHVybjtcbiAgfVxuICBjb25zdCBlbGVtZW50cyA9IGdldENoaWxkRWxlbWVudHMoUmVzdWx0c0xpc3QpO1xuICBpZiAodGhpcy5zdWdnZXN0aW9ucy5sZW5ndGggPiBlbGVtZW50cy5sZW5ndGgpIHtcbiAgICBmb3IgKGxldCBpID0gZWxlbWVudHMubGVuZ3RoOyBpIDwgdGhpcy5zdWdnZXN0aW9ucy5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3QgaXRlbSA9IHRoaXMucmVuZGVySXRlbShpKTtcbiAgICAgIGVsZW1lbnRzLnB1c2goaXRlbSk7XG4gICAgICBpdGVtLm9ubW91c2VlbnRlciA9ICgpID0+IHtcbiAgICAgICAgdGhpcy5zZWxlY3RlZEluZGV4ID0gaTtcbiAgICAgIH07XG4gICAgICBpdGVtLm9ubW91c2VsZWF2ZSA9ICgpID0+IHtcbiAgICAgICAgdGhpcy5zZWxlY3RlZEluZGV4ID0gdm9pZCAwO1xuICAgICAgfTtcbiAgICAgIFJlc3VsdHNMaXN0LmFwcGVuZENoaWxkKGl0ZW0pO1xuICAgIH1cbiAgfVxuICBpZiAodGhpcy5zdWdnZXN0aW9ucy5sZW5ndGggPCBlbGVtZW50cy5sZW5ndGgpIHtcbiAgICBmb3IgKGxldCBpID0gdGhpcy5zdWdnZXN0aW9ucy5sZW5ndGg7IGkgPCBlbGVtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgZWxlbWVudHNbaV0ucmVtb3ZlKCk7XG4gICAgfVxuICB9XG4gIGZvciAoY29uc3Qgc3VnZ2VzdGlvbiBvZiB0aGlzLnN1Z2dlc3Rpb25zKSB7XG4gICAgY29uc3QgaSA9IHRoaXMuc3VnZ2VzdGlvbnMuaW5kZXhPZihzdWdnZXN0aW9uKTtcbiAgICBjb25zdCBlbGVtZW50ID0gZWxlbWVudHNbaV07XG4gICAgdGhpcy5maWxsSXRlbShlbGVtZW50LCBzdWdnZXN0aW9uLCBpLCB0aGlzLnN1Z2dlc3Rpb25zLmxlbmd0aCk7XG4gICAgZWxlbWVudC5vbmNsaWNrID0gKCkgPT4ge1xuICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF9oYW5kbGVTZWxlY3QpLmNhbGwodGhpcywgc3VnZ2VzdGlvbik7XG4gICAgfTtcbiAgfVxufTtcbl90aGVtZUludGVybmFsID0gbmV3IFdlYWtNYXAoKTtcbl9wb3BvdmVyT3B0aW9ucyA9IG5ldyBXZWFrTWFwKCk7XG5faGFuZGxlSW5wdXQgPSBuZXcgV2Vha01hcCgpO1xuX2hhbmRsZVNlbGVjdCA9IG5ldyBXZWFrTWFwKCk7XG5faGFuZGxlRm9jdXMgPSBuZXcgV2Vha01hcCgpO1xuX2hhbmRsZUJsdXIgPSBuZXcgV2Vha01hcCgpO1xuX2hhbmRsZUtleURvd24gPSBuZXcgV2Vha01hcCgpO1xud2luZG93Lk1hcGJveFNlYXJjaExpc3Rib3ggPSBNYXBib3hTZWFyY2hMaXN0Ym94O1xuaWYgKCF3aW5kb3cuY3VzdG9tRWxlbWVudHMuZ2V0KFwibWFwYm94LXNlYXJjaC1saXN0Ym94XCIpKSB7XG4gIGN1c3RvbUVsZW1lbnRzLmRlZmluZShcIm1hcGJveC1zZWFyY2gtbGlzdGJveFwiLCBNYXBib3hTZWFyY2hMaXN0Ym94KTtcbn1cblxuLy8gc3JjL3V0aWxzL2F1dG9maWxsLnRzXG5pbXBvcnQge1xuICBmZWF0dXJlVG9TdWdnZXN0aW9uXG59IGZyb20gXCJAbWFwYm94L3NlYXJjaC1qcy1jb3JlXCI7XG52YXIgQVVUT0ZJTExfVE9LRU5TID0gLyogQF9fUFVSRV9fICovIG5ldyBTZXQoW1xuICBcInN0cmVldC1hZGRyZXNzXCIsXG4gIFwiYWRkcmVzcy1saW5lMVwiLFxuICBcImFkZHJlc3MtbGluZTJcIixcbiAgXCJhZGRyZXNzLWxpbmUzXCIsXG4gIFwiYWRkcmVzcy1sZXZlbDRcIixcbiAgXCJhZGRyZXNzLWxldmVsM1wiLFxuICBcImFkZHJlc3MtbGV2ZWwyXCIsXG4gIFwiYWRkcmVzcy1sZXZlbDFcIixcbiAgXCJjb3VudHJ5XCIsXG4gIFwiY291bnRyeS1uYW1lXCIsXG4gIFwicG9zdGFsLWNvZGVcIlxuXSk7XG52YXIgQVVUT0ZJTExfU0tJUF9UT0tFTlMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFNldChbXCJvZmZcIiwgXCJvblwiLCBcInRydWVcIiwgXCJmYWxzZVwiXSk7XG5mdW5jdGlvbiBmaW5kUGFyZW50Rm9ybShlbCkge1xuICBsZXQgbm9kZSA9IGVsLnBhcmVudE5vZGU7XG4gIHdoaWxlIChub2RlKSB7XG4gICAgaWYgKG5vZGUgaW5zdGFuY2VvZiBIVE1MRm9ybUVsZW1lbnQpIHtcbiAgICAgIHJldHVybiBub2RlO1xuICAgIH1cbiAgICBub2RlID0gbm9kZS5wYXJlbnROb2RlO1xuICB9XG4gIHJldHVybiBudWxsO1xufVxuZnVuY3Rpb24gZmluZEFkZHJlc3NJbnB1dHMoZm9ybSkge1xuICBjb25zdCBwYXJlbnQgPSBmb3JtIHx8IGRvY3VtZW50O1xuICByZXR1cm4gQXJyYXkuZnJvbShwYXJlbnQucXVlcnlTZWxlY3RvckFsbCgnaW5wdXRbYXV0b2NvbXBsZXRlfj1cImFkZHJlc3MtbGluZTFcIl0sIGlucHV0W2F1dG9jb21wbGV0ZX49XCJzdHJlZXQtYWRkcmVzc1wiXScpKTtcbn1cbnZhciBTRUNUSU9OID0gXCJzZWN0aW9uLVwiO1xudmFyIFNFQ1RJT05fREVGQVVMVCA9IFwic2VjdGlvbi1kZWZhdWx0XCI7XG52YXIgU0VDVElPTl9TSElQUElORyA9IFwic2VjdGlvbi1zaGlwcGluZ1wiO1xudmFyIFNFQ1RJT05fQklMTElORyA9IFwic2VjdGlvbi1iaWxsaW5nXCI7XG5mdW5jdGlvbiBwYXJzZUZvcm1TdHJ1Y3R1cmUoZm9ybSkge1xuICBjb25zdCBpbnB1dHMgPSBBcnJheS5mcm9tKGZvcm0ucXVlcnlTZWxlY3RvckFsbChcIlthdXRvY29tcGxldGVdXCIpKS5maWx0ZXIoKGVsKSA9PiB7XG4gICAgY29uc3QgdGFnTmFtZSA9IGVsLnRhZ05hbWUudG9Mb3dlckNhc2UoKTtcbiAgICByZXR1cm4gdGFnTmFtZSA9PT0gXCJpbnB1dFwiIHx8IHRhZ05hbWUgPT09IFwic2VsZWN0XCIgfHwgdGFnTmFtZSA9PT0gXCJ0ZXh0YXJlYVwiO1xuICB9KTtcbiAgY29uc3QgcmVzID0gW107XG4gIGZvciAoY29uc3QgaW5wdXQgb2YgaW5wdXRzKSB7XG4gICAgaWYgKCFpc1Zpc2libGUoaW5wdXQpKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgY29uc3QgYXV0b2NvbXBsZXRlID0gaW5wdXQuZ2V0QXR0cmlidXRlKFwiYXV0b2NvbXBsZXRlXCIpIHx8IFwiXCI7XG4gICAgaWYgKCFhdXRvY29tcGxldGUgfHwgQVVUT0ZJTExfU0tJUF9UT0tFTlMuaGFzKGF1dG9jb21wbGV0ZSkpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBjb25zdCB0b2tlbnMgPSBhdXRvY29tcGxldGUudG9Mb3dlckNhc2UoKS5zcGxpdChcIiBcIik7XG4gICAgaWYgKHRva2Vucy5sZW5ndGggPiAzKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgY29uc3QgZmllbGQgPSB0b2tlbnNbdG9rZW5zLmxlbmd0aCAtIDFdO1xuICAgIGlmICghQVVUT0ZJTExfVE9LRU5TLmhhcyhmaWVsZCkpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICB0b2tlbnMucG9wKCk7XG4gICAgbGV0IHNlY3Rpb24gPSBTRUNUSU9OX0RFRkFVTFQ7XG4gICAgaWYgKHRva2Vucy5sZW5ndGgpIHtcbiAgICAgIGNvbnN0IHNlY3Rpb25Ub2tlbiA9IHRva2Vuc1t0b2tlbnMubGVuZ3RoIC0gMV07XG4gICAgICBpZiAoc2VjdGlvblRva2VuID09PSBcInNoaXBwaW5nXCIpIHtcbiAgICAgICAgc2VjdGlvbiA9IFNFQ1RJT05fU0hJUFBJTkc7XG4gICAgICAgIHRva2Vucy5wb3AoKTtcbiAgICAgIH1cbiAgICAgIGlmIChzZWN0aW9uVG9rZW4gPT09IFwiYmlsbGluZ1wiKSB7XG4gICAgICAgIHNlY3Rpb24gPSBTRUNUSU9OX0JJTExJTkc7XG4gICAgICAgIHRva2Vucy5wb3AoKTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKHRva2Vucy5sZW5ndGgpIHtcbiAgICAgIGNvbnN0IHNlY3Rpb25Ub2tlbiA9IHRva2Vuc1t0b2tlbnMubGVuZ3RoIC0gMV07XG4gICAgICBpZiAoc2VjdGlvblRva2VuLnN0YXJ0c1dpdGgoU0VDVElPTikpIHtcbiAgICAgICAgc2VjdGlvbiA9IHNlY3Rpb25Ub2tlbjtcbiAgICAgIH1cbiAgICB9XG4gICAgcmVzLnB1c2goe1xuICAgICAgaW5wdXQsXG4gICAgICBzZWN0aW9uLFxuICAgICAgZmllbGRcbiAgICB9KTtcbiAgfVxuICByZXR1cm4gcmVzO1xufVxuZnVuY3Rpb24gZmluZEFkZHJlc3NBdXRvZmlsbElucHV0cyhmb3JtLCByZWYpIHtcbiAgY29uc3QgbG9naWNhbFNlY3Rpb25zID0gW107XG4gIGNvbnN0IGxvZ2ljYWxTZWN0aW9uU2VjdGlvbnMgPSBbXTtcbiAgY29uc3QgZm9ybVN0cnVjdHVyZSA9IHBhcnNlRm9ybVN0cnVjdHVyZShmb3JtKTtcbiAgbGV0IGZvdW5kU2VjdGlvbiA9IG51bGw7XG4gIGZvciAoY29uc3QgeyBpbnB1dCwgc2VjdGlvbiwgZmllbGQgfSBvZiBmb3JtU3RydWN0dXJlKSB7XG4gICAgbGV0IGxhc3RJbmRleCA9IGxvZ2ljYWxTZWN0aW9ucy5sZW5ndGggLSAxO1xuICAgIGxldCBjcmVhdGVOZXdTZWN0aW9uID0gZmFsc2U7XG4gICAgaWYgKCFsb2dpY2FsU2VjdGlvbnMubGVuZ3RoKSB7XG4gICAgICBjcmVhdGVOZXdTZWN0aW9uID0gdHJ1ZTtcbiAgICB9IGVsc2UgaWYgKGxvZ2ljYWxTZWN0aW9uU2VjdGlvbnNbbGFzdEluZGV4XSAhPT0gc2VjdGlvbikge1xuICAgICAgY3JlYXRlTmV3U2VjdGlvbiA9IHRydWU7XG4gICAgfSBlbHNlIGlmIChsb2dpY2FsU2VjdGlvbnNbbGFzdEluZGV4XVtmaWVsZF0pIHtcbiAgICAgIGNyZWF0ZU5ld1NlY3Rpb24gPSB0cnVlO1xuICAgIH1cbiAgICBpZiAoY3JlYXRlTmV3U2VjdGlvbikge1xuICAgICAgaWYgKGZvdW5kU2VjdGlvbikge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGxvZ2ljYWxTZWN0aW9ucy5wdXNoKHtcbiAgICAgICAgW2ZpZWxkXTogaW5wdXRcbiAgICAgIH0pO1xuICAgICAgbG9naWNhbFNlY3Rpb25TZWN0aW9ucy5wdXNoKHNlY3Rpb24pO1xuICAgICAgbGFzdEluZGV4Kys7XG4gICAgfSBlbHNlIHtcbiAgICAgIGxvZ2ljYWxTZWN0aW9uc1tsYXN0SW5kZXhdW2ZpZWxkXSA9IGlucHV0O1xuICAgIH1cbiAgICBpZiAoaW5wdXQgPT09IHJlZikge1xuICAgICAgZm91bmRTZWN0aW9uID0gbG9naWNhbFNlY3Rpb25zW2xhc3RJbmRleF07XG4gICAgfVxuICB9XG4gIHJldHVybiBmb3VuZFNlY3Rpb24gIT0gbnVsbCA/IGZvdW5kU2VjdGlvbiA6IHt9O1xufVxuZnVuY3Rpb24gc2V0Rm9ybUF1dG9maWxsVmFsdWVzKGZvcm0sIHJlZiwgc3VnZ2VzdGlvbikge1xuICB2YXIgX2E7XG4gIGNvbnN0IG1hcCA9IGZpbmRBZGRyZXNzQXV0b2ZpbGxJbnB1dHMoZm9ybSwgcmVmKTtcbiAgY29uc3Qgc3RyZWV0QWRkcmVzcyA9IFtcbiAgICBzdWdnZXN0aW9uLmFkZHJlc3NfbGluZTEsXG4gICAgc3VnZ2VzdGlvbi5hZGRyZXNzX2xpbmUyLFxuICAgIHN1Z2dlc3Rpb24uYWRkcmVzc19saW5lM1xuICBdLmZpbHRlcigocGFydCkgPT4gQm9vbGVhbihwYXJ0KSkuam9pbihcIiwgXCIpO1xuICBzZXRWYWx1ZShtYXBbXCJzdHJlZXQtYWRkcmVzc1wiXSwgbWFwW1wiYWRkcmVzcy1saW5lMlwiXSA/IHN1Z2dlc3Rpb24uYWRkcmVzc19saW5lMSB8fCBcIlwiIDogc3RyZWV0QWRkcmVzcyk7XG4gIHNldFZhbHVlKG1hcFtcImFkZHJlc3MtbGluZTFcIl0sIHN1Z2dlc3Rpb24uYWRkcmVzc19saW5lMSB8fCBcIlwiKTtcbiAgc2V0VmFsdWUobWFwW1wiYWRkcmVzcy1saW5lMlwiXSwgc3VnZ2VzdGlvbi5hZGRyZXNzX2xpbmUyIHx8IFwiXCIpO1xuICBzZXRWYWx1ZShtYXBbXCJhZGRyZXNzLWxldmVsMVwiXSwgc3VnZ2VzdGlvbi5hZGRyZXNzX2xldmVsMSB8fCBcIlwiKTtcbiAgc2V0VmFsdWUobWFwW1wiYWRkcmVzcy1sZXZlbDJcIl0sIHN1Z2dlc3Rpb24uYWRkcmVzc19sZXZlbDIgfHwgXCJcIik7XG4gIHNldFZhbHVlKG1hcFtcImFkZHJlc3MtbGV2ZWwzXCJdLCBzdWdnZXN0aW9uLmFkZHJlc3NfbGV2ZWwzIHx8IFwiXCIpO1xuICBjb25zdCBjb3VudHJ5Q29kZSA9IHN1Z2dlc3Rpb24uY291bnRyeV9jb2RlIHx8ICgoX2EgPSBzdWdnZXN0aW9uLm1ldGFkYXRhKSA9PSBudWxsID8gdm9pZCAwIDogX2EuaXNvXzMxNjZfMSkgfHwgXCJcIjtcbiAgaWYgKG1hcC5jb3VudHJ5ICYmIG1hcC5jb3VudHJ5IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQpIHtcbiAgICBsZXQgZmlyc3RPcHRpb24gPSBtYXAuY291bnRyeS5xdWVyeVNlbGVjdG9yKGBvcHRpb25gKS52YWx1ZTtcbiAgICBpZiAoZmlyc3RPcHRpb24gPT09IFwiXCIpIHtcbiAgICAgIGZpcnN0T3B0aW9uID0gbWFwLmNvdW50cnkucXVlcnlTZWxlY3RvckFsbChgb3B0aW9uYClbMV0udmFsdWU7XG4gICAgfVxuICAgIGNvbnN0IGlzVXBwZXJDYXNlID0gZmlyc3RPcHRpb24gPT09IGZpcnN0T3B0aW9uLnRvVXBwZXJDYXNlKCk7XG4gICAgc2V0VmFsdWUobWFwW1wiY291bnRyeVwiXSwgaXNVcHBlckNhc2UgPyBjb3VudHJ5Q29kZS50b1VwcGVyQ2FzZSgpIDogY291bnRyeUNvZGUpO1xuICB9IGVsc2Uge1xuICAgIHNldFZhbHVlKG1hcFtcImNvdW50cnlcIl0sIGNvdW50cnlDb2RlKTtcbiAgfVxuICBzZXRWYWx1ZShtYXBbXCJjb3VudHJ5LW5hbWVcIl0sIHN1Z2dlc3Rpb24uY291bnRyeSB8fCBcIlwiKTtcbiAgc2V0VmFsdWUobWFwW1wicG9zdGFsLWNvZGVcIl0sIHN1Z2dlc3Rpb24ucG9zdGNvZGUgfHwgXCJcIik7XG59XG5mdW5jdGlvbiBnZXRGb3JtQXV0b2ZpbGxWYWx1ZXMoZm9ybSwgcmVmKSB7XG4gIGNvbnN0IG1hcCA9IGZpbmRBZGRyZXNzQXV0b2ZpbGxJbnB1dHMoZm9ybSwgcmVmKTtcbiAgY29uc3QgdmFsdWVzID0ge307XG4gIGZvciAoY29uc3QgW2tleSwgaW5wdXRdIG9mIE9iamVjdC5lbnRyaWVzKG1hcCkpIHtcbiAgICBpZiAoaW5wdXQgPT0gbnVsbCA/IHZvaWQgMCA6IGlucHV0LnZhbHVlKSB7XG4gICAgICB2YWx1ZXNba2V5XSA9IGlucHV0LnZhbHVlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gdmFsdWVzO1xufVxuZnVuY3Rpb24gZ2V0QXV0b2ZpbGxTZWFyY2hUZXh0KHNuYXBzaG90KSB7XG4gIGNvbnN0IHNlYXJjaFRleHQgPSBbXTtcbiAgaWYgKHNuYXBzaG90W1wic3RyZWV0LWFkZHJlc3NcIl0pIHtcbiAgICBzZWFyY2hUZXh0LnB1c2goc25hcHNob3RbXCJzdHJlZXQtYWRkcmVzc1wiXSk7XG4gIH0gZWxzZSB7XG4gICAgc2VhcmNoVGV4dC5wdXNoKHNuYXBzaG90W1wiYWRkcmVzcy1saW5lMVwiXSB8fCBcIlwiKTtcbiAgfVxuICBzZWFyY2hUZXh0LnB1c2goc25hcHNob3RbXCJhZGRyZXNzLWxpbmUyXCJdIHx8IFwiXCIpO1xuICBzZWFyY2hUZXh0LnB1c2goc25hcHNob3RbXCJhZGRyZXNzLWxpbmUzXCJdIHx8IFwiXCIpO1xuICBzZWFyY2hUZXh0LnB1c2goc25hcHNob3RbXCJhZGRyZXNzLWxldmVsM1wiXSB8fCBcIlwiKTtcbiAgc2VhcmNoVGV4dC5wdXNoKHNuYXBzaG90W1wiYWRkcmVzcy1sZXZlbDJcIl0gfHwgXCJcIik7XG4gIHNlYXJjaFRleHQucHVzaChzbmFwc2hvdFtcImFkZHJlc3MtbGV2ZWwxXCJdIHx8IFwiXCIpO1xuICBzZWFyY2hUZXh0LnB1c2goc25hcHNob3RbXCJwb3N0YWwtY29kZVwiXSB8fCBcIlwiKTtcbiAgaWYgKHNuYXBzaG90W1wiY291bnRyeS1uYW1lXCJdKSB7XG4gICAgc2VhcmNoVGV4dC5wdXNoKHNuYXBzaG90W1wiY291bnRyeS1uYW1lXCJdKTtcbiAgfSBlbHNlIHtcbiAgICBzZWFyY2hUZXh0LnB1c2goc25hcHNob3RbXCJjb3VudHJ5XCJdIHx8IFwiXCIpO1xuICB9XG4gIHJldHVybiBzZWFyY2hUZXh0LmZpbHRlcigocGFydCkgPT4gQm9vbGVhbihwYXJ0KSkubWFwKChwYXJ0KSA9PiBwYXJ0LnRyaW0oKSkuam9pbihcIiwgXCIpO1xufVxuZnVuY3Rpb24gZmlsbEZvcm1XaXRoRmVhdHVyZShmZWF0dXJlLCBpbnB1dCkge1xuICBjb25zdCBmb3JtID0gZmluZFBhcmVudEZvcm0oaW5wdXQpO1xuICBpZiAoIWZvcm0pIHtcbiAgICByZXR1cm47XG4gIH1cbiAgY29uc3Qgc3VnZ2VzdGlvbiA9IGZlYXR1cmVUb1N1Z2dlc3Rpb24oZmVhdHVyZSk7XG4gIHNldEZvcm1BdXRvZmlsbFZhbHVlcyhmb3JtLCBpbnB1dCwgc3VnZ2VzdGlvbik7XG4gIGNvbnN0IGlucHV0TWFwID0gZmluZEFkZHJlc3NBdXRvZmlsbElucHV0cyhmb3JtLCBpbnB1dCk7XG4gIGlmIChpbnB1dE1hcFtcImFkZHJlc3MtbGluZTJcIl0gJiYgIXN1Z2dlc3Rpb24uYWRkcmVzc19saW5lMikge1xuICAgIGlucHV0TWFwW1wiYWRkcmVzcy1saW5lMlwiXS5mb2N1cygpO1xuICB9XG59XG5mdW5jdGlvbiBmZWF0dXJlVG9BdXRvZmlsbFZhbHVlTWFwKGZlYXR1cmUpIHtcbiAgdmFyIF9hO1xuICBjb25zdCB2YWx1ZXMgPSB7fTtcbiAgY29uc3Qgc3RyZWV0QWRkcmVzcyA9IFtcbiAgICBmZWF0dXJlLnByb3BlcnRpZXMuYWRkcmVzc19saW5lMSxcbiAgICBmZWF0dXJlLnByb3BlcnRpZXMuYWRkcmVzc19saW5lMixcbiAgICBmZWF0dXJlLnByb3BlcnRpZXMuYWRkcmVzc19saW5lM1xuICBdLmZpbHRlcigocGFydCkgPT4gQm9vbGVhbihwYXJ0KSkuam9pbihcIiwgXCIpO1xuICB2YWx1ZXNbXCJzdHJlZXQtYWRkcmVzc1wiXSA9IHN0cmVldEFkZHJlc3M7XG4gIHZhbHVlc1tcImFkZHJlc3MtbGluZTFcIl0gPSBmZWF0dXJlLnByb3BlcnRpZXMuYWRkcmVzc19saW5lMTtcbiAgdmFsdWVzW1wiYWRkcmVzcy1saW5lMlwiXSA9IGZlYXR1cmUucHJvcGVydGllcy5hZGRyZXNzX2xpbmUyO1xuICB2YWx1ZXNbXCJhZGRyZXNzLWxpbmUzXCJdID0gZmVhdHVyZS5wcm9wZXJ0aWVzLmFkZHJlc3NfbGluZTM7XG4gIHZhbHVlc1tcImFkZHJlc3MtbGV2ZWwxXCJdID0gZmVhdHVyZS5wcm9wZXJ0aWVzLmFkZHJlc3NfbGV2ZWwxO1xuICB2YWx1ZXNbXCJhZGRyZXNzLWxldmVsMlwiXSA9IGZlYXR1cmUucHJvcGVydGllcy5hZGRyZXNzX2xldmVsMjtcbiAgdmFsdWVzW1wiYWRkcmVzcy1sZXZlbDNcIl0gPSBmZWF0dXJlLnByb3BlcnRpZXMuYWRkcmVzc19sZXZlbDM7XG4gIHZhbHVlc1tcImNvdW50cnlcIl0gPSAoX2EgPSBmZWF0dXJlLnByb3BlcnRpZXMubWV0YWRhdGEpID09IG51bGwgPyB2b2lkIDAgOiBfYS5pc29fMzE2Nl8xO1xuICB2YWx1ZXNbXCJjb3VudHJ5LW5hbWVcIl0gPSBmZWF0dXJlLnByb3BlcnRpZXMuY291bnRyeTtcbiAgdmFsdWVzW1wicG9zdGFsLWNvZGVcIl0gPSBmZWF0dXJlLnByb3BlcnRpZXMucG9zdGNvZGU7XG4gIHJldHVybiB2YWx1ZXM7XG59XG5mdW5jdGlvbiBjaGVja0F1dG9maWxsVmFsdWVzQ2hhbmdlZCh0YXJnZXRNYXAsIHJlZmVyZW5jZU1hcCkge1xuICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyh0YXJnZXRNYXApKSB7XG4gICAgaWYgKHJlZmVyZW5jZU1hcFtrZXldICE9PSB2YWx1ZSlcbiAgICAgIHJldHVybiB0cnVlO1xuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cbnZhciBkaXN0aW5jdEV4YWN0U3RyZWV0UmVzdWx0cyA9IChzdWdnZXN0aW9ucykgPT4ge1xuICByZXR1cm4gc3VnZ2VzdGlvbnMuZmlsdGVyKChpdGVtMSwgaWR4LCBhcnIpID0+IHtcbiAgICBjb25zdCB0aXRsZSA9IGdldFN1Z2dlc3Rpb25UaXRsZShpdGVtMSwgMCAvKiBBZGRyZXNzQXV0b2ZpbGwgKi8pO1xuICAgIHJldHVybiBpdGVtMS5hY2N1cmFjeSAhPT0gXCJzdHJlZXRcIiB8fCBhcnIuZmluZEluZGV4KChpdGVtMikgPT4gdGl0bGUgPT09IGdldFN1Z2dlc3Rpb25UaXRsZShpdGVtMiwgMCAvKiBBZGRyZXNzQXV0b2ZpbGwgKi8pKSA9PT0gaWR4O1xuICB9KTtcbn07XG52YXIgdG9nZ2xlQXV0b2NvbXBsZXRpb24gPSAoaW5wdXQsIGluaXRpYWxBdXRvY29tcGxldGVWYWx1ZSwgZW5hYmxlQnJvd3NlckF1dG9jb21wbGV0ZSkgPT4ge1xuICBjb25zdCBkaXNhYmxlVmFsdWUgPSBcIm5ldy1wYXNzd29yZFwiO1xuICBjb25zdCBkZWZhdWx0RmFsbGJhY2tWYWx1ZSA9IFwiYWRkcmVzcy1saW5lMVwiO1xuICBjb25zdCBhdXRvY29tcGxldGVWYWx1ZSA9IGVuYWJsZUJyb3dzZXJBdXRvY29tcGxldGUgPyBpbml0aWFsQXV0b2NvbXBsZXRlVmFsdWUgfHwgZGVmYXVsdEZhbGxiYWNrVmFsdWUgOiBkaXNhYmxlVmFsdWU7XG4gIGlmIChpbnB1dCkge1xuICAgIGlucHV0LmF1dG9jb21wbGV0ZSA9IGF1dG9jb21wbGV0ZVZhbHVlO1xuICB9XG59O1xudmFyIGhhbmRsZVN0cmVldFNlbGVjdGlvbiA9IChpbnB1dCwgaW5pdGlhbEF1dG9jb21wbGV0ZVZhbHVlLCBzdWdnZXN0aW9uKSA9PiB7XG4gIGlmICghaW5wdXQgfHwgIXN1Z2dlc3Rpb24pIHtcbiAgICByZXR1cm47XG4gIH1cbiAgdG9nZ2xlQXV0b2NvbXBsZXRpb24oaW5wdXQsIGluaXRpYWxBdXRvY29tcGxldGVWYWx1ZSwgdHJ1ZSk7XG4gIGNvbnN0IGZlYXR1cmUgPSB7XG4gICAgcHJvcGVydGllczogX19zcHJlYWRQcm9wcyhfX3NwcmVhZFZhbHVlcyh7fSwgc3VnZ2VzdGlvbiksIHtcbiAgICAgIGFkZHJlc3NfbGluZTE6IHN1Z2dlc3Rpb24uYWRkcmVzc19saW5lMSArIFwiIFwiLFxuICAgICAgcG9zdGNvZGU6IG51bGxcbiAgICB9KVxuICB9O1xuICBmaWxsRm9ybVdpdGhGZWF0dXJlKGZlYXR1cmUsIGlucHV0KTtcbiAgdG9nZ2xlQXV0b2NvbXBsZXRpb24oaW5wdXQsIGluaXRpYWxBdXRvY29tcGxldGVWYWx1ZSwgZmFsc2UpO1xuICBpbnB1dCA9PSBudWxsID8gdm9pZCAwIDogaW5wdXQuZm9jdXMoKTtcbn07XG5cbi8vIHNyYy9jb25maXJtQWRkcmVzcy50c1xuaW1wb3J0IHtcbiAgZmVhdHVyZVRvU3VnZ2VzdGlvbiBhcyBmZWF0dXJlVG9TdWdnZXN0aW9uMlxufSBmcm9tIFwiQG1hcGJveC9zZWFyY2gtanMtY29yZVwiO1xuXG4vLyBzcmMvY29tcG9uZW50cy9NYXBib3hBZGRyZXNzQ29uZmlybWF0aW9uLnRzXG5pbXBvcnQge1xuICBNYXRjaENvZGVDb25maWRlbmNlLFxuICBWYWxpZGF0aW9uQ29yZVxufSBmcm9tIFwiQG1hcGJveC9zZWFyY2gtanMtY29yZVwiO1xuaW1wb3J0IG5vU2Nyb2xsIGZyb20gXCJuby1zY3JvbGxcIjtcbmltcG9ydCB7IGNyZWF0ZUZvY3VzVHJhcCB9IGZyb20gXCJmb2N1cy10cmFwXCI7XG5cbi8vIHNyYy9jb25maWcudHNcbmltcG9ydCB7IFNlc3Npb25Ub2tlbiBhcyBTZXNzaW9uVG9rZW4yIH0gZnJvbSBcIkBtYXBib3gvc2VhcmNoLWpzLWNvcmVcIjtcbnZhciBDb25maWcgPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuZmVlZGJhY2tFbmFibGVkID0gdHJ1ZTtcbiAgICB0aGlzLmF1dG9maWxsU2Vzc2lvblRva2VuID0gbmV3IFNlc3Npb25Ub2tlbjIoKTtcbiAgICB0aGlzLmF1dG9maWxsU2Vzc2lvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICB0aGlzLmRldGVjdEJyb3dzZXJBdXRvZmlsbEVuYWJsZWQgPSBmYWxzZTtcbiAgfVxufTtcbnZhciBjb25maWcgPSBuZXcgQ29uZmlnKCk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoY29uZmlnLCBcImF1dG9maWxsU2Vzc2lvblRva2VuXCIsIHtcbiAgY29uZmlndXJhYmxlOiBmYWxzZSxcbiAgd3JpdGFibGU6IGZhbHNlXG59KTtcblxuLy8gc3JjL2NvbXBvbmVudHMvTWFwYm94QWRkcmVzc0NvbmZpcm1hdGlvbi50c1xudmFyIFRFTVBMQVRFID0gY3JlYXRlRWxlbWVudEZyb21TdHJpbmcoYFxuPHRlbXBsYXRlPlxuICA8ZGl2IGNsYXNzPVwiTWFwYm94QWRkcmVzc0NvbmZpcm1hdGlvblwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPlxuICAgIDxtYXBib3gtYWRkcmVzcy1jb25maXJtYXRpb24tZmVhdHVyZSBjbGFzcz1cIkNvbnRlbnRGZWF0dXJlXCI+PC9tYXBib3gtYWRkcmVzcy1jb25maXJtYXRpb24tZmVhdHVyZT5cbiAgICA8bWFwYm94LWFkZHJlc3MtY29uZmlybWF0aW9uLW5vLWZlYXR1cmUgY2xhc3M9XCJDb250ZW50Tm9GZWF0dXJlXCI+PC9tYXBib3gtYWRkcmVzcy1jb25maXJtYXRpb24tbm8tZmVhdHVyZT5cbiAgPC9kaXY+XG48L3RlbXBsYXRlPlxuYCk7XG52YXIgX3Nob3csIF9iaW5kaW5nMiwgX2ZvY3VzVHJhcCwgX3RoZW1lSW50ZXJuYWwyO1xudmFyIE1hcGJveEFkZHJlc3NDb25maXJtYXRpb24gPSBjbGFzcyBleHRlbmRzIEhUTUxTY29wZWRFbGVtZW50IHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoLi4uYXJndW1lbnRzKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX3Nob3csIGZhbHNlKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX2JpbmRpbmcyLCB2b2lkIDApO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfZm9jdXNUcmFwLCB2b2lkIDApO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfdGhlbWVJbnRlcm5hbDIsIHt9KTtcbiAgfVxuICBnZXQgdGVtcGxhdGUoKSB7XG4gICAgcmV0dXJuIFRFTVBMQVRFO1xuICB9XG4gIGdldCB0ZW1wbGF0ZVN0eWxlKCkge1xuICAgIHJldHVybiBzdHlsZV9kZWZhdWx0O1xuICB9XG4gIGdldCB0ZW1wbGF0ZVVzZXJTdHlsZSgpIHtcbiAgICByZXR1cm4gZ2V0VGhlbWVDU1MoXCIuTWFwYm94QWRkcmVzc0NvbmZpcm1hdGlvblwiLCB0aGlzLnRoZW1lKTtcbiAgfVxuICBnZXQgdGhlbWUoKSB7XG4gICAgcmV0dXJuIF9fcHJpdmF0ZUdldCh0aGlzLCBfdGhlbWVJbnRlcm5hbDIpO1xuICB9XG4gIHNldCB0aGVtZSh0aGVtZSkge1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfdGhlbWVJbnRlcm5hbDIsIHRoZW1lKTtcbiAgICBpZiAoIV9fcHJpdmF0ZUdldCh0aGlzLCBfYmluZGluZzIpIHx8ICF0aGVtZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLnVwZGF0ZVRlbXBsYXRlVXNlclN0eWxlKGdldFRoZW1lQ1NTKFwiLk1hcGJveEFkZHJlc3NDb25maXJtYXRpb25cIiwgdGhlbWUpKTtcbiAgICBjb25zdCB7IENvbnRlbnRGZWF0dXJlLCBDb250ZW50Tm9GZWF0dXJlIH0gPSBfX3ByaXZhdGVHZXQodGhpcywgX2JpbmRpbmcyKTtcbiAgICBDb250ZW50RmVhdHVyZS50aGVtZSA9IHRoZW1lO1xuICAgIENvbnRlbnROb0ZlYXR1cmUudGhlbWUgPSB0aGVtZTtcbiAgfVxuICBjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICBzdXBlci5jb25uZWN0ZWRDYWxsYmFjaygpO1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfYmluZGluZzIsIGJpbmRFbGVtZW50cyh0aGlzLCB7XG4gICAgICBNYXBib3hBZGRyZXNzQ29uZmlybWF0aW9uOiBcIi5NYXBib3hBZGRyZXNzQ29uZmlybWF0aW9uXCIsXG4gICAgICBDb250ZW50RmVhdHVyZTogXCIuQ29udGVudEZlYXR1cmVcIixcbiAgICAgIENvbnRlbnROb0ZlYXR1cmU6IFwiLkNvbnRlbnROb0ZlYXR1cmVcIlxuICAgIH0pKTtcbiAgICBjb25zdCB7IE1hcGJveEFkZHJlc3NDb25maXJtYXRpb246IE1hcGJveEFkZHJlc3NDb25maXJtYXRpb24yIH0gPSBfX3ByaXZhdGVHZXQodGhpcywgX2JpbmRpbmcyKTtcbiAgICBNYXBib3hBZGRyZXNzQ29uZmlybWF0aW9uMi5zZXRBdHRyaWJ1dGUoXCJhcmlhLWhpZGRlblwiLCBcInRydWVcIik7XG4gICAgY29uc3QgdGhlbWUgPSB0aGlzLnRoZW1lO1xuICAgIGlmICh0aGVtZSkge1xuICAgICAgY29uc3QgeyBDb250ZW50RmVhdHVyZSwgQ29udGVudE5vRmVhdHVyZSB9ID0gX19wcml2YXRlR2V0KHRoaXMsIF9iaW5kaW5nMik7XG4gICAgICBDb250ZW50RmVhdHVyZS50aGVtZSA9IHRoZW1lO1xuICAgICAgQ29udGVudE5vRmVhdHVyZS50aGVtZSA9IHRoZW1lO1xuICAgIH1cbiAgfVxuICBkaXNjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICBfX3ByaXZhdGVTZXQodGhpcywgX2ZvY3VzVHJhcCwgbnVsbCk7XG4gIH1cbiAgaGlkZSgpIHtcbiAgICB2YXIgX2E7XG4gICAgX19wcml2YXRlU2V0KHRoaXMsIF9zaG93LCBmYWxzZSk7XG4gICAgaWYgKCFfX3ByaXZhdGVHZXQodGhpcywgX2JpbmRpbmcyKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCB7IE1hcGJveEFkZHJlc3NDb25maXJtYXRpb246IE1hcGJveEFkZHJlc3NDb25maXJtYXRpb24yIH0gPSBfX3ByaXZhdGVHZXQodGhpcywgX2JpbmRpbmcyKTtcbiAgICBNYXBib3hBZGRyZXNzQ29uZmlybWF0aW9uMi5zZXRBdHRyaWJ1dGUoXCJhcmlhLWhpZGRlblwiLCBcInRydWVcIik7XG4gICAgKF9hID0gX19wcml2YXRlR2V0KHRoaXMsIF9mb2N1c1RyYXApKSA9PSBudWxsID8gdm9pZCAwIDogX2EuZGVhY3RpdmF0ZSgpO1xuICAgIG5vU2Nyb2xsLm9mZigpO1xuICB9XG4gIHNob3coYXV0b2ZpbGxWYWx1ZXMsIG9wdGlvbnNBcmcsIGZlYXR1cmUpIHtcbiAgICByZXR1cm4gX19hc3luYyh0aGlzLCBudWxsLCBmdW5jdGlvbiogKCkge1xuICAgICAgdmFyIF9hO1xuICAgICAgaWYgKCFfX3ByaXZhdGVHZXQodGhpcywgX2JpbmRpbmcyKSkge1xuICAgICAgICByZXR1cm4geyB0eXBlOiBcImNhbmNlbFwiIH07XG4gICAgICB9XG4gICAgICBjb25zdCB7IE1hcGJveEFkZHJlc3NDb25maXJtYXRpb246IE1hcGJveEFkZHJlc3NDb25maXJtYXRpb24yLCBDb250ZW50RmVhdHVyZSwgQ29udGVudE5vRmVhdHVyZSB9ID0gX19wcml2YXRlR2V0KHRoaXMsIF9iaW5kaW5nMik7XG4gICAgICBjb25zdCB7IGFjY2Vzc1Rva2VuLCBtaW5pbWFwID0gZmFsc2UsIHRoZW1lLCBmb290ZXIgfSA9IG9wdGlvbnNBcmc7XG4gICAgICB0aGlzLnRoZW1lID0gdGhlbWU7XG4gICAgICBpZiAoZmVhdHVyZSkge1xuICAgICAgICBDb250ZW50RmVhdHVyZS5yZW1vdmVBdHRyaWJ1dGUoXCJhcmlhLWhpZGRlblwiKTtcbiAgICAgICAgQ29udGVudE5vRmVhdHVyZS5zZXRBdHRyaWJ1dGUoXCJhcmlhLWhpZGRlblwiLCBcInRydWVcIik7XG4gICAgICAgIENvbnRlbnRGZWF0dXJlLm1pbmltYXAgPSBtaW5pbWFwO1xuICAgICAgICBDb250ZW50RmVhdHVyZS5hY2Nlc3NUb2tlbiA9IGFjY2Vzc1Rva2VuO1xuICAgICAgICBDb250ZW50RmVhdHVyZS5mb290ZXIgPSBmb290ZXI7XG4gICAgICAgIENvbnRlbnRGZWF0dXJlLnVwZGF0ZShmZWF0dXJlLCBhdXRvZmlsbFZhbHVlcyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBDb250ZW50RmVhdHVyZS5zZXRBdHRyaWJ1dGUoXCJhcmlhLWhpZGRlblwiLCBcInRydWVcIik7XG4gICAgICAgIENvbnRlbnROb0ZlYXR1cmUucmVtb3ZlQXR0cmlidXRlKFwiYXJpYS1oaWRkZW5cIik7XG4gICAgICAgIENvbnRlbnROb0ZlYXR1cmUudXBkYXRlKGF1dG9maWxsVmFsdWVzKTtcbiAgICAgIH1cbiAgICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfc2hvdywgdHJ1ZSk7XG4gICAgICBNYXBib3hBZGRyZXNzQ29uZmlybWF0aW9uMi5yZW1vdmVBdHRyaWJ1dGUoXCJhcmlhLWhpZGRlblwiKTtcbiAgICAgIG5vU2Nyb2xsLm9uKCk7XG4gICAgICBjb25zdCBhY3RpdmVDb250ZW50RWxlbWVudCA9IGZlYXR1cmUgPyBDb250ZW50RmVhdHVyZSA6IENvbnRlbnROb0ZlYXR1cmU7XG4gICAgICBfX3ByaXZhdGVTZXQodGhpcywgX2ZvY3VzVHJhcCwgY3JlYXRlRm9jdXNUcmFwKE1hcGJveEFkZHJlc3NDb25maXJtYXRpb24yLCB7XG4gICAgICAgIGZhbGxiYWNrRm9jdXM6IGFjdGl2ZUNvbnRlbnRFbGVtZW50LFxuICAgICAgICBlc2NhcGVEZWFjdGl2YXRlczogKCkgPT4ge1xuICAgICAgICAgIHRoaXMuaGlkZSgpO1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICB9KSk7XG4gICAgICAoX2EgPSBfX3ByaXZhdGVHZXQodGhpcywgX2ZvY3VzVHJhcCkpID09IG51bGwgPyB2b2lkIDAgOiBfYS5hY3RpdmF0ZSgpO1xuICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICAgIGNvbnN0IGV2ZW50SG9zdCA9IGFjdGl2ZUNvbnRlbnRFbGVtZW50O1xuICAgICAgICBjb25zdCBmbiA9IChlKSA9PiB7XG4gICAgICAgICAgZXZlbnRIb3N0LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJyZXN1bHRcIiwgZm4pO1xuICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGUuZGV0YWlsO1xuICAgICAgICAgIHRoaXMuaGlkZSgpO1xuICAgICAgICAgIGlmIChyZXN1bHQgPT09IFwiY2hhbmdlXCIpIHtcbiAgICAgICAgICAgIHJlc29sdmUoe1xuICAgICAgICAgICAgICB0eXBlOiBcImNoYW5nZVwiLFxuICAgICAgICAgICAgICBmZWF0dXJlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVzb2x2ZSh7XG4gICAgICAgICAgICAgIHR5cGU6IHJlc3VsdFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBldmVudEhvc3QuYWRkRXZlbnRMaXN0ZW5lcihcInJlc3VsdFwiLCBmbik7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuICB0cnlTaG93KGF1dG9maWxsVmFsdWVzLCBvcHRpb25zQXJnKSB7XG4gICAgcmV0dXJuIF9fYXN5bmModGhpcywgbnVsbCwgZnVuY3Rpb24qICgpIHtcbiAgICAgIGlmICghX19wcml2YXRlR2V0KHRoaXMsIF9iaW5kaW5nMikpIHtcbiAgICAgICAgcmV0dXJuIHsgdHlwZTogXCJjYW5jZWxcIiB9O1xuICAgICAgfVxuICAgICAgY29uc3QgeyBhY2Nlc3NUb2tlbiwgb3B0aW9ucyA9IHt9IH0gPSBvcHRpb25zQXJnO1xuICAgICAgY29uc3QgdmFsaWRhdGUgPSBuZXcgVmFsaWRhdGlvbkNvcmUoX19zcHJlYWRWYWx1ZXMoe1xuICAgICAgICBhY2Nlc3NUb2tlblxuICAgICAgfSwgb3B0aW9ucykpO1xuICAgICAgY29uc3Qgc2VhcmNoVGV4dCA9IGdldEF1dG9maWxsU2VhcmNoVGV4dChhdXRvZmlsbFZhbHVlcyk7XG4gICAgICBjb25zdCBmZWF0dXJlQ29sbGVjdGlvbiA9IHlpZWxkIHZhbGlkYXRlLnZhbGlkYXRlKHNlYXJjaFRleHQsIHtcbiAgICAgICAgc2Vzc2lvblRva2VuOiBjb25maWcuYXV0b2ZpbGxTZXNzaW9uVG9rZW5cbiAgICAgIH0pO1xuICAgICAgY29uc3QgZmVhdHVyZSA9IGZlYXR1cmVDb2xsZWN0aW9uLmZlYXR1cmVzWzBdO1xuICAgICAgaWYgKGZlYXR1cmUpIHtcbiAgICAgICAgY29uc3QgZGVmYXVsdFZhbGlkYXRpb24gPSAoZmVhdHVyZTIpID0+IGZlYXR1cmUyLnByb3BlcnRpZXMubWF0Y2hfY29kZS5jb25maWRlbmNlID09PSBNYXRjaENvZGVDb25maWRlbmNlLmV4YWN0O1xuICAgICAgICBjb25zdCB7IHNraXBDb25maXJtTW9kYWwgPSBkZWZhdWx0VmFsaWRhdGlvbiB9ID0gb3B0aW9uc0FyZztcbiAgICAgICAgaWYgKHNraXBDb25maXJtTW9kYWwoZmVhdHVyZSkpIHtcbiAgICAgICAgICByZXR1cm4geyB0eXBlOiBcIm5vY2hhbmdlXCIgfTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHlpZWxkIHRoaXMuc2hvdyhhdXRvZmlsbFZhbHVlcywgb3B0aW9uc0FyZywgZmVhdHVyZSk7XG4gICAgfSk7XG4gIH1cbn07XG5fc2hvdyA9IG5ldyBXZWFrTWFwKCk7XG5fYmluZGluZzIgPSBuZXcgV2Vha01hcCgpO1xuX2ZvY3VzVHJhcCA9IG5ldyBXZWFrTWFwKCk7XG5fdGhlbWVJbnRlcm5hbDIgPSBuZXcgV2Vha01hcCgpO1xud2luZG93Lk1hcGJveEFkZHJlc3NDb25maXJtYXRpb24gPSBNYXBib3hBZGRyZXNzQ29uZmlybWF0aW9uO1xuaWYgKCF3aW5kb3cuY3VzdG9tRWxlbWVudHMuZ2V0KFwibWFwYm94LWFkZHJlc3MtY29uZmlybWF0aW9uXCIpKSB7XG4gIGN1c3RvbUVsZW1lbnRzLmRlZmluZShcIm1hcGJveC1hZGRyZXNzLWNvbmZpcm1hdGlvblwiLCBNYXBib3hBZGRyZXNzQ29uZmlybWF0aW9uKTtcbn1cblxuLy8gc3JjL2NvbmZpcm1BZGRyZXNzLnRzXG52YXIgY29uZmlybWF0aW9uID0gbmV3IE1hcGJveEFkZHJlc3NDb25maXJtYXRpb24oKTtcbmZ1bmN0aW9uIGNvbmZpcm1BZGRyZXNzKF8wKSB7XG4gIHJldHVybiBfX2FzeW5jKHRoaXMsIGFyZ3VtZW50cywgZnVuY3Rpb24qIChmb3JtLCBvcHRpb25zQXJnID0ge30pIHtcbiAgICB2YXIgX2E7XG4gICAgY29uc3QgeyBzZWN0aW9ucyA9IFtdIH0gPSBvcHRpb25zQXJnO1xuICAgIGlmICghY29uZmlybWF0aW9uLnBhcmVudE5vZGUpIHtcbiAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoY29uZmlybWF0aW9uKTtcbiAgICB9XG4gICAgbGV0IGNvbGxlY3RlZFJlc3VsdCA9IHsgdHlwZTogXCJub2NoYW5nZVwiIH07XG4gICAgY29uc3QgaW5wdXRzID0gZmluZEFkZHJlc3NJbnB1dHMoZm9ybSk7XG4gICAgY29uc3Qgc3RydWN0dXJlID0gcGFyc2VGb3JtU3RydWN0dXJlKGZvcm0pO1xuICAgIGNvbnN0IGxpc3Rib3hDb21wb25lbnRzID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwibWFwYm94LXNlYXJjaC1saXN0Ym94XCIpKTtcbiAgICBmb3IgKGNvbnN0IGlucHV0IG9mIGlucHV0cykge1xuICAgICAgaWYgKHNlY3Rpb25zLmxlbmd0aCkge1xuICAgICAgICBjb25zdCBzdHJ1Y3R1cmVSZWYgPSBzdHJ1Y3R1cmUuZmluZCgocykgPT4gcy5pbnB1dCA9PT0gaW5wdXQpO1xuICAgICAgICBpZiAoIXN0cnVjdHVyZVJlZikge1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICghc2VjdGlvbnMuaW5jbHVkZXMoc3RydWN0dXJlUmVmLnNlY3Rpb24pKSB7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGNvbnN0IGF1dG9maWxsVmFsdWVzID0gZ2V0Rm9ybUF1dG9maWxsVmFsdWVzKGZvcm0sIGlucHV0KTtcbiAgICAgIGNvbnN0IGxpc3Rib3ggPSBsaXN0Ym94Q29tcG9uZW50cy5maW5kKChsYikgPT4gbGIuaW5wdXQgPT09IGlucHV0KTtcbiAgICAgIGNvbnN0IGF1dG9maWxsMiA9IGxpc3Rib3ggPT0gbnVsbCA/IHZvaWQgMCA6IGxpc3Rib3guYXV0b2ZpbGxIb3N0O1xuICAgICAgaWYgKGF1dG9maWxsMikge1xuICAgICAgICBjb25zdCBsYXN0UmV0cmlldmVkRmVhdHVyZSA9IGF1dG9maWxsMi5yZXRyaWV2ZUZlYXR1cmU7XG4gICAgICAgIGlmIChsYXN0UmV0cmlldmVkRmVhdHVyZSkge1xuICAgICAgICAgIGNvbnN0IHNuYXBzaG90ID0gZmVhdHVyZVRvQXV0b2ZpbGxWYWx1ZU1hcChsYXN0UmV0cmlldmVkRmVhdHVyZSk7XG4gICAgICAgICAgaWYgKCFjaGVja0F1dG9maWxsVmFsdWVzQ2hhbmdlZChhdXRvZmlsbFZhbHVlcywgc25hcHNob3QpKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGNvbnN0IGFjY2Vzc1Rva2VuID0gb3B0aW9uc0FyZy5hY2Nlc3NUb2tlbiB8fCBjb25maWcuYWNjZXNzVG9rZW47XG4gICAgICBjb25zdCByZXN1bHQgPSB5aWVsZCBjb25maXJtYXRpb24udHJ5U2hvdyhhdXRvZmlsbFZhbHVlcywgX19zcHJlYWRQcm9wcyhfX3NwcmVhZFZhbHVlcyh7fSwgb3B0aW9uc0FyZyksIHtcbiAgICAgICAgYWNjZXNzVG9rZW5cbiAgICAgIH0pKTtcbiAgICAgIGlmIChyZXN1bHQudHlwZSA9PT0gXCJjaGFuZ2VcIikge1xuICAgICAgICBjb25zdCBpbnB1dE1hcCA9IGZpbmRBZGRyZXNzQXV0b2ZpbGxJbnB1dHMoZm9ybSwgaW5wdXQpO1xuICAgICAgICBpZiAoKF9hID0gaW5wdXRNYXBbXCJhZGRyZXNzLWxpbmUyXCJdKSA9PSBudWxsID8gdm9pZCAwIDogX2EudmFsdWUpIHtcbiAgICAgICAgICByZXN1bHQuZmVhdHVyZS5wcm9wZXJ0aWVzLmFkZHJlc3NfbGluZTIgPSBpbnB1dE1hcFtcImFkZHJlc3MtbGluZTJcIl0udmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGxpc3Rib3gpIHtcbiAgICAgICAgICBhdXRvZmlsbDIuc2ltdWxhdGVSZXRyaWV2ZShyZXN1bHQuZmVhdHVyZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaW5wdXQuZGF0YXNldFtcIm1hcGJveFN1Y2Nlc3NcIl0gPSBcInRydWVcIjtcbiAgICAgICAgICBjb25zdCBzdWdnZXN0aW9uID0gZmVhdHVyZVRvU3VnZ2VzdGlvbjIocmVzdWx0LmZlYXR1cmUpO1xuICAgICAgICAgIHNldEZvcm1BdXRvZmlsbFZhbHVlcyhmb3JtLCBpbnB1dCwgc3VnZ2VzdGlvbik7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChyZXN1bHQudHlwZSA9PT0gXCJjaGFuZ2VcIiAmJiBjb2xsZWN0ZWRSZXN1bHQudHlwZSAhPT0gXCJjYW5jZWxcIikge1xuICAgICAgICBjb2xsZWN0ZWRSZXN1bHQgPSByZXN1bHQ7XG4gICAgICB9XG4gICAgICBpZiAocmVzdWx0LnR5cGUgPT09IFwiY2FuY2VsXCIpIHtcbiAgICAgICAgY29sbGVjdGVkUmVzdWx0ID0gcmVzdWx0O1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gY29sbGVjdGVkUmVzdWx0O1xuICB9KTtcbn1cblxuLy8gc3JjL3V0aWxzL2NvbmZpcm1hdGlvbi50c1xuZnVuY3Rpb24gY3JlYXRlQWRkcmVzc0VsZW1lbnQoYXV0b2ZpbGxWYWx1ZXMsIGJhc2VBZGRyZXNzLCBmZWF0dXJlTmFtZSwgZmVhdHVyZURlc2NyaXB0aW9uLCBpc1NlY29uZGFyeSkge1xuICBpZiAoYmFzZUFkZHJlc3MpIHtcbiAgICBjb25zdCBlbGVtZW50ID0gY3JlYXRlRWxlbWVudEZyb21TdHJpbmcoYFxuICAgICAgICA8c3Bhbj5cbiAgICAgICAgICA8c3Bhbj48L3NwYW4+XG4gICAgICAgICAgPGJyIC8+XG4gICAgICAgICAgPHNwYW4+PC9zcGFuPlxuICAgICAgICA8L3NwYW4+XG4gICAgICBgKTtcbiAgICBjb25zdCBbZmlyc3RMaW5lLCBsYXN0TGluZV0gPSBBcnJheS5mcm9tKGVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChcInNwYW4gPiBzcGFuXCIpKTtcbiAgICBpZiAoZmVhdHVyZU5hbWUgJiYgZmVhdHVyZURlc2NyaXB0aW9uKSB7XG4gICAgICBmaXJzdExpbmUudGV4dENvbnRlbnQgPSBmZWF0dXJlTmFtZTtcbiAgICAgIGxhc3RMaW5lLnRleHRDb250ZW50ID0gZmVhdHVyZURlc2NyaXB0aW9uO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBwYXJ0cyA9IGJhc2VBZGRyZXNzLnNwbGl0KFwiLFwiKTtcbiAgICAgIGZpcnN0TGluZS50ZXh0Q29udGVudCA9IHBhcnRzWzBdLnRyaW0oKTtcbiAgICAgIGxhc3RMaW5lLnRleHRDb250ZW50ID0gcGFydHMuc2xpY2UoMSkuam9pbihcIixcIikudHJpbSgpO1xuICAgIH1cbiAgICBpZiAoIWlzU2Vjb25kYXJ5KSB7XG4gICAgICBpZiAoYXV0b2ZpbGxWYWx1ZXNbXCJhZGRyZXNzLWxpbmUyXCJdKSB7XG4gICAgICAgIGNvbnN0IHNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTtcbiAgICAgICAgc3Bhbi50ZXh0Q29udGVudCA9IGF1dG9maWxsVmFsdWVzW1wiYWRkcmVzcy1saW5lMlwiXTtcbiAgICAgICAgZWxlbWVudC5pbnNlcnRCZWZvcmUoc3BhbiwgbGFzdExpbmUpO1xuICAgICAgICBlbGVtZW50Lmluc2VydEJlZm9yZShkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnJcIiksIGxhc3RMaW5lKTtcbiAgICAgIH1cbiAgICAgIGlmIChhdXRvZmlsbFZhbHVlc1tcImFkZHJlc3MtbGluZTNcIl0pIHtcbiAgICAgICAgY29uc3Qgc3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpO1xuICAgICAgICBzcGFuLnRleHRDb250ZW50ID0gYXV0b2ZpbGxWYWx1ZXNbXCJhZGRyZXNzLWxpbmUzXCJdO1xuICAgICAgICBlbGVtZW50Lmluc2VydEJlZm9yZShzcGFuLCBsYXN0TGluZSk7XG4gICAgICAgIGVsZW1lbnQuaW5zZXJ0QmVmb3JlKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJiclwiKSwgbGFzdExpbmUpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZWxlbWVudDtcbiAgfSBlbHNlIHtcbiAgICBjb25zdCBmaXJzdExpbmUgPSBhdXRvZmlsbFZhbHVlc1tcInN0cmVldC1hZGRyZXNzXCJdIHx8IGF1dG9maWxsVmFsdWVzW1wiYWRkcmVzcy1saW5lMVwiXSB8fCBcIlwiO1xuICAgIGNvbnN0IGxpbmUyID0gYXV0b2ZpbGxWYWx1ZXNbXCJhZGRyZXNzLWxpbmUyXCJdO1xuICAgIGNvbnN0IGxpbmUzID0gYXV0b2ZpbGxWYWx1ZXNbXCJhZGRyZXNzLWxpbmUzXCJdO1xuICAgIGNvbnN0IGxhc3RMaW5lID0gW1xuICAgICAgYXV0b2ZpbGxWYWx1ZXNbXCJhZGRyZXNzLWxldmVsNFwiXSB8fCBcIlwiLFxuICAgICAgYXV0b2ZpbGxWYWx1ZXNbXCJhZGRyZXNzLWxldmVsM1wiXSB8fCBcIlwiLFxuICAgICAgYXV0b2ZpbGxWYWx1ZXNbXCJhZGRyZXNzLWxldmVsMlwiXSB8fCBcIlwiLFxuICAgICAgYCR7YXV0b2ZpbGxWYWx1ZXNbXCJhZGRyZXNzLWxldmVsMVwiXSB8fCBcIlwifSAke2F1dG9maWxsVmFsdWVzW1wicG9zdGFsLWNvZGVcIl0gfHwgXCJcIn1gLFxuICAgICAgYXV0b2ZpbGxWYWx1ZXMuY291bnRyeSB8fCBhdXRvZmlsbFZhbHVlc1tcImNvdW50cnktbmFtZVwiXSB8fCBcIlwiXG4gICAgXS5maWx0ZXIoQm9vbGVhbikuam9pbihcIiwgXCIpO1xuICAgIGNvbnN0IGFkZHJlc3NMaW5lcyA9IFtmaXJzdExpbmUsIGxpbmUyLCBsaW5lMywgbGFzdExpbmVdLmZpbHRlcihCb29sZWFuKTtcbiAgICBjb25zdCBhZGRyZXNzTGluZXNIdG1sID0gYWRkcmVzc0xpbmVzLm1hcCgodmFsKSA9PiBgPHNwYW4+JHt2YWx9PC9zcGFuPmApLmpvaW4oXCI8YnIgLz5cIik7XG4gICAgY29uc3QgZWxlbWVudCA9IGNyZWF0ZUVsZW1lbnRGcm9tU3RyaW5nKGBcbiAgICAgICAgPHNwYW4+JHthZGRyZXNzTGluZXNIdG1sfTwvc3Bhbj5cbiAgICAgIGApO1xuICAgIHJldHVybiBlbGVtZW50O1xuICB9XG59XG5mdW5jdGlvbiB0cnlDb25maXJtQnJvd3NlckF1dG9maWxsKGlucHV0LCBldmVudCwgY29uZmlybU9uQnJvd3NlckF1dG9maWxsLCBhY2Nlc3NUb2tlbikge1xuICByZXR1cm4gX19hc3luYyh0aGlzLCBudWxsLCBmdW5jdGlvbiogKCkge1xuICAgIGlmICghY29uZmlybU9uQnJvd3NlckF1dG9maWxsKVxuICAgICAgcmV0dXJuO1xuICAgIGNvbnN0IHBhcmVudEZvcm0gPSBmaW5kUGFyZW50Rm9ybShpbnB1dCk7XG4gICAgY29uc3QgZm9ybUVsZW1lbnRzID0gT2JqZWN0LnZhbHVlcyhmaW5kQWRkcmVzc0F1dG9maWxsSW5wdXRzKHBhcmVudEZvcm0sIGlucHV0KSk7XG4gICAgaWYgKCFldmVudC5kZXRhaWwuZWxlbWVudHMuc29tZSgoZWwpID0+IGZvcm1FbGVtZW50cy5pbmNsdWRlcyhlbCkpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IHN0cnVjdHVyZSA9IHBhcnNlRm9ybVN0cnVjdHVyZShwYXJlbnRGb3JtKTtcbiAgICBjb25zdCBzdHJ1Y3R1cmVSZWYgPSBzdHJ1Y3R1cmUuZmluZCgocykgPT4gcy5pbnB1dCA9PT0gaW5wdXQpO1xuICAgIGNvbnN0IGF1dG9maWxsSW5zdGFuY2VTZWN0aW9uID0gc3RydWN0dXJlUmVmLnNlY3Rpb247XG4gICAgY29uc3QgYnJvd3NlckF1dG9maWxsZWRTZWN0aW9ucyA9IEFycmF5LmZyb20obmV3IFNldChzdHJ1Y3R1cmUuZmlsdGVyKChzKSA9PiBldmVudC5kZXRhaWwuZWxlbWVudHMuaW5jbHVkZXMocy5pbnB1dCkpLm1hcCgocykgPT4gcy5zZWN0aW9uKSkpO1xuICAgIGlmICghYnJvd3NlckF1dG9maWxsZWRTZWN0aW9ucy5pbmNsdWRlcyhhdXRvZmlsbEluc3RhbmNlU2VjdGlvbikpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3Qgb3B0aW9uc1NlY3Rpb25zID0gdHlwZW9mIGNvbmZpcm1PbkJyb3dzZXJBdXRvZmlsbCA9PT0gXCJvYmplY3RcIiAmJiBjb25maXJtT25Ccm93c2VyQXV0b2ZpbGwuc2VjdGlvbnMgfHwgW107XG4gICAgaWYgKG9wdGlvbnNTZWN0aW9ucy5sZW5ndGggJiYgIW9wdGlvbnNTZWN0aW9ucy5zb21lKChzZWN0aW9uKSA9PiBicm93c2VyQXV0b2ZpbGxlZFNlY3Rpb25zLmluY2x1ZGVzKHNlY3Rpb24pKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBsZXQgb3B0aW9uc0FyZyA9IHR5cGVvZiBjb25maXJtT25Ccm93c2VyQXV0b2ZpbGwgPT09IFwib2JqZWN0XCIgPyBjb25maXJtT25Ccm93c2VyQXV0b2ZpbGwgOiB7fTtcbiAgICBvcHRpb25zQXJnID0gX19zcHJlYWRQcm9wcyhfX3NwcmVhZFZhbHVlcyh7fSwgb3B0aW9uc0FyZyksIHtcbiAgICAgIGFjY2Vzc1Rva2VuLFxuICAgICAgc2VjdGlvbnM6IFthdXRvZmlsbEluc3RhbmNlU2VjdGlvbl1cbiAgICB9KTtcbiAgICB5aWVsZCBjb25maXJtQWRkcmVzcyhwYXJlbnRGb3JtLCBvcHRpb25zQXJnKTtcbiAgfSk7XG59XG5cbi8vIHNyYy91dGlscy9jb250cmlidXRlLnRzXG52YXIgQ09OVFJJQlVURV9BUElfQkFTRV9VUkwgPSBcImh0dHBzOi8vY29udHJpYnV0ZS1hcGkubWFwYm94LmNvbS92MVwiO1xudmFyIENPTlRSSUJVVEVfQVBJX1NUQUdJTkdfQkFTRV9VUkwgPSBcImh0dHBzOi8vY29udHJpYnV0ZS1hcGktc3RhZ2luZy50aWxlc3RyZWFtLm5ldC92MVwiO1xudmFyIEVESVRfU1VHR0VTVElPTl9FTkRQT0lOVCA9IFwiZWRpdC1zdWdnZXN0aW9uXCI7XG5mdW5jdGlvbiBzZW5kRmVlZGJhY2soYWNjZXNzVG9rZW4sIGZlZWRiYWNrQXJncykge1xuICBpZiAoIWNvbmZpZy5mZWVkYmFja0VuYWJsZWQpXG4gICAgcmV0dXJuO1xuICBjb25zdCBob3N0bmFtZSA9IHdpbmRvdy5sb2NhdGlvbi5ob3N0bmFtZTtcbiAgY29uc3QgQkFTRV9VUkwgPSBpc0xvY2FsU2VydmVyKGhvc3RuYW1lKSB8fCBpc01hcGJveERvbWFpbihob3N0bmFtZSkgPyBDT05UUklCVVRFX0FQSV9TVEFHSU5HX0JBU0VfVVJMIDogQ09OVFJJQlVURV9BUElfQkFTRV9VUkw7XG4gIGNvbnN0IHVybCA9IGAke0JBU0VfVVJMfS8ke0VESVRfU1VHR0VTVElPTl9FTkRQT0lOVH0vYWRkcmVzcz9hY2Nlc3NfdG9rZW49JHthY2Nlc3NUb2tlbn1gO1xuICBjb25zdCB7IG9yaWdpbmFsQ29vcmRpbmF0ZSwgb3JpZ2luYWxBZGRyZXNzLCBjaGFuZ2VzIH0gPSBmZWVkYmFja0FyZ3M7XG4gIGNvbnN0IHBheWxvYWQgPSB7XG4gICAgYWN0aW9uOiBcInVwZGF0ZVwiLFxuICAgIHJlYXNvbjogXCJpbmNvcnJlY3RfYWRkcmVzc1wiLFxuICAgIGxvY2F0aW9uOiB7XG4gICAgICBsb25naXR1ZGU6IG9yaWdpbmFsQ29vcmRpbmF0ZVswXSxcbiAgICAgIGxhdGl0dWRlOiBvcmlnaW5hbENvb3JkaW5hdGVbMV1cbiAgICB9LFxuICAgIHVzZXJFbWFpbDogXCJuby1yZXBseS1hdXRvZmlsbEBtYXBib3guY29tXCIsXG4gICAgY2hhbmdlcyxcbiAgICBwbGFjZU5hbWU6IG9yaWdpbmFsQWRkcmVzc1xuICB9O1xuICBmZXRjaCh1cmwsIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIGhlYWRlcnM6IG5ldyBIZWFkZXJzKHtcbiAgICAgIFwiVXNlci1BZ2VudFwiOiBgbWFwYm94LXNlYXJjaC1qcy4ke3ZlcnNpb259LiR7bmF2aWdhdG9yLnVzZXJBZ2VudH1gLFxuICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCJcbiAgICB9KSxcbiAgICBib2R5OiBKU09OLnN0cmluZ2lmeShwYXlsb2FkKVxuICB9KTtcbn1cblxuLy8gc3JjL2NvbXBvbmVudHMvTWFwYm94QWRkcmVzc0NvbmZpcm1hdGlvbkZlYXR1cmUudHNcbnZhciBURU1QTEFURTIgPSBjcmVhdGVFbGVtZW50RnJvbVN0cmluZyhgXG48dGVtcGxhdGU+XG4gIDxkaXYgY2xhc3M9XCJNYXBib3hBZGRyZXNzQ29uZmlybWF0aW9uRmVhdHVyZVwiPlxuICAgIDxkaXYgY2xhc3M9XCJNb2RhbFwiIGFyaWEtbW9kYWw9XCJ0cnVlXCIgcm9sZT1cImRpYWxvZ1wiPlxuICAgICAgPGRpdiBjbGFzcz1cIk1vZGFsSGVhZGVyXCI+XG4gICAgICAgIDxzdmcgdmlld0JveD1cIjAgMCAxOCAxOFwiIGNsYXNzPVwiSWNvbiBJY29uUXVlc3Rpb25cIj48L3N2Zz5cbiAgICAgICAgPGRpdiBjbGFzcz1cIk1vZGFsSGVhZGVyVGl0bGVcIj5EaWQgeW91IG1lYW4/PC9kaXY+XG4gICAgICAgIDxzdmdcbiAgICAgICAgICB2aWV3Qm94PVwiMCAwIDE4IDE4XCJcbiAgICAgICAgICBjbGFzcz1cIkljb24gSWNvbkNsb3NlXCJcbiAgICAgICAgICB0YWJpbmRleD1cIjBcIlxuICAgICAgICAgIHJvbGU9XCJidXR0b25cIlxuICAgICAgICAgIHRpdGxlPVwiQ2xvc2VcIlxuICAgICAgICAgIGFyaWEtbGFiZWw9XCJDbG9zZVwiXG4gICAgICAgICAgYXJpYS1leHBhbmRlZD1cInRydWVcIlxuICAgICAgICA+PC9zdmc+XG4gICAgICA8L2Rpdj5cblxuICAgICAgPGRpdiBjbGFzcz1cIk1vZGFsQWRkcmVzcyBNb2RhbEFkZHJlc3NBcHByb3ZlXCI+PC9kaXY+XG4gICAgICAgICAgICBcbiAgICAgIDxkaXYgY2xhc3M9XCJNb2RhbE1hcFwiPlxuICAgICAgICA8bWFwYm94LWFkZHJlc3MtbWluaW1hcCBjbGFzcz1cIk1pbmltYXBcIj48L21hcGJveC1hZGRyZXNzLW1pbmltYXA+XG4gICAgICA8L2Rpdj5cblxuICAgICAgPGRpdlxuICAgICAgICBjbGFzcz1cIkJ1dHRvbiBCdXR0b25QcmltYXJ5IEJ1dHRvbkFwcHJvdmVcIlxuICAgICAgICB0YWJpbmRleD1cIjBcIlxuICAgICAgICByb2xlPVwiYnV0dG9uXCJcbiAgICAgICAgYXJpYS1sYWJlbD1cIlllc1wiXG4gICAgICA+XG4gICAgICAgIFllc1xuICAgICAgPC9kaXY+XG4gICAgICBcbiAgICAgIDxkaXZcbiAgICAgICAgY2xhc3M9XCJCdXR0b24gQnV0dG9uU2Vjb25kYXJ5IEJ1dHRvblJlamVjdFwiXG4gICAgICAgIHRhYmluZGV4PVwiMFwiXG4gICAgICAgIHJvbGU9XCJidXR0b25cIlxuICAgICAgICBhcmlhLWxhYmVsPVwiTm8sIHVzZSB0aGUgYWRkcmVzcyBJIHByb3ZpZGVkXCJcbiAgICAgID5cbiAgICAgICAgTm8sIHVzZSB0aGUgYWRkcmVzcyBJIHByb3ZpZGVkXG4gICAgICA8L2Rpdj5cblxuICAgICAgPGRpdiBjbGFzcz1cIk1vZGFsRm9vdGVyXCI+XG4gICAgICAgICAgWW91ciBjb25maXJtYXRpb24gaGVscHMgaW1wcm92ZSBhZGRyZXNzIGRhdGEgYWNjdXJhY3kuXG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cbiAgPC9kaXY+XG48L3RlbXBsYXRlPlxuYCk7XG52YXIgX2JpbmRpbmczLCBfdGhlbWVJbnRlcm5hbDMsIF9mZWF0dXJlLCBfZm9ybVZhbHVlcywgX2hhbmRsZUNsb3NlLCBfbW9kYWxJRCwgX21vZGFsSGVhZGVyVGl0bGVJRCwgX21vZGFsQWRkcmVzc0FwcHJvdmVJRDtcbnZhciBNYXBib3hBZGRyZXNzQ29uZmlybWF0aW9uRmVhdHVyZSA9IGNsYXNzIGV4dGVuZHMgSFRNTFNjb3BlZEVsZW1lbnQge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlciguLi5hcmd1bWVudHMpO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfYmluZGluZzMsIHZvaWQgMCk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF90aGVtZUludGVybmFsMywge30pO1xuICAgIHRoaXMubWluaW1hcCA9IGZhbHNlO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfZmVhdHVyZSwgdm9pZCAwKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX2Zvcm1WYWx1ZXMsIHZvaWQgMCk7XG4gICAgdGhpcy51cGRhdGUgPSAoZmVhdHVyZSwgYXV0b2ZpbGxWYWx1ZXMpID0+IHtcbiAgICAgIHZhciBfYTtcbiAgICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfZmVhdHVyZSwgZmVhdHVyZSk7XG4gICAgICBfX3ByaXZhdGVTZXQodGhpcywgX2Zvcm1WYWx1ZXMsIGF1dG9maWxsVmFsdWVzKTtcbiAgICAgIGNvbnN0IHsgTW9kYWxNYXAsIE1pbmltYXAsIE1vZGFsQWRkcmVzc0FwcHJvdmUgfSA9IF9fcHJpdmF0ZUdldCh0aGlzLCBfYmluZGluZzMpO1xuICAgICAgaWYgKHRoaXMubWluaW1hcCkge1xuICAgICAgICBNb2RhbE1hcC5yZW1vdmVBdHRyaWJ1dGUoXCJhcmlhLWhpZGRlblwiKTtcbiAgICAgICAgTWluaW1hcC5hY2Nlc3NUb2tlbiA9IHRoaXMuYWNjZXNzVG9rZW47XG4gICAgICAgIGlmICh0eXBlb2YgdGhpcy5taW5pbWFwID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgY29uc3QgeyBkZWZhdWx0TWFwU3R5bGUsIHRoZW1lLCBtYXBTdHlsZU1vZGUsIHNhdGVsbGl0ZVRvZ2dsZSB9ID0gdGhpcy5taW5pbWFwO1xuICAgICAgICAgIGRlZmF1bHRNYXBTdHlsZSAmJiAoTWluaW1hcC5kZWZhdWx0TWFwU3R5bGUgPSB0aGlzLm1pbmltYXAuZGVmYXVsdE1hcFN0eWxlKTtcbiAgICAgICAgICB0aGVtZSAmJiAoTWluaW1hcC50aGVtZSA9IHRoaXMubWluaW1hcC50aGVtZSk7XG4gICAgICAgICAgbWFwU3R5bGVNb2RlICYmIChNaW5pbWFwLm1hcFN0eWxlTW9kZSA9IG1hcFN0eWxlTW9kZSk7XG4gICAgICAgICAgc2F0ZWxsaXRlVG9nZ2xlICE9PSB2b2lkIDAgJiYgKE1pbmltYXAuc2F0ZWxsaXRlVG9nZ2xlID0gc2F0ZWxsaXRlVG9nZ2xlKTtcbiAgICAgICAgfVxuICAgICAgICBNaW5pbWFwLmZlYXR1cmUgPSBmZWF0dXJlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgTW9kYWxNYXAuc2V0QXR0cmlidXRlKFwiYXJpYS1oaWRkZW5cIiwgXCJ0cnVlXCIpO1xuICAgICAgfVxuICAgICAgY29uc3QgYXBwcm92ZUFkZHJlc3MgPSBmZWF0dXJlLnByb3BlcnRpZXMucGxhY2VfbmFtZSB8fCBmZWF0dXJlLnByb3BlcnRpZXMuZnVsbF9hZGRyZXNzIHx8IGZlYXR1cmUucHJvcGVydGllcy5hZGRyZXNzO1xuICAgICAgTW9kYWxBZGRyZXNzQXBwcm92ZS5pbm5lckhUTUwgPSBcIlwiO1xuICAgICAgTW9kYWxBZGRyZXNzQXBwcm92ZS5hcHBlbmRDaGlsZChjcmVhdGVBZGRyZXNzRWxlbWVudChhdXRvZmlsbFZhbHVlcywgYXBwcm92ZUFkZHJlc3MsIGZlYXR1cmUucHJvcGVydGllcy5mZWF0dXJlX25hbWUsIGZlYXR1cmUucHJvcGVydGllcy5kZXNjcmlwdGlvbiwgKChfYSA9IGZlYXR1cmUucHJvcGVydGllcy5wbGFjZV90eXBlKSA9PSBudWxsID8gdm9pZCAwIDogX2FbMF0pID09PSBcInNlY29uZGFyeV9hZGRyZXNzXCIpKTtcbiAgICB9O1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfaGFuZGxlQ2xvc2UsICgpID0+IHtcbiAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChuZXcgTWFwYm94SFRNTEV2ZW50KFwicmVzdWx0XCIsIFwiY2FuY2VsXCIpKTtcbiAgICB9KTtcbiAgICB0aGlzLmFwcHJvdmUgPSAoKSA9PiB7XG4gICAgICB0aGlzLmRpc3BhdGNoRXZlbnQobmV3IE1hcGJveEhUTUxFdmVudChcInJlc3VsdFwiLCBcImNoYW5nZVwiKSk7XG4gICAgfTtcbiAgICB0aGlzLnJlamVjdCA9ICgpID0+IHtcbiAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChuZXcgTWFwYm94SFRNTEV2ZW50KFwicmVzdWx0XCIsIFwibm9jaGFuZ2VcIikpO1xuICAgICAgc2VuZEZlZWRiYWNrKHRoaXMuYWNjZXNzVG9rZW4sIHtcbiAgICAgICAgb3JpZ2luYWxDb29yZGluYXRlOiBfX3ByaXZhdGVHZXQodGhpcywgX2ZlYXR1cmUpLmdlb21ldHJ5LmNvb3JkaW5hdGVzLFxuICAgICAgICBvcmlnaW5hbEFkZHJlc3M6IF9fcHJpdmF0ZUdldCh0aGlzLCBfZmVhdHVyZSkucHJvcGVydGllcy5mdWxsX2FkZHJlc3MsXG4gICAgICAgIGNoYW5nZXM6IHtcbiAgICAgICAgICBhZGRyZXNzOiBnZXRBdXRvZmlsbFNlYXJjaFRleHQoX19wcml2YXRlR2V0KHRoaXMsIF9mb3JtVmFsdWVzKSlcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX21vZGFsSUQsIHJhbmRvbVZhbGlkSUQoKSk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9tb2RhbEhlYWRlclRpdGxlSUQsIHJhbmRvbVZhbGlkSUQoKSk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9tb2RhbEFkZHJlc3NBcHByb3ZlSUQsIHJhbmRvbVZhbGlkSUQoKSk7XG4gIH1cbiAgZ2V0IHRlbXBsYXRlKCkge1xuICAgIHJldHVybiBURU1QTEFURTI7XG4gIH1cbiAgZ2V0IHRlbXBsYXRlU3R5bGUoKSB7XG4gICAgcmV0dXJuIHN0eWxlX2RlZmF1bHQ7XG4gIH1cbiAgZ2V0IHRlbXBsYXRlVXNlclN0eWxlKCkge1xuICAgIHJldHVybiBnZXRUaGVtZUNTUyhcIi5NYXBib3hBZGRyZXNzQ29uZmlybWF0aW9uRmVhdHVyZVwiLCB0aGlzLnRoZW1lKTtcbiAgfVxuICBnZXQgdGhlbWUoKSB7XG4gICAgcmV0dXJuIF9fcHJpdmF0ZUdldCh0aGlzLCBfdGhlbWVJbnRlcm5hbDMpO1xuICB9XG4gIHNldCB0aGVtZSh0aGVtZSkge1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfdGhlbWVJbnRlcm5hbDMsIHRoZW1lKTtcbiAgICBpZiAoIV9fcHJpdmF0ZUdldCh0aGlzLCBfYmluZGluZzMpIHx8ICF0aGVtZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLnVwZGF0ZVRlbXBsYXRlVXNlclN0eWxlKGdldFRoZW1lQ1NTKFwiLk1hcGJveEFkZHJlc3NDb25maXJtYXRpb25GZWF0dXJlXCIsIHRoZW1lKSk7XG4gICAgY29uc3QgeyBJY29uUXVlc3Rpb24sIEljb25DbG9zZSB9ID0gX19wcml2YXRlR2V0KHRoaXMsIF9iaW5kaW5nMyk7XG4gICAgSWNvblF1ZXN0aW9uLmlubmVySFRNTCA9IGdldEljb24oXCJxdWVzdGlvblwiLCB0aGVtZSk7XG4gICAgSWNvbkNsb3NlLmlubmVySFRNTCA9IGdldEljb24oXCJjbG9zZVwiLCB0aGVtZSk7XG4gIH1cbiAgc2V0IGZvb3Rlcih2YWwpIHtcbiAgICBpZiAodmFsID09PSB2b2lkIDApXG4gICAgICByZXR1cm47XG4gICAgY29uc3QgZm9vdGVyRWwgPSB0aGlzLnF1ZXJ5U2VsZWN0b3IoXCIuTW9kYWxGb290ZXJcIik7XG4gICAgaWYgKHR5cGVvZiB2YWwgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgIGZvb3RlckVsLnRleHRDb250ZW50ID0gdmFsO1xuICAgICAgZm9vdGVyRWwucmVtb3ZlQXR0cmlidXRlKFwiYXJpYS1oaWRkZW5cIik7XG4gICAgfSBlbHNlIGlmICghdmFsKSB7XG4gICAgICBmb290ZXJFbC5zZXRBdHRyaWJ1dGUoXCJhcmlhLWhpZGRlblwiLCBcInRydWVcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIGZvb3RlckVsLnJlbW92ZUF0dHJpYnV0ZShcImFyaWEtaGlkZGVuXCIpO1xuICAgIH1cbiAgfVxuICBjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICBzdXBlci5jb25uZWN0ZWRDYWxsYmFjaygpO1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfYmluZGluZzMsIGJpbmRFbGVtZW50cyh0aGlzLCB7XG4gICAgICBNYXBib3hBZGRyZXNzQ29uZmlybWF0aW9uRmVhdHVyZTogXCIuTWFwYm94QWRkcmVzc0NvbmZpcm1hdGlvbkZlYXR1cmVcIixcbiAgICAgIE1vZGFsOiBcIi5Nb2RhbFwiLFxuICAgICAgTW9kYWxIZWFkZXJUaXRsZTogXCIuTW9kYWxIZWFkZXJUaXRsZVwiLFxuICAgICAgTW9kYWxNYXA6IFwiLk1vZGFsTWFwXCIsXG4gICAgICBNaW5pbWFwOiBcIi5NaW5pbWFwXCIsXG4gICAgICBJY29uUXVlc3Rpb246IFwiLkljb25RdWVzdGlvblwiLFxuICAgICAgSWNvbkNsb3NlOiBcIi5JY29uQ2xvc2VcIixcbiAgICAgIEJ1dHRvbkFwcHJvdmU6IFwiLkJ1dHRvbkFwcHJvdmVcIixcbiAgICAgIEJ1dHRvblJlamVjdDogXCIuQnV0dG9uUmVqZWN0XCIsXG4gICAgICBNb2RhbEFkZHJlc3NBcHByb3ZlOiBcIi5Nb2RhbEFkZHJlc3NBcHByb3ZlXCJcbiAgICB9KSk7XG4gICAgY29uc3Qge1xuICAgICAgTW9kYWwsXG4gICAgICBNb2RhbEhlYWRlclRpdGxlLFxuICAgICAgSWNvbkNsb3NlLFxuICAgICAgQnV0dG9uQXBwcm92ZSxcbiAgICAgIEJ1dHRvblJlamVjdCxcbiAgICAgIE1vZGFsQWRkcmVzc0FwcHJvdmVcbiAgICB9ID0gX19wcml2YXRlR2V0KHRoaXMsIF9iaW5kaW5nMyk7XG4gICAgTW9kYWwuc2V0QXR0cmlidXRlKFwiYXJpYS1sYWJlbGxlZGJ5XCIsIF9fcHJpdmF0ZUdldCh0aGlzLCBfbW9kYWxIZWFkZXJUaXRsZUlEKSk7XG4gICAgTW9kYWwuc2V0QXR0cmlidXRlKFwiYXJpYS1kZXNjcmliZWRieVwiLCBfX3ByaXZhdGVHZXQodGhpcywgX21vZGFsQWRkcmVzc0FwcHJvdmVJRCkpO1xuICAgIEljb25DbG9zZS5zZXRBdHRyaWJ1dGUoXCJhcmlhLWNvbnRyb2xzXCIsIF9fcHJpdmF0ZUdldCh0aGlzLCBfbW9kYWxJRCkpO1xuICAgIE1vZGFsLmlkID0gX19wcml2YXRlR2V0KHRoaXMsIF9tb2RhbElEKTtcbiAgICBNb2RhbEhlYWRlclRpdGxlLmlkID0gX19wcml2YXRlR2V0KHRoaXMsIF9tb2RhbEhlYWRlclRpdGxlSUQpO1xuICAgIE1vZGFsQWRkcmVzc0FwcHJvdmUuaWQgPSBfX3ByaXZhdGVHZXQodGhpcywgX21vZGFsQWRkcmVzc0FwcHJvdmVJRCk7XG4gICAgY29uc3QgYnV0dG9ucyA9IEFycmF5LmZyb20odGhpcy5xdWVyeVNlbGVjdG9yQWxsKCdbcm9sZT1cImJ1dHRvblwiXScpKTtcbiAgICBmb3IgKGNvbnN0IGJ1dHRvbiBvZiBidXR0b25zKSB7XG4gICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgYXJpYUJ1dHRvbktleURvd24pO1xuICAgIH1cbiAgICBJY29uQ2xvc2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIF9fcHJpdmF0ZUdldCh0aGlzLCBfaGFuZGxlQ2xvc2UpKTtcbiAgICBCdXR0b25BcHByb3ZlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLmFwcHJvdmUpO1xuICAgIEJ1dHRvblJlamVjdC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5yZWplY3QpO1xuICAgIGNvbnN0IHRoZW1lID0gdGhpcy50aGVtZTtcbiAgICBpZiAodGhlbWUpIHtcbiAgICAgIGNvbnN0IHsgSWNvblF1ZXN0aW9uLCBJY29uQ2xvc2U6IEljb25DbG9zZTIgfSA9IF9fcHJpdmF0ZUdldCh0aGlzLCBfYmluZGluZzMpO1xuICAgICAgSWNvblF1ZXN0aW9uLmlubmVySFRNTCA9IGdldEljb24oXCJxdWVzdGlvblwiLCB0aGVtZSk7XG4gICAgICBJY29uQ2xvc2UyLmlubmVySFRNTCA9IGdldEljb24oXCJjbG9zZVwiLCB0aGVtZSk7XG4gICAgfVxuICB9XG4gIGRpc2Nvbm5lY3RlZENhbGxiYWNrKCkge1xuICAgIGNvbnN0IHsgSWNvbkNsb3NlLCBCdXR0b25BcHByb3ZlIH0gPSBfX3ByaXZhdGVHZXQodGhpcywgX2JpbmRpbmczKTtcbiAgICBJY29uQ2xvc2UucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIF9fcHJpdmF0ZUdldCh0aGlzLCBfaGFuZGxlQ2xvc2UpKTtcbiAgICBCdXR0b25BcHByb3ZlLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLmFwcHJvdmUpO1xuICB9XG59O1xuX2JpbmRpbmczID0gbmV3IFdlYWtNYXAoKTtcbl90aGVtZUludGVybmFsMyA9IG5ldyBXZWFrTWFwKCk7XG5fZmVhdHVyZSA9IG5ldyBXZWFrTWFwKCk7XG5fZm9ybVZhbHVlcyA9IG5ldyBXZWFrTWFwKCk7XG5faGFuZGxlQ2xvc2UgPSBuZXcgV2Vha01hcCgpO1xuX21vZGFsSUQgPSBuZXcgV2Vha01hcCgpO1xuX21vZGFsSGVhZGVyVGl0bGVJRCA9IG5ldyBXZWFrTWFwKCk7XG5fbW9kYWxBZGRyZXNzQXBwcm92ZUlEID0gbmV3IFdlYWtNYXAoKTtcbndpbmRvdy5NYXBib3hBZGRyZXNzQ29uZmlybWF0aW9uRmVhdHVyZSA9IE1hcGJveEFkZHJlc3NDb25maXJtYXRpb25GZWF0dXJlO1xuaWYgKCF3aW5kb3cuY3VzdG9tRWxlbWVudHMuZ2V0KFwibWFwYm94LWFkZHJlc3MtY29uZmlybWF0aW9uLWZlYXR1cmVcIikpIHtcbiAgY3VzdG9tRWxlbWVudHMuZGVmaW5lKFwibWFwYm94LWFkZHJlc3MtY29uZmlybWF0aW9uLWZlYXR1cmVcIiwgTWFwYm94QWRkcmVzc0NvbmZpcm1hdGlvbkZlYXR1cmUpO1xufVxuXG4vLyBzcmMvY29tcG9uZW50cy9NYXBib3hBZGRyZXNzQ29uZmlybWF0aW9uTm9GZWF0dXJlLnRzXG52YXIgVEVNUExBVEUzID0gY3JlYXRlRWxlbWVudEZyb21TdHJpbmcoYFxuPHRlbXBsYXRlPlxuICA8ZGl2IGNsYXNzPVwiTWFwYm94QWRkcmVzc0NvbmZpcm1hdGlvbk5vRmVhdHVyZVwiPlxuICAgIDxkaXYgY2xhc3M9XCJNb2RhbFwiIGFyaWEtbW9kYWw9XCJ0cnVlXCIgcm9sZT1cImRpYWxvZ1wiPlxuICAgICAgPGRpdiBjbGFzcz1cIk1vZGFsSGVhZGVyXCI+XG4gICAgICAgIDxzdmcgdmlld0JveD1cIjAgMCAxOCAxOFwiIGNsYXNzPVwiSWNvbiBJY29uUXVlc3Rpb25cIj48L3N2Zz5cbiAgICAgICAgPGRpdiBjbGFzcz1cIk1vZGFsSGVhZGVyVGl0bGVcIj5Db25maXJtIGFkZHJlc3M8L2Rpdj5cbiAgICAgICAgPHN2Z1xuICAgICAgICAgIHZpZXdCb3g9XCIwIDAgMTggMThcIlxuICAgICAgICAgIGNsYXNzPVwiSWNvbiBJY29uQ2xvc2VcIlxuICAgICAgICAgIHRhYmluZGV4PVwiMFwiXG4gICAgICAgICAgcm9sZT1cImJ1dHRvblwiXG4gICAgICAgICAgdGl0bGU9XCJDbG9zZVwiXG4gICAgICAgICAgYXJpYS1sYWJlbD1cIkNsb3NlXCJcbiAgICAgICAgICBhcmlhLWV4cGFuZGVkPVwidHJ1ZVwiXG4gICAgICAgID48L3N2Zz5cbiAgICAgIDwvZGl2PlxuICAgICAgPGRpdiBjbGFzcz1cIk1vZGFsRGVzY3JpcHRpb25cIj5cbiAgICAgICAgV2UgY291bGRuJ3QgdmVyaWZ5IHRoaXMgYWRkcmVzcy4gUGxlYXNlIGNoZWNrIHRoYXQgeW91ciBpbmZvcm1hdGlvbiBpcyBjb3JyZWN0IGJlZm9yZSBjb250aW51aW5nLlxuICAgICAgPC9kaXY+XG4gICAgICA8YnIgLz5cbiAgICAgIDxkaXYgY2xhc3M9XCJNb2RhbFN1YmhlYWRlclwiPlxuICAgICAgICBZb3UgZW50ZXJlZFxuICAgICAgPC9kaXY+XG4gICAgICA8ZGl2IGNsYXNzPVwiTW9kYWxBZGRyZXNzXCI+PC9kaXY+XG4gICAgICA8ZGl2XG4gICAgICAgIGNsYXNzPVwiQnV0dG9uIEJ1dHRvblByaW1hcnlcIlxuICAgICAgICB0YWJpbmRleD1cIjBcIlxuICAgICAgICByb2xlPVwiYnV0dG9uXCJcbiAgICAgICAgYXJpYS1sYWJlbD1cIlVzZSB0aGUgYWRkcmVzcyBJIHByb3ZpZGVkXCJcbiAgICAgID5cbiAgICAgICAgVXNlIHRoZSBhZGRyZXNzIEkgcHJvdmlkZWRcbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICA8L2Rpdj5cbjwvdGVtcGxhdGU+XG5gKTtcbnZhciBfYmluZGluZzQsIF90aGVtZUludGVybmFsNCwgX2hhbmRsZUNsb3NlMiwgX21vZGFsSUQyLCBfbW9kYWxIZWFkZXJUaXRsZUlEMiwgX21vZGFsQWRkcmVzc0lEO1xudmFyIE1hcGJveEFkZHJlc3NDb25maXJtYXRpb25Ob0ZlYXR1cmUgPSBjbGFzcyBleHRlbmRzIEhUTUxTY29wZWRFbGVtZW50IHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoLi4uYXJndW1lbnRzKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX2JpbmRpbmc0LCB2b2lkIDApO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfdGhlbWVJbnRlcm5hbDQsIHt9KTtcbiAgICB0aGlzLnVwZGF0ZSA9IChhdXRvZmlsbFZhbHVlcykgPT4ge1xuICAgICAgY29uc3QgeyBNb2RhbEFkZHJlc3MgfSA9IF9fcHJpdmF0ZUdldCh0aGlzLCBfYmluZGluZzQpO1xuICAgICAgTW9kYWxBZGRyZXNzLmlubmVySFRNTCA9IFwiXCI7XG4gICAgICBNb2RhbEFkZHJlc3MuYXBwZW5kQ2hpbGQoY3JlYXRlQWRkcmVzc0VsZW1lbnQoYXV0b2ZpbGxWYWx1ZXMpKTtcbiAgICB9O1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfaGFuZGxlQ2xvc2UyLCAoKSA9PiB7XG4gICAgICB0aGlzLmRpc3BhdGNoRXZlbnQobmV3IE1hcGJveEhUTUxFdmVudChcInJlc3VsdFwiLCBcImNhbmNlbFwiKSk7XG4gICAgfSk7XG4gICAgdGhpcy5yZWplY3QgPSAoKSA9PiB7XG4gICAgICB0aGlzLmRpc3BhdGNoRXZlbnQobmV3IE1hcGJveEhUTUxFdmVudChcInJlc3VsdFwiLCBcIm5vY2hhbmdlXCIpKTtcbiAgICB9O1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfbW9kYWxJRDIsIHJhbmRvbVZhbGlkSUQoKSk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9tb2RhbEhlYWRlclRpdGxlSUQyLCByYW5kb21WYWxpZElEKCkpO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfbW9kYWxBZGRyZXNzSUQsIHJhbmRvbVZhbGlkSUQoKSk7XG4gIH1cbiAgZ2V0IHRlbXBsYXRlKCkge1xuICAgIHJldHVybiBURU1QTEFURTM7XG4gIH1cbiAgZ2V0IHRlbXBsYXRlU3R5bGUoKSB7XG4gICAgcmV0dXJuIHN0eWxlX2RlZmF1bHQ7XG4gIH1cbiAgZ2V0IHRlbXBsYXRlVXNlclN0eWxlKCkge1xuICAgIHJldHVybiBnZXRUaGVtZUNTUyhcIi5NYXBib3hBZGRyZXNzQ29uZmlybWF0aW9uTm9GZWF0dXJlXCIsIHRoaXMudGhlbWUpO1xuICB9XG4gIGdldCB0aGVtZSgpIHtcbiAgICByZXR1cm4gX19wcml2YXRlR2V0KHRoaXMsIF90aGVtZUludGVybmFsNCk7XG4gIH1cbiAgc2V0IHRoZW1lKHRoZW1lKSB7XG4gICAgX19wcml2YXRlU2V0KHRoaXMsIF90aGVtZUludGVybmFsNCwgdGhlbWUpO1xuICAgIGlmICghX19wcml2YXRlR2V0KHRoaXMsIF9iaW5kaW5nNCkgfHwgIXRoZW1lKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMudXBkYXRlVGVtcGxhdGVVc2VyU3R5bGUoZ2V0VGhlbWVDU1MoXCIuTWFwYm94QWRkcmVzc0NvbmZpcm1hdGlvbk5vRmVhdHVyZVwiLCB0aGVtZSkpO1xuICAgIGNvbnN0IHsgSWNvblF1ZXN0aW9uLCBJY29uQ2xvc2UgfSA9IF9fcHJpdmF0ZUdldCh0aGlzLCBfYmluZGluZzQpO1xuICAgIEljb25RdWVzdGlvbi5pbm5lckhUTUwgPSBnZXRJY29uKFwicXVlc3Rpb25cIiwgdGhlbWUpO1xuICAgIEljb25DbG9zZS5pbm5lckhUTUwgPSBnZXRJY29uKFwiY2xvc2VcIiwgdGhlbWUpO1xuICB9XG4gIGNvbm5lY3RlZENhbGxiYWNrKCkge1xuICAgIHN1cGVyLmNvbm5lY3RlZENhbGxiYWNrKCk7XG4gICAgX19wcml2YXRlU2V0KHRoaXMsIF9iaW5kaW5nNCwgYmluZEVsZW1lbnRzKHRoaXMsIHtcbiAgICAgIE1vZGFsOiBcIi5Nb2RhbFwiLFxuICAgICAgTW9kYWxIZWFkZXJUaXRsZTogXCIuTW9kYWxIZWFkZXJUaXRsZVwiLFxuICAgICAgSWNvblF1ZXN0aW9uOiBcIi5JY29uUXVlc3Rpb25cIixcbiAgICAgIEljb25DbG9zZTogXCIuSWNvbkNsb3NlXCIsXG4gICAgICBNb2RhbEFkZHJlc3M6IFwiLk1vZGFsQWRkcmVzc1wiLFxuICAgICAgQnV0dG9uUmVqZWN0OiBcIi5CdXR0b25cIlxuICAgIH0pKTtcbiAgICBjb25zdCB7IE1vZGFsLCBNb2RhbEhlYWRlclRpdGxlLCBJY29uQ2xvc2UsIE1vZGFsQWRkcmVzcywgQnV0dG9uUmVqZWN0IH0gPSBfX3ByaXZhdGVHZXQodGhpcywgX2JpbmRpbmc0KTtcbiAgICBNb2RhbC5zZXRBdHRyaWJ1dGUoXCJhcmlhLWxhYmVsbGVkYnlcIiwgX19wcml2YXRlR2V0KHRoaXMsIF9tb2RhbEhlYWRlclRpdGxlSUQyKSk7XG4gICAgTW9kYWwuc2V0QXR0cmlidXRlKFwiYXJpYS1kZXNjcmliZWRieVwiLCBfX3ByaXZhdGVHZXQodGhpcywgX21vZGFsQWRkcmVzc0lEKSk7XG4gICAgSWNvbkNsb3NlLnNldEF0dHJpYnV0ZShcImFyaWEtY29udHJvbHNcIiwgX19wcml2YXRlR2V0KHRoaXMsIF9tb2RhbElEMikpO1xuICAgIE1vZGFsLmlkID0gX19wcml2YXRlR2V0KHRoaXMsIF9tb2RhbElEMik7XG4gICAgTW9kYWxIZWFkZXJUaXRsZS5pZCA9IF9fcHJpdmF0ZUdldCh0aGlzLCBfbW9kYWxIZWFkZXJUaXRsZUlEMik7XG4gICAgTW9kYWxBZGRyZXNzLmlkID0gX19wcml2YXRlR2V0KHRoaXMsIF9tb2RhbEFkZHJlc3NJRCk7XG4gICAgY29uc3QgYnV0dG9ucyA9IEFycmF5LmZyb20odGhpcy5xdWVyeVNlbGVjdG9yQWxsKCdbcm9sZT1cImJ1dHRvblwiXScpKTtcbiAgICBmb3IgKGNvbnN0IGJ1dHRvbiBvZiBidXR0b25zKSB7XG4gICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgYXJpYUJ1dHRvbktleURvd24pO1xuICAgIH1cbiAgICBJY29uQ2xvc2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIF9fcHJpdmF0ZUdldCh0aGlzLCBfaGFuZGxlQ2xvc2UyKSk7XG4gICAgQnV0dG9uUmVqZWN0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLnJlamVjdCk7XG4gICAgY29uc3QgdGhlbWUgPSB0aGlzLnRoZW1lO1xuICAgIGlmICh0aGVtZSkge1xuICAgICAgY29uc3QgeyBJY29uUXVlc3Rpb24sIEljb25DbG9zZTogSWNvbkNsb3NlMiB9ID0gX19wcml2YXRlR2V0KHRoaXMsIF9iaW5kaW5nNCk7XG4gICAgICBJY29uUXVlc3Rpb24uaW5uZXJIVE1MID0gZ2V0SWNvbihcInF1ZXN0aW9uXCIsIHRoZW1lKTtcbiAgICAgIEljb25DbG9zZTIuaW5uZXJIVE1MID0gZ2V0SWNvbihcImNsb3NlXCIsIHRoZW1lKTtcbiAgICB9XG4gIH1cbiAgZGlzY29ubmVjdGVkQ2FsbGJhY2soKSB7XG4gICAgY29uc3QgeyBJY29uQ2xvc2UsIEJ1dHRvblJlamVjdCB9ID0gX19wcml2YXRlR2V0KHRoaXMsIF9iaW5kaW5nNCk7XG4gICAgSWNvbkNsb3NlLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBfX3ByaXZhdGVHZXQodGhpcywgX2hhbmRsZUNsb3NlMikpO1xuICAgIEJ1dHRvblJlamVjdC5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5yZWplY3QpO1xuICB9XG59O1xuX2JpbmRpbmc0ID0gbmV3IFdlYWtNYXAoKTtcbl90aGVtZUludGVybmFsNCA9IG5ldyBXZWFrTWFwKCk7XG5faGFuZGxlQ2xvc2UyID0gbmV3IFdlYWtNYXAoKTtcbl9tb2RhbElEMiA9IG5ldyBXZWFrTWFwKCk7XG5fbW9kYWxIZWFkZXJUaXRsZUlEMiA9IG5ldyBXZWFrTWFwKCk7XG5fbW9kYWxBZGRyZXNzSUQgPSBuZXcgV2Vha01hcCgpO1xud2luZG93Lk1hcGJveEFkZHJlc3NDb25maXJtYXRpb25Ob0ZlYXR1cmUgPSBNYXBib3hBZGRyZXNzQ29uZmlybWF0aW9uTm9GZWF0dXJlO1xuaWYgKCF3aW5kb3cuY3VzdG9tRWxlbWVudHMuZ2V0KFwibWFwYm94LWFkZHJlc3MtY29uZmlybWF0aW9uLW5vLWZlYXR1cmVcIikpIHtcbiAgY3VzdG9tRWxlbWVudHMuZGVmaW5lKFwibWFwYm94LWFkZHJlc3MtY29uZmlybWF0aW9uLW5vLWZlYXR1cmVcIiwgTWFwYm94QWRkcmVzc0NvbmZpcm1hdGlvbk5vRmVhdHVyZSk7XG59XG5cbi8vIHNyYy9jb21wb25lbnRzL01hcGJveEFkZHJlc3NBdXRvZmlsbC50c1xuaW1wb3J0IHtcbiAgQWRkcmVzc0F1dG9maWxsQ29yZSxcbiAgU2VhcmNoU2Vzc2lvblxufSBmcm9tIFwiQG1hcGJveC9zZWFyY2gtanMtY29yZVwiO1xuXG4vLyBzcmMvdXRpbHMvZGV0ZWN0X2Jyb3dzZXJfYXV0b2ZpbGwudHNcbmltcG9ydCB7IGRlYm91bmNlIH0gZnJvbSBcIkBtYXBib3gvc2VhcmNoLWpzLWNvcmVcIjtcblxuLy8gc3JjL3V0aWxzL2RldGVjdF9icm93c2VyX2F1dG9maWxsLmNzc1xudmFyIGRldGVjdF9icm93c2VyX2F1dG9maWxsX2RlZmF1bHQgPSAnaW5wdXQ6LXdlYmtpdC1hdXRvZmlsbCxzZWxlY3Q6LXdlYmtpdC1hdXRvZmlsbCx0ZXh0YXJlYTotd2Via2l0LWF1dG9maWxse2FuaW1hdGlvbi1uYW1lOm9uYnJvd3NlcmF1dG9maWxsc3RhcnR9aW5wdXQ6bm90KDotd2Via2l0LWF1dG9maWxsKSxzZWxlY3Q6bm90KDotd2Via2l0LWF1dG9maWxsKSx0ZXh0YXJlYTpub3QoOi13ZWJraXQtYXV0b2ZpbGwpe2FuaW1hdGlvbi1uYW1lOm9uYnJvd3NlcmF1dG9maWxsY2FuY2VsfUBrZXlmcmFtZXMgb25icm93c2VyYXV0b2ZpbGxzdGFydHswJXthbmltYXRpb24tbmFtZTpcIm9uYnJvd3NlcmF1dG9maWxsc3RhcnRcIn10b3thbmltYXRpb24tbmFtZTpcIm9uYnJvd3NlcmF1dG9maWxsc3RhcnRcIn19QGtleWZyYW1lcyBvbmJyb3dzZXJhdXRvZmlsbGNhbmNlbHswJXthbmltYXRpb24tbmFtZTpcIm9uYnJvd3NlcmF1dG9maWxsY2FuY2VsXCJ9dG97YW5pbWF0aW9uLW5hbWU6XCJvbmJyb3dzZXJhdXRvZmlsbGNhbmNlbFwifX0nO1xuXG4vLyBzcmMvdXRpbHMvZGV0ZWN0X2Jyb3dzZXJfYXV0b2ZpbGwudHNcbnZhciBBVFRSX05BTUUgPSBcImJyb3dzZXItYXV0b2ZpbGxlZFwiO1xudmFyIEFVVE9GSUxMRURfRUxFTUVOVFMgPSBbXTtcbmZ1bmN0aW9uIGRpc3BhdGNoQnJvd3NlckF1dG9maWxsRXZlbnQoKSB7XG4gIHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyB3aW5kb3cuQ3VzdG9tRXZlbnQoXCJicm93c2VyYXV0b2ZpbGxcIiwge1xuICAgIGJ1YmJsZXM6IHRydWUsXG4gICAgY2FuY2VsYWJsZTogdHJ1ZSxcbiAgICBkZXRhaWw6IHsgZWxlbWVudHM6IEFVVE9GSUxMRURfRUxFTUVOVFMgfVxuICB9KSk7XG4gIEFVVE9GSUxMRURfRUxFTUVOVFMgPSBbXTtcbn1cbnZhciBkZWJvdW5jZWRBdXRvZmlsbCA9IGRlYm91bmNlKGRpc3BhdGNoQnJvd3NlckF1dG9maWxsRXZlbnQsIDUpO1xuZnVuY3Rpb24gYnJvd3NlckF1dG9maWxsKGVsZW1lbnQpIHtcbiAgaWYgKGVsZW1lbnQuaGFzQXR0cmlidXRlKEFUVFJfTkFNRSkpXG4gICAgcmV0dXJuO1xuICBlbGVtZW50LnNldEF0dHJpYnV0ZShBVFRSX05BTUUsIFwiXCIpO1xuICBBVVRPRklMTEVEX0VMRU1FTlRTLnB1c2goZWxlbWVudCk7XG4gIGRlYm91bmNlZEF1dG9maWxsKCk7XG59XG5mdW5jdGlvbiBjYW5jZWxCcm93c2VyQXV0b2ZpbGwoZWxlbWVudCkge1xuICBpZiAoIWVsZW1lbnQuaGFzQXR0cmlidXRlKEFUVFJfTkFNRSkpXG4gICAgcmV0dXJuO1xuICBlbGVtZW50LnJlbW92ZUF0dHJpYnV0ZShBVFRSX05BTUUpO1xufVxuZnVuY3Rpb24gb25BbmltYXRpb25TdGFydChldmVudCkge1xuICBldmVudC5hbmltYXRpb25OYW1lID09PSBcIm9uYnJvd3NlcmF1dG9maWxsc3RhcnRcIiA/IGJyb3dzZXJBdXRvZmlsbChldmVudC50YXJnZXQpIDogY2FuY2VsQnJvd3NlckF1dG9maWxsKGV2ZW50LnRhcmdldCk7XG59XG5mdW5jdGlvbiBvbklucHV0KGV2ZW50KSB7XG4gIGNvbnN0IHRhcmdldEVsID0gZXZlbnQudGFyZ2V0O1xuICB0YXJnZXRFbC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpICE9PSBcInNlbGVjdFwiICYmICFldmVudC5zaW11bGF0ZWQgJiYgIShldmVudCBpbnN0YW5jZW9mIE1hcGJveEhUTUxFdmVudCkgJiYgKGV2ZW50LmlucHV0VHlwZSA9PT0gXCJpbnNlcnRSZXBsYWNlbWVudFRleHRcIiB8fCAhKFwiZGF0YVwiIGluIGV2ZW50KSkgPyBicm93c2VyQXV0b2ZpbGwodGFyZ2V0RWwpIDogY2FuY2VsQnJvd3NlckF1dG9maWxsKHRhcmdldEVsKTtcbn1cbmZ1bmN0aW9uIGluaXREZXRlY3RCcm93c2VyQXV0b2ZpbGwoKSB7XG4gIGlmIChjb25maWcuZGV0ZWN0QnJvd3NlckF1dG9maWxsRW5hYmxlZCkge1xuICAgIHJldHVybjtcbiAgfSBlbHNlIHtcbiAgICBjb25maWcuZGV0ZWN0QnJvd3NlckF1dG9maWxsRW5hYmxlZCA9IHRydWU7XG4gIH1cbiAgYWRkRG9jdW1lbnRTdHlsZShkZXRlY3RfYnJvd3Nlcl9hdXRvZmlsbF9kZWZhdWx0KTtcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImFuaW1hdGlvbnN0YXJ0XCIsIG9uQW5pbWF0aW9uU3RhcnQsIHRydWUpO1xuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgb25JbnB1dCwgdHJ1ZSk7XG59XG5cbi8vIHNyYy9jb21wb25lbnRzL01hcGJveEFkZHJlc3NBdXRvZmlsbC50c1xudmFyIF9hdXRvZmlsbCwgX3Nlc3Npb24sIF9pbnB1dCwgX2xpc3Rib3gsIF9pbml0aWFsQXV0b2NvbXBsZXRlVmFsdWUsIF9icm93c2VyQXV0b2ZpbGxFbmFibGVkLCBfaGFuZGxlU3VnZ2VzdCwgX2hhbmRsZVN1Z2dlc3RFcnJvciwgX2hhbmRsZVJldHJpZXZlLCBfaGFuZGxlT2JzZXJ2ZSwgX29ic2VydmVyLCBfaGFuZGxlQnJvd3NlckF1dG9maWxsLCBfb25IYW5kbGVJbnB1dCwgX29uSGFuZGxlU2VsZWN0LCBfb25IYW5kbGVCbHVyLCBfb25IYW5kbGVGb2N1cztcbnZhciBNYXBib3hBZGRyZXNzQXV0b2ZpbGwgPSBjbGFzcyBleHRlbmRzIEhUTUxTY29wZWRFbGVtZW50IHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoLi4uYXJndW1lbnRzKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX2F1dG9maWxsLCBuZXcgQWRkcmVzc0F1dG9maWxsQ29yZSgpKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX3Nlc3Npb24sIG5ldyBTZWFyY2hTZXNzaW9uKF9fcHJpdmF0ZUdldCh0aGlzLCBfYXV0b2ZpbGwpKSk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9pbnB1dCwgdm9pZCAwKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX2xpc3Rib3gsIG5ldyBNYXBib3hTZWFyY2hMaXN0Ym94KCkpO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfaW5pdGlhbEF1dG9jb21wbGV0ZVZhbHVlLCB2b2lkIDApO1xuICAgIHRoaXMub3B0aW9ucyA9IHt9O1xuICAgIHRoaXMuY29uZmlybU9uQnJvd3NlckF1dG9maWxsID0gZmFsc2U7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9icm93c2VyQXV0b2ZpbGxFbmFibGVkLCBmYWxzZSk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9oYW5kbGVTdWdnZXN0LCAocmVzdWx0KSA9PiB7XG4gICAgICBjb25zdCBmaWx0ZXJlZFN1Z2dlc3Rpb25zID0gKHJlc3VsdCA9PSBudWxsID8gdm9pZCAwIDogcmVzdWx0LnN1Z2dlc3Rpb25zKSA/IGRpc3RpbmN0RXhhY3RTdHJlZXRSZXN1bHRzKHJlc3VsdC5zdWdnZXN0aW9ucykgOiBudWxsO1xuICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF9saXN0Ym94KS5oYW5kbGVTdWdnZXN0KGZpbHRlcmVkU3VnZ2VzdGlvbnMpO1xuICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KG5ldyBNYXBib3hIVE1MRXZlbnQoXCJzdWdnZXN0XCIsIHJlc3VsdCkpO1xuICAgIH0pO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfaGFuZGxlU3VnZ2VzdEVycm9yLCAoZXJyb3IpID0+IHtcbiAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfbGlzdGJveCkuaGFuZGxlRXJyb3IoKTtcbiAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChuZXcgTWFwYm94SFRNTEV2ZW50KFwic3VnZ2VzdGVycm9yXCIsIGVycm9yKSk7XG4gICAgfSk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9oYW5kbGVSZXRyaWV2ZSwgKHJlc3VsdCkgPT4ge1xuICAgICAgdmFyIF9hO1xuICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KG5ldyBNYXBib3hIVE1MRXZlbnQoXCJyZXRyaWV2ZVwiLCByZXN1bHQpKTtcbiAgICAgIHRoaXMucmV0cmlldmVGZWF0dXJlID0gKF9hID0gcmVzdWx0LmZlYXR1cmVzKSA9PSBudWxsID8gdm9pZCAwIDogX2FbMF07XG4gICAgICBpZiAoIV9fcHJpdmF0ZUdldCh0aGlzLCBfaW5wdXQpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGZlYXR1cmVDb2xsZWN0aW9uID0gcmVzdWx0O1xuICAgICAgaWYgKCFmZWF0dXJlQ29sbGVjdGlvbiB8fCAhZmVhdHVyZUNvbGxlY3Rpb24uZmVhdHVyZXMgfHwgIWZlYXR1cmVDb2xsZWN0aW9uLmZlYXR1cmVzLmxlbmd0aCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBmaWxsRm9ybVdpdGhGZWF0dXJlKGZlYXR1cmVDb2xsZWN0aW9uLmZlYXR1cmVzWzBdLCBfX3ByaXZhdGVHZXQodGhpcywgX2lucHV0KSk7XG4gICAgfSk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9oYW5kbGVPYnNlcnZlLCAoKSA9PiB7XG4gICAgICB2YXIgX2E7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBpbnB1dCA9IChfYSA9IHRoaXMucXVlcnlTZWxlY3RvcihcImlucHV0XCIpKSAhPSBudWxsID8gX2EgOiBudWxsO1xuICAgICAgICBfX3ByaXZhdGVTZXQodGhpcywgX2lucHV0LCBpbnB1dCk7XG4gICAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfbGlzdGJveCkuaW5wdXQgPSBpbnB1dDtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgX19wcml2YXRlU2V0KHRoaXMsIF9pbnB1dCwgbnVsbCk7XG4gICAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfbGlzdGJveCkuaW5wdXQgPSBudWxsO1xuICAgICAgICBjb25zb2xlLmVycm9yKGUubWVzc2FnZSB8fCBlKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX29ic2VydmVyLCBuZXcgTXV0YXRpb25PYnNlcnZlcihfX3ByaXZhdGVHZXQodGhpcywgX2hhbmRsZU9ic2VydmUpKSk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9oYW5kbGVCcm93c2VyQXV0b2ZpbGwsIChlKSA9PiB7XG4gICAgICBfX3ByaXZhdGVHZXQodGhpcywgX2xpc3Rib3gpLmJsdXIoKTtcbiAgICAgIHRyeUNvbmZpcm1Ccm93c2VyQXV0b2ZpbGwoX19wcml2YXRlR2V0KHRoaXMsIF9pbnB1dCksIGUsIHRoaXMuY29uZmlybU9uQnJvd3NlckF1dG9maWxsLCB0aGlzLmFjY2Vzc1Rva2VuKTtcbiAgICB9KTtcbiAgICB0aGlzLnJldHJpZXZlRmVhdHVyZSA9IG51bGw7XG4gICAgdGhpcy5pbnRlcmNlcHRTZWFyY2ggPSBudWxsO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfb25IYW5kbGVJbnB1dCwgKGUpID0+IHtcbiAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChlLmNsb25lKCkpO1xuICAgICAgY29uc3QgaW5wdXRUZXh0ID0gZS5kZXRhaWw7XG4gICAgICBjb25zdCBlbmFibGVCcm93c2VyQXV0b2NvbXBsZXRlID0gdGhpcy5icm93c2VyQXV0b2ZpbGxFbmFibGVkID09PSB0cnVlICYmIChpbnB1dFRleHQgPT0gbnVsbCA/IHZvaWQgMCA6IGlucHV0VGV4dC5sZW5ndGgpIDw9IDI7XG4gICAgICB0b2dnbGVBdXRvY29tcGxldGlvbihfX3ByaXZhdGVHZXQodGhpcywgX2lucHV0KSwgX19wcml2YXRlR2V0KHRoaXMsIF9pbml0aWFsQXV0b2NvbXBsZXRlVmFsdWUpLCBlbmFibGVCcm93c2VyQXV0b2NvbXBsZXRlKTtcbiAgICAgIGNvbnN0IGFsdGVyZWRUZXh0ID0gdGhpcy5pbnRlcmNlcHRTZWFyY2ggJiYgdGhpcy5pbnRlcmNlcHRTZWFyY2goaW5wdXRUZXh0KTtcbiAgICAgIGNvbnN0IHNlYXJjaFRleHQgPSB0aGlzLmludGVyY2VwdFNlYXJjaCA/IGFsdGVyZWRUZXh0IDogaW5wdXRUZXh0O1xuICAgICAgaWYgKHRoaXMuaW50ZXJjZXB0U2VhcmNoICYmICFhbHRlcmVkVGV4dCB8fCAoc2VhcmNoVGV4dCA9PSBudWxsID8gdm9pZCAwIDogc2VhcmNoVGV4dC5sZW5ndGgpIDw9IDIpIHtcbiAgICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF9saXN0Ym94KS5oYW5kbGVTdWdnZXN0KG51bGwpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBfX3ByaXZhdGVHZXQodGhpcywgX3Nlc3Npb24pLnN1Z2dlc3Qoc2VhcmNoVGV4dCwgdGhpcy5vcHRpb25zKTtcbiAgICB9KTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX29uSGFuZGxlU2VsZWN0LCAoZSkgPT4ge1xuICAgICAgY29uc3Qgc3VnZ2VzdGlvbiA9IGUuZGV0YWlsO1xuICAgICAgaWYgKGUuZGV0YWlsLmFjY3VyYWN5ICE9PSBcInN0cmVldFwiKSB7XG4gICAgICAgIHRvZ2dsZUF1dG9jb21wbGV0aW9uKF9fcHJpdmF0ZUdldCh0aGlzLCBfaW5wdXQpLCBfX3ByaXZhdGVHZXQodGhpcywgX2luaXRpYWxBdXRvY29tcGxldGVWYWx1ZSksIHRydWUpO1xuICAgICAgICBfX3ByaXZhdGVHZXQodGhpcywgX3Nlc3Npb24pLnJldHJpZXZlKHN1Z2dlc3Rpb24sIHRoaXMub3B0aW9ucyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBoYW5kbGVTdHJlZXRTZWxlY3Rpb24oX19wcml2YXRlR2V0KHRoaXMsIF9pbnB1dCksIF9fcHJpdmF0ZUdldCh0aGlzLCBfaW5pdGlhbEF1dG9jb21wbGV0ZVZhbHVlKSwgc3VnZ2VzdGlvbik7XG4gICAgICB9XG4gICAgfSk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9vbkhhbmRsZUJsdXIsICgpID0+IHtcbiAgICAgIHRvZ2dsZUF1dG9jb21wbGV0aW9uKF9fcHJpdmF0ZUdldCh0aGlzLCBfaW5wdXQpLCBfX3ByaXZhdGVHZXQodGhpcywgX2luaXRpYWxBdXRvY29tcGxldGVWYWx1ZSksIHRydWUpO1xuICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF9zZXNzaW9uKS5hYm9ydCgpO1xuICAgIH0pO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfb25IYW5kbGVGb2N1cywgKCkgPT4ge1xuICAgICAgdmFyIF9hO1xuICAgICAgY29uc3QgZW5hYmxlQnJvd3NlckF1dG9jb21wbGV0ZSA9IHRoaXMuYnJvd3NlckF1dG9maWxsRW5hYmxlZCA9PT0gdHJ1ZSAmJiAoKF9hID0gX19wcml2YXRlR2V0KHRoaXMsIF9pbnB1dCkudmFsdWUpID09IG51bGwgPyB2b2lkIDAgOiBfYS5sZW5ndGgpIDw9IDI7XG4gICAgICB0b2dnbGVBdXRvY29tcGxldGlvbihfX3ByaXZhdGVHZXQodGhpcywgX2lucHV0KSwgX19wcml2YXRlR2V0KHRoaXMsIF9pbml0aWFsQXV0b2NvbXBsZXRlVmFsdWUpLCBlbmFibGVCcm93c2VyQXV0b2NvbXBsZXRlKTtcbiAgICB9KTtcbiAgfVxuICBnZXQgYWNjZXNzVG9rZW4oKSB7XG4gICAgcmV0dXJuIF9fcHJpdmF0ZUdldCh0aGlzLCBfYXV0b2ZpbGwpLmFjY2Vzc1Rva2VuO1xuICB9XG4gIHNldCBhY2Nlc3NUb2tlbihuZXdUb2tlbikge1xuICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfYXV0b2ZpbGwpLmFjY2Vzc1Rva2VuID0gbmV3VG9rZW47XG4gIH1cbiAgZ2V0IGlucHV0KCkge1xuICAgIHJldHVybiBfX3ByaXZhdGVHZXQodGhpcywgX2lucHV0KTtcbiAgfVxuICBnZXQgdGhlbWUoKSB7XG4gICAgcmV0dXJuIF9fcHJpdmF0ZUdldCh0aGlzLCBfbGlzdGJveCkudGhlbWU7XG4gIH1cbiAgc2V0IHRoZW1lKHRoZW1lKSB7XG4gICAgX19wcml2YXRlR2V0KHRoaXMsIF9saXN0Ym94KS50aGVtZSA9IHRoZW1lO1xuICB9XG4gIGdldCBwb3BvdmVyT3B0aW9ucygpIHtcbiAgICByZXR1cm4gX19wcml2YXRlR2V0KHRoaXMsIF9saXN0Ym94KS5wb3BvdmVyT3B0aW9ucztcbiAgfVxuICBzZXQgcG9wb3Zlck9wdGlvbnMobmV3T3B0aW9ucykge1xuICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfbGlzdGJveCkucG9wb3Zlck9wdGlvbnMgPSBuZXdPcHRpb25zO1xuICB9XG4gIGdldCBicm93c2VyQXV0b2ZpbGxFbmFibGVkKCkge1xuICAgIHJldHVybiBfX3ByaXZhdGVHZXQodGhpcywgX2Jyb3dzZXJBdXRvZmlsbEVuYWJsZWQpO1xuICB9XG4gIHNldCBicm93c2VyQXV0b2ZpbGxFbmFibGVkKGVuYWJsZSkge1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfYnJvd3NlckF1dG9maWxsRW5hYmxlZCwgZW5hYmxlKTtcbiAgfVxuICBjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICB2YXIgX2E7XG4gICAgc3VwZXIuY29ubmVjdGVkQ2FsbGJhY2soKTtcbiAgICBjb25maWcuYXV0b2ZpbGxTZXNzaW9uRW5hYmxlZCA9IHRydWU7XG4gICAgX19wcml2YXRlR2V0KHRoaXMsIF9zZXNzaW9uKS5zZXNzaW9uVG9rZW4gPSBjb25maWcuYXV0b2ZpbGxTZXNzaW9uVG9rZW47XG4gICAgX19wcml2YXRlR2V0KHRoaXMsIF9saXN0Ym94KS5hdXRvZmlsbEhvc3QgPSB0aGlzO1xuICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfbGlzdGJveCkuc2VhcmNoU2VydmljZSA9IDAgLyogQWRkcmVzc0F1dG9maWxsICovO1xuICAgIGNvbnN0IGlucHV0ID0gKF9hID0gdGhpcy5xdWVyeVNlbGVjdG9yKFwiaW5wdXRcIikpICE9IG51bGwgPyBfYSA6IG51bGw7XG4gICAgX19wcml2YXRlR2V0KHRoaXMsIF9vYnNlcnZlcikub2JzZXJ2ZSh0aGlzLCB7XG4gICAgICBzdWJ0cmVlOiB0cnVlLFxuICAgICAgY2hpbGRMaXN0OiB0cnVlXG4gICAgfSk7XG4gICAgX19wcml2YXRlR2V0KHRoaXMsIF9oYW5kbGVPYnNlcnZlKS5jYWxsKHRoaXMpO1xuICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfbGlzdGJveCkuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIF9fcHJpdmF0ZUdldCh0aGlzLCBfb25IYW5kbGVJbnB1dCkpO1xuICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfbGlzdGJveCkuYWRkRXZlbnRMaXN0ZW5lcihcInNlbGVjdFwiLCBfX3ByaXZhdGVHZXQodGhpcywgX29uSGFuZGxlU2VsZWN0KSk7XG4gICAgX19wcml2YXRlR2V0KHRoaXMsIF9saXN0Ym94KS5hZGRFdmVudExpc3RlbmVyKFwiYmx1clwiLCBfX3ByaXZhdGVHZXQodGhpcywgX29uSGFuZGxlQmx1cikpO1xuICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfbGlzdGJveCkuYWRkRXZlbnRMaXN0ZW5lcihcImZvY3VzXCIsIF9fcHJpdmF0ZUdldCh0aGlzLCBfb25IYW5kbGVGb2N1cykpO1xuICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfc2Vzc2lvbikuYWRkRXZlbnRMaXN0ZW5lcihcInN1Z2dlc3RcIiwgX19wcml2YXRlR2V0KHRoaXMsIF9oYW5kbGVTdWdnZXN0KSk7XG4gICAgX19wcml2YXRlR2V0KHRoaXMsIF9zZXNzaW9uKS5hZGRFdmVudExpc3RlbmVyKFwic3VnZ2VzdGVycm9yXCIsIF9fcHJpdmF0ZUdldCh0aGlzLCBfaGFuZGxlU3VnZ2VzdEVycm9yKSk7XG4gICAgX19wcml2YXRlR2V0KHRoaXMsIF9zZXNzaW9uKS5hZGRFdmVudExpc3RlbmVyKFwicmV0cmlldmVcIiwgX19wcml2YXRlR2V0KHRoaXMsIF9oYW5kbGVSZXRyaWV2ZSkpO1xuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoX19wcml2YXRlR2V0KHRoaXMsIF9saXN0Ym94KSk7XG4gICAgaWYgKGlucHV0KSB7XG4gICAgICBpbnB1dC5pbnNlcnRBZGphY2VudEVsZW1lbnQoXCJiZWZvcmViZWdpblwiLCBjcmVhdGVBcmlhTGl2ZUVsZW1lbnQoX19wcml2YXRlR2V0KHRoaXMsIF9saXN0Ym94KS5kYXRhU2VlZCkpO1xuICAgICAgc3VwcHJlc3NFeHRlbnNpb25zQXV0b2NvbXBsZXRlKGlucHV0KTtcbiAgICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfaW5pdGlhbEF1dG9jb21wbGV0ZVZhbHVlLCBpbnB1dC5hdXRvY29tcGxldGUpO1xuICAgIH1cbiAgICBpbml0RGV0ZWN0QnJvd3NlckF1dG9maWxsKCk7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJicm93c2VyYXV0b2ZpbGxcIiwgX19wcml2YXRlR2V0KHRoaXMsIF9oYW5kbGVCcm93c2VyQXV0b2ZpbGwpKTtcbiAgfVxuICBkaXNjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICBfX3ByaXZhdGVHZXQodGhpcywgX2xpc3Rib3gpLnJlbW92ZSgpO1xuICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfbGlzdGJveCkucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIF9fcHJpdmF0ZUdldCh0aGlzLCBfb25IYW5kbGVJbnB1dCkpO1xuICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfbGlzdGJveCkucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInNlbGVjdFwiLCBfX3ByaXZhdGVHZXQodGhpcywgX29uSGFuZGxlU2VsZWN0KSk7XG4gICAgX19wcml2YXRlR2V0KHRoaXMsIF9saXN0Ym94KS5yZW1vdmVFdmVudExpc3RlbmVyKFwiYmx1clwiLCBfX3ByaXZhdGVHZXQodGhpcywgX29uSGFuZGxlQmx1cikpO1xuICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfbGlzdGJveCkucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImZvY3VzXCIsIF9fcHJpdmF0ZUdldCh0aGlzLCBfb25IYW5kbGVGb2N1cykpO1xuICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfc2Vzc2lvbikucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInN1Z2dlc3RcIiwgX19wcml2YXRlR2V0KHRoaXMsIF9oYW5kbGVTdWdnZXN0KSk7XG4gICAgX19wcml2YXRlR2V0KHRoaXMsIF9zZXNzaW9uKS5yZW1vdmVFdmVudExpc3RlbmVyKFwic3VnZ2VzdGVycm9yXCIsIF9fcHJpdmF0ZUdldCh0aGlzLCBfaGFuZGxlU3VnZ2VzdEVycm9yKSk7XG4gICAgX19wcml2YXRlR2V0KHRoaXMsIF9zZXNzaW9uKS5yZW1vdmVFdmVudExpc3RlbmVyKFwicmV0cmlldmVcIiwgX19wcml2YXRlR2V0KHRoaXMsIF9oYW5kbGVSZXRyaWV2ZSkpO1xuICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfb2JzZXJ2ZXIpLmRpc2Nvbm5lY3QoKTtcbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImJyb3dzZXJhdXRvZmlsbFwiLCBfX3ByaXZhdGVHZXQodGhpcywgX2hhbmRsZUJyb3dzZXJBdXRvZmlsbCkpO1xuICB9XG4gIGF0dHJpYnV0ZUNoYW5nZWRDYWxsYmFjayhuYW1lLCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICBpZiAobmFtZSA9PT0gXCJhY2Nlc3MtdG9rZW5cIikge1xuICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF9hdXRvZmlsbCkuYWNjZXNzVG9rZW4gPSBuZXdWYWx1ZTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKG5hbWUgPT09IFwiYnJvd3Nlci1hdXRvZmlsbC1lbmFibGVkXCIpIHtcbiAgICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfYnJvd3NlckF1dG9maWxsRW5hYmxlZCwgQm9vbGVhbihuZXdWYWx1ZSkpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAobmFtZSA9PT0gXCJ0aGVtZVwiKSB7XG4gICAgICB0aGlzLnRoZW1lID0gdHJ5UGFyc2VKU09OKG5ld1ZhbHVlKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKG5hbWUgPT09IFwicG9wb3Zlci1vcHRpb25zXCIpIHtcbiAgICAgIHRoaXMucG9wb3Zlck9wdGlvbnMgPSB0cnlQYXJzZUpTT04obmV3VmFsdWUpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBvcHRpb25OYW1lID0gbmFtZS5zcGxpdChcIi1cIikuam9pbihcIl9cIik7XG4gICAgaWYgKCFuZXdWYWx1ZSkge1xuICAgICAgZGVsZXRlIHRoaXMub3B0aW9uc1tvcHRpb25OYW1lXTtcbiAgICB9XG4gICAgdGhpcy5vcHRpb25zW29wdGlvbk5hbWVdID0gbmV3VmFsdWU7XG4gIH1cbiAgZm9jdXMoKSB7XG4gICAgX19wcml2YXRlR2V0KHRoaXMsIF9saXN0Ym94KS5mb2N1cygpO1xuICB9XG4gIHNpbXVsYXRlUmV0cmlldmUoZmVhdHVyZSkge1xuICAgIGNvbnN0IGlucHV0ID0gdGhpcy5pbnB1dDtcbiAgICBpZiAoaW5wdXQpIHtcbiAgICAgIGlucHV0LmRhdGFzZXRbXCJtYXBib3hTdWNjZXNzXCJdID0gXCJ0cnVlXCI7XG4gICAgfVxuICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfbGlzdGJveCkuaGlkZVJlc3VsdHMoKTtcbiAgICBjb25zdCBzaW1SZXN1bHQgPSB7XG4gICAgICB0eXBlOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4gICAgICBmZWF0dXJlczogW2ZlYXR1cmVdLFxuICAgICAgdXJsOiBcIlwiXG4gICAgfTtcbiAgICBfX3ByaXZhdGVHZXQodGhpcywgX2hhbmRsZVJldHJpZXZlKS5jYWxsKHRoaXMsIHNpbVJlc3VsdCk7XG4gIH1cbn07XG5fYXV0b2ZpbGwgPSBuZXcgV2Vha01hcCgpO1xuX3Nlc3Npb24gPSBuZXcgV2Vha01hcCgpO1xuX2lucHV0ID0gbmV3IFdlYWtNYXAoKTtcbl9saXN0Ym94ID0gbmV3IFdlYWtNYXAoKTtcbl9pbml0aWFsQXV0b2NvbXBsZXRlVmFsdWUgPSBuZXcgV2Vha01hcCgpO1xuX2Jyb3dzZXJBdXRvZmlsbEVuYWJsZWQgPSBuZXcgV2Vha01hcCgpO1xuX2hhbmRsZVN1Z2dlc3QgPSBuZXcgV2Vha01hcCgpO1xuX2hhbmRsZVN1Z2dlc3RFcnJvciA9IG5ldyBXZWFrTWFwKCk7XG5faGFuZGxlUmV0cmlldmUgPSBuZXcgV2Vha01hcCgpO1xuX2hhbmRsZU9ic2VydmUgPSBuZXcgV2Vha01hcCgpO1xuX29ic2VydmVyID0gbmV3IFdlYWtNYXAoKTtcbl9oYW5kbGVCcm93c2VyQXV0b2ZpbGwgPSBuZXcgV2Vha01hcCgpO1xuX29uSGFuZGxlSW5wdXQgPSBuZXcgV2Vha01hcCgpO1xuX29uSGFuZGxlU2VsZWN0ID0gbmV3IFdlYWtNYXAoKTtcbl9vbkhhbmRsZUJsdXIgPSBuZXcgV2Vha01hcCgpO1xuX29uSGFuZGxlRm9jdXMgPSBuZXcgV2Vha01hcCgpO1xuTWFwYm94QWRkcmVzc0F1dG9maWxsLm9ic2VydmVkQXR0cmlidXRlcyA9IFtcbiAgXCJhY2Nlc3MtdG9rZW5cIixcbiAgXCJicm93c2VyLWF1dG9maWxsLWVuYWJsZWRcIixcbiAgXCJ0aGVtZVwiLFxuICBcInBvcG92ZXItb3B0aW9uc1wiLFxuICBcImNzcy10ZXh0XCIsXG4gIFwibGFuZ3VhZ2VcIixcbiAgXCJjb3VudHJ5XCIsXG4gIFwiYmJveFwiLFxuICBcImxpbWl0XCIsXG4gIFwicHJveGltaXR5XCIsXG4gIFwic3RyZWV0c1wiXG5dO1xud2luZG93Lk1hcGJveEFkZHJlc3NBdXRvZmlsbCA9IE1hcGJveEFkZHJlc3NBdXRvZmlsbDtcbmlmICghd2luZG93LmN1c3RvbUVsZW1lbnRzLmdldChcIm1hcGJveC1hZGRyZXNzLWF1dG9maWxsXCIpKSB7XG4gIGN1c3RvbUVsZW1lbnRzLmRlZmluZShcIm1hcGJveC1hZGRyZXNzLWF1dG9maWxsXCIsIE1hcGJveEFkZHJlc3NBdXRvZmlsbCk7XG59XG5cbi8vIHNyYy9jb21wb25lbnRzL01hcGJveFNlYXJjaEJveC50c1xuaW1wb3J0IHtcbiAgZmVhdHVyZVRvU3VnZ2VzdGlvbiBhcyBmZWF0dXJlVG9TdWdnZXN0aW9uMyxcbiAgTG5nTGF0Qm91bmRzLFxuICBTZWFyY2hTZXNzaW9uIGFzIFNlYXJjaFNlc3Npb24yLFxuICBTZWFyY2hCb3hDb3JlXG59IGZyb20gXCJAbWFwYm94L3NlYXJjaC1qcy1jb3JlXCI7XG5pbXBvcnQgc3VidGFnIGZyb20gXCJzdWJ0YWdcIjtcblxuLy8gc3JjL3V0aWxzL2xvY2FsaXphdGlvbi50c1xudmFyIHBsYWNlaG9sZGVyID0ge1xuICBkZTogXCJTdWNoZVwiLFxuICBpdDogXCJSaWNlcmNhXCIsXG4gIGVuOiBcIlNlYXJjaFwiLFxuICBubDogXCJab2VrZW5cIixcbiAgZnI6IFwiQ2hlcmNoZXJcIixcbiAgY2E6IFwiQ2VyY2FcIixcbiAgaGU6IFwiXFx1MDVEQ1xcdTA1RDdcXHUwNUU0XFx1MDVFOVwiLFxuICBqYTogXCJcXHUzMEI1XFx1MzBGQ1xcdTMwQzFcIixcbiAgbHY6IFwiTWVrbFxcdTAxMTN0XCIsXG4gIHB0OiBcIlByb2N1cmFyXCIsXG4gIHNyOiBcIlxcdTA0MUZcXHUwNDQwXFx1MDQzNVxcdTA0NDJcXHUwNDQwXFx1MDQzMFxcdTA0MzNcXHUwNDMwXCIsXG4gIHpoOiBcIlxcdTY0MUNcXHU3RDIyXCIsXG4gIGNzOiBcIlZ5aGxlZFxceEUxdlxceEUxblxceEVEXCIsXG4gIGh1OiBcIktlcmVzXFx4RTlzXCIsXG4gIGthOiBcIlxcdTEwRUJcXHUxMEQ4XFx1MTBENFxcdTEwRDFcXHUxMEQwXCIsXG4gIG5iOiBcIlNcXHhGOGtlXCIsXG4gIHNrOiBcIlZ5aFxcdTAxM0VhZFxceEUxdmFuaWVcIixcbiAgdGg6IFwiXFx1MEUwNFxcdTBFNDlcXHUwRTE5XFx1MEUyQlxcdTBFMzJcIixcbiAgZmk6IFwiSGFlXCIsXG4gIGlzOiBcIkxlaXRhXCIsXG4gIGtvOiBcIlxcdUMyMThcXHVDMEM5XCIsXG4gIHBsOiBcIlN6dWthalwiLFxuICBzbDogXCJJc2thbmplXCIsXG4gIGZhOiBcIlxcdTA2MkNcXHUwNjMzXFx1MDYyQVxcdTA2MkNcXHUwNjQ4XCIsXG4gIHJ1OiBcIlxcdTA0MUZcXHUwNDNFXFx1MDQzOFxcdTA0NDFcXHUwNDNBXCJcbn07XG52YXIgbG9jYWxpemF0aW9uX2RlZmF1bHQgPSB7IHBsYWNlaG9sZGVyIH07XG5cbi8vIHNyYy9jb21wb25lbnRzL01hcGJveFNlYXJjaEJveC50c1xudmFyIE1BWF9aT09NID0gOTtcbnZhciBfYmluZGluZzUsIF9zZWFyY2gsIF9zZXNzaW9uMiwgX21hcCwgX2lucHV0MiwgX2xpc3Rib3gyLCBfZ2V0RGVmYXVsdFBsYWNlaG9sZGVyLCBnZXREZWZhdWx0UGxhY2Vob2xkZXJfZm4sIF9wbGFjZWhvbGRlciwgX2hhbmRsZVN1Z2dlc3QyLCBfaGFuZGxlU3VnZ2VzdEVycm9yMiwgX2hhbmRsZVJldHJpZXZlMiwgX21hcE1hcmtlciwgX3JlbW92ZU1hcmtlciwgX2hhbmRsZU1hcmtlciwgX29uSGFuZGxlSW5wdXQyLCBfb25IYW5kbGVTZWxlY3QyLCBfb25IYW5kbGVCbHVyMiwgX3NldEFjdGlvbkljb25zLCBfaGFuZGxlQ2xlYXIsIF9oYW5kbGVNb3ZlRW5kO1xudmFyIE1hcGJveFNlYXJjaEJveCA9IGNsYXNzIGV4dGVuZHMgSFRNTFNjb3BlZEVsZW1lbnQge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlciguLi5hcmd1bWVudHMpO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfZ2V0RGVmYXVsdFBsYWNlaG9sZGVyKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX2JpbmRpbmc1LCB2b2lkIDApO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfc2VhcmNoLCBuZXcgU2VhcmNoQm94Q29yZSh7fSkpO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfc2Vzc2lvbjIsIG5ldyBTZWFyY2hTZXNzaW9uMihfX3ByaXZhdGVHZXQodGhpcywgX3NlYXJjaCkpKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX21hcCwgbnVsbCk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9pbnB1dDIsIHZvaWQgMCk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9saXN0Ym94MiwgbmV3IE1hcGJveFNlYXJjaExpc3Rib3goKSk7XG4gICAgdGhpcy5vcHRpb25zID0ge307XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9wbGFjZWhvbGRlciwgdm9pZCAwKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX2hhbmRsZVN1Z2dlc3QyLCAocmVzdWx0KSA9PiB7XG4gICAgICBfX3ByaXZhdGVHZXQodGhpcywgX3NldEFjdGlvbkljb25zKS5jYWxsKHRoaXMpO1xuICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF9saXN0Ym94MikuaGFuZGxlU3VnZ2VzdCgocmVzdWx0ID09IG51bGwgPyB2b2lkIDAgOiByZXN1bHQuc3VnZ2VzdGlvbnMpIHx8IG51bGwpO1xuICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KG5ldyBNYXBib3hIVE1MRXZlbnQoXCJzdWdnZXN0XCIsIHJlc3VsdCkpO1xuICAgIH0pO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfaGFuZGxlU3VnZ2VzdEVycm9yMiwgKGVycm9yKSA9PiB7XG4gICAgICBfX3ByaXZhdGVHZXQodGhpcywgX3NldEFjdGlvbkljb25zKS5jYWxsKHRoaXMpO1xuICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF9saXN0Ym94MikuaGFuZGxlRXJyb3IoKTtcbiAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChuZXcgTWFwYm94SFRNTEV2ZW50KFwic3VnZ2VzdGVycm9yXCIsIGVycm9yKSk7XG4gICAgfSk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9oYW5kbGVSZXRyaWV2ZTIsIChyZXN1bHQpID0+IHtcbiAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfc2V0QWN0aW9uSWNvbnMpLmNhbGwodGhpcyk7XG4gICAgICB0aGlzLmRpc3BhdGNoRXZlbnQobmV3IE1hcGJveEhUTUxFdmVudChcInJldHJpZXZlXCIsIHJlc3VsdCkpO1xuICAgICAgY29uc3QgZmVhdHVyZUNvbGxlY3Rpb24gPSByZXN1bHQ7XG4gICAgICBpZiAoIWZlYXR1cmVDb2xsZWN0aW9uIHx8ICFmZWF0dXJlQ29sbGVjdGlvbi5mZWF0dXJlcy5sZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgY29uc3Qgc3VnZ2VzdGlvbiA9IGZlYXR1cmVUb1N1Z2dlc3Rpb24zKGZlYXR1cmVDb2xsZWN0aW9uLmZlYXR1cmVzWzBdKTtcbiAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfaW5wdXQyKS52YWx1ZSA9IHN1Z2dlc3Rpb24ubmFtZTtcbiAgICAgIGNvbnN0IG1hcCA9IF9fcHJpdmF0ZUdldCh0aGlzLCBfbWFwKTtcbiAgICAgIGlmICghbWFwKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGZlYXR1cmUgPSBmZWF0dXJlQ29sbGVjdGlvbi5mZWF0dXJlc1swXTtcbiAgICAgIGlmICghZmVhdHVyZSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjb25zdCBwbGFjZVR5cGUgPSBmZWF0dXJlLnByb3BlcnRpZXMuZmVhdHVyZV90eXBlO1xuICAgICAgY29uc3QgYm91bmRzID0gZmVhdHVyZS5wcm9wZXJ0aWVzLmJib3g7XG4gICAgICBpZiAoYm91bmRzKSB7XG4gICAgICAgIG1hcC5mbHlUbyhiYm94Vmlld3BvcnQobWFwLCBMbmdMYXRCb3VuZHMuY29udmVydChib3VuZHMpLnRvRmxhdEFycmF5KCkpKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IGNlbnRlciA9IGZlYXR1cmUuZ2VvbWV0cnkuY29vcmRpbmF0ZXM7XG4gICAgICAgIGNvbnN0IHpvb20gPSBnZXRNYXhab29tKHBsYWNlVHlwZSk7XG4gICAgICAgIG1hcC5mbHlUbyh7XG4gICAgICAgICAgY2VudGVyLFxuICAgICAgICAgIHpvb20sXG4gICAgICAgICAgc3BlZWQ6IEZMWV9UT19TUEVFRFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLm1hcmtlciAmJiB0aGlzLm1hcGJveGdsKSB7XG4gICAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfaGFuZGxlTWFya2VyKS5jYWxsKHRoaXMsIGZlYXR1cmUpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfbWFwTWFya2VyLCB2b2lkIDApO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfcmVtb3ZlTWFya2VyLCAoKSA9PiB7XG4gICAgICBpZiAoX19wcml2YXRlR2V0KHRoaXMsIF9tYXBNYXJrZXIpKSB7XG4gICAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfbWFwTWFya2VyKS5yZW1vdmUoKTtcbiAgICAgICAgX19wcml2YXRlU2V0KHRoaXMsIF9tYXBNYXJrZXIsIG51bGwpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfaGFuZGxlTWFya2VyLCAoZmVhdHVyZSkgPT4ge1xuICAgICAgaWYgKCFfX3ByaXZhdGVHZXQodGhpcywgX21hcCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF9yZW1vdmVNYXJrZXIpLmNhbGwodGhpcyk7XG4gICAgICBpZiAoIWZlYXR1cmUpXG4gICAgICAgIHJldHVybjtcbiAgICAgIGNvbnN0IGRlZmF1bHRNYXJrZXJPcHRpb25zID0ge1xuICAgICAgICBjb2xvcjogXCIjNDY2OEYyXCJcbiAgICAgIH07XG4gICAgICBjb25zdCBtYXJrZXJPcHRpb25zID0gX19zcHJlYWRWYWx1ZXMoX19zcHJlYWRWYWx1ZXMoe30sIGRlZmF1bHRNYXJrZXJPcHRpb25zKSwgdHlwZW9mIHRoaXMubWFya2VyID09PSBcIm9iamVjdFwiICYmIHRoaXMubWFya2VyKTtcbiAgICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfbWFwTWFya2VyLCBuZXcgdGhpcy5tYXBib3hnbC5NYXJrZXIobWFya2VyT3B0aW9ucykpO1xuICAgICAgaWYgKGZlYXR1cmUuZ2VvbWV0cnkgJiYgZmVhdHVyZS5nZW9tZXRyeS50eXBlICYmIGZlYXR1cmUuZ2VvbWV0cnkudHlwZSA9PT0gXCJQb2ludFwiICYmIGZlYXR1cmUuZ2VvbWV0cnkuY29vcmRpbmF0ZXMpIHtcbiAgICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF9tYXBNYXJrZXIpLnNldExuZ0xhdChmZWF0dXJlLmdlb21ldHJ5LmNvb3JkaW5hdGVzKS5hZGRUbyhfX3ByaXZhdGVHZXQodGhpcywgX21hcCkpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHRoaXMuaW50ZXJjZXB0U2VhcmNoID0gbnVsbDtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX29uSGFuZGxlSW5wdXQyLCAoZSkgPT4ge1xuICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGUuY2xvbmUoKSk7XG4gICAgICBjb25zdCBpbnB1dFRleHQgPSBlLmRldGFpbDtcbiAgICAgIGlmICghaW5wdXRUZXh0KSB7XG4gICAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfaGFuZGxlQ2xlYXIpLmNhbGwodGhpcyk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGFsdGVyZWRUZXh0ID0gdGhpcy5pbnRlcmNlcHRTZWFyY2ggJiYgdGhpcy5pbnRlcmNlcHRTZWFyY2goaW5wdXRUZXh0KTtcbiAgICAgIGNvbnN0IHNlYXJjaFRleHQgPSB0aGlzLmludGVyY2VwdFNlYXJjaCA/IGFsdGVyZWRUZXh0IDogaW5wdXRUZXh0O1xuICAgICAgaWYgKHRoaXMuaW50ZXJjZXB0U2VhcmNoICYmICFhbHRlcmVkVGV4dCkge1xuICAgICAgICBfX3ByaXZhdGVHZXQodGhpcywgX2xpc3Rib3gyKS5oaWRlUmVzdWx0cygpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBfX3ByaXZhdGVHZXQodGhpcywgX3Nlc3Npb24yKS5zdWdnZXN0KHNlYXJjaFRleHQsIHRoaXMub3B0aW9ucyk7XG4gICAgICBfX3ByaXZhdGVHZXQodGhpcywgX3NldEFjdGlvbkljb25zKS5jYWxsKHRoaXMsIHRydWUpO1xuICAgIH0pO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfb25IYW5kbGVTZWxlY3QyLCAoZSkgPT4ge1xuICAgICAgY29uc3Qgc3VnZ2VzdGlvbiA9IGUuZGV0YWlsO1xuICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF9zZXNzaW9uMikucmV0cmlldmUoc3VnZ2VzdGlvbiwgdGhpcy5vcHRpb25zKTtcbiAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfc2V0QWN0aW9uSWNvbnMpLmNhbGwodGhpcywgdHJ1ZSk7XG4gICAgfSk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9vbkhhbmRsZUJsdXIyLCAoKSA9PiB7XG4gICAgICBfX3ByaXZhdGVHZXQodGhpcywgX3Nlc3Npb24yKS5hYm9ydCgpO1xuICAgIH0pO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfc2V0QWN0aW9uSWNvbnMsIChsb2FkaW5nID0gZmFsc2UpID0+IHtcbiAgICAgIGlmIChsb2FkaW5nKSB7XG4gICAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfYmluZGluZzUpLkNsZWFyQnRuLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF9iaW5kaW5nNSkuTG9hZGluZ0ljb24uc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfYmluZGluZzUpLkxvYWRpbmdJY29uLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF9iaW5kaW5nNSkuQ2xlYXJCdG4uc3R5bGUuZGlzcGxheSA9IHRoaXMudmFsdWUgPyBcImJsb2NrXCIgOiBcIm5vbmVcIjtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX2hhbmRsZUNsZWFyLCAoKSA9PiB7XG4gICAgICB0aGlzLnZhbHVlID0gXCJcIjtcbiAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfc2V0QWN0aW9uSWNvbnMpLmNhbGwodGhpcyk7XG4gICAgICBfX3ByaXZhdGVHZXQodGhpcywgX2hhbmRsZU1hcmtlcikuY2FsbCh0aGlzLCBudWxsKTtcbiAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfbGlzdGJveDIpLmhhbmRsZVN1Z2dlc3QobnVsbCk7XG4gICAgICB0aGlzLmRpc3BhdGNoRXZlbnQobmV3IE1hcGJveEhUTUxFdmVudChcImNsZWFyXCIpKTtcbiAgICB9KTtcbiAgICB0aGlzLm1hcmtlciA9IHRydWU7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9oYW5kbGVNb3ZlRW5kLCAoKSA9PiB7XG4gICAgICBjb25zdCBtYXAgPSBfX3ByaXZhdGVHZXQodGhpcywgX21hcCk7XG4gICAgICBjb25zdCBvcHRpb25zID0gX19zcHJlYWRWYWx1ZXMoe30sIHRoaXMub3B0aW9ucyk7XG4gICAgICBpZiAobWFwLmdldFpvb20oKSA8PSBNQVhfWk9PTSkge1xuICAgICAgICBkZWxldGUgb3B0aW9ucy5wcm94aW1pdHk7XG4gICAgICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGNlbnRlciA9IG1hcC5nZXRDZW50ZXIoKTtcbiAgICAgIHRoaXMub3B0aW9ucyA9IF9fc3ByZWFkUHJvcHMoX19zcHJlYWRWYWx1ZXMoe30sIG9wdGlvbnMpLCB7XG4gICAgICAgIHByb3hpbWl0eTogY2VudGVyXG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuICBnZXQgYWNjZXNzVG9rZW4oKSB7XG4gICAgcmV0dXJuIF9fcHJpdmF0ZUdldCh0aGlzLCBfc2VhcmNoKS5hY2Nlc3NUb2tlbjtcbiAgfVxuICBzZXQgYWNjZXNzVG9rZW4obmV3VG9rZW4pIHtcbiAgICBfX3ByaXZhdGVHZXQodGhpcywgX3NlYXJjaCkuYWNjZXNzVG9rZW4gPSBuZXdUb2tlbjtcbiAgfVxuICBnZXQgdmFsdWUoKSB7XG4gICAgcmV0dXJuIF9fcHJpdmF0ZUdldCh0aGlzLCBfaW5wdXQyKS52YWx1ZTtcbiAgfVxuICBzZXQgdmFsdWUobmV3VmFsdWUpIHtcbiAgICBfX3ByaXZhdGVHZXQodGhpcywgX2lucHV0MikudmFsdWUgPSBuZXdWYWx1ZSB8fCBcIlwiO1xuICB9XG4gIGdldCBpbnB1dCgpIHtcbiAgICByZXR1cm4gX19wcml2YXRlR2V0KHRoaXMsIF9pbnB1dDIpO1xuICB9XG4gIGdldCB0ZW1wbGF0ZSgpIHtcbiAgICByZXR1cm4gU0VBUkNIQk9YX1RFTVBMQVRFO1xuICB9XG4gIGdldCB0ZW1wbGF0ZVN0eWxlKCkge1xuICAgIHJldHVybiBzdHlsZV9kZWZhdWx0O1xuICB9XG4gIGdldCB0ZW1wbGF0ZVVzZXJTdHlsZSgpIHtcbiAgICByZXR1cm4gZ2V0VGhlbWVDU1MoXCIuU2VhcmNoQm94XCIsIF9fcHJpdmF0ZUdldCh0aGlzLCBfbGlzdGJveDIpLnRoZW1lKTtcbiAgfVxuICBnZXQgdGhlbWUoKSB7XG4gICAgcmV0dXJuIF9fcHJpdmF0ZUdldCh0aGlzLCBfbGlzdGJveDIpLnRoZW1lO1xuICB9XG4gIHNldCB0aGVtZSh0aGVtZSkge1xuICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfbGlzdGJveDIpLnRoZW1lID0gdGhlbWU7XG4gICAgaWYgKCFfX3ByaXZhdGVHZXQodGhpcywgX2JpbmRpbmc1KSB8fCAhdGhlbWUpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy51cGRhdGVUZW1wbGF0ZVVzZXJTdHlsZShnZXRUaGVtZUNTUyhcIi5TZWFyY2hCb3hcIiwgdGhlbWUpKTtcbiAgICBfX3ByaXZhdGVHZXQodGhpcywgX2xpc3Rib3gyKS51cGRhdGVQb3BvdmVyKCk7XG4gICAgY29uc3QgeyBTZWFyY2hJY29uIH0gPSBfX3ByaXZhdGVHZXQodGhpcywgX2JpbmRpbmc1KTtcbiAgICBTZWFyY2hJY29uLmlubmVySFRNTCA9IGdldEljb24oXCJzZWFyY2hcIiwgdGhlbWUpO1xuICB9XG4gIGdldCBwb3BvdmVyT3B0aW9ucygpIHtcbiAgICByZXR1cm4gX19wcml2YXRlR2V0KHRoaXMsIF9saXN0Ym94MikucG9wb3Zlck9wdGlvbnM7XG4gIH1cbiAgc2V0IHBvcG92ZXJPcHRpb25zKG5ld09wdGlvbnMpIHtcbiAgICBfX3ByaXZhdGVHZXQodGhpcywgX2xpc3Rib3gyKS5wb3BvdmVyT3B0aW9ucyA9IG5ld09wdGlvbnM7XG4gIH1cbiAgZ2V0IHBsYWNlaG9sZGVyKCkge1xuICAgIHJldHVybiBfX3ByaXZhdGVHZXQodGhpcywgX3BsYWNlaG9sZGVyKSB8fCBfX3ByaXZhdGVNZXRob2QodGhpcywgX2dldERlZmF1bHRQbGFjZWhvbGRlciwgZ2V0RGVmYXVsdFBsYWNlaG9sZGVyX2ZuKS5jYWxsKHRoaXMpO1xuICB9XG4gIHNldCBwbGFjZWhvbGRlcih0ZXh0KSB7XG4gICAgX19wcml2YXRlU2V0KHRoaXMsIF9wbGFjZWhvbGRlciwgdGV4dCk7XG4gICAgaWYgKF9fcHJpdmF0ZUdldCh0aGlzLCBfaW5wdXQyKSkge1xuICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF9pbnB1dDIpLnBsYWNlaG9sZGVyID0gdGhpcy5wbGFjZWhvbGRlcjtcbiAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfaW5wdXQyKS5zZXRBdHRyaWJ1dGUoXCJhcmlhLWxhYmVsXCIsIHRoaXMucGxhY2Vob2xkZXIpO1xuICAgIH1cbiAgfVxuICBjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICBzdXBlci5jb25uZWN0ZWRDYWxsYmFjaygpO1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfYmluZGluZzUsIGJpbmRFbGVtZW50cyh0aGlzLCB7XG4gICAgICBTZWFyY2hCb3g6IFwiLlNlYXJjaEJveFwiLFxuICAgICAgU2VhcmNoSWNvbjogXCIuU2VhcmNoSWNvblwiLFxuICAgICAgSW5wdXQ6IFwiLklucHV0XCIsXG4gICAgICBDbGVhckJ0bjogXCIuQ2xlYXJCdG5cIixcbiAgICAgIExvYWRpbmdJY29uOiBcIi5Mb2FkaW5nSWNvblwiXG4gICAgfSkpO1xuICAgIHRoaXMudGhlbWUgPSBfX3NwcmVhZFZhbHVlcyh7fSwgdGhpcy50aGVtZSk7XG4gICAgY29uc3QgeyBJbnB1dCwgQ2xlYXJCdG4gfSA9IF9fcHJpdmF0ZUdldCh0aGlzLCBfYmluZGluZzUpO1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfaW5wdXQyLCBJbnB1dCk7XG4gICAgX19wcml2YXRlR2V0KHRoaXMsIF9saXN0Ym94MikuaW5wdXQgPSBJbnB1dDtcbiAgICBfX3ByaXZhdGVHZXQodGhpcywgX2xpc3Rib3gyKS5zZWFyY2hTZXJ2aWNlID0gMiAvKiBTZWFyY2hCb3ggKi87XG4gICAgX19wcml2YXRlR2V0KHRoaXMsIF9saXN0Ym94MikuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIF9fcHJpdmF0ZUdldCh0aGlzLCBfb25IYW5kbGVJbnB1dDIpKTtcbiAgICBfX3ByaXZhdGVHZXQodGhpcywgX2xpc3Rib3gyKS5hZGRFdmVudExpc3RlbmVyKFwic2VsZWN0XCIsIF9fcHJpdmF0ZUdldCh0aGlzLCBfb25IYW5kbGVTZWxlY3QyKSk7XG4gICAgX19wcml2YXRlR2V0KHRoaXMsIF9saXN0Ym94MikuYWRkRXZlbnRMaXN0ZW5lcihcImJsdXJcIiwgX19wcml2YXRlR2V0KHRoaXMsIF9vbkhhbmRsZUJsdXIyKSk7XG4gICAgX19wcml2YXRlR2V0KHRoaXMsIF9zZXNzaW9uMikuYWRkRXZlbnRMaXN0ZW5lcihcInN1Z2dlc3RcIiwgX19wcml2YXRlR2V0KHRoaXMsIF9oYW5kbGVTdWdnZXN0MikpO1xuICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfc2Vzc2lvbjIpLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWdnZXN0ZXJyb3JcIiwgX19wcml2YXRlR2V0KHRoaXMsIF9oYW5kbGVTdWdnZXN0RXJyb3IyKSk7XG4gICAgX19wcml2YXRlR2V0KHRoaXMsIF9zZXNzaW9uMikuYWRkRXZlbnRMaXN0ZW5lcihcInJldHJpZXZlXCIsIF9fcHJpdmF0ZUdldCh0aGlzLCBfaGFuZGxlUmV0cmlldmUyKSk7XG4gICAgQ2xlYXJCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIF9fcHJpdmF0ZUdldCh0aGlzLCBfaGFuZGxlQ2xlYXIpKTtcbiAgICB0aGlzLnBsYWNlaG9sZGVyID0gX19wcml2YXRlR2V0KHRoaXMsIF9wbGFjZWhvbGRlcik7XG4gICAgdGhpcy5wYXJlbnRFbGVtZW50LmFwcGVuZENoaWxkKF9fcHJpdmF0ZUdldCh0aGlzLCBfbGlzdGJveDIpKTtcbiAgICBpZiAoSW5wdXQpIHtcbiAgICAgIGlmIChJbnB1dC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nLmhhc0F0dHJpYnV0ZShcImFyaWEtbGl2ZVwiKSkge1xuICAgICAgICBJbnB1dC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nLnJlbW92ZSgpO1xuICAgICAgfVxuICAgICAgSW5wdXQuaW5zZXJ0QWRqYWNlbnRFbGVtZW50KFwiYmVmb3JlYmVnaW5cIiwgY3JlYXRlQXJpYUxpdmVFbGVtZW50KF9fcHJpdmF0ZUdldCh0aGlzLCBfbGlzdGJveDIpLmRhdGFTZWVkKSk7XG4gICAgfVxuICB9XG4gIGRpc2Nvbm5lY3RlZENhbGxiYWNrKCkge1xuICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfbGlzdGJveDIpLnJlbW92ZSgpO1xuICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfbGlzdGJveDIpLmlucHV0ID0gbnVsbDtcbiAgICBfX3ByaXZhdGVHZXQodGhpcywgX2xpc3Rib3gyKS5yZW1vdmVFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgX19wcml2YXRlR2V0KHRoaXMsIF9vbkhhbmRsZUlucHV0MikpO1xuICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfbGlzdGJveDIpLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJzZWxlY3RcIiwgX19wcml2YXRlR2V0KHRoaXMsIF9vbkhhbmRsZVNlbGVjdDIpKTtcbiAgICBfX3ByaXZhdGVHZXQodGhpcywgX2xpc3Rib3gyKS5yZW1vdmVFdmVudExpc3RlbmVyKFwiYmx1clwiLCBfX3ByaXZhdGVHZXQodGhpcywgX29uSGFuZGxlQmx1cjIpKTtcbiAgICBfX3ByaXZhdGVHZXQodGhpcywgX3Nlc3Npb24yKS5yZW1vdmVFdmVudExpc3RlbmVyKFwic3VnZ2VzdFwiLCBfX3ByaXZhdGVHZXQodGhpcywgX2hhbmRsZVN1Z2dlc3QyKSk7XG4gICAgX19wcml2YXRlR2V0KHRoaXMsIF9zZXNzaW9uMikucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInN1Z2dlc3RlcnJvclwiLCBfX3ByaXZhdGVHZXQodGhpcywgX2hhbmRsZVN1Z2dlc3RFcnJvcjIpKTtcbiAgICBfX3ByaXZhdGVHZXQodGhpcywgX3Nlc3Npb24yKS5yZW1vdmVFdmVudExpc3RlbmVyKFwicmV0cmlldmVcIiwgX19wcml2YXRlR2V0KHRoaXMsIF9oYW5kbGVSZXRyaWV2ZTIpKTtcbiAgfVxuICBhdHRyaWJ1dGVDaGFuZ2VkQ2FsbGJhY2sobmFtZSwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgaWYgKG5hbWUgPT09IFwiYWNjZXNzLXRva2VuXCIpIHtcbiAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfc2VhcmNoKS5hY2Nlc3NUb2tlbiA9IG5ld1ZhbHVlO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAobmFtZSA9PT0gXCJ0aGVtZVwiKSB7XG4gICAgICB0aGlzLnRoZW1lID0gdHJ5UGFyc2VKU09OKG5ld1ZhbHVlKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKG5hbWUgPT09IFwicG9wb3Zlci1vcHRpb25zXCIpIHtcbiAgICAgIHRoaXMucG9wb3Zlck9wdGlvbnMgPSB0cnlQYXJzZUpTT04obmV3VmFsdWUpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAobmFtZSA9PT0gXCJwbGFjZWhvbGRlclwiKSB7XG4gICAgICB0aGlzLnBsYWNlaG9sZGVyID0gbmV3VmFsdWU7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IG9wdGlvbk5hbWUgPSBuYW1lLnNwbGl0KFwiLVwiKS5qb2luKFwiX1wiKTtcbiAgICBpZiAoIW5ld1ZhbHVlKSB7XG4gICAgICBkZWxldGUgdGhpcy5vcHRpb25zW29wdGlvbk5hbWVdO1xuICAgIH1cbiAgICB0aGlzLm9wdGlvbnNbb3B0aW9uTmFtZV0gPSBuZXdWYWx1ZTtcbiAgICBpZiAob3B0aW9uTmFtZSA9PT0gXCJsYW5ndWFnZVwiKSB7XG4gICAgICB0aGlzLnBsYWNlaG9sZGVyID0gX19wcml2YXRlR2V0KHRoaXMsIF9wbGFjZWhvbGRlcik7XG4gICAgfVxuICB9XG4gIGZvY3VzKCkge1xuICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfbGlzdGJveDIpLmZvY3VzKCk7XG4gIH1cbiAgc2VhcmNoKHRleHQpIHtcbiAgICB0aGlzLnZhbHVlID0gdGV4dDtcbiAgICBfX3ByaXZhdGVHZXQodGhpcywgX29uSGFuZGxlSW5wdXQyKS5jYWxsKHRoaXMsIG5ldyBNYXBib3hIVE1MRXZlbnQoXCJpbnB1dFwiLCB0ZXh0KSk7XG4gIH1cbiAgYmluZE1hcChtYXApIHtcbiAgICBpZiAoX19wcml2YXRlR2V0KHRoaXMsIF9tYXApKSB7XG4gICAgICBfX3ByaXZhdGVHZXQodGhpcywgX21hcCkub2ZmKFwibW92ZWVuZFwiLCBfX3ByaXZhdGVHZXQodGhpcywgX2hhbmRsZU1vdmVFbmQpKTtcbiAgICB9XG4gICAgaWYgKG1hcCkge1xuICAgICAgbWFwLm9uKFwibW92ZWVuZFwiLCBfX3ByaXZhdGVHZXQodGhpcywgX2hhbmRsZU1vdmVFbmQpKTtcbiAgICB9XG4gICAgX19wcml2YXRlU2V0KHRoaXMsIF9tYXAsIG1hcCk7XG4gIH1cbiAgdW5iaW5kTWFwKCkge1xuICAgIHRoaXMuYmluZE1hcChudWxsKTtcbiAgfVxuICBvbkFkZChtYXApIHtcbiAgICB0aGlzLmJpbmRNYXAobWFwKTtcbiAgICB0aGlzLnJlbW92ZSgpO1xuICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgY29udGFpbmVyLmNsYXNzTmFtZSA9IFwibWFwYm94Z2wtY3RybFwiO1xuICAgIGNvbnRhaW5lci5zdHlsZS53aWR0aCA9IFwiMzAwcHhcIjtcbiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcyk7XG4gICAgcmV0dXJuIGNvbnRhaW5lcjtcbiAgfVxuICBvblJlbW92ZSgpIHtcbiAgICB0aGlzLnJlbW92ZSgpO1xuICAgIHRoaXMudW5iaW5kTWFwKCk7XG4gICAgX19wcml2YXRlR2V0KHRoaXMsIF9yZW1vdmVNYXJrZXIpLmNhbGwodGhpcyk7XG4gIH1cbiAgZ2V0RGVmYXVsdFBvc2l0aW9uKCkge1xuICAgIHJldHVybiBcInRvcC1yaWdodFwiO1xuICB9XG59O1xuX2JpbmRpbmc1ID0gbmV3IFdlYWtNYXAoKTtcbl9zZWFyY2ggPSBuZXcgV2Vha01hcCgpO1xuX3Nlc3Npb24yID0gbmV3IFdlYWtNYXAoKTtcbl9tYXAgPSBuZXcgV2Vha01hcCgpO1xuX2lucHV0MiA9IG5ldyBXZWFrTWFwKCk7XG5fbGlzdGJveDIgPSBuZXcgV2Vha01hcCgpO1xuX2dldERlZmF1bHRQbGFjZWhvbGRlciA9IG5ldyBXZWFrU2V0KCk7XG5nZXREZWZhdWx0UGxhY2Vob2xkZXJfZm4gPSBmdW5jdGlvbigpIHtcbiAgaWYgKHRoaXMub3B0aW9ucy5sYW5ndWFnZSkge1xuICAgIGNvbnN0IGZpcnN0TGFuZ3VhZ2UgPSB0aGlzLm9wdGlvbnMubGFuZ3VhZ2Uuc3BsaXQoXCIsXCIpWzBdO1xuICAgIGNvbnN0IGxhbmd1YWdlID0gc3VidGFnLmxhbmd1YWdlKGZpcnN0TGFuZ3VhZ2UpO1xuICAgIGNvbnN0IGxvY2FsaXplZFZhbHVlID0gbG9jYWxpemF0aW9uX2RlZmF1bHQucGxhY2Vob2xkZXJbbGFuZ3VhZ2VdO1xuICAgIGlmIChsb2NhbGl6ZWRWYWx1ZSlcbiAgICAgIHJldHVybiBsb2NhbGl6ZWRWYWx1ZTtcbiAgfVxuICByZXR1cm4gXCJTZWFyY2hcIjtcbn07XG5fcGxhY2Vob2xkZXIgPSBuZXcgV2Vha01hcCgpO1xuX2hhbmRsZVN1Z2dlc3QyID0gbmV3IFdlYWtNYXAoKTtcbl9oYW5kbGVTdWdnZXN0RXJyb3IyID0gbmV3IFdlYWtNYXAoKTtcbl9oYW5kbGVSZXRyaWV2ZTIgPSBuZXcgV2Vha01hcCgpO1xuX21hcE1hcmtlciA9IG5ldyBXZWFrTWFwKCk7XG5fcmVtb3ZlTWFya2VyID0gbmV3IFdlYWtNYXAoKTtcbl9oYW5kbGVNYXJrZXIgPSBuZXcgV2Vha01hcCgpO1xuX29uSGFuZGxlSW5wdXQyID0gbmV3IFdlYWtNYXAoKTtcbl9vbkhhbmRsZVNlbGVjdDIgPSBuZXcgV2Vha01hcCgpO1xuX29uSGFuZGxlQmx1cjIgPSBuZXcgV2Vha01hcCgpO1xuX3NldEFjdGlvbkljb25zID0gbmV3IFdlYWtNYXAoKTtcbl9oYW5kbGVDbGVhciA9IG5ldyBXZWFrTWFwKCk7XG5faGFuZGxlTW92ZUVuZCA9IG5ldyBXZWFrTWFwKCk7XG5NYXBib3hTZWFyY2hCb3gub2JzZXJ2ZWRBdHRyaWJ1dGVzID0gW1xuICBcImFjY2Vzcy10b2tlblwiLFxuICBcInRoZW1lXCIsXG4gIFwicG9wb3Zlci1vcHRpb25zXCIsXG4gIFwicGxhY2Vob2xkZXJcIixcbiAgXCJsYW5ndWFnZVwiLFxuICBcImNvdW50cnlcIixcbiAgXCJiYm94XCIsXG4gIFwibGltaXRcIixcbiAgXCJuYXZpZ2F0aW9uLXByb2ZpbGVcIixcbiAgXCJvcmlnaW5cIixcbiAgXCJwcm94aW1pdHlcIixcbiAgXCJldGEtdHlwZVwiLFxuICBcInR5cGVzXCJcbl07XG53aW5kb3cuTWFwYm94U2VhcmNoQm94ID0gTWFwYm94U2VhcmNoQm94O1xuaWYgKCF3aW5kb3cuY3VzdG9tRWxlbWVudHMuZ2V0KFwibWFwYm94LXNlYXJjaC1ib3hcIikpIHtcbiAgY3VzdG9tRWxlbWVudHMuZGVmaW5lKFwibWFwYm94LXNlYXJjaC1ib3hcIiwgTWFwYm94U2VhcmNoQm94KTtcbn1cblxuLy8gc3JjL2NvbXBvbmVudHMvTWFwYm94R2VvY29kZXIudHNcbmltcG9ydCB7XG4gIExuZ0xhdEJvdW5kcyBhcyBMbmdMYXRCb3VuZHMyLFxuICBTZWFyY2hTZXNzaW9uIGFzIFNlYXJjaFNlc3Npb24zLFxuICBHZW9jb2RpbmdDb3JlXG59IGZyb20gXCJAbWFwYm94L3NlYXJjaC1qcy1jb3JlXCI7XG5pbXBvcnQgc3VidGFnMiBmcm9tIFwic3VidGFnXCI7XG52YXIgTUFYX1pPT00yID0gOTtcbnZhciBfYmluZGluZzYsIF9zZWFyY2gyLCBfc2Vzc2lvbjMsIF9tYXAyLCBfaW5wdXQzLCBfbGlzdGJveDMsIF9nZXREZWZhdWx0UGxhY2Vob2xkZXIyLCBnZXREZWZhdWx0UGxhY2Vob2xkZXJfZm4yLCBfcGxhY2Vob2xkZXIyLCBfaGFuZGxlU3VnZ2VzdDMsIF9oYW5kbGVTdWdnZXN0RXJyb3IzLCBfaGFuZGxlUmV0cmlldmUzLCBfbWFwTWFya2VyMiwgX3JlbW92ZU1hcmtlcjIsIF9oYW5kbGVNYXJrZXIyLCBfb25IYW5kbGVJbnB1dDMsIF9vbkhhbmRsZVNlbGVjdDMsIF9vbkhhbmRsZUJsdXIzLCBfc2V0QWN0aW9uSWNvbnMyLCBfaGFuZGxlQ2xlYXIyLCBfaGFuZGxlTW92ZUVuZDI7XG52YXIgTWFwYm94R2VvY29kZXIgPSBjbGFzcyBleHRlbmRzIEhUTUxTY29wZWRFbGVtZW50IHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoLi4uYXJndW1lbnRzKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX2dldERlZmF1bHRQbGFjZWhvbGRlcjIpO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfYmluZGluZzYsIHZvaWQgMCk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9zZWFyY2gyLCBuZXcgR2VvY29kaW5nQ29yZSh7fSkpO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfc2Vzc2lvbjMsIG5ldyBTZWFyY2hTZXNzaW9uMyhfX3ByaXZhdGVHZXQodGhpcywgX3NlYXJjaDIpKSk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9tYXAyLCBudWxsKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX2lucHV0Mywgdm9pZCAwKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX2xpc3Rib3gzLCBuZXcgTWFwYm94U2VhcmNoTGlzdGJveCgpKTtcbiAgICB0aGlzLm9wdGlvbnMgPSB7fTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX3BsYWNlaG9sZGVyMiwgdm9pZCAwKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX2hhbmRsZVN1Z2dlc3QzLCAocmVzdWx0KSA9PiB7XG4gICAgICBfX3ByaXZhdGVHZXQodGhpcywgX3NldEFjdGlvbkljb25zMikuY2FsbCh0aGlzKTtcbiAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfbGlzdGJveDMpLmhhbmRsZVN1Z2dlc3QoKHJlc3VsdCA9PSBudWxsID8gdm9pZCAwIDogcmVzdWx0LmZlYXR1cmVzKSB8fCBudWxsKTtcbiAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChuZXcgTWFwYm94SFRNTEV2ZW50KFwic3VnZ2VzdFwiLCByZXN1bHQpKTtcbiAgICB9KTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX2hhbmRsZVN1Z2dlc3RFcnJvcjMsIChlcnJvcikgPT4ge1xuICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF9zZXRBY3Rpb25JY29uczIpLmNhbGwodGhpcyk7XG4gICAgICBfX3ByaXZhdGVHZXQodGhpcywgX2xpc3Rib3gzKS5oYW5kbGVFcnJvcigpO1xuICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KG5ldyBNYXBib3hIVE1MRXZlbnQoXCJzdWdnZXN0ZXJyb3JcIiwgZXJyb3IpKTtcbiAgICB9KTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX2hhbmRsZVJldHJpZXZlMywgKHJlc3VsdCkgPT4ge1xuICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF9zZXRBY3Rpb25JY29uczIpLmNhbGwodGhpcyk7XG4gICAgICB0aGlzLmRpc3BhdGNoRXZlbnQobmV3IE1hcGJveEhUTUxFdmVudChcInJldHJpZXZlXCIsIHJlc3VsdCkpO1xuICAgICAgY29uc3QgZmVhdHVyZSA9IHJlc3VsdDtcbiAgICAgIGlmICghZmVhdHVyZSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBfX3ByaXZhdGVHZXQodGhpcywgX2lucHV0MykudmFsdWUgPSBmZWF0dXJlLnByb3BlcnRpZXMuZnVsbF9hZGRyZXNzO1xuICAgICAgY29uc3QgbWFwID0gX19wcml2YXRlR2V0KHRoaXMsIF9tYXAyKTtcbiAgICAgIGlmICghbWFwKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHBsYWNlVHlwZSA9IGZlYXR1cmUucHJvcGVydGllcy5mZWF0dXJlX3R5cGU7XG4gICAgICBjb25zdCBib3VuZHMgPSBmZWF0dXJlLnByb3BlcnRpZXMuYmJveDtcbiAgICAgIGlmIChib3VuZHMpIHtcbiAgICAgICAgbWFwLmZseVRvKGJib3hWaWV3cG9ydChtYXAsIExuZ0xhdEJvdW5kczIuY29udmVydChib3VuZHMpLnRvRmxhdEFycmF5KCkpKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IGNlbnRlciA9IGZlYXR1cmUuZ2VvbWV0cnkuY29vcmRpbmF0ZXM7XG4gICAgICAgIGNvbnN0IHpvb20gPSBnZXRNYXhab29tKHBsYWNlVHlwZSk7XG4gICAgICAgIG1hcC5mbHlUbyh7XG4gICAgICAgICAgY2VudGVyLFxuICAgICAgICAgIHpvb20sXG4gICAgICAgICAgc3BlZWQ6IEZMWV9UT19TUEVFRFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLm1hcmtlciAmJiB0aGlzLm1hcGJveGdsKSB7XG4gICAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfaGFuZGxlTWFya2VyMikuY2FsbCh0aGlzLCBmZWF0dXJlKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX21hcE1hcmtlcjIsIHZvaWQgMCk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9yZW1vdmVNYXJrZXIyLCAoKSA9PiB7XG4gICAgICBpZiAoX19wcml2YXRlR2V0KHRoaXMsIF9tYXBNYXJrZXIyKSkge1xuICAgICAgICBfX3ByaXZhdGVHZXQodGhpcywgX21hcE1hcmtlcjIpLnJlbW92ZSgpO1xuICAgICAgICBfX3ByaXZhdGVTZXQodGhpcywgX21hcE1hcmtlcjIsIG51bGwpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfaGFuZGxlTWFya2VyMiwgKGZlYXR1cmUpID0+IHtcbiAgICAgIGlmICghX19wcml2YXRlR2V0KHRoaXMsIF9tYXAyKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBfX3ByaXZhdGVHZXQodGhpcywgX3JlbW92ZU1hcmtlcjIpLmNhbGwodGhpcyk7XG4gICAgICBpZiAoIWZlYXR1cmUpXG4gICAgICAgIHJldHVybjtcbiAgICAgIGNvbnN0IGRlZmF1bHRNYXJrZXJPcHRpb25zID0ge1xuICAgICAgICBjb2xvcjogXCIjNDY2OEYyXCJcbiAgICAgIH07XG4gICAgICBjb25zdCBtYXJrZXJPcHRpb25zID0gX19zcHJlYWRWYWx1ZXMoX19zcHJlYWRWYWx1ZXMoe30sIGRlZmF1bHRNYXJrZXJPcHRpb25zKSwgdHlwZW9mIHRoaXMubWFya2VyID09PSBcIm9iamVjdFwiICYmIHRoaXMubWFya2VyKTtcbiAgICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfbWFwTWFya2VyMiwgbmV3IHRoaXMubWFwYm94Z2wuTWFya2VyKG1hcmtlck9wdGlvbnMpKTtcbiAgICAgIGlmIChmZWF0dXJlLmdlb21ldHJ5ICYmIGZlYXR1cmUuZ2VvbWV0cnkudHlwZSAmJiBmZWF0dXJlLmdlb21ldHJ5LnR5cGUgPT09IFwiUG9pbnRcIiAmJiBmZWF0dXJlLmdlb21ldHJ5LmNvb3JkaW5hdGVzKSB7XG4gICAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfbWFwTWFya2VyMikuc2V0TG5nTGF0KGZlYXR1cmUuZ2VvbWV0cnkuY29vcmRpbmF0ZXMpLmFkZFRvKF9fcHJpdmF0ZUdldCh0aGlzLCBfbWFwMikpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHRoaXMuaW50ZXJjZXB0U2VhcmNoID0gbnVsbDtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX29uSGFuZGxlSW5wdXQzLCAoZSkgPT4ge1xuICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGUuY2xvbmUoKSk7XG4gICAgICBjb25zdCBpbnB1dFRleHQgPSBlLmRldGFpbDtcbiAgICAgIGlmICghaW5wdXRUZXh0KSB7XG4gICAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfaGFuZGxlQ2xlYXIyKS5jYWxsKHRoaXMpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjb25zdCBhbHRlcmVkVGV4dCA9IHRoaXMuaW50ZXJjZXB0U2VhcmNoICYmIHRoaXMuaW50ZXJjZXB0U2VhcmNoKGlucHV0VGV4dCk7XG4gICAgICBjb25zdCBzZWFyY2hUZXh0ID0gdGhpcy5pbnRlcmNlcHRTZWFyY2ggPyBhbHRlcmVkVGV4dCA6IGlucHV0VGV4dDtcbiAgICAgIGlmICh0aGlzLmludGVyY2VwdFNlYXJjaCAmJiAhYWx0ZXJlZFRleHQpIHtcbiAgICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF9saXN0Ym94MykuaGlkZVJlc3VsdHMoKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF9zZXNzaW9uMykuc3VnZ2VzdChzZWFyY2hUZXh0LCB0aGlzLm9wdGlvbnMpO1xuICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF9zZXRBY3Rpb25JY29uczIpLmNhbGwodGhpcywgdHJ1ZSk7XG4gICAgfSk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9vbkhhbmRsZVNlbGVjdDMsIChlKSA9PiB7XG4gICAgICBjb25zdCBzdWdnZXN0aW9uID0gZS5kZXRhaWw7XG4gICAgICBfX3ByaXZhdGVHZXQodGhpcywgX3Nlc3Npb24zKS5yZXRyaWV2ZShzdWdnZXN0aW9uLCB0aGlzLm9wdGlvbnMpO1xuICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF9zZXRBY3Rpb25JY29uczIpLmNhbGwodGhpcywgdHJ1ZSk7XG4gICAgfSk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9vbkhhbmRsZUJsdXIzLCAoKSA9PiB7XG4gICAgICBfX3ByaXZhdGVHZXQodGhpcywgX3Nlc3Npb24zKS5hYm9ydCgpO1xuICAgIH0pO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfc2V0QWN0aW9uSWNvbnMyLCAobG9hZGluZyA9IGZhbHNlKSA9PiB7XG4gICAgICBpZiAobG9hZGluZykge1xuICAgICAgICBfX3ByaXZhdGVHZXQodGhpcywgX2JpbmRpbmc2KS5DbGVhckJ0bi5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gICAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfYmluZGluZzYpLkxvYWRpbmdJY29uLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBfX3ByaXZhdGVHZXQodGhpcywgX2JpbmRpbmc2KS5Mb2FkaW5nSWNvbi5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gICAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfYmluZGluZzYpLkNsZWFyQnRuLnN0eWxlLmRpc3BsYXkgPSB0aGlzLnZhbHVlID8gXCJibG9ja1wiIDogXCJub25lXCI7XG4gICAgICB9XG4gICAgfSk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9oYW5kbGVDbGVhcjIsICgpID0+IHtcbiAgICAgIHRoaXMudmFsdWUgPSBcIlwiO1xuICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF9zZXRBY3Rpb25JY29uczIpLmNhbGwodGhpcyk7XG4gICAgICBfX3ByaXZhdGVHZXQodGhpcywgX2hhbmRsZU1hcmtlcjIpLmNhbGwodGhpcywgbnVsbCk7XG4gICAgICBfX3ByaXZhdGVHZXQodGhpcywgX2xpc3Rib3gzKS5oYW5kbGVTdWdnZXN0KG51bGwpO1xuICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KG5ldyBNYXBib3hIVE1MRXZlbnQoXCJjbGVhclwiKSk7XG4gICAgfSk7XG4gICAgdGhpcy5tYXJrZXIgPSB0cnVlO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfaGFuZGxlTW92ZUVuZDIsICgpID0+IHtcbiAgICAgIGNvbnN0IG1hcCA9IF9fcHJpdmF0ZUdldCh0aGlzLCBfbWFwMik7XG4gICAgICBjb25zdCBvcHRpb25zID0gX19zcHJlYWRWYWx1ZXMoe30sIHRoaXMub3B0aW9ucyk7XG4gICAgICBpZiAobWFwLmdldFpvb20oKSA8PSBNQVhfWk9PTTIpIHtcbiAgICAgICAgZGVsZXRlIG9wdGlvbnMucHJveGltaXR5O1xuICAgICAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjb25zdCBjZW50ZXIgPSBtYXAuZ2V0Q2VudGVyKCk7XG4gICAgICB0aGlzLm9wdGlvbnMgPSBfX3NwcmVhZFByb3BzKF9fc3ByZWFkVmFsdWVzKHt9LCBvcHRpb25zKSwge1xuICAgICAgICBwcm94aW1pdHk6IGNlbnRlclxuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbiAgZ2V0IGFjY2Vzc1Rva2VuKCkge1xuICAgIHJldHVybiBfX3ByaXZhdGVHZXQodGhpcywgX3NlYXJjaDIpLmFjY2Vzc1Rva2VuO1xuICB9XG4gIHNldCBhY2Nlc3NUb2tlbihuZXdUb2tlbikge1xuICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfc2VhcmNoMikuYWNjZXNzVG9rZW4gPSBuZXdUb2tlbjtcbiAgfVxuICBnZXQgdmFsdWUoKSB7XG4gICAgcmV0dXJuIF9fcHJpdmF0ZUdldCh0aGlzLCBfaW5wdXQzKS52YWx1ZTtcbiAgfVxuICBzZXQgdmFsdWUobmV3VmFsdWUpIHtcbiAgICBfX3ByaXZhdGVHZXQodGhpcywgX2lucHV0MykudmFsdWUgPSBuZXdWYWx1ZSB8fCBcIlwiO1xuICB9XG4gIGdldCBpbnB1dCgpIHtcbiAgICByZXR1cm4gX19wcml2YXRlR2V0KHRoaXMsIF9pbnB1dDMpO1xuICB9XG4gIGdldCB0ZW1wbGF0ZSgpIHtcbiAgICByZXR1cm4gR0VPQ09ERVJfVEVNUExBVEU7XG4gIH1cbiAgZ2V0IHRlbXBsYXRlU3R5bGUoKSB7XG4gICAgcmV0dXJuIHN0eWxlX2RlZmF1bHQ7XG4gIH1cbiAgZ2V0IHRlbXBsYXRlVXNlclN0eWxlKCkge1xuICAgIHJldHVybiBnZXRUaGVtZUNTUyhcIi5HZW9jb2RlclwiLCBfX3ByaXZhdGVHZXQodGhpcywgX2xpc3Rib3gzKS50aGVtZSk7XG4gIH1cbiAgZ2V0IHRoZW1lKCkge1xuICAgIHJldHVybiBfX3ByaXZhdGVHZXQodGhpcywgX2xpc3Rib3gzKS50aGVtZTtcbiAgfVxuICBzZXQgdGhlbWUodGhlbWUpIHtcbiAgICBfX3ByaXZhdGVHZXQodGhpcywgX2xpc3Rib3gzKS50aGVtZSA9IHRoZW1lO1xuICAgIGlmICghX19wcml2YXRlR2V0KHRoaXMsIF9iaW5kaW5nNikgfHwgIXRoZW1lKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMudXBkYXRlVGVtcGxhdGVVc2VyU3R5bGUoZ2V0VGhlbWVDU1MoXCIuR2VvY29kZXJcIiwgdGhlbWUpKTtcbiAgICBfX3ByaXZhdGVHZXQodGhpcywgX2xpc3Rib3gzKS51cGRhdGVQb3BvdmVyKCk7XG4gICAgY29uc3QgeyBTZWFyY2hJY29uIH0gPSBfX3ByaXZhdGVHZXQodGhpcywgX2JpbmRpbmc2KTtcbiAgICBTZWFyY2hJY29uLmlubmVySFRNTCA9IGdldEljb24oXCJzZWFyY2hcIiwgdGhlbWUpO1xuICB9XG4gIGdldCBwb3BvdmVyT3B0aW9ucygpIHtcbiAgICByZXR1cm4gX19wcml2YXRlR2V0KHRoaXMsIF9saXN0Ym94MykucG9wb3Zlck9wdGlvbnM7XG4gIH1cbiAgc2V0IHBvcG92ZXJPcHRpb25zKG5ld09wdGlvbnMpIHtcbiAgICBfX3ByaXZhdGVHZXQodGhpcywgX2xpc3Rib3gzKS5wb3BvdmVyT3B0aW9ucyA9IG5ld09wdGlvbnM7XG4gIH1cbiAgZ2V0IHBsYWNlaG9sZGVyKCkge1xuICAgIHJldHVybiBfX3ByaXZhdGVHZXQodGhpcywgX3BsYWNlaG9sZGVyMikgfHwgX19wcml2YXRlTWV0aG9kKHRoaXMsIF9nZXREZWZhdWx0UGxhY2Vob2xkZXIyLCBnZXREZWZhdWx0UGxhY2Vob2xkZXJfZm4yKS5jYWxsKHRoaXMpO1xuICB9XG4gIHNldCBwbGFjZWhvbGRlcih0ZXh0KSB7XG4gICAgX19wcml2YXRlU2V0KHRoaXMsIF9wbGFjZWhvbGRlcjIsIHRleHQpO1xuICAgIGlmIChfX3ByaXZhdGVHZXQodGhpcywgX2lucHV0MykpIHtcbiAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfaW5wdXQzKS5wbGFjZWhvbGRlciA9IHRoaXMucGxhY2Vob2xkZXI7XG4gICAgICBfX3ByaXZhdGVHZXQodGhpcywgX2lucHV0Mykuc2V0QXR0cmlidXRlKFwiYXJpYS1sYWJlbFwiLCB0aGlzLnBsYWNlaG9sZGVyKTtcbiAgICB9XG4gIH1cbiAgY29ubmVjdGVkQ2FsbGJhY2soKSB7XG4gICAgc3VwZXIuY29ubmVjdGVkQ2FsbGJhY2soKTtcbiAgICBfX3ByaXZhdGVTZXQodGhpcywgX2JpbmRpbmc2LCBiaW5kRWxlbWVudHModGhpcywge1xuICAgICAgR2VvY29kZXI6IFwiLkdlb2NvZGVyXCIsXG4gICAgICBTZWFyY2hJY29uOiBcIi5TZWFyY2hJY29uXCIsXG4gICAgICBJbnB1dDogXCIuSW5wdXRcIixcbiAgICAgIENsZWFyQnRuOiBcIi5DbGVhckJ0blwiLFxuICAgICAgTG9hZGluZ0ljb246IFwiLkxvYWRpbmdJY29uXCJcbiAgICB9KSk7XG4gICAgdGhpcy50aGVtZSA9IF9fc3ByZWFkVmFsdWVzKHt9LCB0aGlzLnRoZW1lKTtcbiAgICBjb25zdCB7IElucHV0LCBDbGVhckJ0biB9ID0gX19wcml2YXRlR2V0KHRoaXMsIF9iaW5kaW5nNik7XG4gICAgX19wcml2YXRlU2V0KHRoaXMsIF9pbnB1dDMsIElucHV0KTtcbiAgICBfX3ByaXZhdGVHZXQodGhpcywgX2xpc3Rib3gzKS5pbnB1dCA9IElucHV0O1xuICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfbGlzdGJveDMpLnNlYXJjaFNlcnZpY2UgPSAxIC8qIEdlb2NvZGluZyAqLztcbiAgICBfX3ByaXZhdGVHZXQodGhpcywgX2xpc3Rib3gzKS5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgX19wcml2YXRlR2V0KHRoaXMsIF9vbkhhbmRsZUlucHV0MykpO1xuICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfbGlzdGJveDMpLmFkZEV2ZW50TGlzdGVuZXIoXCJzZWxlY3RcIiwgX19wcml2YXRlR2V0KHRoaXMsIF9vbkhhbmRsZVNlbGVjdDMpKTtcbiAgICBfX3ByaXZhdGVHZXQodGhpcywgX2xpc3Rib3gzKS5hZGRFdmVudExpc3RlbmVyKFwiYmx1clwiLCBfX3ByaXZhdGVHZXQodGhpcywgX29uSGFuZGxlQmx1cjMpKTtcbiAgICBfX3ByaXZhdGVHZXQodGhpcywgX3Nlc3Npb24zKS5hZGRFdmVudExpc3RlbmVyKFwic3VnZ2VzdFwiLCBfX3ByaXZhdGVHZXQodGhpcywgX2hhbmRsZVN1Z2dlc3QzKSk7XG4gICAgX19wcml2YXRlR2V0KHRoaXMsIF9zZXNzaW9uMykuYWRkRXZlbnRMaXN0ZW5lcihcInN1Z2dlc3RlcnJvclwiLCBfX3ByaXZhdGVHZXQodGhpcywgX2hhbmRsZVN1Z2dlc3RFcnJvcjMpKTtcbiAgICBfX3ByaXZhdGVHZXQodGhpcywgX3Nlc3Npb24zKS5hZGRFdmVudExpc3RlbmVyKFwicmV0cmlldmVcIiwgX19wcml2YXRlR2V0KHRoaXMsIF9oYW5kbGVSZXRyaWV2ZTMpKTtcbiAgICBDbGVhckJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgX19wcml2YXRlR2V0KHRoaXMsIF9oYW5kbGVDbGVhcjIpKTtcbiAgICB0aGlzLnBsYWNlaG9sZGVyID0gX19wcml2YXRlR2V0KHRoaXMsIF9wbGFjZWhvbGRlcjIpO1xuICAgIHRoaXMucGFyZW50RWxlbWVudC5hcHBlbmRDaGlsZChfX3ByaXZhdGVHZXQodGhpcywgX2xpc3Rib3gzKSk7XG4gICAgaWYgKElucHV0KSB7XG4gICAgICBpZiAoSW5wdXQucHJldmlvdXNFbGVtZW50U2libGluZy5oYXNBdHRyaWJ1dGUoXCJhcmlhLWxpdmVcIikpIHtcbiAgICAgICAgSW5wdXQucHJldmlvdXNFbGVtZW50U2libGluZy5yZW1vdmUoKTtcbiAgICAgIH1cbiAgICAgIElucHV0Lmluc2VydEFkamFjZW50RWxlbWVudChcImJlZm9yZWJlZ2luXCIsIGNyZWF0ZUFyaWFMaXZlRWxlbWVudChfX3ByaXZhdGVHZXQodGhpcywgX2xpc3Rib3gzKS5kYXRhU2VlZCkpO1xuICAgIH1cbiAgfVxuICBkaXNjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICBfX3ByaXZhdGVHZXQodGhpcywgX2xpc3Rib3gzKS5yZW1vdmUoKTtcbiAgICBfX3ByaXZhdGVHZXQodGhpcywgX2xpc3Rib3gzKS5pbnB1dCA9IG51bGw7XG4gICAgX19wcml2YXRlR2V0KHRoaXMsIF9saXN0Ym94MykucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIF9fcHJpdmF0ZUdldCh0aGlzLCBfb25IYW5kbGVJbnB1dDMpKTtcbiAgICBfX3ByaXZhdGVHZXQodGhpcywgX2xpc3Rib3gzKS5yZW1vdmVFdmVudExpc3RlbmVyKFwic2VsZWN0XCIsIF9fcHJpdmF0ZUdldCh0aGlzLCBfb25IYW5kbGVTZWxlY3QzKSk7XG4gICAgX19wcml2YXRlR2V0KHRoaXMsIF9saXN0Ym94MykucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImJsdXJcIiwgX19wcml2YXRlR2V0KHRoaXMsIF9vbkhhbmRsZUJsdXIzKSk7XG4gICAgX19wcml2YXRlR2V0KHRoaXMsIF9zZXNzaW9uMykucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInN1Z2dlc3RcIiwgX19wcml2YXRlR2V0KHRoaXMsIF9oYW5kbGVTdWdnZXN0MykpO1xuICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfc2Vzc2lvbjMpLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJzdWdnZXN0ZXJyb3JcIiwgX19wcml2YXRlR2V0KHRoaXMsIF9oYW5kbGVTdWdnZXN0RXJyb3IzKSk7XG4gICAgX19wcml2YXRlR2V0KHRoaXMsIF9zZXNzaW9uMykucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInJldHJpZXZlXCIsIF9fcHJpdmF0ZUdldCh0aGlzLCBfaGFuZGxlUmV0cmlldmUzKSk7XG4gIH1cbiAgYXR0cmlidXRlQ2hhbmdlZENhbGxiYWNrKG5hbWUsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgIGlmIChuYW1lID09PSBcImFjY2Vzcy10b2tlblwiKSB7XG4gICAgICBfX3ByaXZhdGVHZXQodGhpcywgX3NlYXJjaDIpLmFjY2Vzc1Rva2VuID0gbmV3VmFsdWU7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChuYW1lID09PSBcInRoZW1lXCIpIHtcbiAgICAgIHRoaXMudGhlbWUgPSB0cnlQYXJzZUpTT04obmV3VmFsdWUpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAobmFtZSA9PT0gXCJwb3BvdmVyLW9wdGlvbnNcIikge1xuICAgICAgdGhpcy5wb3BvdmVyT3B0aW9ucyA9IHRyeVBhcnNlSlNPTihuZXdWYWx1ZSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChuYW1lID09PSBcInBsYWNlaG9sZGVyXCIpIHtcbiAgICAgIHRoaXMucGxhY2Vob2xkZXIgPSBuZXdWYWx1ZTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3Qgb3B0aW9uTmFtZSA9IG5hbWUuc3BsaXQoXCItXCIpLmpvaW4oXCJfXCIpO1xuICAgIGlmICghbmV3VmFsdWUpIHtcbiAgICAgIGRlbGV0ZSB0aGlzLm9wdGlvbnNbb3B0aW9uTmFtZV07XG4gICAgfVxuICAgIHRoaXMub3B0aW9uc1tvcHRpb25OYW1lXSA9IG5ld1ZhbHVlO1xuICAgIGlmIChvcHRpb25OYW1lID09PSBcImxhbmd1YWdlXCIpIHtcbiAgICAgIHRoaXMucGxhY2Vob2xkZXIgPSBfX3ByaXZhdGVHZXQodGhpcywgX3BsYWNlaG9sZGVyMik7XG4gICAgfVxuICB9XG4gIGZvY3VzKCkge1xuICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfbGlzdGJveDMpLmZvY3VzKCk7XG4gIH1cbiAgc2VhcmNoKHRleHQpIHtcbiAgICB0aGlzLnZhbHVlID0gdGV4dDtcbiAgICBfX3ByaXZhdGVHZXQodGhpcywgX29uSGFuZGxlSW5wdXQzKS5jYWxsKHRoaXMsIG5ldyBNYXBib3hIVE1MRXZlbnQoXCJpbnB1dFwiLCB0ZXh0KSk7XG4gIH1cbiAgYmluZE1hcChtYXApIHtcbiAgICBpZiAoX19wcml2YXRlR2V0KHRoaXMsIF9tYXAyKSkge1xuICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF9tYXAyKS5vZmYoXCJtb3ZlZW5kXCIsIF9fcHJpdmF0ZUdldCh0aGlzLCBfaGFuZGxlTW92ZUVuZDIpKTtcbiAgICB9XG4gICAgaWYgKG1hcCkge1xuICAgICAgbWFwLm9uKFwibW92ZWVuZFwiLCBfX3ByaXZhdGVHZXQodGhpcywgX2hhbmRsZU1vdmVFbmQyKSk7XG4gICAgfVxuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfbWFwMiwgbWFwKTtcbiAgfVxuICB1bmJpbmRNYXAoKSB7XG4gICAgdGhpcy5iaW5kTWFwKG51bGwpO1xuICB9XG4gIG9uQWRkKG1hcCkge1xuICAgIHRoaXMuYmluZE1hcChtYXApO1xuICAgIHRoaXMucmVtb3ZlKCk7XG4gICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICBjb250YWluZXIuY2xhc3NOYW1lID0gXCJtYXBib3hnbC1jdHJsXCI7XG4gICAgY29udGFpbmVyLnN0eWxlLndpZHRoID0gXCIzMDBweFwiO1xuICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzKTtcbiAgICByZXR1cm4gY29udGFpbmVyO1xuICB9XG4gIG9uUmVtb3ZlKCkge1xuICAgIHRoaXMucmVtb3ZlKCk7XG4gICAgdGhpcy51bmJpbmRNYXAoKTtcbiAgICBfX3ByaXZhdGVHZXQodGhpcywgX3JlbW92ZU1hcmtlcjIpLmNhbGwodGhpcyk7XG4gIH1cbiAgZ2V0RGVmYXVsdFBvc2l0aW9uKCkge1xuICAgIHJldHVybiBcInRvcC1yaWdodFwiO1xuICB9XG59O1xuX2JpbmRpbmc2ID0gbmV3IFdlYWtNYXAoKTtcbl9zZWFyY2gyID0gbmV3IFdlYWtNYXAoKTtcbl9zZXNzaW9uMyA9IG5ldyBXZWFrTWFwKCk7XG5fbWFwMiA9IG5ldyBXZWFrTWFwKCk7XG5faW5wdXQzID0gbmV3IFdlYWtNYXAoKTtcbl9saXN0Ym94MyA9IG5ldyBXZWFrTWFwKCk7XG5fZ2V0RGVmYXVsdFBsYWNlaG9sZGVyMiA9IG5ldyBXZWFrU2V0KCk7XG5nZXREZWZhdWx0UGxhY2Vob2xkZXJfZm4yID0gZnVuY3Rpb24oKSB7XG4gIGlmICh0aGlzLm9wdGlvbnMubGFuZ3VhZ2UpIHtcbiAgICBjb25zdCBmaXJzdExhbmd1YWdlID0gdGhpcy5vcHRpb25zLmxhbmd1YWdlLnNwbGl0KFwiLFwiKVswXTtcbiAgICBjb25zdCBsYW5ndWFnZSA9IHN1YnRhZzIubGFuZ3VhZ2UoZmlyc3RMYW5ndWFnZSk7XG4gICAgY29uc3QgbG9jYWxpemVkVmFsdWUgPSBsb2NhbGl6YXRpb25fZGVmYXVsdC5wbGFjZWhvbGRlcltsYW5ndWFnZV07XG4gICAgaWYgKGxvY2FsaXplZFZhbHVlKVxuICAgICAgcmV0dXJuIGxvY2FsaXplZFZhbHVlO1xuICB9XG4gIHJldHVybiBcIlNlYXJjaFwiO1xufTtcbl9wbGFjZWhvbGRlcjIgPSBuZXcgV2Vha01hcCgpO1xuX2hhbmRsZVN1Z2dlc3QzID0gbmV3IFdlYWtNYXAoKTtcbl9oYW5kbGVTdWdnZXN0RXJyb3IzID0gbmV3IFdlYWtNYXAoKTtcbl9oYW5kbGVSZXRyaWV2ZTMgPSBuZXcgV2Vha01hcCgpO1xuX21hcE1hcmtlcjIgPSBuZXcgV2Vha01hcCgpO1xuX3JlbW92ZU1hcmtlcjIgPSBuZXcgV2Vha01hcCgpO1xuX2hhbmRsZU1hcmtlcjIgPSBuZXcgV2Vha01hcCgpO1xuX29uSGFuZGxlSW5wdXQzID0gbmV3IFdlYWtNYXAoKTtcbl9vbkhhbmRsZVNlbGVjdDMgPSBuZXcgV2Vha01hcCgpO1xuX29uSGFuZGxlQmx1cjMgPSBuZXcgV2Vha01hcCgpO1xuX3NldEFjdGlvbkljb25zMiA9IG5ldyBXZWFrTWFwKCk7XG5faGFuZGxlQ2xlYXIyID0gbmV3IFdlYWtNYXAoKTtcbl9oYW5kbGVNb3ZlRW5kMiA9IG5ldyBXZWFrTWFwKCk7XG5NYXBib3hHZW9jb2Rlci5vYnNlcnZlZEF0dHJpYnV0ZXMgPSBbXG4gIFwiYWNjZXNzLXRva2VuXCIsXG4gIFwidGhlbWVcIixcbiAgXCJwb3BvdmVyLW9wdGlvbnNcIixcbiAgXCJwbGFjZWhvbGRlclwiLFxuICBcImF1dG9jb21wbGV0ZVwiLFxuICBcImxhbmd1YWdlXCIsXG4gIFwiY291bnRyeVwiLFxuICBcImJib3hcIixcbiAgXCJsaW1pdFwiLFxuICBcInByb3hpbWl0eVwiLFxuICBcInR5cGVzXCIsXG4gIFwid29ybGR2aWV3XCIsXG4gIFwicGVybWFuZW50XCJcbl07XG53aW5kb3cuTWFwYm94R2VvY29kZXIgPSBNYXBib3hHZW9jb2RlcjtcbmlmICghd2luZG93LmN1c3RvbUVsZW1lbnRzLmdldChcIm1hcGJveC1nZW9jb2RlclwiKSkge1xuICBjdXN0b21FbGVtZW50cy5kZWZpbmUoXCJtYXBib3gtZ2VvY29kZXJcIiwgTWFwYm94R2VvY29kZXIpO1xufVxuXG4vLyBzcmMvY29tcG9uZW50cy9NYXBib3hBZGRyZXNzTWluaW1hcC50c1xuaW1wb3J0IHsgTG5nTGF0IH0gZnJvbSBcIkBtYXBib3gvc2VhcmNoLWpzLWNvcmVcIjtcblxuLy8gc3JjL3V0aWxzL21pbmltYXAudHNcbmltcG9ydCBTcGhlcmljYWxNZXJjYXRvciBmcm9tIFwiQG1hcGJveC9zcGhlcmljYWxtZXJjYXRvclwiO1xudmFyIG1lcmMgPSBuZXcgU3BoZXJpY2FsTWVyY2F0b3IoeyBzaXplOiA1MTIsIGFudGltZXJpZGlhbjogdHJ1ZSB9KTtcbnZhciBNQVhfSU1BR0VfRElNID0gMTI4MDtcbmZ1bmN0aW9uIGdldEFuY2hvck9mZnNldChtYXJrZXIsIGFuY2hvcikge1xuICBjb25zdCB7IHdpZHRoLCBoZWlnaHQgfSA9IGdldEVsZW1lbnRTaXplKG1hcmtlciwgdHJ1ZSk7XG4gIHN3aXRjaCAoYW5jaG9yKSB7XG4gICAgY2FzZSBcImNlbnRlclwiOlxuICAgICAgcmV0dXJuIFswLCAwXTtcbiAgICBjYXNlIFwidG9wXCI6XG4gICAgICByZXR1cm4gWzAsIGhlaWdodCAvIDJdO1xuICAgIGNhc2UgXCJib3R0b21cIjpcbiAgICAgIHJldHVybiBbMCwgLTEgKiBoZWlnaHQgLyAyXTtcbiAgICBjYXNlIFwibGVmdFwiOlxuICAgICAgcmV0dXJuIFt3aWR0aCAvIDIsIDBdO1xuICAgIGNhc2UgXCJyaWdodFwiOlxuICAgICAgcmV0dXJuIFstMSAqIHdpZHRoIC8gMiwgMF07XG4gICAgY2FzZSBcInRvcC1sZWZ0XCI6XG4gICAgICByZXR1cm4gW3dpZHRoIC8gMiwgaGVpZ2h0IC8gMl07XG4gICAgY2FzZSBcInRvcC1yaWdodFwiOlxuICAgICAgcmV0dXJuIFstMSAqIHdpZHRoIC8gMiwgaGVpZ2h0IC8gMl07XG4gICAgY2FzZSBcImJvdHRvbS1sZWZ0XCI6XG4gICAgICByZXR1cm4gW3dpZHRoIC8gMiwgLTEgKiBoZWlnaHQgLyAyXTtcbiAgICBjYXNlIFwiYm90dG9tLXJpZ2h0XCI6XG4gICAgICByZXR1cm4gWy0xICogd2lkdGggLyAyLCAtMSAqIGhlaWdodCAvIDJdO1xuICB9XG59XG52YXIgX2FuY2hvciwgX2hhbmRsZUFuY2hvclJlc2l6ZSwgX21hcmtlclRyYW5zZm9ybSwgX2lzQWN0aXZlLCBfb3JpZ2luYWxDb29yZGluYXRlLCBfb25Qb2ludGVyRG93bk1hcmtlciwgX29uUG9pbnRlclVwTWFya2VyLCBfb25Qb2ludGVyTW92ZU1hcmtlciwgX29uUG9pbnRlckRvd25JbWFnZSwgX29uUG9pbnRlclVwSW1hZ2UsIF9vblBvaW50ZXJNb3ZlSW1hZ2UsIF91cGRhdGVQb2ludGVyUG9zaXRpb24sIF91cGRhdGVNYXJrZXJUcmFuc2Zvcm0sIF91cGRhdGVNYXJrZXJDb3JyZWN0aW9uO1xudmFyIE1hcmtlckNvbnRyb2xsZXIgPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKGltYWdlQ29udGFpbmVyLCBpbWFnZUVsZW1lbnQsIG1hcmtlciwga2VlcE1hcmtlckNlbnRlcmVkLCB6b29tLCBhbmNob3IpIHtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX2FuY2hvciwgdm9pZCAwKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX2hhbmRsZUFuY2hvclJlc2l6ZSwgKCkgPT4ge1xuICAgICAgW3RoaXMuYW5jaG9yT2Zmc2V0WCwgdGhpcy5hbmNob3JPZmZzZXRZXSA9IGdldEFuY2hvck9mZnNldCh0aGlzLm1hcmtlckVsZW1lbnQsIHRoaXMuYW5jaG9yKTtcbiAgICAgIHRoaXMubWFya2VyVHJhbnNmb3JtID0ge1xuICAgICAgICBhbmNob3JYOiB0aGlzLmFuY2hvck9mZnNldFgsXG4gICAgICAgIGFuY2hvclk6IHRoaXMuYW5jaG9yT2Zmc2V0WVxuICAgICAgfTtcbiAgICB9KTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX21hcmtlclRyYW5zZm9ybSwge1xuICAgICAgYW5jaG9yWDogMCxcbiAgICAgIGFuY2hvclk6IDAsXG4gICAgICBnbG9iYWxYOiAwLFxuICAgICAgZ2xvYmFsWTogMCxcbiAgICAgIGNvcnJlY3Rpb25YOiAwLFxuICAgICAgY29ycmVjdGlvblk6IDBcbiAgICB9KTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX2lzQWN0aXZlLCBmYWxzZSk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9vcmlnaW5hbENvb3JkaW5hdGUsIHZvaWQgMCk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9vblBvaW50ZXJEb3duTWFya2VyLCAobSkgPT4ge1xuICAgICAgaWYgKCF0aGlzLmlzQWN0aXZlKVxuICAgICAgICByZXR1cm47XG4gICAgICBtLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBtLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF91cGRhdGVQb2ludGVyUG9zaXRpb24pLmNhbGwodGhpcywgbSk7XG4gICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInBvaW50ZXJtb3ZlXCIsIF9fcHJpdmF0ZUdldCh0aGlzLCBfb25Qb2ludGVyTW92ZU1hcmtlcikpO1xuICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJwb2ludGVydXBcIiwgX19wcml2YXRlR2V0KHRoaXMsIF9vblBvaW50ZXJVcE1hcmtlcikpO1xuICAgIH0pO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfb25Qb2ludGVyVXBNYXJrZXIsICgpID0+IHtcbiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwicG9pbnRlcm1vdmVcIiwgX19wcml2YXRlR2V0KHRoaXMsIF9vblBvaW50ZXJNb3ZlTWFya2VyKSk7XG4gICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInBvaW50ZXJ1cFwiLCBfX3ByaXZhdGVHZXQodGhpcywgX29uUG9pbnRlclVwTWFya2VyKSk7XG4gICAgfSk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9vblBvaW50ZXJNb3ZlTWFya2VyLCAobSkgPT4ge1xuICAgICAgbS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgbS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgIGNvbnN0IGRpZmZYID0gdGhpcy5jdXJQb2ludGVyWFBvcyAtIG0ucGFnZVg7XG4gICAgICBjb25zdCBkaWZmWSA9IHRoaXMuY3VyUG9pbnRlcllQb3MgLSBtLnBhZ2VZO1xuICAgICAgdGhpcy5tYXJrZXJEZWx0YVggKz0gZGlmZlg7XG4gICAgICB0aGlzLm1hcmtlckRlbHRhWSAtPSBkaWZmWTtcbiAgICAgIHRoaXMubWFya2VyRGVsdGFYID0gTWF0aC5tYXgoTWF0aC5taW4odGhpcy5pbWdFbGVtZW50LndpZHRoIC8gMiwgdGhpcy5tYXJrZXJEZWx0YVgpLCB0aGlzLmltZ0VsZW1lbnQud2lkdGggLyAyICogLTEpO1xuICAgICAgdGhpcy5tYXJrZXJEZWx0YVkgPSBNYXRoLm1heChNYXRoLm1pbih0aGlzLmltZ0VsZW1lbnQuaGVpZ2h0IC8gMiwgdGhpcy5tYXJrZXJEZWx0YVkpLCB0aGlzLmltZ0VsZW1lbnQuaGVpZ2h0IC8gMiAqIC0xKTtcbiAgICAgIGNvbnN0IGltYWdlT2Zmc2V0WCA9IHRoaXMuaW1nQ2VudGVyUHhbMF0gLSB0aGlzLmltZ0NlbnRlckFkanVzdGVkUHhbMF07XG4gICAgICBjb25zdCBpbWFnZU9mZnNldFkgPSB0aGlzLmltZ0NlbnRlclB4WzFdIC0gdGhpcy5pbWdDZW50ZXJBZGp1c3RlZFB4WzFdO1xuICAgICAgY29uc3QgZGVsdGFYID0gdGhpcy5tYXJrZXJEZWx0YVggLSBpbWFnZU9mZnNldFg7XG4gICAgICBjb25zdCBkZWx0YVkgPSB0aGlzLm1hcmtlckRlbHRhWSArIGltYWdlT2Zmc2V0WTtcbiAgICAgIHRoaXMubWFya2VyVHJhbnNmb3JtID0geyBnbG9iYWxYOiBkZWx0YVgsIGdsb2JhbFk6IGRlbHRhWSB9O1xuICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF91cGRhdGVQb2ludGVyUG9zaXRpb24pLmNhbGwodGhpcywgbSk7XG4gICAgfSk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9vblBvaW50ZXJEb3duSW1hZ2UsIChtKSA9PiB7XG4gICAgICBpZiAoIXRoaXMuaXNBY3RpdmUpXG4gICAgICAgIHJldHVybjtcbiAgICAgIG0ucHJldmVudERlZmF1bHQoKTtcbiAgICAgIG0uc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICBfX3ByaXZhdGVHZXQodGhpcywgX3VwZGF0ZVBvaW50ZXJQb3NpdGlvbikuY2FsbCh0aGlzLCBtKTtcbiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwicG9pbnRlcm1vdmVcIiwgX19wcml2YXRlR2V0KHRoaXMsIF9vblBvaW50ZXJNb3ZlSW1hZ2UpKTtcbiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwicG9pbnRlcnVwXCIsIF9fcHJpdmF0ZUdldCh0aGlzLCBfb25Qb2ludGVyVXBJbWFnZSkpO1xuICAgIH0pO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfb25Qb2ludGVyVXBJbWFnZSwgKCkgPT4ge1xuICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJwb2ludGVybW92ZVwiLCBfX3ByaXZhdGVHZXQodGhpcywgX29uUG9pbnRlck1vdmVJbWFnZSkpO1xuICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJwb2ludGVydXBcIiwgX19wcml2YXRlR2V0KHRoaXMsIF9vblBvaW50ZXJVcEltYWdlKSk7XG4gICAgfSk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9vblBvaW50ZXJNb3ZlSW1hZ2UsIChtKSA9PiB7XG4gICAgICBtLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBsZXQgdG9wID0gTWF0aC5yb3VuZCh0aGlzLmltZ0NvbnRhaW5lckVsZW1lbnQuc2Nyb2xsVG9wICsgKHRoaXMuY3VyUG9pbnRlcllQb3MgLSBtLnBhZ2VZKSk7XG4gICAgICB0b3AgPSBNYXRoLm1heChNYXRoLm1pbih0aGlzLmltZ0VsZW1lbnQuaGVpZ2h0IC0gdGhpcy5pbWdDb250YWluZXJFbGVtZW50LmNsaWVudEhlaWdodCwgdG9wKSwgMCk7XG4gICAgICBsZXQgbGVmdCA9IE1hdGgucm91bmQodGhpcy5pbWdDb250YWluZXJFbGVtZW50LnNjcm9sbExlZnQgKyAodGhpcy5jdXJQb2ludGVyWFBvcyAtIG0ucGFnZVgpKTtcbiAgICAgIGxlZnQgPSBNYXRoLm1heChNYXRoLm1pbih0aGlzLmltZ0VsZW1lbnQud2lkdGggLSB0aGlzLmltZ0NvbnRhaW5lckVsZW1lbnQuY2xpZW50V2lkdGgsIGxlZnQpLCAwKTtcbiAgICAgIHRoaXMuaW1nQ29udGFpbmVyRWxlbWVudC5zY3JvbGxUb3AgPSB0b3A7XG4gICAgICB0aGlzLmltZ0NvbnRhaW5lckVsZW1lbnQuc2Nyb2xsTGVmdCA9IGxlZnQ7XG4gICAgICBjb25zdCBkaWZmWCA9IE1hdGgucm91bmQobGVmdCAtICh0aGlzLmltZ0VsZW1lbnQud2lkdGggLSB0aGlzLmltZ0NvbnRhaW5lckVsZW1lbnQuY2xpZW50V2lkdGgpIC8gMik7XG4gICAgICBjb25zdCBkaWZmWSA9IE1hdGgucm91bmQoKHRoaXMuaW1nRWxlbWVudC5oZWlnaHQgLSB0aGlzLmltZ0NvbnRhaW5lckVsZW1lbnQuY2xpZW50SGVpZ2h0KSAvIDIgLSB0b3ApO1xuICAgICAgdGhpcy5pbWdDZW50ZXJBZGp1c3RlZFB4ID0gW1xuICAgICAgICB0aGlzLmltZ0NlbnRlclB4WzBdICsgZGlmZlgsXG4gICAgICAgIHRoaXMuaW1nQ2VudGVyUHhbMV0gLSBkaWZmWVxuICAgICAgXTtcbiAgICAgIGlmICghdGhpcy5rZWVwTWFya2VyQ2VudGVyZWQpIHtcbiAgICAgICAgY29uc3QgZGVsdGFYID0gdGhpcy5tYXJrZXJEZWx0YVggKyBkaWZmWDtcbiAgICAgICAgY29uc3QgZGVsdGFZID0gdGhpcy5tYXJrZXJEZWx0YVkgKyBkaWZmWTtcbiAgICAgICAgdGhpcy5tYXJrZXJUcmFuc2Zvcm0gPSB7IGdsb2JhbFg6IGRlbHRhWCwgZ2xvYmFsWTogZGVsdGFZIH07XG4gICAgICB9XG4gICAgICBfX3ByaXZhdGVHZXQodGhpcywgX3VwZGF0ZU1hcmtlckNvcnJlY3Rpb24pLmNhbGwodGhpcywgbGVmdCwgdG9wKTtcbiAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfdXBkYXRlUG9pbnRlclBvc2l0aW9uKS5jYWxsKHRoaXMsIG0pO1xuICAgIH0pO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfdXBkYXRlUG9pbnRlclBvc2l0aW9uLCAobSkgPT4ge1xuICAgICAgdGhpcy5jdXJQb2ludGVyWFBvcyA9IG0ucGFnZVg7XG4gICAgICB0aGlzLmN1clBvaW50ZXJZUG9zID0gbS5wYWdlWTtcbiAgICB9KTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX3VwZGF0ZU1hcmtlclRyYW5zZm9ybSwgKCkgPT4ge1xuICAgICAgY29uc3QgeyBhbmNob3JYLCBhbmNob3JZLCBnbG9iYWxYLCBnbG9iYWxZLCBjb3JyZWN0aW9uWCwgY29ycmVjdGlvblkgfSA9IF9fcHJpdmF0ZUdldCh0aGlzLCBfbWFya2VyVHJhbnNmb3JtKTtcbiAgICAgIGNvbnN0IHRyYW5zZm9ybVggPSBhbmNob3JYIC0gZ2xvYmFsWCArIGNvcnJlY3Rpb25YO1xuICAgICAgY29uc3QgdHJhbnNmb3JtWSA9IGFuY2hvclkgKyBnbG9iYWxZICsgY29ycmVjdGlvblk7XG4gICAgICB0aGlzLm1hcmtlckVsZW1lbnQuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZShjYWxjKC01MCUgKyAke3RyYW5zZm9ybVh9cHgpLCBjYWxjKC01MCUgKyAke3RyYW5zZm9ybVl9cHgpKWA7XG4gICAgfSk7XG4gICAgdGhpcy5yZUNlbnRlciA9ICgpID0+IHtcbiAgICAgIGNvbnN0IHRvcCA9ICh0aGlzLmltZ0VsZW1lbnQuaGVpZ2h0IC0gdGhpcy5pbWdDb250YWluZXJFbGVtZW50LmNsaWVudEhlaWdodCkgLyAyO1xuICAgICAgY29uc3QgbGVmdCA9ICh0aGlzLmltZ0VsZW1lbnQud2lkdGggLSB0aGlzLmltZ0NvbnRhaW5lckVsZW1lbnQuY2xpZW50V2lkdGgpIC8gMjtcbiAgICAgIHRoaXMuaW1nQ29udGFpbmVyRWxlbWVudC5zY3JvbGxUb3AgPSB0b3A7XG4gICAgICB0aGlzLmltZ0NvbnRhaW5lckVsZW1lbnQuc2Nyb2xsTGVmdCA9IGxlZnQ7XG4gICAgICB0aGlzLmltZ0NlbnRlckFkanVzdGVkUHggPSB0aGlzLmltZ0NlbnRlclB4O1xuICAgICAgdGhpcy5tYXJrZXJEZWx0YVggPSB0aGlzLm1hcmtlckRlbHRhWSA9IDA7XG4gICAgICB0aGlzLm1hcmtlclRyYW5zZm9ybSA9IHtcbiAgICAgICAgZ2xvYmFsWDogMCxcbiAgICAgICAgZ2xvYmFsWTogMCxcbiAgICAgICAgY29ycmVjdGlvblg6IDAsXG4gICAgICAgIGNvcnJlY3Rpb25ZOiAwXG4gICAgICB9O1xuICAgIH07XG4gICAgdGhpcy5oYW5kbGVNaW5pbWFwUmVzaXplID0gKCkgPT4ge1xuICAgICAgaWYgKCF0aGlzLmltZ0VsZW1lbnQuaGVpZ2h0IHx8ICF0aGlzLmltZ0VsZW1lbnQud2lkdGgpXG4gICAgICAgIHJldHVybjtcbiAgICAgIGNvbnN0IGNlbnRlck9mZnNldFggPSB0aGlzLmltZ0NlbnRlck9mZnNldC54O1xuICAgICAgY29uc3QgY2VudGVyT2Zmc2V0WSA9IHRoaXMuaW1nQ2VudGVyT2Zmc2V0Lnk7XG4gICAgICBjb25zdCBsZWZ0ID0gdGhpcy5pbWdFbGVtZW50LndpZHRoIC8gMiAtIGNlbnRlck9mZnNldFggLSB0aGlzLmltZ0NvbnRhaW5lckVsZW1lbnQuY2xpZW50V2lkdGggLyAyO1xuICAgICAgY29uc3QgdG9wID0gdGhpcy5pbWdFbGVtZW50LmhlaWdodCAvIDIgLSBjZW50ZXJPZmZzZXRZIC0gdGhpcy5pbWdDb250YWluZXJFbGVtZW50LmNsaWVudEhlaWdodCAvIDI7XG4gICAgICB0aGlzLmltZ0NvbnRhaW5lckVsZW1lbnQuc2Nyb2xsTGVmdCA9IGxlZnQ7XG4gICAgICB0aGlzLmltZ0NvbnRhaW5lckVsZW1lbnQuc2Nyb2xsVG9wID0gdG9wO1xuICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF91cGRhdGVNYXJrZXJDb3JyZWN0aW9uKS5jYWxsKHRoaXMsIGxlZnQsIHRvcCk7XG4gICAgfTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX3VwZGF0ZU1hcmtlckNvcnJlY3Rpb24sIChzY3JvbGxMZWZ0LCBzY3JvbGxUb3ApID0+IHtcbiAgICAgIGNvbnN0IGNlbnRlck9mZnNldFggPSB0aGlzLmltZ0NlbnRlck9mZnNldC54O1xuICAgICAgY29uc3QgY2VudGVyT2Zmc2V0WSA9IHRoaXMuaW1nQ2VudGVyT2Zmc2V0Lnk7XG4gICAgICBjb25zdCB7IGNvcnJlY3Rpb25YLCBjb3JyZWN0aW9uWSB9ID0gdGhpcy5tYXJrZXJUcmFuc2Zvcm07XG4gICAgICBjb25zdCBjb3JyZWN0aW9ucyA9IHt9O1xuICAgICAgaWYgKHNjcm9sbExlZnQgLyAyIDwgY2VudGVyT2Zmc2V0WCAqIC0xKSB7XG4gICAgICAgIGNvbnN0IG1hcmtlclRyYW5zbGF0ZVggPSBjZW50ZXJPZmZzZXRYICogLTEgLSBzY3JvbGxMZWZ0IC8gMjtcbiAgICAgICAgY29ycmVjdGlvbnMuY29ycmVjdGlvblggPSBtYXJrZXJUcmFuc2xhdGVYICogMjtcbiAgICAgIH0gZWxzZSBpZiAoc2Nyb2xsTGVmdCA8IDApIHtcbiAgICAgICAgY29ycmVjdGlvbnMuY29ycmVjdGlvblggPSBzY3JvbGxMZWZ0O1xuICAgICAgfSBlbHNlIGlmIChjb3JyZWN0aW9uWCAhPT0gMCkge1xuICAgICAgICBjb3JyZWN0aW9ucy5jb3JyZWN0aW9uWCA9IDA7XG4gICAgICB9XG4gICAgICBpZiAoc2Nyb2xsVG9wIC8gMiA8IGNlbnRlck9mZnNldFkgKiAtMSkge1xuICAgICAgICBjb25zdCBtYXJrZXJUcmFuc2xhdGVZID0gY2VudGVyT2Zmc2V0WSAqIC0xIC0gc2Nyb2xsVG9wIC8gMjtcbiAgICAgICAgY29ycmVjdGlvbnMuY29ycmVjdGlvblkgPSBtYXJrZXJUcmFuc2xhdGVZICogMjtcbiAgICAgIH0gZWxzZSBpZiAoc2Nyb2xsVG9wIDwgMCkge1xuICAgICAgICBjb3JyZWN0aW9ucy5jb3JyZWN0aW9uWSA9IHNjcm9sbFRvcDtcbiAgICAgIH0gZWxzZSBpZiAoY29ycmVjdGlvblkgIT09IDApIHtcbiAgICAgICAgY29ycmVjdGlvbnMuY29ycmVjdGlvblkgPSAwO1xuICAgICAgfVxuICAgICAgdGhpcy5tYXJrZXJUcmFuc2Zvcm0gPSBjb3JyZWN0aW9ucztcbiAgICB9KTtcbiAgICB0aGlzLm1hcmtlckVsZW1lbnQgPSBtYXJrZXI7XG4gICAgdGhpcy5pbWdDb250YWluZXJFbGVtZW50ID0gaW1hZ2VDb250YWluZXI7XG4gICAgdGhpcy5pbWdFbGVtZW50ID0gaW1hZ2VFbGVtZW50O1xuICAgIHRoaXMua2VlcE1hcmtlckNlbnRlcmVkID0ga2VlcE1hcmtlckNlbnRlcmVkO1xuICAgIHRoaXMuem9vbSA9IHpvb207XG4gICAgdGhpcy5hbmNob3IgPSBhbmNob3I7XG4gICAgdGhpcy5jdXJQb2ludGVyWFBvcyA9IDA7XG4gICAgdGhpcy5jdXJQb2ludGVyWVBvcyA9IDA7XG4gICAgdGhpcy5tYXJrZXJEZWx0YVggPSAwO1xuICAgIHRoaXMubWFya2VyRGVsdGFZID0gMDtcbiAgICB0aGlzLmltZ0NvbnRhaW5lckVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInBvaW50ZXJkb3duXCIsIF9fcHJpdmF0ZUdldCh0aGlzLCBfb25Qb2ludGVyRG93bkltYWdlKSk7XG4gICAgaWYgKCF0aGlzLmtlZXBNYXJrZXJDZW50ZXJlZCkge1xuICAgICAgdGhpcy5tYXJrZXJFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJwb2ludGVyZG93blwiLCBfX3ByaXZhdGVHZXQodGhpcywgX29uUG9pbnRlckRvd25NYXJrZXIpKTtcbiAgICB9XG4gICAgY29uc3QgcmVzaXplT2JzZXJ2ZXIgPSBuZXcgUmVzaXplT2JzZXJ2ZXIoX19wcml2YXRlR2V0KHRoaXMsIF9oYW5kbGVBbmNob3JSZXNpemUpKTtcbiAgICByZXNpemVPYnNlcnZlci5vYnNlcnZlKHRoaXMubWFya2VyRWxlbWVudCk7XG4gIH1cbiAgZ2V0IGFuY2hvcigpIHtcbiAgICByZXR1cm4gX19wcml2YXRlR2V0KHRoaXMsIF9hbmNob3IpO1xuICB9XG4gIHNldCBhbmNob3IobmV3QW5jaG9yKSB7XG4gICAgX19wcml2YXRlU2V0KHRoaXMsIF9hbmNob3IsIG5ld0FuY2hvcik7XG4gICAgW3RoaXMuYW5jaG9yT2Zmc2V0WCwgdGhpcy5hbmNob3JPZmZzZXRZXSA9IGdldEFuY2hvck9mZnNldCh0aGlzLm1hcmtlckVsZW1lbnQsIG5ld0FuY2hvcik7XG4gICAgdGhpcy5tYXJrZXJUcmFuc2Zvcm0gPSB7XG4gICAgICBhbmNob3JYOiB0aGlzLmFuY2hvck9mZnNldFgsXG4gICAgICBhbmNob3JZOiB0aGlzLmFuY2hvck9mZnNldFlcbiAgICB9O1xuICB9XG4gIGdldCBtYXJrZXJUcmFuc2Zvcm0oKSB7XG4gICAgcmV0dXJuIF9fcHJpdmF0ZUdldCh0aGlzLCBfbWFya2VyVHJhbnNmb3JtKTtcbiAgfVxuICBzZXQgbWFya2VyVHJhbnNmb3JtKHZhbCkge1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfbWFya2VyVHJhbnNmb3JtLCBfX3NwcmVhZFZhbHVlcyhfX3NwcmVhZFZhbHVlcyh7fSwgX19wcml2YXRlR2V0KHRoaXMsIF9tYXJrZXJUcmFuc2Zvcm0pKSwgdmFsKSk7XG4gICAgX19wcml2YXRlR2V0KHRoaXMsIF91cGRhdGVNYXJrZXJUcmFuc2Zvcm0pLmNhbGwodGhpcyk7XG4gIH1cbiAgZ2V0IGlzQWN0aXZlKCkge1xuICAgIHJldHVybiBfX3ByaXZhdGVHZXQodGhpcywgX2lzQWN0aXZlKTtcbiAgfVxuICBzZXQgaXNBY3RpdmUodmFsKSB7XG4gICAgdGhpcy5pbWdDb250YWluZXJFbGVtZW50LnN0eWxlLnRvdWNoQWN0aW9uID0gdmFsID8gXCJub25lXCIgOiBcIlwiO1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfaXNBY3RpdmUsIHZhbCk7XG4gIH1cbiAgZ2V0IGNvb3JkaW5hdGUoKSB7XG4gICAgY29uc3QgYWRqdXN0ZWRQeCA9IHRoaXMua2VlcE1hcmtlckNlbnRlcmVkID8gdGhpcy5pbWdDZW50ZXJBZGp1c3RlZFB4IDogW1xuICAgICAgdGhpcy5pbWdDZW50ZXJQeFswXSAtIHRoaXMubWFya2VyRGVsdGFYLFxuICAgICAgdGhpcy5pbWdDZW50ZXJQeFsxXSArIHRoaXMubWFya2VyRGVsdGFZXG4gICAgXTtcbiAgICBpZiAoZGVlcEVxdWFscyhhZGp1c3RlZFB4LCB0aGlzLmltZ0NlbnRlclB4KSkge1xuICAgICAgcmV0dXJuIF9fcHJpdmF0ZUdldCh0aGlzLCBfb3JpZ2luYWxDb29yZGluYXRlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgbG5nTGF0ID0gbWVyYy5sbChhZGp1c3RlZFB4LCB0aGlzLnpvb20pO1xuICAgICAgcmV0dXJuIFtyb3VuZChsbmdMYXRbMF0sIDYpLCByb3VuZChsbmdMYXRbMV0sIDYpXTtcbiAgICB9XG4gIH1cbiAgc2V0IGNvb3JkaW5hdGUobG5nTGF0KSB7XG4gICAgX19wcml2YXRlU2V0KHRoaXMsIF9vcmlnaW5hbENvb3JkaW5hdGUsIGxuZ0xhdCk7XG4gICAgdGhpcy5pbWdDZW50ZXJQeCA9IHRoaXMuaW1nQ2VudGVyQWRqdXN0ZWRQeCA9IG1lcmMucHgobG5nTGF0LCB0aGlzLnpvb20pO1xuICB9XG4gIGdldCBpbWdDZW50ZXJPZmZzZXQoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHg6IHRoaXMuaW1nQ2VudGVyUHhbMF0gLSB0aGlzLmltZ0NlbnRlckFkanVzdGVkUHhbMF0sXG4gICAgICB5OiB0aGlzLmltZ0NlbnRlclB4WzFdIC0gdGhpcy5pbWdDZW50ZXJBZGp1c3RlZFB4WzFdXG4gICAgfTtcbiAgfVxufTtcbl9hbmNob3IgPSBuZXcgV2Vha01hcCgpO1xuX2hhbmRsZUFuY2hvclJlc2l6ZSA9IG5ldyBXZWFrTWFwKCk7XG5fbWFya2VyVHJhbnNmb3JtID0gbmV3IFdlYWtNYXAoKTtcbl9pc0FjdGl2ZSA9IG5ldyBXZWFrTWFwKCk7XG5fb3JpZ2luYWxDb29yZGluYXRlID0gbmV3IFdlYWtNYXAoKTtcbl9vblBvaW50ZXJEb3duTWFya2VyID0gbmV3IFdlYWtNYXAoKTtcbl9vblBvaW50ZXJVcE1hcmtlciA9IG5ldyBXZWFrTWFwKCk7XG5fb25Qb2ludGVyTW92ZU1hcmtlciA9IG5ldyBXZWFrTWFwKCk7XG5fb25Qb2ludGVyRG93bkltYWdlID0gbmV3IFdlYWtNYXAoKTtcbl9vblBvaW50ZXJVcEltYWdlID0gbmV3IFdlYWtNYXAoKTtcbl9vblBvaW50ZXJNb3ZlSW1hZ2UgPSBuZXcgV2Vha01hcCgpO1xuX3VwZGF0ZVBvaW50ZXJQb3NpdGlvbiA9IG5ldyBXZWFrTWFwKCk7XG5fdXBkYXRlTWFya2VyVHJhbnNmb3JtID0gbmV3IFdlYWtNYXAoKTtcbl91cGRhdGVNYXJrZXJDb3JyZWN0aW9uID0gbmV3IFdlYWtNYXAoKTtcblxuLy8gc3JjL2ljb25zL21hcGJveGdsLWN0cmwtbG9nby5zdmdcbnZhciBtYXBib3hnbF9jdHJsX2xvZ29fZGVmYXVsdCA9ICc8c3ZnIHdpZHRoPVwiODhcIiBoZWlnaHQ9XCIyM1wiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB4bWxuczp4bGluaz1cImh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmtcIiBmaWxsLXJ1bGU9XCJldmVub2RkXCI+PGRlZnM+PHBhdGggaWQ9XCJnXCIgZD1cIk0xMS41IDIuMjVhOS4yNSA5LjI1IDAgMSAxIDAgMTguNSA5LjI1IDkuMjUgMCAwIDEgMC0xOC41ek03IDE1Ljk4Yy0uMDUtLjMzLS44My01LjggMi4yMy04Ljg3YTQuNCA0LjQgMCAwIDEgMy4xMy0xLjI4YzEuMjcgMCAyLjQ5LjUxIDMuMzkgMS40Mi45MS45IDEuNDIgMi4xMiAxLjQyIDMuMzlhNC40IDQuNCAwIDAgMS0xLjI4IDMuMTNDMTIuNzIgMTYuOTMgNyAxNiA3IDE2di0uMDJ6bTguMy01LjQ4LTIgLjgtLjggMi0uOC0yLTItLjggMi0uOC44LTIgLjggMiAyIC44elwiLz48cGF0aCBpZD1cImJcIiBkPVwiTTUwLjYzIDhjLjEzIDAgLjIzLjEuMjMuMjNWOWMuNy0uNzYgMS43LTEuMTggMi43My0xLjE4IDIuMTcgMCAzLjk1IDEuODUgMy45NSA0LjE3cy0xLjc3IDQuMTktMy45NCA0LjE5QTMuNzcgMy43NyAwIDAgMSA1MC44NiAxNXYzLjc3YzAgLjEzLS4xLjIzLS4yMy4yM2gtMS40YS4yMy4yMyAwIDAgMS0uMjMtLjIzVjguMjNjMC0uMTIuMS0uMjMuMjMtLjIzaDEuNHptLTMuODYuMDEuMDEtLjAxYy4xMyAwIC4yMi4xLjIyLjIydjcuNTVjMCAuMTItLjEuMjMtLjIzLjIzaC0xLjRhLjIzLjIzIDAgMCAxLS4yMy0uMjNWMTVhMy43IDMuNyAwIDAgMS0yLjczIDEuMTljLTIuMTcgMC0zLjk0LTEuODctMy45NC00LjE5IDAtMi4zMiAxLjc3LTQuMTkgMy45NC00LjE5IDEuMDMgMCAyLjAyLjQzIDIuNzMgMS4xOHYtLjc1YzAtLjEyLjEtLjIzLjIzLS4yM2gxLjR6bTI2LjM4LS4xOWE0LjI0IDQuMjQgMCAwIDAtNC4xNiAzLjI5IDQuMDcgNC4wNyAwIDAgMCAwIDEuNzcgNC4yMyA0LjIzIDAgMCAwIDQuMTcgMy4zIDQuMjIgNC4yMiAwIDAgMCA0LjI2LTQuMTkgNC4yIDQuMiAwIDAgMC00LjI3LTQuMTd6TTYwLjYzIDVjLjEzIDAgLjIzLjEuMjMuMjN2My43NmMuNy0uNzYgMS43LTEuMTggMi43My0xLjE4YTQgNCAwIDAgMSAzLjg0IDMuMjhjLjEzLjU5LjEzIDEuMiAwIDEuOGE0IDQgMCAwIDEtMy44NCAzLjI5QTMuNzcgMy43NyAwIDAgMSA2MC44NiAxNXYuNzdjMCAuMTItLjEuMjMtLjIzLjIzaC0xLjRhLjIzLjIzIDAgMCAxLS4yMy0uMjNWNS4yM2MwLS4xMi4xLS4yMy4yMy0uMjNoMS40em0tMzQgMTFoLTEuNGEuMjMuMjMgMCAwIDEtLjIzLS4yM1Y4LjIyYy4wMS0uMTMuMS0uMjIuMjMtLjIyaDEuNGMuMTMgMCAuMjIuMTEuMjMuMjJ2LjY4Yy41LS42OCAxLjMtMS4wOSAyLjE2LTEuMWguMDNjMS4wOSAwIDIuMDkuNiAyLjYgMS41NWEyLjczIDIuNzMgMCAwIDEgMi40NC0xLjU2YzEuNjIgMCAyLjkzIDEuMjUgMi45IDIuNzhsLjAzIDUuMmMwIC4xMy0uMS4yMy0uMjMuMjNoLTEuNDFhLjIzLjIzIDAgMCAxLS4yMy0uMjN2LTQuNTljMC0uOTgtLjc0LTEuNzEtMS42Mi0xLjcxLS44IDAtMS40Ni43LTEuNTkgMS42MmwuMDEgNC42OGMwIC4xMy0uMTEuMjMtLjIzLjIzaC0xLjQxYS4yMy4yMyAwIDAgMS0uMjMtLjIzdi00LjU5YzAtLjk4LS43NC0xLjcxLTEuNjItMS43MS0uODUgMC0xLjU0Ljc5LTEuNiAxLjh2NC41YzAgLjEzLS4xLjIzLS4yMy4yM3ptNTMuNjIgMGgtMS42MWEuMjcuMjcgMCAwIDEtLjEyLS4wM2MtLjEtLjA2LS4xMy0uMTktLjA2LS4yOGwyLjQzLTMuNzEtMi40LTMuNjVhLjIxLjIxIDAgMCAxLS4wMi0uMTIuMi4yIDAgMCAxIC4yLS4yMWgxLjYxYy4xMyAwIC4yNC4wNi4zLjE3TDgyIDEwLjU0bDEuNC0yLjM3YS4zNC4zNCAwIDAgMSAuMy0uMTdoMS42bC4xMi4wM2MuMS4wNi4xMy4xOS4wNi4yOGwtMi4zNyAzLjY1IDIuNDMgMy43LjAxLjEzYS4yLjIgMCAwIDEtLjIuMjFoLTEuNjFhLjMzLjMzIDAgMCAxLS4zLS4xN2wtMS40NC0yLjQyLTEuNDQgMi40MmEuMzQuMzQgMCAwIDEtLjMuMTd6bS03LjEyLTEuNDlBMi40NyAyLjQ3IDAgMCAxIDcwLjcgMTJhMi40NyAyLjQ3IDAgMCAxIDIuNDItMi41MiAyLjQ3IDIuNDcgMCAwIDEgMi40MiAyLjUxIDIuNDggMi40OCAwIDAgMS0yLjQyIDIuNTJ6bS0xOS44NyAwYTIuNDggMi40OCAwIDAgMS0yLjQyLTIuNDh2LS4wN2EyLjQ3IDIuNDcgMCAwIDEgMi40LTIuNDkgMi40NyAyLjQ3IDAgMCAxIDIuNDEgMi41MSAyLjQ3IDIuNDcgMCAwIDEtMi4zOSAyLjUzem0tOC4xMS0yLjQ4Yy0uMDEgMS4zNy0xLjA5IDIuNDctMi40MSAyLjQ3cy0yLjQyLTEuMTItMi40Mi0yLjUxYTIuNDcgMi40NyAwIDAgMSAyLjQtMi41MiAyLjQ2IDIuNDYgMCAwIDEgMi40MSAyLjQ4bC4wMi4wOHptMTguMTIgMi40N2EyLjQ3IDIuNDcgMCAwIDEtMi40MS0yLjQ4di0uMDZjLjAyLTEuMzggMS4wOS0yLjQ4IDIuNDEtMi40OHMyLjQyIDEuMTIgMi40MiAyLjUxYTIuNDcgMi40NyAwIDAgMS0yLjQyIDIuNTF6XCIvPjwvZGVmcz48bWFzayBpZD1cImNcIj48cmVjdCB3aWR0aD1cIjEwMCVcIiBoZWlnaHQ9XCIxMDAlXCIgZmlsbD1cIiNmZmZcIi8+PHVzZSB4bGluazpocmVmPVwiI2dcIi8+PHVzZSB4bGluazpocmVmPVwiI2JcIi8+PC9tYXNrPjxnIG9wYWNpdHk9XCIuM1wiIHN0cm9rZT1cIiMwMDBcIiBzdHJva2Utd2lkdGg9XCIzXCI+PGNpcmNsZSBtYXNrPVwidXJsKCNjKVwiIGN4PVwiMTEuNVwiIGN5PVwiMTEuNVwiIHI9XCI5LjI1XCIvPjx1c2UgeGxpbms6aHJlZj1cIiNiXCIgbWFzaz1cInVybCgjYylcIi8+PC9nPjxnIG9wYWNpdHk9XCIuOVwiIGZpbGw9XCIjZmZmXCI+PHVzZSB4bGluazpocmVmPVwiI2dcIi8+PHVzZSB4bGluazpocmVmPVwiI2JcIi8+PC9nPjwvc3ZnPic7XG5cbi8vIHNyYy9jb21wb25lbnRzL01hcGJveEFkZHJlc3NNaW5pbWFwLnRzXG52YXIgWk9PTSA9IDE2O1xudmFyIFRFTVBMQVRFNCA9IGNyZWF0ZUVsZW1lbnRGcm9tU3RyaW5nKGBcbjx0ZW1wbGF0ZT5cbiAgPGRpdiBjbGFzcz1cIk1hcGJveEFkZHJlc3NNaW5pbWFwXCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+XG4gICAgPGRpdiBjbGFzcz1cIk1pbmltYXBJbWFnZUNvbnRhaW5lclwiPlxuICAgICAgPGltZyBjbGFzcz1cIk1pbmltYXBJbWFnZVwiIGRyYWdnYWJsZT1cImZhbHNlXCI+PC9pbWc+XG4gICAgICA8ZGl2IGNsYXNzPVwiTWluaW1hcElubmVyRnJhbWVcIj5cbiAgICAgICAgPGRpdiBjbGFzcz1cIk1pbmltYXBNYXJrZXJcIj48L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzcz1cIk1pbmltYXBBdHRyaWJ1dGlvblwiPlxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJNaW5pbWFwQXR0cmlidXRpb25Mb2dvXCI+XG4gICAgICAgICAgICA8YSB0YXJnZXQ9XCJfYmxhbmtcIiByZWw9XCJub29wZW5lciBub2ZvbGxvd1wiIGhyZWY9XCJodHRwczovL3d3dy5tYXBib3guY29tL1wiIGFyaWEtbGFiZWw9XCJNYXBib3ggbG9nb1wiPlxuICAgICAgICAgICAgICAke21hcGJveGdsX2N0cmxfbG9nb19kZWZhdWx0fVxuICAgICAgICAgICAgPC9hPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJNaW5pbWFwQXR0cmlidXRpb25UZXh0XCI+XG4gICAgICAgICAgICA8YSB0YXJnZXQ9XCJfYmxhbmtcIiBocmVmPSdodHRwczovL3d3dy5tYXBib3guY29tL2Fib3V0L21hcHMvJz5cXHhBOSBNYXBib3g8L2E+PGEgdGFyZ2V0PVwiX2JsYW5rXCIgaHJlZj0naHR0cDovL3d3dy5vcGVuc3RyZWV0bWFwLm9yZy9jb3B5cmlnaHQnPlxceEE5IE9wZW5TdHJlZXRNYXA8L2E+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gIDwvZGl2PlxuPC90ZW1wbGF0ZT5cbmApO1xudmFyIFNUWUxFX1RPR0dMRV9URU1QTEFURSA9IGNyZWF0ZUVsZW1lbnRGcm9tU3RyaW5nKGBcbjx0ZW1wbGF0ZT5cbiAgPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJNaW5pbWFwU3R5bGVUb2dnbGVcIj48L2J1dHRvbj5cbjwvdGVtcGxhdGU+XG5gKTtcbnZhciBGT09URVJfVEVNUExBVEUgPSBjcmVhdGVFbGVtZW50RnJvbVN0cmluZyhgXG48dGVtcGxhdGU+XG4gIDxkaXYgY2xhc3M9XCJNaW5pbWFwRm9vdGVyXCI+QWRqdXN0IHRoZSBtYXJrZXIgb24gdGhlIG1hcCBpZiBpdCBkb2Vzbid0IHByZWNpc2VseSBtYXRjaCB5b3VyIGxvY2F0aW9uLiBUaGlzIGhlbHBzIGltcHJvdmUgYWRkcmVzcyBkYXRhIHF1YWxpdHkuPC9kaXY+XG48L3RlbXBsYXRlPlxuYCk7XG52YXIgQURKVVNUX1BJTl9URVhUID0gXCJBZGp1c3QgcGluXCI7XG52YXIgU0FWRV9URVhUID0gXCJTYXZlXCI7XG52YXIgQ0FOQ0VMX1RFWFQgPSBcIkNhbmNlbFwiO1xudmFyIEVESVRfQlVUVE9OU19URU1QTEFURSA9IGNyZWF0ZUVsZW1lbnRGcm9tU3RyaW5nKGBcbjx0ZW1wbGF0ZT5cbiAgPGRpdiBjbGFzcz1cIk1pbmltYXBFZGl0QnV0dG9uc1wiPlxuICAgIDxkaXYgY2xhc3M9XCJCdXR0b24gQnV0dG9uUHJpbWFyeSBNaW5pbWFwQnV0dG9uQWRqdXN0XCI+JHtBREpVU1RfUElOX1RFWFR9PC9kaXY+XG4gICAgPGRpdiBjbGFzcz1cIkJ1dHRvbiBCdXR0b25QcmltYXJ5IE1pbmltYXBCdXR0b25TYXZlXCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+JHtTQVZFX1RFWFR9PC9kaXY+XG4gICAgPGRpdiBjbGFzcz1cIkJ1dHRvbiBNaW5pbWFwQnV0dG9uQ2FuY2VsXCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+JHtDQU5DRUxfVEVYVH08L2Rpdj5cbiAgPC9kaXY+XG48L3RlbXBsYXRlPlxuYCk7XG52YXIgX2NhbkFkanVzdE1hcmtlckludGVybmFsLCBfaXNBZGp1c3RNYXJrZXJFZGl0aW5nLCBfaW1hZ2VMb2FkZWQsIF9mZWF0dXJlMiwgX3VybCwgX3dpZHRoLCBfaGVpZ2h0LCBfYmluZGluZzcsIF9tYXJrZXJDb250cm9sbGVyLCBfYWNjZXNzVG9rZW4sIF90aGVtZUludGVybmFsNSwgX3NhdGVsbGl0ZVRvZ2dsZUludGVybmFsLCBfbWFwU3R5bGVNb2RlLCBfYWRqdXN0QnRuVGV4dCwgX3NhdmVCdG5UZXh0LCBfY2FuY2VsQnRuVGV4dCwgX2RlZmF1bHRNYXBTdHlsZSwgX2Zvb3RlciwgX2NvbnRhaW5lciwgX3RvZ2dsZU1hcmtlckVkaXRpbmcsIF9oYW5kbGVTdGFydE1hcmtlckVkaXRpbmcsIF9oYW5kbGVTYXZlTWFya2VyRWRpdGluZywgX2hhbmRsZUNhbmNlbE1hcmtlckVkaXRpbmcsIF9oYW5kbGVUb2dnbGVNYXBTdHlsZSwgX2hhbmRsZUltYWdlTG9hZCwgX2hhbmRsZUltYWdlRXJyb3IsIF9nZXRJbWFnZVVybCwgX3VwZGF0ZUltYWdlU3JjLCBfZ2V0VG9nZ2xlQmFja2dyb3VuZEltYWdlVXJsLCBfc2V0U2l6ZSwgX2FkZE1hcmtlckVkaXRDb250cm9scywgX3JlbW92ZU1hcmtlckVkaXRDb250cm9scywgX2FkZFNhdGVsbGl0ZVRvZ2dsZSwgX3JlbW92ZVNhdGVsbGl0ZVRvZ2dsZTtcbnZhciBNYXBib3hBZGRyZXNzTWluaW1hcCA9IGNsYXNzIGV4dGVuZHMgSFRNTFNjb3BlZEVsZW1lbnQge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlciguLi5hcmd1bWVudHMpO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfY2FuQWRqdXN0TWFya2VySW50ZXJuYWwsIGZhbHNlKTtcbiAgICB0aGlzLmtlZXBNYXJrZXJDZW50ZXJlZCA9IGZhbHNlO1xuICAgIHRoaXMubWFya2VyQW5jaG9yID0gXCJib3R0b21cIjtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX2lzQWRqdXN0TWFya2VyRWRpdGluZywgZmFsc2UpO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfaW1hZ2VMb2FkZWQsIGZhbHNlKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX2ZlYXR1cmUyLCB2b2lkIDApO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfdXJsLCBcIlwiKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX3dpZHRoLCB2b2lkIDApO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfaGVpZ2h0LCB2b2lkIDApO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfYmluZGluZzcsIHZvaWQgMCk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9tYXJrZXJDb250cm9sbGVyLCB2b2lkIDApO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfYWNjZXNzVG9rZW4sIHZvaWQgMCk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF90aGVtZUludGVybmFsNSwge30pO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfc2F0ZWxsaXRlVG9nZ2xlSW50ZXJuYWwsIGZhbHNlKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX21hcFN0eWxlTW9kZSwgXCJkZWZhdWx0XCIpO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfYWRqdXN0QnRuVGV4dCwgdm9pZCAwKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX3NhdmVCdG5UZXh0LCB2b2lkIDApO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfY2FuY2VsQnRuVGV4dCwgdm9pZCAwKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX2RlZmF1bHRNYXBTdHlsZSwgW1wibWFwYm94XCIsIFwic3RyZWV0cy12MTFcIl0pO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfZm9vdGVyLCB2b2lkIDApO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfY29udGFpbmVyLCB2b2lkIDApO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfdG9nZ2xlTWFya2VyRWRpdGluZywgKCkgPT4ge1xuICAgICAgY29uc3QgeyBJbWFnZUNvbnRhaW5lciwgQnV0dG9uQWRqdXN0LCBCdXR0b25TYXZlLCBCdXR0b25DYW5jZWwgfSA9IF9fcHJpdmF0ZUdldCh0aGlzLCBfYmluZGluZzcpO1xuICAgICAgaWYgKF9fcHJpdmF0ZUdldCh0aGlzLCBfaXNBZGp1c3RNYXJrZXJFZGl0aW5nKSkge1xuICAgICAgICBJbWFnZUNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKGAke3RoaXMuZGF0YXNldC5zZWVkfS0tZHJhZ2dhYmxlYCk7XG4gICAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfbWFya2VyQ29udHJvbGxlcikuaXNBY3RpdmUgPSB0cnVlO1xuICAgICAgICBCdXR0b25BZGp1c3Quc2V0QXR0cmlidXRlKFwiYXJpYS1oaWRkZW5cIiwgXCJ0cnVlXCIpO1xuICAgICAgICBCdXR0b25TYXZlLnJlbW92ZUF0dHJpYnV0ZShcImFyaWEtaGlkZGVuXCIpO1xuICAgICAgICBCdXR0b25DYW5jZWwucmVtb3ZlQXR0cmlidXRlKFwiYXJpYS1oaWRkZW5cIik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBJbWFnZUNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKGAke3RoaXMuZGF0YXNldC5zZWVkfS0tZHJhZ2dhYmxlYCk7XG4gICAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfbWFya2VyQ29udHJvbGxlcikuaXNBY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgQnV0dG9uQWRqdXN0LnJlbW92ZUF0dHJpYnV0ZShcImFyaWEtaGlkZGVuXCIpO1xuICAgICAgICBCdXR0b25TYXZlLnNldEF0dHJpYnV0ZShcImFyaWEtaGlkZGVuXCIsIFwidHJ1ZVwiKTtcbiAgICAgICAgQnV0dG9uQ2FuY2VsLnNldEF0dHJpYnV0ZShcImFyaWEtaGlkZGVuXCIsIFwidHJ1ZVwiKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX2hhbmRsZVN0YXJ0TWFya2VyRWRpdGluZywgKCkgPT4ge1xuICAgICAgX19wcml2YXRlU2V0KHRoaXMsIF9pc0FkanVzdE1hcmtlckVkaXRpbmcsIHRydWUpO1xuICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF90b2dnbGVNYXJrZXJFZGl0aW5nKS5jYWxsKHRoaXMpO1xuICAgIH0pO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfaGFuZGxlU2F2ZU1hcmtlckVkaXRpbmcsICgpID0+IHtcbiAgICAgIGlmICh0aGlzLmZlYXR1cmUucHJvcGVydGllcy5mdWxsX2FkZHJlc3MgJiYgIWRlZXBFcXVhbHModGhpcy5mZWF0dXJlLmdlb21ldHJ5LmNvb3JkaW5hdGVzLCBfX3ByaXZhdGVHZXQodGhpcywgX21hcmtlckNvbnRyb2xsZXIpLmNvb3JkaW5hdGUpKSB7XG4gICAgICAgIGNvbnN0IFtsbmcsIGxhdF0gPSBfX3ByaXZhdGVHZXQodGhpcywgX21hcmtlckNvbnRyb2xsZXIpLmNvb3JkaW5hdGU7XG4gICAgICAgIHNlbmRGZWVkYmFjayh0aGlzLmFjY2Vzc1Rva2VuLCB7XG4gICAgICAgICAgb3JpZ2luYWxDb29yZGluYXRlOiB0aGlzLmZlYXR1cmUuZ2VvbWV0cnkuY29vcmRpbmF0ZXMsXG4gICAgICAgICAgb3JpZ2luYWxBZGRyZXNzOiB0aGlzLmZlYXR1cmUucHJvcGVydGllcy5mdWxsX2FkZHJlc3MsXG4gICAgICAgICAgY2hhbmdlczoge1xuICAgICAgICAgICAgbG9jYXRpb246IHsgbG9uZ2l0dWRlOiBsbmcsIGxhdGl0dWRlOiBsYXQgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5vblNhdmVNYXJrZXJMb2NhdGlvbikge1xuICAgICAgICB0aGlzLm9uU2F2ZU1hcmtlckxvY2F0aW9uKF9fcHJpdmF0ZUdldCh0aGlzLCBfbWFya2VyQ29udHJvbGxlcikuY29vcmRpbmF0ZSk7XG4gICAgICB9XG4gICAgICBfX3ByaXZhdGVTZXQodGhpcywgX2lzQWRqdXN0TWFya2VyRWRpdGluZywgZmFsc2UpO1xuICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF90b2dnbGVNYXJrZXJFZGl0aW5nKS5jYWxsKHRoaXMpO1xuICAgIH0pO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfaGFuZGxlQ2FuY2VsTWFya2VyRWRpdGluZywgKCkgPT4ge1xuICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF9tYXJrZXJDb250cm9sbGVyKS5yZUNlbnRlcigpO1xuICAgICAgX19wcml2YXRlU2V0KHRoaXMsIF9pc0FkanVzdE1hcmtlckVkaXRpbmcsIGZhbHNlKTtcbiAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfdG9nZ2xlTWFya2VyRWRpdGluZykuY2FsbCh0aGlzKTtcbiAgICB9KTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX2hhbmRsZVRvZ2dsZU1hcFN0eWxlLCAoKSA9PiB7XG4gICAgICB0aGlzLm1hcFN0eWxlTW9kZSA9IHRoaXMubWFwU3R5bGVNb2RlID09PSBcImRlZmF1bHRcIiA/IFwic2F0ZWxsaXRlXCIgOiBcImRlZmF1bHRcIjtcbiAgICB9KTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX2hhbmRsZUltYWdlTG9hZCwgKCkgPT4ge1xuICAgICAgaWYgKCFfX3ByaXZhdGVHZXQodGhpcywgX2ltYWdlTG9hZGVkKSkge1xuICAgICAgICBfX3ByaXZhdGVHZXQodGhpcywgX21hcmtlckNvbnRyb2xsZXIpLnJlQ2VudGVyKCk7XG4gICAgICB9XG4gICAgICBfX3ByaXZhdGVTZXQodGhpcywgX2ltYWdlTG9hZGVkLCB0cnVlKTtcbiAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfbWFya2VyQ29udHJvbGxlcikgJiYgX19wcml2YXRlR2V0KHRoaXMsIF9tYXJrZXJDb250cm9sbGVyKS5oYW5kbGVNaW5pbWFwUmVzaXplKCk7XG4gICAgfSk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9oYW5kbGVJbWFnZUVycm9yLCAoKSA9PiB7XG4gICAgICBfX3ByaXZhdGVTZXQodGhpcywgX2ltYWdlTG9hZGVkLCBmYWxzZSk7XG4gICAgfSk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9nZXRJbWFnZVVybCwgKGxuZ0xhdExpa2UpID0+IHtcbiAgICAgIGlmIChfX3ByaXZhdGVHZXQodGhpcywgX3dpZHRoKSA9PT0gMCB8fCBfX3ByaXZhdGVHZXQodGhpcywgX2hlaWdodCkgPT09IDApXG4gICAgICAgIHJldHVybiBcIlwiO1xuICAgICAgY29uc3QgW3VzZXJuYW1lLCBzdHlsZUlkXSA9IHRoaXMuZGVmYXVsdE1hcFN0eWxlO1xuICAgICAgY29uc3QgZGVmYXVsdEJhc2VVcmwgPSBnZXRTdGF0aWNCYXNlVXJsKHVzZXJuYW1lLCBzdHlsZUlkKTtcbiAgICAgIGNvbnN0IGJhc2VVcmwgPSB0aGlzLm1hcFN0eWxlTW9kZSA9PT0gXCJkZWZhdWx0XCIgPyBkZWZhdWx0QmFzZVVybCA6IFNUQVRJQ19CQVNFX1VSTF9TQVRFTExJVEU7XG4gICAgICBjb25zdCBza3VUb2tlbiA9IEFVVE9GSUxMX1NLVV9UT0tFTl9QUkVGSVggKyBjb25maWcuYXV0b2ZpbGxTZXNzaW9uVG9rZW4udG9TdHJpbmcoKTtcbiAgICAgIGxldCBpbWdVcmwgPSBiYXNlVXJsICsgTG5nTGF0LmNvbnZlcnQobG5nTGF0TGlrZSkudG9BcnJheSgpLmpvaW4oXCIsXCIpICsgXCIsXCIgKyBaT09NICsgXCIsMC9cIiArIE1hdGgubWluKF9fcHJpdmF0ZUdldCh0aGlzLCBfd2lkdGgpICogMiwgTUFYX0lNQUdFX0RJTSkgKyBcInhcIiArIE1hdGgubWluKF9fcHJpdmF0ZUdldCh0aGlzLCBfaGVpZ2h0KSAqIDIsIE1BWF9JTUFHRV9ESU0pICsgXCI/YWNjZXNzX3Rva2VuPVwiICsgdGhpcy5hY2Nlc3NUb2tlbiArIFwiJmF0dHJpYnV0aW9uPWZhbHNlJmxvZ289ZmFsc2VcIjtcbiAgICAgIGlmIChjb25maWcuYXV0b2ZpbGxTZXNzaW9uRW5hYmxlZCkge1xuICAgICAgICBpbWdVcmwgKz0gYCZza3U9JHtza3VUb2tlbn1gO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGltZ1VybDtcbiAgICB9KTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX3VwZGF0ZUltYWdlU3JjLCAoKSA9PiB7XG4gICAgICBpZiAoX19wcml2YXRlR2V0KHRoaXMsIF9mZWF0dXJlMikpIHtcbiAgICAgICAgY29uc3QgbG5nTGF0ID0gX19wcml2YXRlR2V0KHRoaXMsIF9mZWF0dXJlMikuZ2VvbWV0cnkuY29vcmRpbmF0ZXM7XG4gICAgICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfdXJsLCBfX3ByaXZhdGVHZXQodGhpcywgX2dldEltYWdlVXJsKS5jYWxsKHRoaXMsIGxuZ0xhdCkpO1xuICAgICAgICBjb25zdCB7IEltYWdlIH0gPSBfX3ByaXZhdGVHZXQodGhpcywgX2JpbmRpbmc3KTtcbiAgICAgICAgSW1hZ2Uuc3JjID0gX19wcml2YXRlR2V0KHRoaXMsIF91cmwpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfZ2V0VG9nZ2xlQmFja2dyb3VuZEltYWdlVXJsLCAoc3R5bGVNb2RlKSA9PiB7XG4gICAgICByZXR1cm4gYHVybChcIiR7Z2V0SW1hZ2Uoc3R5bGVNb2RlID09PSBcImRlZmF1bHRcIiA/IFwic3R5bGVUb2dnbGVEZWZhdWx0XCIgOiBcInN0eWxlVG9nZ2xlU2F0ZWxsaXRlXCIsIHRoaXMudGhlbWUpfVwiKWA7XG4gICAgfSk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9zZXRTaXplLCAoKSA9PiB7XG4gICAgICBjb25zdCB7IE1hcGJveEFkZHJlc3NNaW5pbWFwOiBNYXBib3hBZGRyZXNzTWluaW1hcDIsIEltYWdlQ29udGFpbmVyLCBJbWFnZSB9ID0gX19wcml2YXRlR2V0KHRoaXMsIF9iaW5kaW5nNyk7XG4gICAgICBjb25zdCB7IHdpZHRoLCBoZWlnaHQgfSA9IGdldEVsZW1lbnRTaXplKHRoaXMuY29udGFpbmVyKTtcbiAgICAgIGNvbnN0IFtvbGRXaWR0aCwgb2xkSGVpZ2h0XSA9IFtfX3ByaXZhdGVHZXQodGhpcywgX3dpZHRoKSwgX19wcml2YXRlR2V0KHRoaXMsIF9oZWlnaHQpXTtcbiAgICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfd2lkdGgsIE1hdGgubWluKHdpZHRoLCBNQVhfSU1BR0VfRElNKSk7XG4gICAgICBfX3ByaXZhdGVTZXQodGhpcywgX2hlaWdodCwgTWF0aC5taW4oaGVpZ2h0LCBNQVhfSU1BR0VfRElNKSk7XG4gICAgICBNYXBib3hBZGRyZXNzTWluaW1hcDIuc3R5bGUuc2V0UHJvcGVydHkoXCJ3aWR0aFwiLCBgJHtfX3ByaXZhdGVHZXQodGhpcywgX3dpZHRoKX1weGApO1xuICAgICAgTWFwYm94QWRkcmVzc01pbmltYXAyLnN0eWxlLnNldFByb3BlcnR5KFwiaGVpZ2h0XCIsIGAke19fcHJpdmF0ZUdldCh0aGlzLCBfaGVpZ2h0KX1weGApO1xuICAgICAgSW1hZ2VDb250YWluZXIuc3R5bGUuc2V0UHJvcGVydHkoXCJoZWlnaHRcIiwgYCR7X19wcml2YXRlR2V0KHRoaXMsIF9oZWlnaHQpfXB4YCk7XG4gICAgICBJbWFnZUNvbnRhaW5lci5zdHlsZS5zZXRQcm9wZXJ0eShcIndpZHRoXCIsIGAke19fcHJpdmF0ZUdldCh0aGlzLCBfd2lkdGgpfXB4YCk7XG4gICAgICBjb25zdCBbaW1nV2lkdGgsIGltZ0hlaWdodF0gPSBbSW1hZ2Uud2lkdGgsIEltYWdlLmhlaWdodF07XG4gICAgICBpZiAoX19wcml2YXRlR2V0KHRoaXMsIF93aWR0aCkgPiBvbGRXaWR0aCAmJiBfX3ByaXZhdGVHZXQodGhpcywgX3dpZHRoKSA+IGltZ1dpZHRoIC8gMiAmJiBpbWdXaWR0aCA8IE1BWF9JTUFHRV9ESU0gfHwgX19wcml2YXRlR2V0KHRoaXMsIF9oZWlnaHQpID4gb2xkSGVpZ2h0ICYmIF9fcHJpdmF0ZUdldCh0aGlzLCBfaGVpZ2h0KSA+IGltZ0hlaWdodCAvIDIgJiYgaW1nSGVpZ2h0IDwgTUFYX0lNQUdFX0RJTSkge1xuICAgICAgICBfX3ByaXZhdGVHZXQodGhpcywgX3VwZGF0ZUltYWdlU3JjKS5jYWxsKHRoaXMpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF9tYXJrZXJDb250cm9sbGVyKSAmJiBfX3ByaXZhdGVHZXQodGhpcywgX21hcmtlckNvbnRyb2xsZXIpLmhhbmRsZU1pbmltYXBSZXNpemUoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX2FkZE1hcmtlckVkaXRDb250cm9scywgKCkgPT4ge1xuICAgICAgY29uc3QgZXhpc3RpbmdGb290ZXIgPSB0aGlzLnF1ZXJ5U2VsZWN0b3IoXCIuTWluaW1hcEZvb3RlclwiKTtcbiAgICAgIGlmIChleGlzdGluZ0Zvb3RlcilcbiAgICAgICAgcmV0dXJuO1xuICAgICAgY29uc3QgZm9vdGVyRWxlbWVudCA9IHRoaXMucHJlcGFyZVRlbXBsYXRlKEZPT1RFUl9URU1QTEFURSk7XG4gICAgICBjb25zdCBtaW5pbWFwRWxlbWVudCA9IHRoaXMucXVlcnlTZWxlY3RvcihcIi5NYXBib3hBZGRyZXNzTWluaW1hcFwiKTtcbiAgICAgIGlmICghbWluaW1hcEVsZW1lbnQpXG4gICAgICAgIHJldHVybjtcbiAgICAgIG1pbmltYXBFbGVtZW50LmFwcGVuZENoaWxkKGZvb3RlckVsZW1lbnQpO1xuICAgICAgY29uc3QgZXhpc3RpbmdFZGl0QnRucyA9IHRoaXMucXVlcnlTZWxlY3RvcihcIi5NaW5pbWFwRWRpdEJ1dHRvbnNcIik7XG4gICAgICBpZiAoZXhpc3RpbmdFZGl0QnRucylcbiAgICAgICAgcmV0dXJuO1xuICAgICAgY29uc3QgZWRpdEJ1dHRvbnNFbGVtZW50ID0gdGhpcy5wcmVwYXJlVGVtcGxhdGUoRURJVF9CVVRUT05TX1RFTVBMQVRFKTtcbiAgICAgIGNvbnN0IGlubmVyRnJhbWUgPSB0aGlzLnF1ZXJ5U2VsZWN0b3IoXCIuTWluaW1hcElubmVyRnJhbWVcIik7XG4gICAgICBpbm5lckZyYW1lLmFwcGVuZENoaWxkKGVkaXRCdXR0b25zRWxlbWVudCk7XG4gICAgICBfX3ByaXZhdGVTZXQodGhpcywgX2JpbmRpbmc3LCBfX3NwcmVhZFByb3BzKF9fc3ByZWFkVmFsdWVzKHt9LCBfX3ByaXZhdGVHZXQodGhpcywgX2JpbmRpbmc3KSksIHtcbiAgICAgICAgRWRpdEJ1dHRvbnM6IHRoaXMucXVlcnlTZWxlY3RvcihcIi5NaW5pbWFwRWRpdEJ1dHRvbnNcIiksXG4gICAgICAgIEJ1dHRvbkFkanVzdDogdGhpcy5xdWVyeVNlbGVjdG9yKFwiLk1pbmltYXBCdXR0b25BZGp1c3RcIiksXG4gICAgICAgIEJ1dHRvblNhdmU6IHRoaXMucXVlcnlTZWxlY3RvcihcIi5NaW5pbWFwQnV0dG9uU2F2ZVwiKSxcbiAgICAgICAgQnV0dG9uQ2FuY2VsOiB0aGlzLnF1ZXJ5U2VsZWN0b3IoXCIuTWluaW1hcEJ1dHRvbkNhbmNlbFwiKVxuICAgICAgfSkpO1xuICAgICAgY29uc3QgeyBCdXR0b25BZGp1c3QsIEJ1dHRvblNhdmUsIEJ1dHRvbkNhbmNlbCB9ID0gX19wcml2YXRlR2V0KHRoaXMsIF9iaW5kaW5nNyk7XG4gICAgICBCdXR0b25BZGp1c3QuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIF9fcHJpdmF0ZUdldCh0aGlzLCBfaGFuZGxlU3RhcnRNYXJrZXJFZGl0aW5nKSk7XG4gICAgICBCdXR0b25TYXZlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBfX3ByaXZhdGVHZXQodGhpcywgX2hhbmRsZVNhdmVNYXJrZXJFZGl0aW5nKSk7XG4gICAgICBCdXR0b25DYW5jZWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIF9fcHJpdmF0ZUdldCh0aGlzLCBfaGFuZGxlQ2FuY2VsTWFya2VyRWRpdGluZykpO1xuICAgIH0pO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfcmVtb3ZlTWFya2VyRWRpdENvbnRyb2xzLCAoKSA9PiB7XG4gICAgICBpZiAoIV9fcHJpdmF0ZUdldCh0aGlzLCBfYmluZGluZzcpKVxuICAgICAgICByZXR1cm47XG4gICAgICBjb25zdCB7IEVkaXRCdXR0b25zLCBCdXR0b25BZGp1c3QsIEJ1dHRvblNhdmUsIEJ1dHRvbkNhbmNlbCB9ID0gX19wcml2YXRlR2V0KHRoaXMsIF9iaW5kaW5nNyk7XG4gICAgICBjb25zdCBleGlzdGluZ0Zvb3RlciA9IHRoaXMucXVlcnlTZWxlY3RvcihcIi5NaW5pbWFwRm9vdGVyXCIpO1xuICAgICAgZXhpc3RpbmdGb290ZXIgPT0gbnVsbCA/IHZvaWQgMCA6IGV4aXN0aW5nRm9vdGVyLnJlbW92ZSgpO1xuICAgICAgRWRpdEJ1dHRvbnMgPT0gbnVsbCA/IHZvaWQgMCA6IEVkaXRCdXR0b25zLnJlbW92ZSgpO1xuICAgICAgaWYgKEJ1dHRvbkFkanVzdCkge1xuICAgICAgICBCdXR0b25BZGp1c3QucmVtb3ZlKCk7XG4gICAgICAgIEJ1dHRvbkFkanVzdC5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgX19wcml2YXRlR2V0KHRoaXMsIF9oYW5kbGVTdGFydE1hcmtlckVkaXRpbmcpKTtcbiAgICAgIH1cbiAgICAgIGlmIChCdXR0b25TYXZlKSB7XG4gICAgICAgIEJ1dHRvblNhdmUucmVtb3ZlKCk7XG4gICAgICAgIEJ1dHRvblNhdmUucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIF9fcHJpdmF0ZUdldCh0aGlzLCBfaGFuZGxlU2F2ZU1hcmtlckVkaXRpbmcpKTtcbiAgICAgIH1cbiAgICAgIGlmIChCdXR0b25DYW5jZWwpIHtcbiAgICAgICAgQnV0dG9uQ2FuY2VsLnJlbW92ZSgpO1xuICAgICAgICBCdXR0b25DYW5jZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIF9fcHJpdmF0ZUdldCh0aGlzLCBfaGFuZGxlQ2FuY2VsTWFya2VyRWRpdGluZykpO1xuICAgICAgfVxuICAgICAgZGVsZXRlIF9fcHJpdmF0ZUdldCh0aGlzLCBfYmluZGluZzcpLkVkaXRCdXR0b25zO1xuICAgICAgZGVsZXRlIF9fcHJpdmF0ZUdldCh0aGlzLCBfYmluZGluZzcpLkJ1dHRvbkFkanVzdDtcbiAgICAgIGRlbGV0ZSBfX3ByaXZhdGVHZXQodGhpcywgX2JpbmRpbmc3KS5CdXR0b25TYXZlO1xuICAgICAgZGVsZXRlIF9fcHJpdmF0ZUdldCh0aGlzLCBfYmluZGluZzcpLkJ1dHRvbkNhbmNlbDtcbiAgICB9KTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX2FkZFNhdGVsbGl0ZVRvZ2dsZSwgKCkgPT4ge1xuICAgICAgY29uc3QgZXhpc3RpbmdUb2dnbGUgPSB0aGlzLnF1ZXJ5U2VsZWN0b3IoXCIuTWluaW1hcFN0eWxlVG9nZ2xlXCIpO1xuICAgICAgaWYgKGV4aXN0aW5nVG9nZ2xlKVxuICAgICAgICByZXR1cm47XG4gICAgICBjb25zdCB0b2dnbGVFbGVtZW50ID0gdGhpcy5wcmVwYXJlVGVtcGxhdGUoU1RZTEVfVE9HR0xFX1RFTVBMQVRFKTtcbiAgICAgIGNvbnN0IGlubmVyRnJhbWUgPSB0aGlzLnF1ZXJ5U2VsZWN0b3IoXCIuTWluaW1hcElubmVyRnJhbWVcIik7XG4gICAgICBpZiAoIWlubmVyRnJhbWUpXG4gICAgICAgIHJldHVybjtcbiAgICAgIGlubmVyRnJhbWUuYXBwZW5kQ2hpbGQodG9nZ2xlRWxlbWVudCk7XG4gICAgICBfX3ByaXZhdGVHZXQodGhpcywgX2JpbmRpbmc3KS5NYXBTdHlsZVRvZ2dsZSA9IHRvZ2dsZUVsZW1lbnQ7XG4gICAgICB0b2dnbGVFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBfX3ByaXZhdGVHZXQodGhpcywgX2hhbmRsZVRvZ2dsZU1hcFN0eWxlKSk7XG4gICAgICB0b2dnbGVFbGVtZW50LnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IF9fcHJpdmF0ZUdldCh0aGlzLCBfZ2V0VG9nZ2xlQmFja2dyb3VuZEltYWdlVXJsKS5jYWxsKHRoaXMsIHRoaXMubWFwU3R5bGVNb2RlID09PSBcImRlZmF1bHRcIiA/IFwic2F0ZWxsaXRlXCIgOiBcImRlZmF1bHRcIik7XG4gICAgICB0b2dnbGVFbGVtZW50LnNldEF0dHJpYnV0ZShcInRpdGxlXCIsIGBTd2l0Y2ggdG8gJHt0aGlzLm1hcFN0eWxlTW9kZSA9PT0gXCJkZWZhdWx0XCIgPyBcIlNhdGVsbGl0ZVwiIDogXCJEZWZhdWx0XCJ9YCk7XG4gICAgfSk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9yZW1vdmVTYXRlbGxpdGVUb2dnbGUsICgpID0+IHtcbiAgICAgIGlmICghX19wcml2YXRlR2V0KHRoaXMsIF9iaW5kaW5nNykpXG4gICAgICAgIHJldHVybjtcbiAgICAgIGNvbnN0IHsgTWFwU3R5bGVUb2dnbGUgfSA9IF9fcHJpdmF0ZUdldCh0aGlzLCBfYmluZGluZzcpO1xuICAgICAgaWYgKCFNYXBTdHlsZVRvZ2dsZSlcbiAgICAgICAgcmV0dXJuO1xuICAgICAgTWFwU3R5bGVUb2dnbGUucmVtb3ZlKCk7XG4gICAgICBNYXBTdHlsZVRvZ2dsZS5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgX19wcml2YXRlR2V0KHRoaXMsIF9oYW5kbGVUb2dnbGVNYXBTdHlsZSkpO1xuICAgICAgZGVsZXRlIF9fcHJpdmF0ZUdldCh0aGlzLCBfYmluZGluZzcpLk1hcFN0eWxlVG9nZ2xlO1xuICAgIH0pO1xuICB9XG4gIGdldCBjYW5BZGp1c3RNYXJrZXIoKSB7XG4gICAgcmV0dXJuIF9fcHJpdmF0ZUdldCh0aGlzLCBfY2FuQWRqdXN0TWFya2VySW50ZXJuYWwpO1xuICB9XG4gIHNldCBjYW5BZGp1c3RNYXJrZXIodmFsKSB7XG4gICAgX19wcml2YXRlU2V0KHRoaXMsIF9jYW5BZGp1c3RNYXJrZXJJbnRlcm5hbCwgdmFsKTtcbiAgICB2YWwgPyBfX3ByaXZhdGVHZXQodGhpcywgX2FkZE1hcmtlckVkaXRDb250cm9scykuY2FsbCh0aGlzKSA6IF9fcHJpdmF0ZUdldCh0aGlzLCBfcmVtb3ZlTWFya2VyRWRpdENvbnRyb2xzKS5jYWxsKHRoaXMpO1xuICB9XG4gIGdldCBhY2Nlc3NUb2tlbigpIHtcbiAgICByZXR1cm4gX19wcml2YXRlR2V0KHRoaXMsIF9hY2Nlc3NUb2tlbikgfHwgY29uZmlnLmFjY2Vzc1Rva2VuO1xuICB9XG4gIHNldCBhY2Nlc3NUb2tlbihuZXdUb2tlbikge1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfYWNjZXNzVG9rZW4sIG5ld1Rva2VuKTtcbiAgfVxuICBnZXQgZmVhdHVyZSgpIHtcbiAgICByZXR1cm4gX19wcml2YXRlR2V0KHRoaXMsIF9mZWF0dXJlMik7XG4gIH1cbiAgc2V0IGZlYXR1cmUoZmVhdHVyZSkge1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfZmVhdHVyZTIsIGZlYXR1cmUpO1xuICAgIGlmICghZmVhdHVyZSkge1xuICAgICAgdGhpcy5oaWRlKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc2hvdygpO1xuICAgIH1cbiAgfVxuICBnZXQgdGVtcGxhdGUoKSB7XG4gICAgcmV0dXJuIFRFTVBMQVRFNDtcbiAgfVxuICBnZXQgdGVtcGxhdGVTdHlsZSgpIHtcbiAgICByZXR1cm4gc3R5bGVfZGVmYXVsdDtcbiAgfVxuICBnZXQgdGVtcGxhdGVVc2VyU3R5bGUoKSB7XG4gICAgcmV0dXJuIGdldFRoZW1lQ1NTKFwiLk1hcGJveEFkZHJlc3NNaW5pbWFwXCIsIHRoaXMudGhlbWUpO1xuICB9XG4gIGdldCBzYXRlbGxpdGVUb2dnbGUoKSB7XG4gICAgcmV0dXJuIF9fcHJpdmF0ZUdldCh0aGlzLCBfc2F0ZWxsaXRlVG9nZ2xlSW50ZXJuYWwpO1xuICB9XG4gIHNldCBzYXRlbGxpdGVUb2dnbGUodmFsKSB7XG4gICAgX19wcml2YXRlU2V0KHRoaXMsIF9zYXRlbGxpdGVUb2dnbGVJbnRlcm5hbCwgdmFsKTtcbiAgICB2YWwgPyBfX3ByaXZhdGVHZXQodGhpcywgX2FkZFNhdGVsbGl0ZVRvZ2dsZSkuY2FsbCh0aGlzKSA6IF9fcHJpdmF0ZUdldCh0aGlzLCBfcmVtb3ZlU2F0ZWxsaXRlVG9nZ2xlKS5jYWxsKHRoaXMpO1xuICB9XG4gIGdldCB0aGVtZSgpIHtcbiAgICByZXR1cm4gX19wcml2YXRlR2V0KHRoaXMsIF90aGVtZUludGVybmFsNSk7XG4gIH1cbiAgc2V0IHRoZW1lKHRoZW1lKSB7XG4gICAgX19wcml2YXRlU2V0KHRoaXMsIF90aGVtZUludGVybmFsNSwgdGhlbWUpO1xuICAgIGlmICghX19wcml2YXRlR2V0KHRoaXMsIF9iaW5kaW5nNykgfHwgIXRoZW1lKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMudXBkYXRlVGVtcGxhdGVVc2VyU3R5bGUoZ2V0VGhlbWVDU1MoXCIuTWFwYm94QWRkcmVzc01pbmltYXBcIiwgdGhlbWUpKTtcbiAgICBjb25zdCB7IE1hcmtlciwgTWFwU3R5bGVUb2dnbGUgfSA9IF9fcHJpdmF0ZUdldCh0aGlzLCBfYmluZGluZzcpO1xuICAgIE1hcmtlci5pbm5lckhUTUwgPSBnZXRJY29uKFwibWFya2VyXCIsIHRoZW1lKTtcbiAgICBpZiAoTWFwU3R5bGVUb2dnbGUpIHtcbiAgICAgIE1hcFN0eWxlVG9nZ2xlLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IF9fcHJpdmF0ZUdldCh0aGlzLCBfZ2V0VG9nZ2xlQmFja2dyb3VuZEltYWdlVXJsKS5jYWxsKHRoaXMsIHRoaXMubWFwU3R5bGVNb2RlID09PSBcImRlZmF1bHRcIiA/IFwic2F0ZWxsaXRlXCIgOiBcImRlZmF1bHRcIik7XG4gICAgfVxuICB9XG4gIGdldCBhZGp1c3RCdG5UZXh0KCkge1xuICAgIHJldHVybiBfX3ByaXZhdGVHZXQodGhpcywgX2FkanVzdEJ0blRleHQpIHx8IEFESlVTVF9QSU5fVEVYVDtcbiAgfVxuICBzZXQgYWRqdXN0QnRuVGV4dCh2YWwpIHtcbiAgICBfX3ByaXZhdGVTZXQodGhpcywgX2FkanVzdEJ0blRleHQsIHZhbCk7XG4gICAgY29uc3QgYWRqdXN0QnRuID0gdGhpcy5xdWVyeVNlbGVjdG9yKFwiLk1pbmltYXBCdXR0b25BZGp1c3RcIik7XG4gICAgYWRqdXN0QnRuLnRleHRDb250ZW50ID0gdmFsIHx8IEFESlVTVF9QSU5fVEVYVDtcbiAgfVxuICBnZXQgc2F2ZUJ0blRleHQoKSB7XG4gICAgcmV0dXJuIF9fcHJpdmF0ZUdldCh0aGlzLCBfc2F2ZUJ0blRleHQpIHx8IFNBVkVfVEVYVDtcbiAgfVxuICBzZXQgc2F2ZUJ0blRleHQodmFsKSB7XG4gICAgX19wcml2YXRlU2V0KHRoaXMsIF9zYXZlQnRuVGV4dCwgdmFsKTtcbiAgICBjb25zdCBzYXZlQnRuID0gdGhpcy5xdWVyeVNlbGVjdG9yKFwiLk1pbmltYXBCdXR0b25TYXZlXCIpO1xuICAgIHNhdmVCdG4udGV4dENvbnRlbnQgPSB2YWwgfHwgU0FWRV9URVhUO1xuICB9XG4gIGdldCBjYW5jZWxCdG5UZXh0KCkge1xuICAgIHJldHVybiBfX3ByaXZhdGVHZXQodGhpcywgX2NhbmNlbEJ0blRleHQpIHx8IENBTkNFTF9URVhUO1xuICB9XG4gIHNldCBjYW5jZWxCdG5UZXh0KHZhbCkge1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfY2FuY2VsQnRuVGV4dCwgdmFsKTtcbiAgICBjb25zdCBjYW5jZWxCdG4gPSB0aGlzLnF1ZXJ5U2VsZWN0b3IoXCIuTWluaW1hcEJ1dHRvbkNhbmNlbFwiKTtcbiAgICBjYW5jZWxCdG4udGV4dENvbnRlbnQgPSB2YWwgfHwgQ0FOQ0VMX1RFWFQ7XG4gIH1cbiAgZ2V0IG1hcFN0eWxlTW9kZSgpIHtcbiAgICByZXR1cm4gX19wcml2YXRlR2V0KHRoaXMsIF9tYXBTdHlsZU1vZGUpO1xuICB9XG4gIHNldCBtYXBTdHlsZU1vZGUoc3R5bGVNb2RlKSB7XG4gICAgY29uc3QgcHJldlN0eWxlTW9kZSA9IF9fcHJpdmF0ZUdldCh0aGlzLCBfbWFwU3R5bGVNb2RlKTtcbiAgICBpZiAocHJldlN0eWxlTW9kZSA9PT0gc3R5bGVNb2RlKVxuICAgICAgcmV0dXJuO1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfbWFwU3R5bGVNb2RlLCBzdHlsZU1vZGUpO1xuICAgIGlmICghX19wcml2YXRlR2V0KHRoaXMsIF9iaW5kaW5nNykpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgeyBNYXBTdHlsZVRvZ2dsZSB9ID0gX19wcml2YXRlR2V0KHRoaXMsIF9iaW5kaW5nNyk7XG4gICAgaWYgKCFNYXBTdHlsZVRvZ2dsZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBNYXBTdHlsZVRvZ2dsZS5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBfX3ByaXZhdGVHZXQodGhpcywgX2dldFRvZ2dsZUJhY2tncm91bmRJbWFnZVVybCkuY2FsbCh0aGlzLCBwcmV2U3R5bGVNb2RlKTtcbiAgICBNYXBTdHlsZVRvZ2dsZS5zZXRBdHRyaWJ1dGUoXCJ0aXRsZVwiLCBgU3dpdGNoIHRvICR7cHJldlN0eWxlTW9kZSA9PT0gXCJzYXRlbGxpdGVcIiA/IFwiU2F0ZWxsaXRlXCIgOiBcIkRlZmF1bHRcIn1gKTtcbiAgICBfX3ByaXZhdGVHZXQodGhpcywgX3VwZGF0ZUltYWdlU3JjKS5jYWxsKHRoaXMpO1xuICB9XG4gIGdldCBkZWZhdWx0TWFwU3R5bGUoKSB7XG4gICAgcmV0dXJuIF9fcHJpdmF0ZUdldCh0aGlzLCBfZGVmYXVsdE1hcFN0eWxlKTtcbiAgfVxuICBzZXQgZGVmYXVsdE1hcFN0eWxlKHN0eWxlKSB7XG4gICAgX19wcml2YXRlU2V0KHRoaXMsIF9kZWZhdWx0TWFwU3R5bGUsIHN0eWxlKTtcbiAgICBfX3ByaXZhdGVHZXQodGhpcywgX3VwZGF0ZUltYWdlU3JjKS5jYWxsKHRoaXMpO1xuICB9XG4gIGdldCBmb290ZXIoKSB7XG4gICAgcmV0dXJuIF9fcHJpdmF0ZUdldCh0aGlzLCBfZm9vdGVyKTtcbiAgfVxuICBzZXQgZm9vdGVyKHZhbCkge1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfZm9vdGVyLCB2YWwpO1xuICAgIGNvbnN0IGZvb3RlckVsID0gdGhpcy5xdWVyeVNlbGVjdG9yKFwiLk1pbmltYXBGb290ZXJcIik7XG4gICAgaWYgKGZvb3RlckVsKSB7XG4gICAgICBpZiAodHlwZW9mIHZhbCA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICBmb290ZXJFbC50ZXh0Q29udGVudCA9IHZhbDtcbiAgICAgICAgZm9vdGVyRWwucmVtb3ZlQXR0cmlidXRlKFwiYXJpYS1oaWRkZW5cIik7XG4gICAgICB9IGVsc2UgaWYgKCF2YWwpIHtcbiAgICAgICAgZm9vdGVyRWwuc2V0QXR0cmlidXRlKFwiYXJpYS1oaWRkZW5cIiwgXCJ0cnVlXCIpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZm9vdGVyRWwucmVtb3ZlQXR0cmlidXRlKFwiYXJpYS1oaWRkZW5cIik7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGdldCBjb250YWluZXIoKSB7XG4gICAgcmV0dXJuIF9fcHJpdmF0ZUdldCh0aGlzLCBfY29udGFpbmVyKTtcbiAgfVxuICBzZXQgY29udGFpbmVyKG5ld0NvbnRhaW5lcikge1xuICAgIGlmIChuZXdDb250YWluZXIpIHtcbiAgICAgIG5ld0NvbnRhaW5lci5zdHlsZS5wb3NpdGlvbiA9IFwicmVsYXRpdmVcIjtcbiAgICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfY29udGFpbmVyLCBuZXdDb250YWluZXIpO1xuICAgIH1cbiAgfVxuICBzaG93KCkge1xuICAgIGlmICghX19wcml2YXRlR2V0KHRoaXMsIF9mZWF0dXJlMikpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgbG5nTGF0ID0gX19wcml2YXRlR2V0KHRoaXMsIF9mZWF0dXJlMikuZ2VvbWV0cnkuY29vcmRpbmF0ZXM7XG4gICAgX19wcml2YXRlR2V0KHRoaXMsIF9tYXJrZXJDb250cm9sbGVyKS5jb29yZGluYXRlID0gbG5nTGF0O1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfdXJsLCBfX3ByaXZhdGVHZXQodGhpcywgX2dldEltYWdlVXJsKS5jYWxsKHRoaXMsIGxuZ0xhdCkpO1xuICAgIGNvbnN0IHsgTWFwYm94QWRkcmVzc01pbmltYXA6IE1hcGJveEFkZHJlc3NNaW5pbWFwMiwgSW1hZ2UgfSA9IF9fcHJpdmF0ZUdldCh0aGlzLCBfYmluZGluZzcpO1xuICAgIEltYWdlLnNyYyA9IF9fcHJpdmF0ZUdldCh0aGlzLCBfdXJsKTtcbiAgICBNYXBib3hBZGRyZXNzTWluaW1hcDIucmVtb3ZlQXR0cmlidXRlKFwiYXJpYS1oaWRkZW5cIik7XG4gIH1cbiAgaGlkZSgpIHtcbiAgICBjb25zdCB7IE1hcGJveEFkZHJlc3NNaW5pbWFwOiBNYXBib3hBZGRyZXNzTWluaW1hcDIgfSA9IF9fcHJpdmF0ZUdldCh0aGlzLCBfYmluZGluZzcpO1xuICAgIE1hcGJveEFkZHJlc3NNaW5pbWFwMi5zZXRBdHRyaWJ1dGUoXCJhcmlhLWhpZGRlblwiLCBcInRydWVcIik7XG4gIH1cbiAgY29ubmVjdGVkQ2FsbGJhY2soKSB7XG4gICAgc3VwZXIuY29ubmVjdGVkQ2FsbGJhY2soKTtcbiAgICBfX3ByaXZhdGVTZXQodGhpcywgX2JpbmRpbmc3LCBiaW5kRWxlbWVudHModGhpcywge1xuICAgICAgTWFwYm94QWRkcmVzc01pbmltYXA6IFwiLk1hcGJveEFkZHJlc3NNaW5pbWFwXCIsXG4gICAgICBJbWFnZUNvbnRhaW5lcjogXCIuTWluaW1hcEltYWdlQ29udGFpbmVyXCIsXG4gICAgICBJbWFnZTogXCIuTWluaW1hcEltYWdlXCIsXG4gICAgICBNYXJrZXI6IFwiLk1pbmltYXBNYXJrZXJcIixcbiAgICAgIE1hcFN0eWxlVG9nZ2xlOiBcIi5NaW5pbWFwU3R5bGVUb2dnbGVcIixcbiAgICAgIEVkaXRCdXR0b25zOiBcIi5NaW5pbWFwRWRpdEJ1dHRvbnNcIixcbiAgICAgIEJ1dHRvbkFkanVzdDogXCIuTWluaW1hcEJ1dHRvbkFkanVzdFwiLFxuICAgICAgQnV0dG9uU2F2ZTogXCIuTWluaW1hcEJ1dHRvblNhdmVcIixcbiAgICAgIEJ1dHRvbkNhbmNlbDogXCIuTWluaW1hcEJ1dHRvbkNhbmNlbFwiXG4gICAgfSkpO1xuICAgIHRoaXMubWFwU3R5bGVNb2RlID0gX19wcml2YXRlR2V0KHRoaXMsIF9tYXBTdHlsZU1vZGUpO1xuICAgIHRoaXMudGhlbWUgPSBfX3NwcmVhZFZhbHVlcyh7fSwgdGhpcy50aGVtZSk7XG4gICAgaWYgKHRoaXMuY2FuQWRqdXN0TWFya2VyKSB7XG4gICAgICBfX3ByaXZhdGVHZXQodGhpcywgX2FkZE1hcmtlckVkaXRDb250cm9scykuY2FsbCh0aGlzKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuc2F0ZWxsaXRlVG9nZ2xlKSB7XG4gICAgICBfX3ByaXZhdGVHZXQodGhpcywgX2FkZFNhdGVsbGl0ZVRvZ2dsZSkuY2FsbCh0aGlzKTtcbiAgICB9XG4gICAgdGhpcy5jb250YWluZXIgPSB0aGlzLnBhcmVudEVsZW1lbnQ7XG4gICAgY29uc3QgcmVzaXplT2JzZXJ2ZXIgPSBuZXcgUmVzaXplT2JzZXJ2ZXIoX19wcml2YXRlR2V0KHRoaXMsIF9zZXRTaXplKSk7XG4gICAgcmVzaXplT2JzZXJ2ZXIub2JzZXJ2ZSh0aGlzLmNvbnRhaW5lcik7XG4gICAgX19wcml2YXRlR2V0KHRoaXMsIF9zZXRTaXplKS5jYWxsKHRoaXMpO1xuICAgIGNvbnN0IHsgTWFwYm94QWRkcmVzc01pbmltYXA6IE1hcGJveEFkZHJlc3NNaW5pbWFwMiwgSW1hZ2VDb250YWluZXIsIEltYWdlLCBNYXJrZXIgfSA9IF9fcHJpdmF0ZUdldCh0aGlzLCBfYmluZGluZzcpO1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfbWFya2VyQ29udHJvbGxlciwgbmV3IE1hcmtlckNvbnRyb2xsZXIoSW1hZ2VDb250YWluZXIsIEltYWdlLCBNYXJrZXIsIHRoaXMua2VlcE1hcmtlckNlbnRlcmVkLCBaT09NLCB0aGlzLm1hcmtlckFuY2hvcikpO1xuICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfbWFya2VyQ29udHJvbGxlcikucmVDZW50ZXIoKTtcbiAgICBJbWFnZS5vbmxvYWQgPSBfX3ByaXZhdGVHZXQodGhpcywgX2hhbmRsZUltYWdlTG9hZCk7XG4gICAgSW1hZ2Uub25lcnJvciA9IF9fcHJpdmF0ZUdldCh0aGlzLCBfaGFuZGxlSW1hZ2VFcnJvcik7XG4gICAgSW1hZ2Uuc3JjID0gX19wcml2YXRlR2V0KHRoaXMsIF91cmwpO1xuICAgIGlmIChfX3ByaXZhdGVHZXQodGhpcywgX2ZlYXR1cmUyKSlcbiAgICAgIE1hcGJveEFkZHJlc3NNaW5pbWFwMi5yZW1vdmVBdHRyaWJ1dGUoXCJhcmlhLWhpZGRlblwiKTtcbiAgICBlbHNlXG4gICAgICBNYXBib3hBZGRyZXNzTWluaW1hcDIuc2V0QXR0cmlidXRlKFwiYXJpYS1oaWRkZW5cIiwgXCJ0cnVlXCIpO1xuICB9XG4gIGF0dHJpYnV0ZUNoYW5nZWRDYWxsYmFjayhuYW1lLCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICBpZiAobmFtZSA9PT0gXCJhY2Nlc3MtdG9rZW5cIikge1xuICAgICAgdGhpcy5hY2Nlc3NUb2tlbiA9IG5ld1ZhbHVlO1xuICAgIH0gZWxzZSBpZiAobmFtZSA9PT0gXCJjYW4tYWRqdXN0LW1hcmtlclwiKSB7XG4gICAgICB0aGlzLmNhbkFkanVzdE1hcmtlciA9IG5ld1ZhbHVlID09PSBcInRydWVcIjtcbiAgICB9IGVsc2UgaWYgKG5hbWUgPT09IFwia2VlcC1tYXJrZXItY2VudGVyZWRcIikge1xuICAgICAgdGhpcy5rZWVwTWFya2VyQ2VudGVyZWQgPSBuZXdWYWx1ZSA9PT0gXCJ0cnVlXCI7XG4gICAgfSBlbHNlIGlmIChuYW1lID09PSBcIm1hcmtlci1hbmNob3JcIikge1xuICAgICAgY29uc3QgbmV3QW5jaG9yID0gbmV3VmFsdWU7XG4gICAgICB0aGlzLm1hcmtlckFuY2hvciA9IG5ld0FuY2hvcjtcbiAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfbWFya2VyQ29udHJvbGxlcikgJiYgKF9fcHJpdmF0ZUdldCh0aGlzLCBfbWFya2VyQ29udHJvbGxlcikuYW5jaG9yID0gbmV3QW5jaG9yKTtcbiAgICB9IGVsc2UgaWYgKG5hbWUgPT09IFwic2F0ZWxsaXRlLXRvZ2dsZVwiKSB7XG4gICAgICB0aGlzLnNhdGVsbGl0ZVRvZ2dsZSA9IG5ld1ZhbHVlID09PSBcInRydWVcIjtcbiAgICB9XG4gIH1cbn07XG5fY2FuQWRqdXN0TWFya2VySW50ZXJuYWwgPSBuZXcgV2Vha01hcCgpO1xuX2lzQWRqdXN0TWFya2VyRWRpdGluZyA9IG5ldyBXZWFrTWFwKCk7XG5faW1hZ2VMb2FkZWQgPSBuZXcgV2Vha01hcCgpO1xuX2ZlYXR1cmUyID0gbmV3IFdlYWtNYXAoKTtcbl91cmwgPSBuZXcgV2Vha01hcCgpO1xuX3dpZHRoID0gbmV3IFdlYWtNYXAoKTtcbl9oZWlnaHQgPSBuZXcgV2Vha01hcCgpO1xuX2JpbmRpbmc3ID0gbmV3IFdlYWtNYXAoKTtcbl9tYXJrZXJDb250cm9sbGVyID0gbmV3IFdlYWtNYXAoKTtcbl9hY2Nlc3NUb2tlbiA9IG5ldyBXZWFrTWFwKCk7XG5fdGhlbWVJbnRlcm5hbDUgPSBuZXcgV2Vha01hcCgpO1xuX3NhdGVsbGl0ZVRvZ2dsZUludGVybmFsID0gbmV3IFdlYWtNYXAoKTtcbl9tYXBTdHlsZU1vZGUgPSBuZXcgV2Vha01hcCgpO1xuX2FkanVzdEJ0blRleHQgPSBuZXcgV2Vha01hcCgpO1xuX3NhdmVCdG5UZXh0ID0gbmV3IFdlYWtNYXAoKTtcbl9jYW5jZWxCdG5UZXh0ID0gbmV3IFdlYWtNYXAoKTtcbl9kZWZhdWx0TWFwU3R5bGUgPSBuZXcgV2Vha01hcCgpO1xuX2Zvb3RlciA9IG5ldyBXZWFrTWFwKCk7XG5fY29udGFpbmVyID0gbmV3IFdlYWtNYXAoKTtcbl90b2dnbGVNYXJrZXJFZGl0aW5nID0gbmV3IFdlYWtNYXAoKTtcbl9oYW5kbGVTdGFydE1hcmtlckVkaXRpbmcgPSBuZXcgV2Vha01hcCgpO1xuX2hhbmRsZVNhdmVNYXJrZXJFZGl0aW5nID0gbmV3IFdlYWtNYXAoKTtcbl9oYW5kbGVDYW5jZWxNYXJrZXJFZGl0aW5nID0gbmV3IFdlYWtNYXAoKTtcbl9oYW5kbGVUb2dnbGVNYXBTdHlsZSA9IG5ldyBXZWFrTWFwKCk7XG5faGFuZGxlSW1hZ2VMb2FkID0gbmV3IFdlYWtNYXAoKTtcbl9oYW5kbGVJbWFnZUVycm9yID0gbmV3IFdlYWtNYXAoKTtcbl9nZXRJbWFnZVVybCA9IG5ldyBXZWFrTWFwKCk7XG5fdXBkYXRlSW1hZ2VTcmMgPSBuZXcgV2Vha01hcCgpO1xuX2dldFRvZ2dsZUJhY2tncm91bmRJbWFnZVVybCA9IG5ldyBXZWFrTWFwKCk7XG5fc2V0U2l6ZSA9IG5ldyBXZWFrTWFwKCk7XG5fYWRkTWFya2VyRWRpdENvbnRyb2xzID0gbmV3IFdlYWtNYXAoKTtcbl9yZW1vdmVNYXJrZXJFZGl0Q29udHJvbHMgPSBuZXcgV2Vha01hcCgpO1xuX2FkZFNhdGVsbGl0ZVRvZ2dsZSA9IG5ldyBXZWFrTWFwKCk7XG5fcmVtb3ZlU2F0ZWxsaXRlVG9nZ2xlID0gbmV3IFdlYWtNYXAoKTtcbk1hcGJveEFkZHJlc3NNaW5pbWFwLm9ic2VydmVkQXR0cmlidXRlcyA9IFtcbiAgXCJhY2Nlc3MtdG9rZW5cIixcbiAgXCJjYW4tYWRqdXN0LW1hcmtlclwiLFxuICBcImtlZXAtbWFya2VyLWNlbnRlcmVkXCIsXG4gIFwibWFya2VyLWFuY2hvclwiLFxuICBcInNhdGVsbGl0ZS10b2dnbGVcIlxuXTtcbndpbmRvdy5NYXBib3hBZGRyZXNzTWluaW1hcCA9IE1hcGJveEFkZHJlc3NNaW5pbWFwO1xuaWYgKCF3aW5kb3cuY3VzdG9tRWxlbWVudHMuZ2V0KFwibWFwYm94LWFkZHJlc3MtbWluaW1hcFwiKSkge1xuICBjdXN0b21FbGVtZW50cy5kZWZpbmUoXCJtYXBib3gtYWRkcmVzcy1taW5pbWFwXCIsIE1hcGJveEFkZHJlc3NNaW5pbWFwKTtcbn1cblxuLy8gc3JjL2F1dG9maWxsLnRzXG5pbXBvcnQge1xuICBFdmVudGVkLFxuICBBZGRyZXNzQXV0b2ZpbGxDb3JlIGFzIEFkZHJlc3NBdXRvZmlsbENvcmUyLFxuICBTZWFyY2hTZXNzaW9uIGFzIFNlYXJjaFNlc3Npb240XG59IGZyb20gXCJAbWFwYm94L3NlYXJjaC1qcy1jb3JlXCI7XG52YXIgX2lucHV0NCwgX2NvbGxlY3Rpb24sIF9zZXNzaW9uNCwgX2luaXRpYWxBdXRvY29tcGxldGVWYWx1ZTIsIF9vbkhhbmRsZUlucHV0NCwgX29uSGFuZGxlU2VsZWN0NCwgX29uSGFuZGxlQmx1cjQsIF9vbkhhbmRsZUZvY3VzMiwgX2hhbmRsZVN1Z2dlc3Q0LCBfaGFuZGxlU3VnZ2VzdEVycm9yNCwgX2hhbmRsZVJldHJpZXZlNDtcbnZhciBBZGRyZXNzQXV0b2ZpbGxJbnN0YW5jZSA9IGNsYXNzIHtcbiAgY29uc3RydWN0b3IoY29sbGVjdGlvbiwgaW5wdXQsIGF1dG9maWxsUmVmKSB7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9pbnB1dDQsIHZvaWQgMCk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9jb2xsZWN0aW9uLCB2b2lkIDApO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfc2Vzc2lvbjQsIHZvaWQgMCk7XG4gICAgdGhpcy5vcHRpb25zID0ge307XG4gICAgdGhpcy5yZXRyaWV2ZUZlYXR1cmUgPSBudWxsO1xuICAgIHRoaXMubGlzdGJveCA9IG5ldyBNYXBib3hTZWFyY2hMaXN0Ym94KCk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9pbml0aWFsQXV0b2NvbXBsZXRlVmFsdWUyLCB2b2lkIDApO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfb25IYW5kbGVJbnB1dDQsIChlKSA9PiB7XG4gICAgICBjb25zdCB2YWx1ZSA9IGUuZGV0YWlsO1xuICAgICAgY29uc3QgZW5hYmxlQnJvd3NlckF1dG9jb21wbGV0ZSA9IF9fcHJpdmF0ZUdldCh0aGlzLCBfY29sbGVjdGlvbikuYnJvd3NlckF1dG9maWxsRW5hYmxlZCA9PT0gdHJ1ZSAmJiAodmFsdWUgPT0gbnVsbCA/IHZvaWQgMCA6IHZhbHVlLmxlbmd0aCkgPD0gMjtcbiAgICAgIHRvZ2dsZUF1dG9jb21wbGV0aW9uKF9fcHJpdmF0ZUdldCh0aGlzLCBfaW5wdXQ0KSwgX19wcml2YXRlR2V0KHRoaXMsIF9pbml0aWFsQXV0b2NvbXBsZXRlVmFsdWUyKSwgZW5hYmxlQnJvd3NlckF1dG9jb21wbGV0ZSk7XG4gICAgICBpZiAoKHZhbHVlID09IG51bGwgPyB2b2lkIDAgOiB2YWx1ZS5sZW5ndGgpIDw9IDIpIHtcbiAgICAgICAgdGhpcy5saXN0Ym94LmhhbmRsZVN1Z2dlc3QobnVsbCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfc2Vzc2lvbjQpLnN1Z2dlc3QodmFsdWUsIHRoaXMub3B0aW9ucyk7XG4gICAgfSk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9vbkhhbmRsZVNlbGVjdDQsIChlKSA9PiB7XG4gICAgICBjb25zdCBzdWdnZXN0aW9uID0gZS5kZXRhaWw7XG4gICAgICBpZiAoZS5kZXRhaWwuYWNjdXJhY3kgIT09IFwic3RyZWV0XCIpIHtcbiAgICAgICAgdG9nZ2xlQXV0b2NvbXBsZXRpb24oX19wcml2YXRlR2V0KHRoaXMsIF9pbnB1dDQpLCBfX3ByaXZhdGVHZXQodGhpcywgX2luaXRpYWxBdXRvY29tcGxldGVWYWx1ZTIpLCB0cnVlKTtcbiAgICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF9zZXNzaW9uNCkucmV0cmlldmUoc3VnZ2VzdGlvbiwgdGhpcy5vcHRpb25zKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGhhbmRsZVN0cmVldFNlbGVjdGlvbihfX3ByaXZhdGVHZXQodGhpcywgX2lucHV0NCksIF9fcHJpdmF0ZUdldCh0aGlzLCBfaW5pdGlhbEF1dG9jb21wbGV0ZVZhbHVlMiksIHN1Z2dlc3Rpb24pO1xuICAgICAgfVxuICAgIH0pO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfb25IYW5kbGVCbHVyNCwgKCkgPT4ge1xuICAgICAgdG9nZ2xlQXV0b2NvbXBsZXRpb24oX19wcml2YXRlR2V0KHRoaXMsIF9pbnB1dDQpLCBfX3ByaXZhdGVHZXQodGhpcywgX2luaXRpYWxBdXRvY29tcGxldGVWYWx1ZTIpLCB0cnVlKTtcbiAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfc2Vzc2lvbjQpLmFib3J0KCk7XG4gICAgfSk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9vbkhhbmRsZUZvY3VzMiwgKCkgPT4ge1xuICAgICAgdmFyIF9hO1xuICAgICAgY29uc3QgZW5hYmxlQnJvd3NlckF1dG9jb21wbGV0ZSA9IF9fcHJpdmF0ZUdldCh0aGlzLCBfY29sbGVjdGlvbikuYnJvd3NlckF1dG9maWxsRW5hYmxlZCA9PT0gdHJ1ZSAmJiAoKF9hID0gX19wcml2YXRlR2V0KHRoaXMsIF9pbnB1dDQpLnZhbHVlKSA9PSBudWxsID8gdm9pZCAwIDogX2EubGVuZ3RoKSA8PSAyO1xuICAgICAgdG9nZ2xlQXV0b2NvbXBsZXRpb24oX19wcml2YXRlR2V0KHRoaXMsIF9pbnB1dDQpLCBfX3ByaXZhdGVHZXQodGhpcywgX2luaXRpYWxBdXRvY29tcGxldGVWYWx1ZTIpLCBlbmFibGVCcm93c2VyQXV0b2NvbXBsZXRlKTtcbiAgICB9KTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX2hhbmRsZVN1Z2dlc3Q0LCAocmVzdWx0KSA9PiB7XG4gICAgICBjb25zdCBmaWx0ZXJlZFN1Z2dlc3Rpb25zID0gKHJlc3VsdCA9PSBudWxsID8gdm9pZCAwIDogcmVzdWx0LnN1Z2dlc3Rpb25zKSA/IGRpc3RpbmN0RXhhY3RTdHJlZXRSZXN1bHRzKHJlc3VsdC5zdWdnZXN0aW9ucykgOiBudWxsO1xuICAgICAgdGhpcy5saXN0Ym94LmhhbmRsZVN1Z2dlc3QoZmlsdGVyZWRTdWdnZXN0aW9ucyk7XG4gICAgICBjb25zdCBldmVudCA9IG5ldyBNYXBib3hIVE1MRXZlbnQoXCJzdWdnZXN0XCIsIHJlc3VsdCk7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXZlbnQsIFwidGFyZ2V0XCIsIHsgdmFsdWU6IF9fcHJpdmF0ZUdldCh0aGlzLCBfaW5wdXQ0KSB9KTtcbiAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfY29sbGVjdGlvbikuZmlyZShcInN1Z2dlc3RcIiwgZXZlbnQpO1xuICAgIH0pO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfaGFuZGxlU3VnZ2VzdEVycm9yNCwgKGVycm9yKSA9PiB7XG4gICAgICB0aGlzLmxpc3Rib3guaGFuZGxlRXJyb3IoKTtcbiAgICAgIGNvbnN0IGV2ZW50ID0gbmV3IE1hcGJveEhUTUxFdmVudChcInN1Z2dlc3RlcnJvclwiLCBlcnJvcik7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXZlbnQsIFwidGFyZ2V0XCIsIHsgdmFsdWU6IF9fcHJpdmF0ZUdldCh0aGlzLCBfaW5wdXQ0KSB9KTtcbiAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfY29sbGVjdGlvbikuZmlyZShcInN1Z2dlc3RlcnJvclwiLCBldmVudCk7XG4gICAgfSk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9oYW5kbGVSZXRyaWV2ZTQsIChyZXN1bHQpID0+IHtcbiAgICAgIHZhciBfYTtcbiAgICAgIGNvbnN0IGV2ZW50ID0gbmV3IE1hcGJveEhUTUxFdmVudChcInJldHJpZXZlXCIsIHJlc3VsdCk7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXZlbnQsIFwidGFyZ2V0XCIsIHsgdmFsdWU6IF9fcHJpdmF0ZUdldCh0aGlzLCBfaW5wdXQ0KSB9KTtcbiAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfY29sbGVjdGlvbikuZmlyZShcInJldHJpZXZlXCIsIGV2ZW50KTtcbiAgICAgIHRoaXMucmV0cmlldmVGZWF0dXJlID0gKF9hID0gcmVzdWx0LmZlYXR1cmVzKSA9PSBudWxsID8gdm9pZCAwIDogX2FbMF07XG4gICAgICBpZiAoIV9fcHJpdmF0ZUdldCh0aGlzLCBfaW5wdXQ0KSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjb25zdCBmZWF0dXJlQ29sbGVjdGlvbiA9IHJlc3VsdDtcbiAgICAgIGlmICghZmVhdHVyZUNvbGxlY3Rpb24gfHwgIWZlYXR1cmVDb2xsZWN0aW9uLmZlYXR1cmVzIHx8ICFmZWF0dXJlQ29sbGVjdGlvbi5mZWF0dXJlcy5sZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgZmlsbEZvcm1XaXRoRmVhdHVyZShmZWF0dXJlQ29sbGVjdGlvbi5mZWF0dXJlc1swXSwgX19wcml2YXRlR2V0KHRoaXMsIF9pbnB1dDQpKTtcbiAgICB9KTtcbiAgICBfX3ByaXZhdGVTZXQodGhpcywgX2lucHV0NCwgaW5wdXQpO1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfY29sbGVjdGlvbiwgY29sbGVjdGlvbik7XG4gICAgX19wcml2YXRlU2V0KHRoaXMsIF9zZXNzaW9uNCwgbmV3IFNlYXJjaFNlc3Npb240KGF1dG9maWxsUmVmKSk7XG4gICAgX19wcml2YXRlR2V0KHRoaXMsIF9zZXNzaW9uNCkuc2Vzc2lvblRva2VuID0gY29uZmlnLmF1dG9maWxsU2Vzc2lvblRva2VuO1xuICAgIHRoaXMubGlzdGJveC5pbnB1dCA9IF9fcHJpdmF0ZUdldCh0aGlzLCBfaW5wdXQ0KTtcbiAgICB0aGlzLmxpc3Rib3guYXV0b2ZpbGxIb3N0ID0gdGhpcztcbiAgICB0aGlzLmxpc3Rib3guc2VhcmNoU2VydmljZSA9IDAgLyogQWRkcmVzc0F1dG9maWxsICovO1xuICAgIHRoaXMubGlzdGJveC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgX19wcml2YXRlR2V0KHRoaXMsIF9vbkhhbmRsZUlucHV0NCkpO1xuICAgIHRoaXMubGlzdGJveC5hZGRFdmVudExpc3RlbmVyKFwic2VsZWN0XCIsIF9fcHJpdmF0ZUdldCh0aGlzLCBfb25IYW5kbGVTZWxlY3Q0KSk7XG4gICAgdGhpcy5saXN0Ym94LmFkZEV2ZW50TGlzdGVuZXIoXCJibHVyXCIsIF9fcHJpdmF0ZUdldCh0aGlzLCBfb25IYW5kbGVCbHVyNCkpO1xuICAgIHRoaXMubGlzdGJveC5hZGRFdmVudExpc3RlbmVyKFwiZm9jdXNcIiwgX19wcml2YXRlR2V0KHRoaXMsIF9vbkhhbmRsZUZvY3VzMikpO1xuICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfc2Vzc2lvbjQpLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWdnZXN0XCIsIF9fcHJpdmF0ZUdldCh0aGlzLCBfaGFuZGxlU3VnZ2VzdDQpKTtcbiAgICBfX3ByaXZhdGVHZXQodGhpcywgX3Nlc3Npb240KS5hZGRFdmVudExpc3RlbmVyKFwic3VnZ2VzdGVycm9yXCIsIF9fcHJpdmF0ZUdldCh0aGlzLCBfaGFuZGxlU3VnZ2VzdEVycm9yNCkpO1xuICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfc2Vzc2lvbjQpLmFkZEV2ZW50TGlzdGVuZXIoXCJyZXRyaWV2ZVwiLCBfX3ByaXZhdGVHZXQodGhpcywgX2hhbmRsZVJldHJpZXZlNCkpO1xuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodGhpcy5saXN0Ym94KTtcbiAgICBpZiAoaW5wdXQpIHtcbiAgICAgIGlucHV0Lmluc2VydEFkamFjZW50RWxlbWVudChcImJlZm9yZWJlZ2luXCIsIGNyZWF0ZUFyaWFMaXZlRWxlbWVudCh0aGlzLmxpc3Rib3guZGF0YVNlZWQpKTtcbiAgICAgIHN1cHByZXNzRXh0ZW5zaW9uc0F1dG9jb21wbGV0ZShpbnB1dCk7XG4gICAgICBfX3ByaXZhdGVTZXQodGhpcywgX2luaXRpYWxBdXRvY29tcGxldGVWYWx1ZTIsIGlucHV0LmF1dG9jb21wbGV0ZSk7XG4gICAgfVxuICB9XG4gIGdldCBpbnB1dCgpIHtcbiAgICByZXR1cm4gX19wcml2YXRlR2V0KHRoaXMsIF9pbnB1dDQpO1xuICB9XG4gIHJlbW92ZSgpIHtcbiAgICB0aGlzLmxpc3Rib3gucmVtb3ZlKCk7XG4gICAgdGhpcy5saXN0Ym94LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCBfX3ByaXZhdGVHZXQodGhpcywgX29uSGFuZGxlSW5wdXQ0KSk7XG4gICAgdGhpcy5saXN0Ym94LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJzZWxlY3RcIiwgX19wcml2YXRlR2V0KHRoaXMsIF9vbkhhbmRsZVNlbGVjdDQpKTtcbiAgICB0aGlzLmxpc3Rib3gucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImJsdXJcIiwgX19wcml2YXRlR2V0KHRoaXMsIF9vbkhhbmRsZUJsdXI0KSk7XG4gICAgdGhpcy5saXN0Ym94LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJmb2N1c1wiLCBfX3ByaXZhdGVHZXQodGhpcywgX29uSGFuZGxlRm9jdXMyKSk7XG4gICAgX19wcml2YXRlR2V0KHRoaXMsIF9zZXNzaW9uNCkucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInN1Z2dlc3RcIiwgX19wcml2YXRlR2V0KHRoaXMsIF9oYW5kbGVTdWdnZXN0NCkpO1xuICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfc2Vzc2lvbjQpLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJzdWdnZXN0ZXJyb3JcIiwgX19wcml2YXRlR2V0KHRoaXMsIF9oYW5kbGVTdWdnZXN0RXJyb3I0KSk7XG4gICAgX19wcml2YXRlR2V0KHRoaXMsIF9zZXNzaW9uNCkucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInJldHJpZXZlXCIsIF9fcHJpdmF0ZUdldCh0aGlzLCBfaGFuZGxlUmV0cmlldmU0KSk7XG4gIH1cbiAgc2ltdWxhdGVSZXRyaWV2ZShmZWF0dXJlKSB7XG4gICAgY29uc3QgaW5wdXQgPSBfX3ByaXZhdGVHZXQodGhpcywgX2lucHV0NCk7XG4gICAgaWYgKGlucHV0KSB7XG4gICAgICBpbnB1dC5kYXRhc2V0W1wibWFwYm94U3VjY2Vzc1wiXSA9IFwidHJ1ZVwiO1xuICAgIH1cbiAgICB0aGlzLmxpc3Rib3guaGlkZVJlc3VsdHMoKTtcbiAgICBjb25zdCBzaW1SZXN1bHQgPSB7XG4gICAgICB0eXBlOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4gICAgICBmZWF0dXJlczogW2ZlYXR1cmVdLFxuICAgICAgdXJsOiBcIlwiXG4gICAgfTtcbiAgICBfX3ByaXZhdGVHZXQodGhpcywgX2hhbmRsZVJldHJpZXZlNCkuY2FsbCh0aGlzLCBzaW1SZXN1bHQpO1xuICB9XG59O1xuX2lucHV0NCA9IG5ldyBXZWFrTWFwKCk7XG5fY29sbGVjdGlvbiA9IG5ldyBXZWFrTWFwKCk7XG5fc2Vzc2lvbjQgPSBuZXcgV2Vha01hcCgpO1xuX2luaXRpYWxBdXRvY29tcGxldGVWYWx1ZTIgPSBuZXcgV2Vha01hcCgpO1xuX29uSGFuZGxlSW5wdXQ0ID0gbmV3IFdlYWtNYXAoKTtcbl9vbkhhbmRsZVNlbGVjdDQgPSBuZXcgV2Vha01hcCgpO1xuX29uSGFuZGxlQmx1cjQgPSBuZXcgV2Vha01hcCgpO1xuX29uSGFuZGxlRm9jdXMyID0gbmV3IFdlYWtNYXAoKTtcbl9oYW5kbGVTdWdnZXN0NCA9IG5ldyBXZWFrTWFwKCk7XG5faGFuZGxlU3VnZ2VzdEVycm9yNCA9IG5ldyBXZWFrTWFwKCk7XG5faGFuZGxlUmV0cmlldmU0ID0gbmV3IFdlYWtNYXAoKTtcbnZhciBfY3VycmVudElucHV0cywgX2F1dG9maWxsMiwgX29wdGlvbnMyLCBfdGhlbWUsIF9wb3BvdmVyT3B0aW9uczIsIF9oYW5kbGVPYnNlcnZlMiwgX29ic2VydmVyMiwgX2hhbmRsZUJyb3dzZXJBdXRvZmlsbDI7XG52YXIgQWRkcmVzc0F1dG9maWxsQ29sbGVjdGlvbiA9IGNsYXNzIGV4dGVuZHMgRXZlbnRlZCB7XG4gIGNvbnN0cnVjdG9yKHtcbiAgICBhY2Nlc3NUb2tlbixcbiAgICBvcHRpb25zLFxuICAgIHRoZW1lLFxuICAgIHBvcG92ZXJPcHRpb25zLFxuICAgIGNvbmZpcm1PbkJyb3dzZXJBdXRvZmlsbCxcbiAgICBicm93c2VyQXV0b2ZpbGxFbmFibGVkXG4gIH0pIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMuaW5zdGFuY2VzID0gW107XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9jdXJyZW50SW5wdXRzLCB2b2lkIDApO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfYXV0b2ZpbGwyLCBuZXcgQWRkcmVzc0F1dG9maWxsQ29yZTIoKSk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9vcHRpb25zMiwgdm9pZCAwKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX3RoZW1lLCB2b2lkIDApO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfcG9wb3Zlck9wdGlvbnMyLCB2b2lkIDApO1xuICAgIHRoaXMuY29uZmlybU9uQnJvd3NlckF1dG9maWxsID0gZmFsc2U7XG4gICAgdGhpcy5icm93c2VyQXV0b2ZpbGxFbmFibGVkID0gZmFsc2U7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9oYW5kbGVPYnNlcnZlMiwgKCkgPT4ge1xuICAgICAgaWYgKCFkZWVwRXF1YWxzKGZpbmRBZGRyZXNzSW5wdXRzKCksIF9fcHJpdmF0ZUdldCh0aGlzLCBfY3VycmVudElucHV0cykpKSB7XG4gICAgICAgIHRoaXMudXBkYXRlKCk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9vYnNlcnZlcjIsIG5ldyBNdXRhdGlvbk9ic2VydmVyKF9fcHJpdmF0ZUdldCh0aGlzLCBfaGFuZGxlT2JzZXJ2ZTIpKSk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9oYW5kbGVCcm93c2VyQXV0b2ZpbGwyLCAoZSkgPT4gX19hc3luYyh0aGlzLCBudWxsLCBmdW5jdGlvbiogKCkge1xuICAgICAgdGhpcy5pbnN0YW5jZXMuZm9yRWFjaCgoaW5zdGFuY2UpID0+IGluc3RhbmNlLmxpc3Rib3guYmx1cigpKTtcbiAgICAgIGZvciAoY29uc3QgaW5zdGFuY2Ugb2YgdGhpcy5pbnN0YW5jZXMpIHtcbiAgICAgICAgY29uc3QgaW5wdXQgPSBpbnN0YW5jZS5saXN0Ym94LmlucHV0O1xuICAgICAgICB5aWVsZCB0cnlDb25maXJtQnJvd3NlckF1dG9maWxsKGlucHV0LCBlLCB0aGlzLmNvbmZpcm1PbkJyb3dzZXJBdXRvZmlsbCwgdGhpcy5hY2Nlc3NUb2tlbik7XG4gICAgICB9XG4gICAgfSkpO1xuICAgIGluaXREZXRlY3RCcm93c2VyQXV0b2ZpbGwoKTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImJyb3dzZXJhdXRvZmlsbFwiLCBfX3ByaXZhdGVHZXQodGhpcywgX2hhbmRsZUJyb3dzZXJBdXRvZmlsbDIpKTtcbiAgICBjb25maWcuYXV0b2ZpbGxTZXNzaW9uRW5hYmxlZCA9IHRydWU7XG4gICAgdGhpcy5hY2Nlc3NUb2tlbiA9IGFjY2Vzc1Rva2VuIHx8IGNvbmZpZy5hY2Nlc3NUb2tlbjtcbiAgICBvcHRpb25zICYmICh0aGlzLm9wdGlvbnMgPSBvcHRpb25zKTtcbiAgICB0aGVtZSAmJiAodGhpcy50aGVtZSA9IHRoZW1lKTtcbiAgICBwb3BvdmVyT3B0aW9ucyAmJiAodGhpcy5wb3BvdmVyT3B0aW9ucyA9IHBvcG92ZXJPcHRpb25zKTtcbiAgICBjb25maXJtT25Ccm93c2VyQXV0b2ZpbGwgJiYgKHRoaXMuY29uZmlybU9uQnJvd3NlckF1dG9maWxsID0gY29uZmlybU9uQnJvd3NlckF1dG9maWxsKTtcbiAgICBicm93c2VyQXV0b2ZpbGxFbmFibGVkICYmICh0aGlzLmJyb3dzZXJBdXRvZmlsbEVuYWJsZWQgPSBicm93c2VyQXV0b2ZpbGxFbmFibGVkKTtcbiAgICB0aGlzLnVwZGF0ZSgpO1xuICB9XG4gIGdldCBhY2Nlc3NUb2tlbigpIHtcbiAgICByZXR1cm4gX19wcml2YXRlR2V0KHRoaXMsIF9hdXRvZmlsbDIpLmFjY2Vzc1Rva2VuO1xuICB9XG4gIHNldCBhY2Nlc3NUb2tlbihuZXdUb2tlbikge1xuICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfYXV0b2ZpbGwyKS5hY2Nlc3NUb2tlbiA9IG5ld1Rva2VuO1xuICB9XG4gIGdldCBvcHRpb25zKCkge1xuICAgIHJldHVybiBfX3ByaXZhdGVHZXQodGhpcywgX29wdGlvbnMyKTtcbiAgfVxuICBzZXQgb3B0aW9ucyhuZXdPcHRpb25zKSB7XG4gICAgX19wcml2YXRlU2V0KHRoaXMsIF9vcHRpb25zMiwgX19zcHJlYWRWYWx1ZXMoX19zcHJlYWRWYWx1ZXMoe30sIF9fcHJpdmF0ZUdldCh0aGlzLCBfb3B0aW9uczIpKSwgbmV3T3B0aW9ucykpO1xuICAgIHRoaXMuaW5zdGFuY2VzLmZvckVhY2goKGluc3RhbmNlKSA9PiB7XG4gICAgICBpbnN0YW5jZS5vcHRpb25zID0gX19zcHJlYWRWYWx1ZXMoX19zcHJlYWRWYWx1ZXMoe30sIGluc3RhbmNlLm9wdGlvbnMpLCBuZXdPcHRpb25zKTtcbiAgICB9KTtcbiAgfVxuICBnZXQgdGhlbWUoKSB7XG4gICAgcmV0dXJuIF9fcHJpdmF0ZUdldCh0aGlzLCBfdGhlbWUpO1xuICB9XG4gIHNldCB0aGVtZShuZXdUaGVtZSkge1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfdGhlbWUsIG5ld1RoZW1lKTtcbiAgICB0aGlzLmluc3RhbmNlcy5mb3JFYWNoKChpbnN0YW5jZSkgPT4ge1xuICAgICAgaW5zdGFuY2UubGlzdGJveC50aGVtZSA9IG5ld1RoZW1lO1xuICAgIH0pO1xuICB9XG4gIGdldCBwb3BvdmVyT3B0aW9ucygpIHtcbiAgICByZXR1cm4gX19wcml2YXRlR2V0KHRoaXMsIF9wb3BvdmVyT3B0aW9uczIpO1xuICB9XG4gIHNldCBwb3BvdmVyT3B0aW9ucyhuZXdPcHRpb25zKSB7XG4gICAgX19wcml2YXRlU2V0KHRoaXMsIF9wb3BvdmVyT3B0aW9uczIsIG5ld09wdGlvbnMpO1xuICAgIHRoaXMuaW5zdGFuY2VzLmZvckVhY2goKGluc3RhbmNlKSA9PiB7XG4gICAgICBpbnN0YW5jZS5saXN0Ym94LnBvcG92ZXJPcHRpb25zID0gbmV3T3B0aW9ucztcbiAgICB9KTtcbiAgfVxuICB1cGRhdGUoKSB7XG4gICAgdGhpcy5pbnN0YW5jZXMuZm9yRWFjaCgoaW5zdGFuY2UpID0+IHtcbiAgICAgIGluc3RhbmNlLnJlbW92ZSgpO1xuICAgIH0pO1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfY3VycmVudElucHV0cywgZmluZEFkZHJlc3NJbnB1dHMoKSk7XG4gICAgdGhpcy5pbnN0YW5jZXMgPSBbXTtcbiAgICBfX3ByaXZhdGVHZXQodGhpcywgX2N1cnJlbnRJbnB1dHMpLmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICBjb25zdCBhdXRvZmlsbEluc3RhbmNlID0gbmV3IEFkZHJlc3NBdXRvZmlsbEluc3RhbmNlKHRoaXMsIGlucHV0LCBfX3ByaXZhdGVHZXQodGhpcywgX2F1dG9maWxsMikpO1xuICAgICAgYXV0b2ZpbGxJbnN0YW5jZS5vcHRpb25zID0gdGhpcy5vcHRpb25zO1xuICAgICAgYXV0b2ZpbGxJbnN0YW5jZS5saXN0Ym94LnRoZW1lID0gdGhpcy50aGVtZTtcbiAgICAgIGF1dG9maWxsSW5zdGFuY2UubGlzdGJveC5wb3BvdmVyT3B0aW9ucyA9IHRoaXMucG9wb3Zlck9wdGlvbnM7XG4gICAgICB0aGlzLmluc3RhbmNlcy5wdXNoKGF1dG9maWxsSW5zdGFuY2UpO1xuICAgIH0pO1xuICB9XG4gIG9ic2VydmUoKSB7XG4gICAgX19wcml2YXRlR2V0KHRoaXMsIF9vYnNlcnZlcjIpLm9ic2VydmUoZG9jdW1lbnQsIHtcbiAgICAgIHN1YnRyZWU6IHRydWUsXG4gICAgICBjaGlsZExpc3Q6IHRydWVcbiAgICB9KTtcbiAgICBfX3ByaXZhdGVHZXQodGhpcywgX2hhbmRsZU9ic2VydmUyKS5jYWxsKHRoaXMpO1xuICB9XG4gIHVub2JzZXJ2ZSgpIHtcbiAgICBfX3ByaXZhdGVHZXQodGhpcywgX29ic2VydmVyMikuZGlzY29ubmVjdCgpO1xuICB9XG4gIHJlbW92ZSgpIHtcbiAgICB0aGlzLmluc3RhbmNlcy5mb3JFYWNoKChpbnN0YW5jZSkgPT4ge1xuICAgICAgaW5zdGFuY2UucmVtb3ZlKCk7XG4gICAgfSk7XG4gICAgdGhpcy51bm9ic2VydmUoKTtcbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImJyb3dzZXJhdXRvZmlsbFwiLCBfX3ByaXZhdGVHZXQodGhpcywgX2hhbmRsZUJyb3dzZXJBdXRvZmlsbDIpKTtcbiAgfVxufTtcbl9jdXJyZW50SW5wdXRzID0gbmV3IFdlYWtNYXAoKTtcbl9hdXRvZmlsbDIgPSBuZXcgV2Vha01hcCgpO1xuX29wdGlvbnMyID0gbmV3IFdlYWtNYXAoKTtcbl90aGVtZSA9IG5ldyBXZWFrTWFwKCk7XG5fcG9wb3Zlck9wdGlvbnMyID0gbmV3IFdlYWtNYXAoKTtcbl9oYW5kbGVPYnNlcnZlMiA9IG5ldyBXZWFrTWFwKCk7XG5fb2JzZXJ2ZXIyID0gbmV3IFdlYWtNYXAoKTtcbl9oYW5kbGVCcm93c2VyQXV0b2ZpbGwyID0gbmV3IFdlYWtNYXAoKTtcbmZ1bmN0aW9uIGF1dG9maWxsKG9wdGlvbnNBcmcpIHtcbiAgcmV0dXJuIG5ldyBBZGRyZXNzQXV0b2ZpbGxDb2xsZWN0aW9uKG9wdGlvbnNBcmcpO1xufVxuZXhwb3J0IHtcbiAgTWFwYm94QWRkcmVzc0F1dG9maWxsLFxuICBNYXBib3hBZGRyZXNzQ29uZmlybWF0aW9uLFxuICBNYXBib3hBZGRyZXNzTWluaW1hcCxcbiAgTWFwYm94R2VvY29kZXIsXG4gIE1hcGJveEhUTUxFdmVudCxcbiAgTWFwYm94U2VhcmNoQm94LFxuICBhdXRvZmlsbCxcbiAgY29uZmlnLFxuICBjb25maXJtQWRkcmVzcyxcbiAgZ2V0QXV0b2ZpbGxTZWFyY2hUZXh0LFxuICBnZXRGb3JtQXV0b2ZpbGxWYWx1ZXNcbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC1lc20uanMubWFwXG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@mapbox/search-js-web/dist/index-esm.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@mapbox/sphericalmercator/sphericalmercator.js":
/*!*********************************************************************!*\
  !*** ./node_modules/@mapbox/sphericalmercator/sphericalmercator.js ***!
  \*********************************************************************/
/***/ ((module, exports) => {

eval("var SphericalMercator = (function(){\n\n// Closures including constants and other precalculated values.\nvar cache = {},\n    EPSLN = 1.0e-10,\n    D2R = Math.PI / 180,\n    R2D = 180 / Math.PI,\n    // 900913 properties.\n    A = 6378137.0,\n    MAXEXTENT = 20037508.342789244;\n\nfunction isFloat(n){\n    return Number(n) === n && n % 1 !== 0;\n}\n\n// SphericalMercator constructor: precaches calculations\n// for fast tile lookups.\nfunction SphericalMercator(options) {\n    options = options || {};\n    this.size = options.size || 256;\n    this.expansion = (options.antimeridian === true) ? 2 : 1;\n    if (!cache[this.size]) {\n        var size = this.size;\n        var c = cache[this.size] = {};\n        c.Bc = [];\n        c.Cc = [];\n        c.zc = [];\n        c.Ac = [];\n        for (var d = 0; d < 30; d++) {\n            c.Bc.push(size / 360);\n            c.Cc.push(size / (2 * Math.PI));\n            c.zc.push(size / 2);\n            c.Ac.push(size);\n            size *= 2;\n        }\n    }\n    this.Bc = cache[this.size].Bc;\n    this.Cc = cache[this.size].Cc;\n    this.zc = cache[this.size].zc;\n    this.Ac = cache[this.size].Ac;\n};\n\n// Convert lon lat to screen pixel value\n//\n// - `ll` {Array} `[lon, lat]` array of geographic coordinates.\n// - `zoom` {Number} zoom level.\nSphericalMercator.prototype.px = function(ll, zoom) {\n  if (isFloat(zoom)) {\n    var size = this.size * Math.pow(2, zoom);\n    var d = size / 2;\n    var bc = (size / 360);\n    var cc = (size / (2 * Math.PI));\n    var ac = size;\n    var f = Math.min(Math.max(Math.sin(D2R * ll[1]), -0.9999), 0.9999);\n    var x = d + ll[0] * bc;\n    var y = d + 0.5 * Math.log((1 + f) / (1 - f)) * -cc;\n    (x > ac * this.expansion) && (x = ac * this.expansion);\n    (y > ac) && (y = ac);\n    //(x < 0) && (x = 0);\n    //(y < 0) && (y = 0);\n    return [x, y];\n  } else {\n    var d = this.zc[zoom];\n    var f = Math.min(Math.max(Math.sin(D2R * ll[1]), -0.9999), 0.9999);\n    var x = Math.round(d + ll[0] * this.Bc[zoom]);\n    var y = Math.round(d + 0.5 * Math.log((1 + f) / (1 - f)) * (-this.Cc[zoom]));\n    (x > this.Ac[zoom] * this.expansion) && (x = this.Ac[zoom] * this.expansion);\n    (y > this.Ac[zoom]) && (y = this.Ac[zoom]);\n    //(x < 0) && (x = 0);\n    //(y < 0) && (y = 0);\n    return [x, y];\n  }\n};\n\n// Convert screen pixel value to lon lat\n//\n// - `px` {Array} `[x, y]` array of geographic coordinates.\n// - `zoom` {Number} zoom level.\nSphericalMercator.prototype.ll = function(px, zoom) {\n  if (isFloat(zoom)) {\n    var size = this.size * Math.pow(2, zoom);\n    var bc = (size / 360);\n    var cc = (size / (2 * Math.PI));\n    var zc = size / 2;\n    var g = (px[1] - zc) / -cc;\n    var lon = (px[0] - zc) / bc;\n    var lat = R2D * (2 * Math.atan(Math.exp(g)) - 0.5 * Math.PI);\n    return [lon, lat];\n  } else {\n    var g = (px[1] - this.zc[zoom]) / (-this.Cc[zoom]);\n    var lon = (px[0] - this.zc[zoom]) / this.Bc[zoom];\n    var lat = R2D * (2 * Math.atan(Math.exp(g)) - 0.5 * Math.PI);\n    return [lon, lat];\n  }\n};\n\n// Convert tile xyz value to bbox of the form `[w, s, e, n]`\n//\n// - `x` {Number} x (longitude) number.\n// - `y` {Number} y (latitude) number.\n// - `zoom` {Number} zoom.\n// - `tms_style` {Boolean} whether to compute using tms-style.\n// - `srs` {String} projection for resulting bbox (WGS84|900913).\n// - `return` {Array} bbox array of values in form `[w, s, e, n]`.\nSphericalMercator.prototype.bbox = function(x, y, zoom, tms_style, srs) {\n    // Convert xyz into bbox with srs WGS84\n    if (tms_style) {\n        y = (Math.pow(2, zoom) - 1) - y;\n    }\n    // Use +y to make sure it's a number to avoid inadvertent concatenation.\n    var ll = [x * this.size, (+y + 1) * this.size]; // lower left\n    // Use +x to make sure it's a number to avoid inadvertent concatenation.\n    var ur = [(+x + 1) * this.size, y * this.size]; // upper right\n    var bbox = this.ll(ll, zoom).concat(this.ll(ur, zoom));\n\n    // If web mercator requested reproject to 900913.\n    if (srs === '900913') {\n        return this.convert(bbox, '900913');\n    } else {\n        return bbox;\n    }\n};\n\n// Convert bbox to xyx bounds\n//\n// - `bbox` {Number} bbox in the form `[w, s, e, n]`.\n// - `zoom` {Number} zoom.\n// - `tms_style` {Boolean} whether to compute using tms-style.\n// - `srs` {String} projection of input bbox (WGS84|900913).\n// - `@return` {Object} XYZ bounds containing minX, maxX, minY, maxY properties.\nSphericalMercator.prototype.xyz = function(bbox, zoom, tms_style, srs) {\n    // If web mercator provided reproject to WGS84.\n    if (srs === '900913') {\n        bbox = this.convert(bbox, 'WGS84');\n    }\n\n    var ll = [bbox[0], bbox[1]]; // lower left\n    var ur = [bbox[2], bbox[3]]; // upper right\n    var px_ll = this.px(ll, zoom);\n    var px_ur = this.px(ur, zoom);\n    // Y = 0 for XYZ is the top hence minY uses px_ur[1].\n    var x = [ Math.floor(px_ll[0] / this.size), Math.floor((px_ur[0] - 1) / this.size) ];\n    var y = [ Math.floor(px_ur[1] / this.size), Math.floor((px_ll[1] - 1) / this.size) ];\n    var bounds = {\n        minX: Math.min.apply(Math, x) < 0 ? 0 : Math.min.apply(Math, x),\n        minY: Math.min.apply(Math, y) < 0 ? 0 : Math.min.apply(Math, y),\n        maxX: Math.max.apply(Math, x),\n        maxY: Math.max.apply(Math, y)\n    };\n    if (tms_style) {\n        var tms = {\n            minY: (Math.pow(2, zoom) - 1) - bounds.maxY,\n            maxY: (Math.pow(2, zoom) - 1) - bounds.minY\n        };\n        bounds.minY = tms.minY;\n        bounds.maxY = tms.maxY;\n    }\n    return bounds;\n};\n\n// Convert projection of given bbox.\n//\n// - `bbox` {Number} bbox in the form `[w, s, e, n]`.\n// - `to` {String} projection of output bbox (WGS84|900913). Input bbox\n//   assumed to be the \"other\" projection.\n// - `@return` {Object} bbox with reprojected coordinates.\nSphericalMercator.prototype.convert = function(bbox, to) {\n    if (to === '900913') {\n        return this.forward(bbox.slice(0, 2)).concat(this.forward(bbox.slice(2,4)));\n    } else {\n        return this.inverse(bbox.slice(0, 2)).concat(this.inverse(bbox.slice(2,4)));\n    }\n};\n\n// Convert lon/lat values to 900913 x/y.\nSphericalMercator.prototype.forward = function(ll) {\n    var xy = [\n        A * ll[0] * D2R,\n        A * Math.log(Math.tan((Math.PI*0.25) + (0.5 * ll[1] * D2R)))\n    ];\n    // if xy value is beyond maxextent (e.g. poles), return maxextent.\n    (xy[0] > MAXEXTENT) && (xy[0] = MAXEXTENT);\n    (xy[0] < -MAXEXTENT) && (xy[0] = -MAXEXTENT);\n    (xy[1] > MAXEXTENT) && (xy[1] = MAXEXTENT);\n    (xy[1] < -MAXEXTENT) && (xy[1] = -MAXEXTENT);\n    return xy;\n};\n\n// Convert 900913 x/y values to lon/lat.\nSphericalMercator.prototype.inverse = function(xy) {\n    return [\n        (xy[0] * R2D / A),\n        ((Math.PI*0.5) - 2.0 * Math.atan(Math.exp(-xy[1] / A))) * R2D\n    ];\n};\n\nreturn SphericalMercator;\n\n})();\n\nif (true) {\n    module.exports = exports = SphericalMercator;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQG1hcGJveC9zcGhlcmljYWxtZXJjYXRvci9zcGhlcmljYWxtZXJjYXRvci5qcyIsIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLFFBQVE7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxXQUFXLE9BQU87QUFDbEIsYUFBYSxRQUFRO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxXQUFXLE9BQU87QUFDbEIsYUFBYSxRQUFRO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsVUFBVSxRQUFRO0FBQ2xCLFVBQVUsUUFBUTtBQUNsQixhQUFhLFFBQVE7QUFDckIsa0JBQWtCLFNBQVM7QUFDM0IsWUFBWSxRQUFRO0FBQ3BCLGVBQWUsT0FBTztBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvREFBb0Q7QUFDcEQ7QUFDQSxvREFBb0Q7QUFDcEQ7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsYUFBYSxRQUFRO0FBQ3JCLGFBQWEsUUFBUTtBQUNyQixrQkFBa0IsU0FBUztBQUMzQixZQUFZLFFBQVE7QUFDcEIsZ0JBQWdCLFFBQVE7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxpQ0FBaUM7QUFDakMsaUNBQWlDO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsYUFBYSxRQUFRO0FBQ3JCLFdBQVcsUUFBUTtBQUNuQjtBQUNBLGdCQUFnQixRQUFRO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUEsQ0FBQzs7QUFFRCxJQUFJLElBQStEO0FBQ25FO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9yb3V0ZS1wbGFubmVyLy4vbm9kZV9tb2R1bGVzL0BtYXBib3gvc3BoZXJpY2FsbWVyY2F0b3Ivc3BoZXJpY2FsbWVyY2F0b3IuanM/MDY3MyJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgU3BoZXJpY2FsTWVyY2F0b3IgPSAoZnVuY3Rpb24oKXtcblxuLy8gQ2xvc3VyZXMgaW5jbHVkaW5nIGNvbnN0YW50cyBhbmQgb3RoZXIgcHJlY2FsY3VsYXRlZCB2YWx1ZXMuXG52YXIgY2FjaGUgPSB7fSxcbiAgICBFUFNMTiA9IDEuMGUtMTAsXG4gICAgRDJSID0gTWF0aC5QSSAvIDE4MCxcbiAgICBSMkQgPSAxODAgLyBNYXRoLlBJLFxuICAgIC8vIDkwMDkxMyBwcm9wZXJ0aWVzLlxuICAgIEEgPSA2Mzc4MTM3LjAsXG4gICAgTUFYRVhURU5UID0gMjAwMzc1MDguMzQyNzg5MjQ0O1xuXG5mdW5jdGlvbiBpc0Zsb2F0KG4pe1xuICAgIHJldHVybiBOdW1iZXIobikgPT09IG4gJiYgbiAlIDEgIT09IDA7XG59XG5cbi8vIFNwaGVyaWNhbE1lcmNhdG9yIGNvbnN0cnVjdG9yOiBwcmVjYWNoZXMgY2FsY3VsYXRpb25zXG4vLyBmb3IgZmFzdCB0aWxlIGxvb2t1cHMuXG5mdW5jdGlvbiBTcGhlcmljYWxNZXJjYXRvcihvcHRpb25zKSB7XG4gICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gICAgdGhpcy5zaXplID0gb3B0aW9ucy5zaXplIHx8IDI1NjtcbiAgICB0aGlzLmV4cGFuc2lvbiA9IChvcHRpb25zLmFudGltZXJpZGlhbiA9PT0gdHJ1ZSkgPyAyIDogMTtcbiAgICBpZiAoIWNhY2hlW3RoaXMuc2l6ZV0pIHtcbiAgICAgICAgdmFyIHNpemUgPSB0aGlzLnNpemU7XG4gICAgICAgIHZhciBjID0gY2FjaGVbdGhpcy5zaXplXSA9IHt9O1xuICAgICAgICBjLkJjID0gW107XG4gICAgICAgIGMuQ2MgPSBbXTtcbiAgICAgICAgYy56YyA9IFtdO1xuICAgICAgICBjLkFjID0gW107XG4gICAgICAgIGZvciAodmFyIGQgPSAwOyBkIDwgMzA7IGQrKykge1xuICAgICAgICAgICAgYy5CYy5wdXNoKHNpemUgLyAzNjApO1xuICAgICAgICAgICAgYy5DYy5wdXNoKHNpemUgLyAoMiAqIE1hdGguUEkpKTtcbiAgICAgICAgICAgIGMuemMucHVzaChzaXplIC8gMik7XG4gICAgICAgICAgICBjLkFjLnB1c2goc2l6ZSk7XG4gICAgICAgICAgICBzaXplICo9IDI7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdGhpcy5CYyA9IGNhY2hlW3RoaXMuc2l6ZV0uQmM7XG4gICAgdGhpcy5DYyA9IGNhY2hlW3RoaXMuc2l6ZV0uQ2M7XG4gICAgdGhpcy56YyA9IGNhY2hlW3RoaXMuc2l6ZV0uemM7XG4gICAgdGhpcy5BYyA9IGNhY2hlW3RoaXMuc2l6ZV0uQWM7XG59O1xuXG4vLyBDb252ZXJ0IGxvbiBsYXQgdG8gc2NyZWVuIHBpeGVsIHZhbHVlXG4vL1xuLy8gLSBgbGxgIHtBcnJheX0gYFtsb24sIGxhdF1gIGFycmF5IG9mIGdlb2dyYXBoaWMgY29vcmRpbmF0ZXMuXG4vLyAtIGB6b29tYCB7TnVtYmVyfSB6b29tIGxldmVsLlxuU3BoZXJpY2FsTWVyY2F0b3IucHJvdG90eXBlLnB4ID0gZnVuY3Rpb24obGwsIHpvb20pIHtcbiAgaWYgKGlzRmxvYXQoem9vbSkpIHtcbiAgICB2YXIgc2l6ZSA9IHRoaXMuc2l6ZSAqIE1hdGgucG93KDIsIHpvb20pO1xuICAgIHZhciBkID0gc2l6ZSAvIDI7XG4gICAgdmFyIGJjID0gKHNpemUgLyAzNjApO1xuICAgIHZhciBjYyA9IChzaXplIC8gKDIgKiBNYXRoLlBJKSk7XG4gICAgdmFyIGFjID0gc2l6ZTtcbiAgICB2YXIgZiA9IE1hdGgubWluKE1hdGgubWF4KE1hdGguc2luKEQyUiAqIGxsWzFdKSwgLTAuOTk5OSksIDAuOTk5OSk7XG4gICAgdmFyIHggPSBkICsgbGxbMF0gKiBiYztcbiAgICB2YXIgeSA9IGQgKyAwLjUgKiBNYXRoLmxvZygoMSArIGYpIC8gKDEgLSBmKSkgKiAtY2M7XG4gICAgKHggPiBhYyAqIHRoaXMuZXhwYW5zaW9uKSAmJiAoeCA9IGFjICogdGhpcy5leHBhbnNpb24pO1xuICAgICh5ID4gYWMpICYmICh5ID0gYWMpO1xuICAgIC8vKHggPCAwKSAmJiAoeCA9IDApO1xuICAgIC8vKHkgPCAwKSAmJiAoeSA9IDApO1xuICAgIHJldHVybiBbeCwgeV07XG4gIH0gZWxzZSB7XG4gICAgdmFyIGQgPSB0aGlzLnpjW3pvb21dO1xuICAgIHZhciBmID0gTWF0aC5taW4oTWF0aC5tYXgoTWF0aC5zaW4oRDJSICogbGxbMV0pLCAtMC45OTk5KSwgMC45OTk5KTtcbiAgICB2YXIgeCA9IE1hdGgucm91bmQoZCArIGxsWzBdICogdGhpcy5CY1t6b29tXSk7XG4gICAgdmFyIHkgPSBNYXRoLnJvdW5kKGQgKyAwLjUgKiBNYXRoLmxvZygoMSArIGYpIC8gKDEgLSBmKSkgKiAoLXRoaXMuQ2Nbem9vbV0pKTtcbiAgICAoeCA+IHRoaXMuQWNbem9vbV0gKiB0aGlzLmV4cGFuc2lvbikgJiYgKHggPSB0aGlzLkFjW3pvb21dICogdGhpcy5leHBhbnNpb24pO1xuICAgICh5ID4gdGhpcy5BY1t6b29tXSkgJiYgKHkgPSB0aGlzLkFjW3pvb21dKTtcbiAgICAvLyh4IDwgMCkgJiYgKHggPSAwKTtcbiAgICAvLyh5IDwgMCkgJiYgKHkgPSAwKTtcbiAgICByZXR1cm4gW3gsIHldO1xuICB9XG59O1xuXG4vLyBDb252ZXJ0IHNjcmVlbiBwaXhlbCB2YWx1ZSB0byBsb24gbGF0XG4vL1xuLy8gLSBgcHhgIHtBcnJheX0gYFt4LCB5XWAgYXJyYXkgb2YgZ2VvZ3JhcGhpYyBjb29yZGluYXRlcy5cbi8vIC0gYHpvb21gIHtOdW1iZXJ9IHpvb20gbGV2ZWwuXG5TcGhlcmljYWxNZXJjYXRvci5wcm90b3R5cGUubGwgPSBmdW5jdGlvbihweCwgem9vbSkge1xuICBpZiAoaXNGbG9hdCh6b29tKSkge1xuICAgIHZhciBzaXplID0gdGhpcy5zaXplICogTWF0aC5wb3coMiwgem9vbSk7XG4gICAgdmFyIGJjID0gKHNpemUgLyAzNjApO1xuICAgIHZhciBjYyA9IChzaXplIC8gKDIgKiBNYXRoLlBJKSk7XG4gICAgdmFyIHpjID0gc2l6ZSAvIDI7XG4gICAgdmFyIGcgPSAocHhbMV0gLSB6YykgLyAtY2M7XG4gICAgdmFyIGxvbiA9IChweFswXSAtIHpjKSAvIGJjO1xuICAgIHZhciBsYXQgPSBSMkQgKiAoMiAqIE1hdGguYXRhbihNYXRoLmV4cChnKSkgLSAwLjUgKiBNYXRoLlBJKTtcbiAgICByZXR1cm4gW2xvbiwgbGF0XTtcbiAgfSBlbHNlIHtcbiAgICB2YXIgZyA9IChweFsxXSAtIHRoaXMuemNbem9vbV0pIC8gKC10aGlzLkNjW3pvb21dKTtcbiAgICB2YXIgbG9uID0gKHB4WzBdIC0gdGhpcy56Y1t6b29tXSkgLyB0aGlzLkJjW3pvb21dO1xuICAgIHZhciBsYXQgPSBSMkQgKiAoMiAqIE1hdGguYXRhbihNYXRoLmV4cChnKSkgLSAwLjUgKiBNYXRoLlBJKTtcbiAgICByZXR1cm4gW2xvbiwgbGF0XTtcbiAgfVxufTtcblxuLy8gQ29udmVydCB0aWxlIHh5eiB2YWx1ZSB0byBiYm94IG9mIHRoZSBmb3JtIGBbdywgcywgZSwgbl1gXG4vL1xuLy8gLSBgeGAge051bWJlcn0geCAobG9uZ2l0dWRlKSBudW1iZXIuXG4vLyAtIGB5YCB7TnVtYmVyfSB5IChsYXRpdHVkZSkgbnVtYmVyLlxuLy8gLSBgem9vbWAge051bWJlcn0gem9vbS5cbi8vIC0gYHRtc19zdHlsZWAge0Jvb2xlYW59IHdoZXRoZXIgdG8gY29tcHV0ZSB1c2luZyB0bXMtc3R5bGUuXG4vLyAtIGBzcnNgIHtTdHJpbmd9IHByb2plY3Rpb24gZm9yIHJlc3VsdGluZyBiYm94IChXR1M4NHw5MDA5MTMpLlxuLy8gLSBgcmV0dXJuYCB7QXJyYXl9IGJib3ggYXJyYXkgb2YgdmFsdWVzIGluIGZvcm0gYFt3LCBzLCBlLCBuXWAuXG5TcGhlcmljYWxNZXJjYXRvci5wcm90b3R5cGUuYmJveCA9IGZ1bmN0aW9uKHgsIHksIHpvb20sIHRtc19zdHlsZSwgc3JzKSB7XG4gICAgLy8gQ29udmVydCB4eXogaW50byBiYm94IHdpdGggc3JzIFdHUzg0XG4gICAgaWYgKHRtc19zdHlsZSkge1xuICAgICAgICB5ID0gKE1hdGgucG93KDIsIHpvb20pIC0gMSkgLSB5O1xuICAgIH1cbiAgICAvLyBVc2UgK3kgdG8gbWFrZSBzdXJlIGl0J3MgYSBudW1iZXIgdG8gYXZvaWQgaW5hZHZlcnRlbnQgY29uY2F0ZW5hdGlvbi5cbiAgICB2YXIgbGwgPSBbeCAqIHRoaXMuc2l6ZSwgKCt5ICsgMSkgKiB0aGlzLnNpemVdOyAvLyBsb3dlciBsZWZ0XG4gICAgLy8gVXNlICt4IHRvIG1ha2Ugc3VyZSBpdCdzIGEgbnVtYmVyIHRvIGF2b2lkIGluYWR2ZXJ0ZW50IGNvbmNhdGVuYXRpb24uXG4gICAgdmFyIHVyID0gWygreCArIDEpICogdGhpcy5zaXplLCB5ICogdGhpcy5zaXplXTsgLy8gdXBwZXIgcmlnaHRcbiAgICB2YXIgYmJveCA9IHRoaXMubGwobGwsIHpvb20pLmNvbmNhdCh0aGlzLmxsKHVyLCB6b29tKSk7XG5cbiAgICAvLyBJZiB3ZWIgbWVyY2F0b3IgcmVxdWVzdGVkIHJlcHJvamVjdCB0byA5MDA5MTMuXG4gICAgaWYgKHNycyA9PT0gJzkwMDkxMycpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udmVydChiYm94LCAnOTAwOTEzJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGJib3g7XG4gICAgfVxufTtcblxuLy8gQ29udmVydCBiYm94IHRvIHh5eCBib3VuZHNcbi8vXG4vLyAtIGBiYm94YCB7TnVtYmVyfSBiYm94IGluIHRoZSBmb3JtIGBbdywgcywgZSwgbl1gLlxuLy8gLSBgem9vbWAge051bWJlcn0gem9vbS5cbi8vIC0gYHRtc19zdHlsZWAge0Jvb2xlYW59IHdoZXRoZXIgdG8gY29tcHV0ZSB1c2luZyB0bXMtc3R5bGUuXG4vLyAtIGBzcnNgIHtTdHJpbmd9IHByb2plY3Rpb24gb2YgaW5wdXQgYmJveCAoV0dTODR8OTAwOTEzKS5cbi8vIC0gYEByZXR1cm5gIHtPYmplY3R9IFhZWiBib3VuZHMgY29udGFpbmluZyBtaW5YLCBtYXhYLCBtaW5ZLCBtYXhZIHByb3BlcnRpZXMuXG5TcGhlcmljYWxNZXJjYXRvci5wcm90b3R5cGUueHl6ID0gZnVuY3Rpb24oYmJveCwgem9vbSwgdG1zX3N0eWxlLCBzcnMpIHtcbiAgICAvLyBJZiB3ZWIgbWVyY2F0b3IgcHJvdmlkZWQgcmVwcm9qZWN0IHRvIFdHUzg0LlxuICAgIGlmIChzcnMgPT09ICc5MDA5MTMnKSB7XG4gICAgICAgIGJib3ggPSB0aGlzLmNvbnZlcnQoYmJveCwgJ1dHUzg0Jyk7XG4gICAgfVxuXG4gICAgdmFyIGxsID0gW2Jib3hbMF0sIGJib3hbMV1dOyAvLyBsb3dlciBsZWZ0XG4gICAgdmFyIHVyID0gW2Jib3hbMl0sIGJib3hbM11dOyAvLyB1cHBlciByaWdodFxuICAgIHZhciBweF9sbCA9IHRoaXMucHgobGwsIHpvb20pO1xuICAgIHZhciBweF91ciA9IHRoaXMucHgodXIsIHpvb20pO1xuICAgIC8vIFkgPSAwIGZvciBYWVogaXMgdGhlIHRvcCBoZW5jZSBtaW5ZIHVzZXMgcHhfdXJbMV0uXG4gICAgdmFyIHggPSBbIE1hdGguZmxvb3IocHhfbGxbMF0gLyB0aGlzLnNpemUpLCBNYXRoLmZsb29yKChweF91clswXSAtIDEpIC8gdGhpcy5zaXplKSBdO1xuICAgIHZhciB5ID0gWyBNYXRoLmZsb29yKHB4X3VyWzFdIC8gdGhpcy5zaXplKSwgTWF0aC5mbG9vcigocHhfbGxbMV0gLSAxKSAvIHRoaXMuc2l6ZSkgXTtcbiAgICB2YXIgYm91bmRzID0ge1xuICAgICAgICBtaW5YOiBNYXRoLm1pbi5hcHBseShNYXRoLCB4KSA8IDAgPyAwIDogTWF0aC5taW4uYXBwbHkoTWF0aCwgeCksXG4gICAgICAgIG1pblk6IE1hdGgubWluLmFwcGx5KE1hdGgsIHkpIDwgMCA/IDAgOiBNYXRoLm1pbi5hcHBseShNYXRoLCB5KSxcbiAgICAgICAgbWF4WDogTWF0aC5tYXguYXBwbHkoTWF0aCwgeCksXG4gICAgICAgIG1heFk6IE1hdGgubWF4LmFwcGx5KE1hdGgsIHkpXG4gICAgfTtcbiAgICBpZiAodG1zX3N0eWxlKSB7XG4gICAgICAgIHZhciB0bXMgPSB7XG4gICAgICAgICAgICBtaW5ZOiAoTWF0aC5wb3coMiwgem9vbSkgLSAxKSAtIGJvdW5kcy5tYXhZLFxuICAgICAgICAgICAgbWF4WTogKE1hdGgucG93KDIsIHpvb20pIC0gMSkgLSBib3VuZHMubWluWVxuICAgICAgICB9O1xuICAgICAgICBib3VuZHMubWluWSA9IHRtcy5taW5ZO1xuICAgICAgICBib3VuZHMubWF4WSA9IHRtcy5tYXhZO1xuICAgIH1cbiAgICByZXR1cm4gYm91bmRzO1xufTtcblxuLy8gQ29udmVydCBwcm9qZWN0aW9uIG9mIGdpdmVuIGJib3guXG4vL1xuLy8gLSBgYmJveGAge051bWJlcn0gYmJveCBpbiB0aGUgZm9ybSBgW3csIHMsIGUsIG5dYC5cbi8vIC0gYHRvYCB7U3RyaW5nfSBwcm9qZWN0aW9uIG9mIG91dHB1dCBiYm94IChXR1M4NHw5MDA5MTMpLiBJbnB1dCBiYm94XG4vLyAgIGFzc3VtZWQgdG8gYmUgdGhlIFwib3RoZXJcIiBwcm9qZWN0aW9uLlxuLy8gLSBgQHJldHVybmAge09iamVjdH0gYmJveCB3aXRoIHJlcHJvamVjdGVkIGNvb3JkaW5hdGVzLlxuU3BoZXJpY2FsTWVyY2F0b3IucHJvdG90eXBlLmNvbnZlcnQgPSBmdW5jdGlvbihiYm94LCB0bykge1xuICAgIGlmICh0byA9PT0gJzkwMDkxMycpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZm9yd2FyZChiYm94LnNsaWNlKDAsIDIpKS5jb25jYXQodGhpcy5mb3J3YXJkKGJib3guc2xpY2UoMiw0KSkpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB0aGlzLmludmVyc2UoYmJveC5zbGljZSgwLCAyKSkuY29uY2F0KHRoaXMuaW52ZXJzZShiYm94LnNsaWNlKDIsNCkpKTtcbiAgICB9XG59O1xuXG4vLyBDb252ZXJ0IGxvbi9sYXQgdmFsdWVzIHRvIDkwMDkxMyB4L3kuXG5TcGhlcmljYWxNZXJjYXRvci5wcm90b3R5cGUuZm9yd2FyZCA9IGZ1bmN0aW9uKGxsKSB7XG4gICAgdmFyIHh5ID0gW1xuICAgICAgICBBICogbGxbMF0gKiBEMlIsXG4gICAgICAgIEEgKiBNYXRoLmxvZyhNYXRoLnRhbigoTWF0aC5QSSowLjI1KSArICgwLjUgKiBsbFsxXSAqIEQyUikpKVxuICAgIF07XG4gICAgLy8gaWYgeHkgdmFsdWUgaXMgYmV5b25kIG1heGV4dGVudCAoZS5nLiBwb2xlcyksIHJldHVybiBtYXhleHRlbnQuXG4gICAgKHh5WzBdID4gTUFYRVhURU5UKSAmJiAoeHlbMF0gPSBNQVhFWFRFTlQpO1xuICAgICh4eVswXSA8IC1NQVhFWFRFTlQpICYmICh4eVswXSA9IC1NQVhFWFRFTlQpO1xuICAgICh4eVsxXSA+IE1BWEVYVEVOVCkgJiYgKHh5WzFdID0gTUFYRVhURU5UKTtcbiAgICAoeHlbMV0gPCAtTUFYRVhURU5UKSAmJiAoeHlbMV0gPSAtTUFYRVhURU5UKTtcbiAgICByZXR1cm4geHk7XG59O1xuXG4vLyBDb252ZXJ0IDkwMDkxMyB4L3kgdmFsdWVzIHRvIGxvbi9sYXQuXG5TcGhlcmljYWxNZXJjYXRvci5wcm90b3R5cGUuaW52ZXJzZSA9IGZ1bmN0aW9uKHh5KSB7XG4gICAgcmV0dXJuIFtcbiAgICAgICAgKHh5WzBdICogUjJEIC8gQSksXG4gICAgICAgICgoTWF0aC5QSSowLjUpIC0gMi4wICogTWF0aC5hdGFuKE1hdGguZXhwKC14eVsxXSAvIEEpKSkgKiBSMkRcbiAgICBdO1xufTtcblxucmV0dXJuIFNwaGVyaWNhbE1lcmNhdG9yO1xuXG59KSgpO1xuXG5pZiAodHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIGV4cG9ydHMgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzID0gU3BoZXJpY2FsTWVyY2F0b3I7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@mapbox/sphericalmercator/sphericalmercator.js\n");

/***/ })

};
;